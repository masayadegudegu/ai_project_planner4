(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function n(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(a){if(a.ep)return;a.ep=!0;const l=n(a);fetch(a.href,l)}})();function Gy(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Sd={exports:{}},Co={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lg;function NS(){if(Lg)return Co;Lg=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(r,a,l){var c=null;if(l!==void 0&&(c=""+l),a.key!==void 0&&(c=""+a.key),"key"in a){l={};for(var u in a)u!=="key"&&(l[u]=a[u])}else l=a;return a=l.ref,{$$typeof:e,type:r,key:c,ref:a!==void 0?a:null,props:l}}return Co.Fragment=t,Co.jsx=n,Co.jsxs=n,Co}var Og;function MS(){return Og||(Og=1,Sd.exports=NS()),Sd.exports}var g=MS(),wd={exports:{}},ct={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pg;function RS(){if(Pg)return ct;Pg=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),y=Symbol.iterator;function _(N){return N===null||typeof N!="object"?null:(N=y&&N[y]||N["@@iterator"],typeof N=="function"?N:null)}var E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,S={};function C(N,Z,D){this.props=N,this.context=Z,this.refs=S,this.updater=D||E}C.prototype.isReactComponent={},C.prototype.setState=function(N,Z){if(typeof N!="object"&&typeof N!="function"&&N!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,N,Z,"setState")},C.prototype.forceUpdate=function(N){this.updater.enqueueForceUpdate(this,N,"forceUpdate")};function M(){}M.prototype=C.prototype;function k(N,Z,D){this.props=N,this.context=Z,this.refs=S,this.updater=D||E}var b=k.prototype=new M;b.constructor=k,w(b,C.prototype),b.isPureReactComponent=!0;var U=Array.isArray,G={H:null,A:null,T:null,S:null,V:null},J=Object.prototype.hasOwnProperty;function F(N,Z,D,H,q,j){return D=j.ref,{$$typeof:e,type:N,key:Z,ref:D!==void 0?D:null,props:j}}function W(N,Z){return F(N.type,Z,void 0,void 0,void 0,N.props)}function O(N){return typeof N=="object"&&N!==null&&N.$$typeof===e}function ee(N){var Z={"=":"=0",":":"=2"};return"$"+N.replace(/[=:]/g,function(D){return Z[D]})}var ne=/\/+/g;function te(N,Z){return typeof N=="object"&&N!==null&&N.key!=null?ee(""+N.key):Z.toString(36)}function _e(){}function Ie(N){switch(N.status){case"fulfilled":return N.value;case"rejected":throw N.reason;default:switch(typeof N.status=="string"?N.then(_e,_e):(N.status="pending",N.then(function(Z){N.status==="pending"&&(N.status="fulfilled",N.value=Z)},function(Z){N.status==="pending"&&(N.status="rejected",N.reason=Z)})),N.status){case"fulfilled":return N.value;case"rejected":throw N.reason}}throw N}function Ee(N,Z,D,H,q){var j=typeof N;(j==="undefined"||j==="boolean")&&(N=null);var se=!1;if(N===null)se=!0;else switch(j){case"bigint":case"string":case"number":se=!0;break;case"object":switch(N.$$typeof){case e:case t:se=!0;break;case x:return se=N._init,Ee(se(N._payload),Z,D,H,q)}}if(se)return q=q(N),se=H===""?"."+te(N,0):H,U(q)?(D="",se!=null&&(D=se.replace(ne,"$&/")+"/"),Ee(q,Z,D,"",function(Re){return Re})):q!=null&&(O(q)&&(q=W(q,D+(q.key==null||N&&N.key===q.key?"":(""+q.key).replace(ne,"$&/")+"/")+se)),Z.push(q)),1;se=0;var Te=H===""?".":H+":";if(U(N))for(var Ae=0;Ae<N.length;Ae++)H=N[Ae],j=Te+te(H,Ae),se+=Ee(H,Z,D,j,q);else if(Ae=_(N),typeof Ae=="function")for(N=Ae.call(N),Ae=0;!(H=N.next()).done;)H=H.value,j=Te+te(H,Ae++),se+=Ee(H,Z,D,j,q);else if(j==="object"){if(typeof N.then=="function")return Ee(Ie(N),Z,D,H,q);throw Z=String(N),Error("Objects are not valid as a React child (found: "+(Z==="[object Object]"?"object with keys {"+Object.keys(N).join(", ")+"}":Z)+"). If you meant to render a collection of children, use an array instead.")}return se}function ae(N,Z,D){if(N==null)return N;var H=[],q=0;return Ee(N,H,"","",function(j){return Z.call(D,j,q++)}),H}function de(N){if(N._status===-1){var Z=N._result;Z=Z(),Z.then(function(D){(N._status===0||N._status===-1)&&(N._status=1,N._result=D)},function(D){(N._status===0||N._status===-1)&&(N._status=2,N._result=D)}),N._status===-1&&(N._status=0,N._result=Z)}if(N._status===1)return N._result.default;throw N._result}var re=typeof reportError=="function"?reportError:function(N){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Z=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof N=="object"&&N!==null&&typeof N.message=="string"?String(N.message):String(N),error:N});if(!window.dispatchEvent(Z))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",N);return}console.error(N)};function Y(){}return ct.Children={map:ae,forEach:function(N,Z,D){ae(N,function(){Z.apply(this,arguments)},D)},count:function(N){var Z=0;return ae(N,function(){Z++}),Z},toArray:function(N){return ae(N,function(Z){return Z})||[]},only:function(N){if(!O(N))throw Error("React.Children.only expected to receive a single React element child.");return N}},ct.Component=C,ct.Fragment=n,ct.Profiler=a,ct.PureComponent=k,ct.StrictMode=r,ct.Suspense=p,ct.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=G,ct.__COMPILER_RUNTIME={__proto__:null,c:function(N){return G.H.useMemoCache(N)}},ct.cache=function(N){return function(){return N.apply(null,arguments)}},ct.cloneElement=function(N,Z,D){if(N==null)throw Error("The argument must be a React element, but you passed "+N+".");var H=w({},N.props),q=N.key,j=void 0;if(Z!=null)for(se in Z.ref!==void 0&&(j=void 0),Z.key!==void 0&&(q=""+Z.key),Z)!J.call(Z,se)||se==="key"||se==="__self"||se==="__source"||se==="ref"&&Z.ref===void 0||(H[se]=Z[se]);var se=arguments.length-2;if(se===1)H.children=D;else if(1<se){for(var Te=Array(se),Ae=0;Ae<se;Ae++)Te[Ae]=arguments[Ae+2];H.children=Te}return F(N.type,q,void 0,void 0,j,H)},ct.createContext=function(N){return N={$$typeof:c,_currentValue:N,_currentValue2:N,_threadCount:0,Provider:null,Consumer:null},N.Provider=N,N.Consumer={$$typeof:l,_context:N},N},ct.createElement=function(N,Z,D){var H,q={},j=null;if(Z!=null)for(H in Z.key!==void 0&&(j=""+Z.key),Z)J.call(Z,H)&&H!=="key"&&H!=="__self"&&H!=="__source"&&(q[H]=Z[H]);var se=arguments.length-2;if(se===1)q.children=D;else if(1<se){for(var Te=Array(se),Ae=0;Ae<se;Ae++)Te[Ae]=arguments[Ae+2];q.children=Te}if(N&&N.defaultProps)for(H in se=N.defaultProps,se)q[H]===void 0&&(q[H]=se[H]);return F(N,j,void 0,void 0,null,q)},ct.createRef=function(){return{current:null}},ct.forwardRef=function(N){return{$$typeof:u,render:N}},ct.isValidElement=O,ct.lazy=function(N){return{$$typeof:x,_payload:{_status:-1,_result:N},_init:de}},ct.memo=function(N,Z){return{$$typeof:m,type:N,compare:Z===void 0?null:Z}},ct.startTransition=function(N){var Z=G.T,D={};G.T=D;try{var H=N(),q=G.S;q!==null&&q(D,H),typeof H=="object"&&H!==null&&typeof H.then=="function"&&H.then(Y,re)}catch(j){re(j)}finally{G.T=Z}},ct.unstable_useCacheRefresh=function(){return G.H.useCacheRefresh()},ct.use=function(N){return G.H.use(N)},ct.useActionState=function(N,Z,D){return G.H.useActionState(N,Z,D)},ct.useCallback=function(N,Z){return G.H.useCallback(N,Z)},ct.useContext=function(N){return G.H.useContext(N)},ct.useDebugValue=function(){},ct.useDeferredValue=function(N,Z){return G.H.useDeferredValue(N,Z)},ct.useEffect=function(N,Z,D){var H=G.H;if(typeof D=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return H.useEffect(N,Z)},ct.useId=function(){return G.H.useId()},ct.useImperativeHandle=function(N,Z,D){return G.H.useImperativeHandle(N,Z,D)},ct.useInsertionEffect=function(N,Z){return G.H.useInsertionEffect(N,Z)},ct.useLayoutEffect=function(N,Z){return G.H.useLayoutEffect(N,Z)},ct.useMemo=function(N,Z){return G.H.useMemo(N,Z)},ct.useOptimistic=function(N,Z){return G.H.useOptimistic(N,Z)},ct.useReducer=function(N,Z,D){return G.H.useReducer(N,Z,D)},ct.useRef=function(N){return G.H.useRef(N)},ct.useState=function(N){return G.H.useState(N)},ct.useSyncExternalStore=function(N,Z,D){return G.H.useSyncExternalStore(N,Z,D)},ct.useTransition=function(){return G.H.useTransition()},ct.version="19.1.0",ct}var Ug;function Eh(){return Ug||(Ug=1,wd.exports=RS()),wd.exports}var he=Eh();const Wa=Gy(he);var Cd={exports:{}},Ao={},Ad={exports:{}},bd={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bg;function DS(){return Bg||(Bg=1,function(e){function t(ae,de){var re=ae.length;ae.push(de);e:for(;0<re;){var Y=re-1>>>1,N=ae[Y];if(0<a(N,de))ae[Y]=de,ae[re]=N,re=Y;else break e}}function n(ae){return ae.length===0?null:ae[0]}function r(ae){if(ae.length===0)return null;var de=ae[0],re=ae.pop();if(re!==de){ae[0]=re;e:for(var Y=0,N=ae.length,Z=N>>>1;Y<Z;){var D=2*(Y+1)-1,H=ae[D],q=D+1,j=ae[q];if(0>a(H,re))q<N&&0>a(j,H)?(ae[Y]=j,ae[q]=re,Y=q):(ae[Y]=H,ae[D]=re,Y=D);else if(q<N&&0>a(j,re))ae[Y]=j,ae[q]=re,Y=q;else break e}}return de}function a(ae,de){var re=ae.sortIndex-de.sortIndex;return re!==0?re:ae.id-de.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var c=Date,u=c.now();e.unstable_now=function(){return c.now()-u}}var p=[],m=[],x=1,y=null,_=3,E=!1,w=!1,S=!1,C=!1,M=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;function U(ae){for(var de=n(m);de!==null;){if(de.callback===null)r(m);else if(de.startTime<=ae)r(m),de.sortIndex=de.expirationTime,t(p,de);else break;de=n(m)}}function G(ae){if(S=!1,U(ae),!w)if(n(p)!==null)w=!0,J||(J=!0,te());else{var de=n(m);de!==null&&Ee(G,de.startTime-ae)}}var J=!1,F=-1,W=5,O=-1;function ee(){return C?!0:!(e.unstable_now()-O<W)}function ne(){if(C=!1,J){var ae=e.unstable_now();O=ae;var de=!0;try{e:{w=!1,S&&(S=!1,k(F),F=-1),E=!0;var re=_;try{t:{for(U(ae),y=n(p);y!==null&&!(y.expirationTime>ae&&ee());){var Y=y.callback;if(typeof Y=="function"){y.callback=null,_=y.priorityLevel;var N=Y(y.expirationTime<=ae);if(ae=e.unstable_now(),typeof N=="function"){y.callback=N,U(ae),de=!0;break t}y===n(p)&&r(p),U(ae)}else r(p);y=n(p)}if(y!==null)de=!0;else{var Z=n(m);Z!==null&&Ee(G,Z.startTime-ae),de=!1}}break e}finally{y=null,_=re,E=!1}de=void 0}}finally{de?te():J=!1}}}var te;if(typeof b=="function")te=function(){b(ne)};else if(typeof MessageChannel<"u"){var _e=new MessageChannel,Ie=_e.port2;_e.port1.onmessage=ne,te=function(){Ie.postMessage(null)}}else te=function(){M(ne,0)};function Ee(ae,de){F=M(function(){ae(e.unstable_now())},de)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ae){ae.callback=null},e.unstable_forceFrameRate=function(ae){0>ae||125<ae?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):W=0<ae?Math.floor(1e3/ae):5},e.unstable_getCurrentPriorityLevel=function(){return _},e.unstable_next=function(ae){switch(_){case 1:case 2:case 3:var de=3;break;default:de=_}var re=_;_=de;try{return ae()}finally{_=re}},e.unstable_requestPaint=function(){C=!0},e.unstable_runWithPriority=function(ae,de){switch(ae){case 1:case 2:case 3:case 4:case 5:break;default:ae=3}var re=_;_=ae;try{return de()}finally{_=re}},e.unstable_scheduleCallback=function(ae,de,re){var Y=e.unstable_now();switch(typeof re=="object"&&re!==null?(re=re.delay,re=typeof re=="number"&&0<re?Y+re:Y):re=Y,ae){case 1:var N=-1;break;case 2:N=250;break;case 5:N=1073741823;break;case 4:N=1e4;break;default:N=5e3}return N=re+N,ae={id:x++,callback:de,priorityLevel:ae,startTime:re,expirationTime:N,sortIndex:-1},re>Y?(ae.sortIndex=re,t(m,ae),n(p)===null&&ae===n(m)&&(S?(k(F),F=-1):S=!0,Ee(G,re-Y))):(ae.sortIndex=N,t(p,ae),w||E||(w=!0,J||(J=!0,te()))),ae},e.unstable_shouldYield=ee,e.unstable_wrapCallback=function(ae){var de=_;return function(){var re=_;_=de;try{return ae.apply(this,arguments)}finally{_=re}}}}(bd)),bd}var Vg;function IS(){return Vg||(Vg=1,Ad.exports=DS()),Ad.exports}var kd={exports:{}},Jn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hg;function FS(){if(Hg)return Jn;Hg=1;var e=Eh();function t(p){var m="https://react.dev/errors/"+p;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var x=2;x<arguments.length;x++)m+="&args[]="+encodeURIComponent(arguments[x])}return"Minified React error #"+p+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(t(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},a=Symbol.for("react.portal");function l(p,m,x){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:y==null?null:""+y,children:p,containerInfo:m,implementation:x}}var c=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(p,m){if(p==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return Jn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Jn.createPortal=function(p,m){var x=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(t(299));return l(p,m,null,x)},Jn.flushSync=function(p){var m=c.T,x=r.p;try{if(c.T=null,r.p=2,p)return p()}finally{c.T=m,r.p=x,r.d.f()}},Jn.preconnect=function(p,m){typeof p=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,r.d.C(p,m))},Jn.prefetchDNS=function(p){typeof p=="string"&&r.d.D(p)},Jn.preinit=function(p,m){if(typeof p=="string"&&m&&typeof m.as=="string"){var x=m.as,y=u(x,m.crossOrigin),_=typeof m.integrity=="string"?m.integrity:void 0,E=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;x==="style"?r.d.S(p,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:y,integrity:_,fetchPriority:E}):x==="script"&&r.d.X(p,{crossOrigin:y,integrity:_,fetchPriority:E,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},Jn.preinitModule=function(p,m){if(typeof p=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var x=u(m.as,m.crossOrigin);r.d.M(p,{crossOrigin:x,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&r.d.M(p)},Jn.preload=function(p,m){if(typeof p=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var x=m.as,y=u(x,m.crossOrigin);r.d.L(p,x,{crossOrigin:y,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},Jn.preloadModule=function(p,m){if(typeof p=="string")if(m){var x=u(m.as,m.crossOrigin);r.d.m(p,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:x,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else r.d.m(p)},Jn.requestFormReset=function(p){r.d.r(p)},Jn.unstable_batchedUpdates=function(p,m){return p(m)},Jn.useFormState=function(p,m,x){return c.H.useFormState(p,m,x)},Jn.useFormStatus=function(){return c.H.useHostTransitionStatus()},Jn.version="19.1.0",Jn}var Gg;function LS(){if(Gg)return kd.exports;Gg=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),kd.exports=FS(),kd.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jg;function OS(){if(jg)return Ao;jg=1;var e=IS(),t=Eh(),n=LS();function r(i){var s="https://react.dev/errors/"+i;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)s+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+i+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function l(i){var s=i,o=i;if(i.alternate)for(;s.return;)s=s.return;else{i=s;do s=i,(s.flags&4098)!==0&&(o=s.return),i=s.return;while(i)}return s.tag===3?o:null}function c(i){if(i.tag===13){var s=i.memoizedState;if(s===null&&(i=i.alternate,i!==null&&(s=i.memoizedState)),s!==null)return s.dehydrated}return null}function u(i){if(l(i)!==i)throw Error(r(188))}function p(i){var s=i.alternate;if(!s){if(s=l(i),s===null)throw Error(r(188));return s!==i?null:i}for(var o=i,h=s;;){var v=o.return;if(v===null)break;var T=v.alternate;if(T===null){if(h=v.return,h!==null){o=h;continue}break}if(v.child===T.child){for(T=v.child;T;){if(T===o)return u(v),i;if(T===h)return u(v),s;T=T.sibling}throw Error(r(188))}if(o.return!==h.return)o=v,h=T;else{for(var A=!1,I=v.child;I;){if(I===o){A=!0,o=v,h=T;break}if(I===h){A=!0,h=v,o=T;break}I=I.sibling}if(!A){for(I=T.child;I;){if(I===o){A=!0,o=T,h=v;break}if(I===h){A=!0,h=T,o=v;break}I=I.sibling}if(!A)throw Error(r(189))}}if(o.alternate!==h)throw Error(r(190))}if(o.tag!==3)throw Error(r(188));return o.stateNode.current===o?i:s}function m(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i;for(i=i.child;i!==null;){if(s=m(i),s!==null)return s;i=i.sibling}return null}var x=Object.assign,y=Symbol.for("react.element"),_=Symbol.for("react.transitional.element"),E=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),M=Symbol.for("react.provider"),k=Symbol.for("react.consumer"),b=Symbol.for("react.context"),U=Symbol.for("react.forward_ref"),G=Symbol.for("react.suspense"),J=Symbol.for("react.suspense_list"),F=Symbol.for("react.memo"),W=Symbol.for("react.lazy"),O=Symbol.for("react.activity"),ee=Symbol.for("react.memo_cache_sentinel"),ne=Symbol.iterator;function te(i){return i===null||typeof i!="object"?null:(i=ne&&i[ne]||i["@@iterator"],typeof i=="function"?i:null)}var _e=Symbol.for("react.client.reference");function Ie(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===_e?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case w:return"Fragment";case C:return"Profiler";case S:return"StrictMode";case G:return"Suspense";case J:return"SuspenseList";case O:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case E:return"Portal";case b:return(i.displayName||"Context")+".Provider";case k:return(i._context.displayName||"Context")+".Consumer";case U:var s=i.render;return i=i.displayName,i||(i=s.displayName||s.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case F:return s=i.displayName||null,s!==null?s:Ie(i.type)||"Memo";case W:s=i._payload,i=i._init;try{return Ie(i(s))}catch{}}return null}var Ee=Array.isArray,ae=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,de=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,re={pending:!1,data:null,method:null,action:null},Y=[],N=-1;function Z(i){return{current:i}}function D(i){0>N||(i.current=Y[N],Y[N]=null,N--)}function H(i,s){N++,Y[N]=i.current,i.current=s}var q=Z(null),j=Z(null),se=Z(null),Te=Z(null);function Ae(i,s){switch(H(se,s),H(j,i),H(q,null),s.nodeType){case 9:case 11:i=(i=s.documentElement)&&(i=i.namespaceURI)?cg(i):0;break;default:if(i=s.tagName,s=s.namespaceURI)s=cg(s),i=ug(s,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}D(q),H(q,i)}function Re(){D(q),D(j),D(se)}function Ce(i){i.memoizedState!==null&&H(Te,i);var s=q.current,o=ug(s,i.type);s!==o&&(H(j,i),H(q,o))}function Xe(i){j.current===i&&(D(q),D(j)),Te.current===i&&(D(Te),To._currentValue=re)}var X=Object.prototype.hasOwnProperty,ut=e.unstable_scheduleCallback,Ke=e.unstable_cancelCallback,pt=e.unstable_shouldYield,Me=e.unstable_requestPaint,ve=e.unstable_now,Ge=e.unstable_getCurrentPriorityLevel,je=e.unstable_ImmediatePriority,Pt=e.unstable_UserBlockingPriority,Ct=e.unstable_NormalPriority,en=e.unstable_LowPriority,dt=e.unstable_IdlePriority,on=e.log,Bn=e.unstable_setDisableYieldValue,Jt=null,Xt=null;function Ut(i){if(typeof on=="function"&&Bn(i),Xt&&typeof Xt.setStrictMode=="function")try{Xt.setStrictMode(Jt,i)}catch{}}var at=Math.clz32?Math.clz32:Yt,Ve=Math.log,ht=Math.LN2;function Yt(i){return i>>>=0,i===0?32:31-(Ve(i)/ht|0)|0}var _t=256,Dn=4194304;function Yn(i){var s=i&42;if(s!==0)return s;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function Jr(i,s,o){var h=i.pendingLanes;if(h===0)return 0;var v=0,T=i.suspendedLanes,A=i.pingedLanes;i=i.warmLanes;var I=h&134217727;return I!==0?(h=I&~T,h!==0?v=Yn(h):(A&=I,A!==0?v=Yn(A):o||(o=I&~i,o!==0&&(v=Yn(o))))):(I=h&~T,I!==0?v=Yn(I):A!==0?v=Yn(A):o||(o=h&~i,o!==0&&(v=Yn(o)))),v===0?0:s!==0&&s!==v&&(s&T)===0&&(T=v&-v,o=s&-s,T>=o||T===32&&(o&4194048)!==0)?s:v}function Rr(i,s){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&s)===0}function ti(i,s){switch(i){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Aa(){var i=_t;return _t<<=1,(_t&4194048)===0&&(_t=256),i}function ba(){var i=Dn;return Dn<<=1,(Dn&62914560)===0&&(Dn=4194304),i}function ka(i){for(var s=[],o=0;31>o;o++)s.push(i);return s}function Pe(i,s){i.pendingLanes|=s,s!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function st(i,s,o,h,v,T){var A=i.pendingLanes;i.pendingLanes=o,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=o,i.entangledLanes&=o,i.errorRecoveryDisabledLanes&=o,i.shellSuspendCounter=0;var I=i.entanglements,Q=i.expirationTimes,fe=i.hiddenUpdates;for(o=A&~o;0<o;){var we=31-at(o),Ne=1<<we;I[we]=0,Q[we]=-1;var pe=fe[we];if(pe!==null)for(fe[we]=null,we=0;we<pe.length;we++){var ge=pe[we];ge!==null&&(ge.lane&=-536870913)}o&=~Ne}h!==0&&gt(i,h,0),T!==0&&v===0&&i.tag!==0&&(i.suspendedLanes|=T&~(A&~s))}function gt(i,s,o){i.pendingLanes|=s,i.suspendedLanes&=~s;var h=31-at(s);i.entangledLanes|=s,i.entanglements[h]=i.entanglements[h]|1073741824|o&4194090}function cn(i,s){var o=i.entangledLanes|=s;for(i=i.entanglements;o;){var h=31-at(o),v=1<<h;v&s|i[h]&s&&(i[h]|=s),o&=~v}}function In(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function Cn(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function Dr(){var i=de.p;return i!==0?i:(i=window.event,i===void 0?32:Ng(i.type))}function Na(i,s){var o=de.p;try{return de.p=i,s()}finally{de.p=o}}var Vn=Math.random().toString(36).slice(2),tn="__reactFiber$"+Vn,nn="__reactProps$"+Vn,dr="__reactContainer$"+Vn,Mt="__reactEvents$"+Vn,Ma="__reactListeners$"+Vn,R="__reactHandles$"+Vn,V="__reactResources$"+Vn,L="__reactMarker$"+Vn;function P(i){delete i[tn],delete i[nn],delete i[Mt],delete i[Ma],delete i[R]}function B(i){var s=i[tn];if(s)return s;for(var o=i.parentNode;o;){if(s=o[dr]||o[tn]){if(o=s.alternate,s.child!==null||o!==null&&o.child!==null)for(i=mg(i);i!==null;){if(o=i[tn])return o;i=mg(i)}return s}i=o,o=i.parentNode}return null}function z(i){if(i=i[tn]||i[dr]){var s=i.tag;if(s===5||s===6||s===13||s===26||s===27||s===3)return i}return null}function ue(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i.stateNode;throw Error(r(33))}function ye(i){var s=i[V];return s||(s=i[V]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function oe(i){i[L]=!0}var me=new Set,xe={};function De(i,s){Oe(i,s),Oe(i+"Capture",s)}function Oe(i,s){for(xe[i]=s,i=0;i<s.length;i++)me.add(s[i])}var Be=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Fe={},K={};function Se(i){return X.call(K,i)?!0:X.call(Fe,i)?!1:Be.test(i)?K[i]=!0:(Fe[i]=!0,!1)}function ke(i,s,o){if(Se(s))if(o===null)i.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":i.removeAttribute(s);return;case"boolean":var h=s.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){i.removeAttribute(s);return}}i.setAttribute(s,""+o)}}function Ue(i,s,o){if(o===null)i.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(s);return}i.setAttribute(s,""+o)}}function ze(i,s,o,h){if(h===null)i.removeAttribute(o);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(o);return}i.setAttributeNS(s,o,""+h)}}var ot,Dt;function Et(i){if(ot===void 0)try{throw Error()}catch(o){var s=o.stack.trim().match(/\n( *(at )?)/);ot=s&&s[1]||"",Dt=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ot+i+Dt}var It=!1;function un(i,s){if(!i||It)return"";It=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(s){var Ne=function(){throw Error()};if(Object.defineProperty(Ne.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ne,[])}catch(ge){var pe=ge}Reflect.construct(i,[],Ne)}else{try{Ne.call()}catch(ge){pe=ge}i.call(Ne.prototype)}}else{try{throw Error()}catch(ge){pe=ge}(Ne=i())&&typeof Ne.catch=="function"&&Ne.catch(function(){})}}catch(ge){if(ge&&pe&&typeof ge.stack=="string")return[ge.stack,pe.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var v=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");v&&v.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var T=h.DetermineComponentFrameRoot(),A=T[0],I=T[1];if(A&&I){var Q=A.split(`
`),fe=I.split(`
`);for(v=h=0;h<Q.length&&!Q[h].includes("DetermineComponentFrameRoot");)h++;for(;v<fe.length&&!fe[v].includes("DetermineComponentFrameRoot");)v++;if(h===Q.length||v===fe.length)for(h=Q.length-1,v=fe.length-1;1<=h&&0<=v&&Q[h]!==fe[v];)v--;for(;1<=h&&0<=v;h--,v--)if(Q[h]!==fe[v]){if(h!==1||v!==1)do if(h--,v--,0>v||Q[h]!==fe[v]){var we=`
`+Q[h].replace(" at new "," at ");return i.displayName&&we.includes("<anonymous>")&&(we=we.replace("<anonymous>",i.displayName)),we}while(1<=h&&0<=v);break}}}finally{It=!1,Error.prepareStackTrace=o}return(o=i?i.displayName||i.name:"")?Et(o):""}function Ft(i){switch(i.tag){case 26:case 27:case 5:return Et(i.type);case 16:return Et("Lazy");case 13:return Et("Suspense");case 19:return Et("SuspenseList");case 0:case 15:return un(i.type,!1);case 11:return un(i.type.render,!1);case 1:return un(i.type,!0);case 31:return Et("Activity");default:return""}}function Ir(i){try{var s="";do s+=Ft(i),i=i.return;while(i);return s}catch(o){return`
Error generating stack: `+o.message+`
`+o.stack}}function fn(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Rl(i){var s=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function ws(i){var s=Rl(i)?"checked":"value",o=Object.getOwnPropertyDescriptor(i.constructor.prototype,s),h=""+i[s];if(!i.hasOwnProperty(s)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var v=o.get,T=o.set;return Object.defineProperty(i,s,{configurable:!0,get:function(){return v.call(this)},set:function(A){h=""+A,T.call(this,A)}}),Object.defineProperty(i,s,{enumerable:o.enumerable}),{getValue:function(){return h},setValue:function(A){h=""+A},stopTracking:function(){i._valueTracker=null,delete i[s]}}}}function ni(i){i._valueTracker||(i._valueTracker=ws(i))}function Cs(i){if(!i)return!1;var s=i._valueTracker;if(!s)return!0;var o=s.getValue(),h="";return i&&(h=Rl(i)?i.checked?"true":"false":i.value),i=h,i!==o?(s.setValue(i),!0):!1}function Bi(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var jt=/[\n"\\]/g;function vt(i){return i.replace(jt,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function An(i,s,o,h,v,T,A,I){i.name="",A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"?i.type=A:i.removeAttribute("type"),s!=null?A==="number"?(s===0&&i.value===""||i.value!=s)&&(i.value=""+fn(s)):i.value!==""+fn(s)&&(i.value=""+fn(s)):A!=="submit"&&A!=="reset"||i.removeAttribute("value"),s!=null?Xr(i,A,fn(s)):o!=null?Xr(i,A,fn(o)):h!=null&&i.removeAttribute("value"),v==null&&T!=null&&(i.defaultChecked=!!T),v!=null&&(i.checked=v&&typeof v!="function"&&typeof v!="symbol"),I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"?i.name=""+fn(I):i.removeAttribute("name")}function Vi(i,s,o,h,v,T,A,I){if(T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(i.type=T),s!=null||o!=null){if(!(T!=="submit"&&T!=="reset"||s!=null))return;o=o!=null?""+fn(o):"",s=s!=null?""+fn(s):o,I||s===i.value||(i.value=s),i.defaultValue=s}h=h??v,h=typeof h!="function"&&typeof h!="symbol"&&!!h,i.checked=I?i.checked:!!h,i.defaultChecked=!!h,A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(i.name=A)}function Xr(i,s,o){s==="number"&&Bi(i.ownerDocument)===i||i.defaultValue===""+o||(i.defaultValue=""+o)}function yr(i,s,o,h){if(i=i.options,s){s={};for(var v=0;v<o.length;v++)s["$"+o[v]]=!0;for(o=0;o<i.length;o++)v=s.hasOwnProperty("$"+i[o].value),i[o].selected!==v&&(i[o].selected=v),v&&h&&(i[o].defaultSelected=!0)}else{for(o=""+fn(o),s=null,v=0;v<i.length;v++){if(i[v].value===o){i[v].selected=!0,h&&(i[v].defaultSelected=!0);return}s!==null||i[v].disabled||(s=i[v])}s!==null&&(s.selected=!0)}}function gc(i,s,o){if(s!=null&&(s=""+fn(s),s!==i.value&&(i.value=s),o==null)){i.defaultValue!==s&&(i.defaultValue=s);return}i.defaultValue=o!=null?""+fn(o):""}function om(i,s,o,h){if(s==null){if(h!=null){if(o!=null)throw Error(r(92));if(Ee(h)){if(1<h.length)throw Error(r(93));h=h[0]}o=h}o==null&&(o=""),s=o}o=fn(s),i.defaultValue=o,h=i.textContent,h===o&&h!==""&&h!==null&&(i.value=h)}function As(i,s){if(s){var o=i.firstChild;if(o&&o===i.lastChild&&o.nodeType===3){o.nodeValue=s;return}}i.textContent=s}var A_=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function cm(i,s,o){var h=s.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?h?i.setProperty(s,""):s==="float"?i.cssFloat="":i[s]="":h?i.setProperty(s,o):typeof o!="number"||o===0||A_.has(s)?s==="float"?i.cssFloat=o:i[s]=(""+o).trim():i[s]=o+"px"}function um(i,s,o){if(s!=null&&typeof s!="object")throw Error(r(62));if(i=i.style,o!=null){for(var h in o)!o.hasOwnProperty(h)||s!=null&&s.hasOwnProperty(h)||(h.indexOf("--")===0?i.setProperty(h,""):h==="float"?i.cssFloat="":i[h]="");for(var v in s)h=s[v],s.hasOwnProperty(v)&&o[v]!==h&&cm(i,v,h)}else for(var T in s)s.hasOwnProperty(T)&&cm(i,T,s[T])}function Ef(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var b_=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),k_=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function vc(i){return k_.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}var Sf=null;function wf(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var bs=null,ks=null;function fm(i){var s=z(i);if(s&&(i=s.stateNode)){var o=i[nn]||null;e:switch(i=s.stateNode,s.type){case"input":if(An(i,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),s=o.name,o.type==="radio"&&s!=null){for(o=i;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+vt(""+s)+'"][type="radio"]'),s=0;s<o.length;s++){var h=o[s];if(h!==i&&h.form===i.form){var v=h[nn]||null;if(!v)throw Error(r(90));An(h,v.value,v.defaultValue,v.defaultValue,v.checked,v.defaultChecked,v.type,v.name)}}for(s=0;s<o.length;s++)h=o[s],h.form===i.form&&Cs(h)}break e;case"textarea":gc(i,o.value,o.defaultValue);break e;case"select":s=o.value,s!=null&&yr(i,!!o.multiple,s,!1)}}}var Cf=!1;function dm(i,s,o){if(Cf)return i(s,o);Cf=!0;try{var h=i(s);return h}finally{if(Cf=!1,(bs!==null||ks!==null)&&(ru(),bs&&(s=bs,i=ks,ks=bs=null,fm(s),i)))for(s=0;s<i.length;s++)fm(i[s])}}function Dl(i,s){var o=i.stateNode;if(o===null)return null;var h=o[nn]||null;if(h===null)return null;o=h[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(i=i.type,h=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!h;break e;default:i=!1}if(i)return null;if(o&&typeof o!="function")throw Error(r(231,s,typeof o));return o}var Ra=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Af=!1;if(Ra)try{var Il={};Object.defineProperty(Il,"passive",{get:function(){Af=!0}}),window.addEventListener("test",Il,Il),window.removeEventListener("test",Il,Il)}catch{Af=!1}var ri=null,bf=null,yc=null;function hm(){if(yc)return yc;var i,s=bf,o=s.length,h,v="value"in ri?ri.value:ri.textContent,T=v.length;for(i=0;i<o&&s[i]===v[i];i++);var A=o-i;for(h=1;h<=A&&s[o-h]===v[T-h];h++);return yc=v.slice(i,1<h?1-h:void 0)}function Tc(i){var s=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&s===13&&(i=13)):i=s,i===10&&(i=13),32<=i||i===13?i:0}function _c(){return!0}function mm(){return!1}function hr(i){function s(o,h,v,T,A){this._reactName=o,this._targetInst=v,this.type=h,this.nativeEvent=T,this.target=A,this.currentTarget=null;for(var I in i)i.hasOwnProperty(I)&&(o=i[I],this[I]=o?o(T):T[I]);return this.isDefaultPrevented=(T.defaultPrevented!=null?T.defaultPrevented:T.returnValue===!1)?_c:mm,this.isPropagationStopped=mm,this}return x(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=_c)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=_c)},persist:function(){},isPersistent:_c}),s}var Hi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ec=hr(Hi),Fl=x({},Hi,{view:0,detail:0}),N_=hr(Fl),kf,Nf,Ll,Sc=x({},Fl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Rf,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Ll&&(Ll&&i.type==="mousemove"?(kf=i.screenX-Ll.screenX,Nf=i.screenY-Ll.screenY):Nf=kf=0,Ll=i),kf)},movementY:function(i){return"movementY"in i?i.movementY:Nf}}),pm=hr(Sc),M_=x({},Sc,{dataTransfer:0}),R_=hr(M_),D_=x({},Fl,{relatedTarget:0}),Mf=hr(D_),I_=x({},Hi,{animationName:0,elapsedTime:0,pseudoElement:0}),F_=hr(I_),L_=x({},Hi,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),O_=hr(L_),P_=x({},Hi,{data:0}),xm=hr(P_),U_={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},B_={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},V_={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function H_(i){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(i):(i=V_[i])?!!s[i]:!1}function Rf(){return H_}var G_=x({},Fl,{key:function(i){if(i.key){var s=U_[i.key]||i.key;if(s!=="Unidentified")return s}return i.type==="keypress"?(i=Tc(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?B_[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Rf,charCode:function(i){return i.type==="keypress"?Tc(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Tc(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),j_=hr(G_),z_=x({},Sc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),gm=hr(z_),q_=x({},Fl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Rf}),$_=hr(q_),Y_=x({},Hi,{propertyName:0,elapsedTime:0,pseudoElement:0}),W_=hr(Y_),J_=x({},Sc,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),X_=hr(J_),K_=x({},Hi,{newState:0,oldState:0}),Z_=hr(K_),Q_=[9,13,27,32],Df=Ra&&"CompositionEvent"in window,Ol=null;Ra&&"documentMode"in document&&(Ol=document.documentMode);var eE=Ra&&"TextEvent"in window&&!Ol,vm=Ra&&(!Df||Ol&&8<Ol&&11>=Ol),ym=" ",Tm=!1;function _m(i,s){switch(i){case"keyup":return Q_.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Em(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Ns=!1;function tE(i,s){switch(i){case"compositionend":return Em(s);case"keypress":return s.which!==32?null:(Tm=!0,ym);case"textInput":return i=s.data,i===ym&&Tm?null:i;default:return null}}function nE(i,s){if(Ns)return i==="compositionend"||!Df&&_m(i,s)?(i=hm(),yc=bf=ri=null,Ns=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return vm&&s.locale!=="ko"?null:s.data;default:return null}}var rE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Sm(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s==="input"?!!rE[i.type]:s==="textarea"}function wm(i,s,o,h){bs?ks?ks.push(h):ks=[h]:bs=h,s=cu(s,"onChange"),0<s.length&&(o=new Ec("onChange","change",null,o,h),i.push({event:o,listeners:s}))}var Pl=null,Ul=null;function aE(i){ag(i,0)}function wc(i){var s=ue(i);if(Cs(s))return i}function Cm(i,s){if(i==="change")return s}var Am=!1;if(Ra){var If;if(Ra){var Ff="oninput"in document;if(!Ff){var bm=document.createElement("div");bm.setAttribute("oninput","return;"),Ff=typeof bm.oninput=="function"}If=Ff}else If=!1;Am=If&&(!document.documentMode||9<document.documentMode)}function km(){Pl&&(Pl.detachEvent("onpropertychange",Nm),Ul=Pl=null)}function Nm(i){if(i.propertyName==="value"&&wc(Ul)){var s=[];wm(s,Ul,i,wf(i)),dm(aE,s)}}function iE(i,s,o){i==="focusin"?(km(),Pl=s,Ul=o,Pl.attachEvent("onpropertychange",Nm)):i==="focusout"&&km()}function sE(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return wc(Ul)}function lE(i,s){if(i==="click")return wc(s)}function oE(i,s){if(i==="input"||i==="change")return wc(s)}function cE(i,s){return i===s&&(i!==0||1/i===1/s)||i!==i&&s!==s}var Tr=typeof Object.is=="function"?Object.is:cE;function Bl(i,s){if(Tr(i,s))return!0;if(typeof i!="object"||i===null||typeof s!="object"||s===null)return!1;var o=Object.keys(i),h=Object.keys(s);if(o.length!==h.length)return!1;for(h=0;h<o.length;h++){var v=o[h];if(!X.call(s,v)||!Tr(i[v],s[v]))return!1}return!0}function Mm(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Rm(i,s){var o=Mm(i);i=0;for(var h;o;){if(o.nodeType===3){if(h=i+o.textContent.length,i<=s&&h>=s)return{node:o,offset:s-i};i=h}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=Mm(o)}}function Dm(i,s){return i&&s?i===s?!0:i&&i.nodeType===3?!1:s&&s.nodeType===3?Dm(i,s.parentNode):"contains"in i?i.contains(s):i.compareDocumentPosition?!!(i.compareDocumentPosition(s)&16):!1:!1}function Im(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var s=Bi(i.document);s instanceof i.HTMLIFrameElement;){try{var o=typeof s.contentWindow.location.href=="string"}catch{o=!1}if(o)i=s.contentWindow;else break;s=Bi(i.document)}return s}function Lf(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s&&(s==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||s==="textarea"||i.contentEditable==="true")}var uE=Ra&&"documentMode"in document&&11>=document.documentMode,Ms=null,Of=null,Vl=null,Pf=!1;function Fm(i,s,o){var h=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Pf||Ms==null||Ms!==Bi(h)||(h=Ms,"selectionStart"in h&&Lf(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),Vl&&Bl(Vl,h)||(Vl=h,h=cu(Of,"onSelect"),0<h.length&&(s=new Ec("onSelect","select",null,s,o),i.push({event:s,listeners:h}),s.target=Ms)))}function Gi(i,s){var o={};return o[i.toLowerCase()]=s.toLowerCase(),o["Webkit"+i]="webkit"+s,o["Moz"+i]="moz"+s,o}var Rs={animationend:Gi("Animation","AnimationEnd"),animationiteration:Gi("Animation","AnimationIteration"),animationstart:Gi("Animation","AnimationStart"),transitionrun:Gi("Transition","TransitionRun"),transitionstart:Gi("Transition","TransitionStart"),transitioncancel:Gi("Transition","TransitionCancel"),transitionend:Gi("Transition","TransitionEnd")},Uf={},Lm={};Ra&&(Lm=document.createElement("div").style,"AnimationEvent"in window||(delete Rs.animationend.animation,delete Rs.animationiteration.animation,delete Rs.animationstart.animation),"TransitionEvent"in window||delete Rs.transitionend.transition);function ji(i){if(Uf[i])return Uf[i];if(!Rs[i])return i;var s=Rs[i],o;for(o in s)if(s.hasOwnProperty(o)&&o in Lm)return Uf[i]=s[o];return i}var Om=ji("animationend"),Pm=ji("animationiteration"),Um=ji("animationstart"),fE=ji("transitionrun"),dE=ji("transitionstart"),hE=ji("transitioncancel"),Bm=ji("transitionend"),Vm=new Map,Bf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Bf.push("scrollEnd");function Kr(i,s){Vm.set(i,s),De(s,[i])}var Hm=new WeakMap;function Fr(i,s){if(typeof i=="object"&&i!==null){var o=Hm.get(i);return o!==void 0?o:(s={value:i,source:s,stack:Ir(s)},Hm.set(i,s),s)}return{value:i,source:s,stack:Ir(s)}}var Lr=[],Ds=0,Vf=0;function Cc(){for(var i=Ds,s=Vf=Ds=0;s<i;){var o=Lr[s];Lr[s++]=null;var h=Lr[s];Lr[s++]=null;var v=Lr[s];Lr[s++]=null;var T=Lr[s];if(Lr[s++]=null,h!==null&&v!==null){var A=h.pending;A===null?v.next=v:(v.next=A.next,A.next=v),h.pending=v}T!==0&&Gm(o,v,T)}}function Ac(i,s,o,h){Lr[Ds++]=i,Lr[Ds++]=s,Lr[Ds++]=o,Lr[Ds++]=h,Vf|=h,i.lanes|=h,i=i.alternate,i!==null&&(i.lanes|=h)}function Hf(i,s,o,h){return Ac(i,s,o,h),bc(i)}function Is(i,s){return Ac(i,null,null,s),bc(i)}function Gm(i,s,o){i.lanes|=o;var h=i.alternate;h!==null&&(h.lanes|=o);for(var v=!1,T=i.return;T!==null;)T.childLanes|=o,h=T.alternate,h!==null&&(h.childLanes|=o),T.tag===22&&(i=T.stateNode,i===null||i._visibility&1||(v=!0)),i=T,T=T.return;return i.tag===3?(T=i.stateNode,v&&s!==null&&(v=31-at(o),i=T.hiddenUpdates,h=i[v],h===null?i[v]=[s]:h.push(s),s.lane=o|536870912),T):null}function bc(i){if(50<fo)throw fo=0,Y0=null,Error(r(185));for(var s=i.return;s!==null;)i=s,s=i.return;return i.tag===3?i.stateNode:null}var Fs={};function mE(i,s,o,h){this.tag=i,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function _r(i,s,o,h){return new mE(i,s,o,h)}function Gf(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Da(i,s){var o=i.alternate;return o===null?(o=_r(i.tag,s,i.key,i.mode),o.elementType=i.elementType,o.type=i.type,o.stateNode=i.stateNode,o.alternate=i,i.alternate=o):(o.pendingProps=s,o.type=i.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=i.flags&65011712,o.childLanes=i.childLanes,o.lanes=i.lanes,o.child=i.child,o.memoizedProps=i.memoizedProps,o.memoizedState=i.memoizedState,o.updateQueue=i.updateQueue,s=i.dependencies,o.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},o.sibling=i.sibling,o.index=i.index,o.ref=i.ref,o.refCleanup=i.refCleanup,o}function jm(i,s){i.flags&=65011714;var o=i.alternate;return o===null?(i.childLanes=0,i.lanes=s,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,s=o.dependencies,i.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),i}function kc(i,s,o,h,v,T){var A=0;if(h=i,typeof i=="function")Gf(i)&&(A=1);else if(typeof i=="string")A=xS(i,o,q.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case O:return i=_r(31,o,s,v),i.elementType=O,i.lanes=T,i;case w:return zi(o.children,v,T,s);case S:A=8,v|=24;break;case C:return i=_r(12,o,s,v|2),i.elementType=C,i.lanes=T,i;case G:return i=_r(13,o,s,v),i.elementType=G,i.lanes=T,i;case J:return i=_r(19,o,s,v),i.elementType=J,i.lanes=T,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case M:case b:A=10;break e;case k:A=9;break e;case U:A=11;break e;case F:A=14;break e;case W:A=16,h=null;break e}A=29,o=Error(r(130,i===null?"null":typeof i,"")),h=null}return s=_r(A,o,s,v),s.elementType=i,s.type=h,s.lanes=T,s}function zi(i,s,o,h){return i=_r(7,i,h,s),i.lanes=o,i}function jf(i,s,o){return i=_r(6,i,null,s),i.lanes=o,i}function zf(i,s,o){return s=_r(4,i.children!==null?i.children:[],i.key,s),s.lanes=o,s.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},s}var Ls=[],Os=0,Nc=null,Mc=0,Or=[],Pr=0,qi=null,Ia=1,Fa="";function $i(i,s){Ls[Os++]=Mc,Ls[Os++]=Nc,Nc=i,Mc=s}function zm(i,s,o){Or[Pr++]=Ia,Or[Pr++]=Fa,Or[Pr++]=qi,qi=i;var h=Ia;i=Fa;var v=32-at(h)-1;h&=~(1<<v),o+=1;var T=32-at(s)+v;if(30<T){var A=v-v%5;T=(h&(1<<A)-1).toString(32),h>>=A,v-=A,Ia=1<<32-at(s)+v|o<<v|h,Fa=T+i}else Ia=1<<T|o<<v|h,Fa=i}function qf(i){i.return!==null&&($i(i,1),zm(i,1,0))}function $f(i){for(;i===Nc;)Nc=Ls[--Os],Ls[Os]=null,Mc=Ls[--Os],Ls[Os]=null;for(;i===qi;)qi=Or[--Pr],Or[Pr]=null,Fa=Or[--Pr],Or[Pr]=null,Ia=Or[--Pr],Or[Pr]=null}var ar=null,dn=null,Bt=!1,Yi=null,ua=!1,Yf=Error(r(519));function Wi(i){var s=Error(r(418,""));throw jl(Fr(s,i)),Yf}function qm(i){var s=i.stateNode,o=i.type,h=i.memoizedProps;switch(s[tn]=i,s[nn]=h,o){case"dialog":Tt("cancel",s),Tt("close",s);break;case"iframe":case"object":case"embed":Tt("load",s);break;case"video":case"audio":for(o=0;o<mo.length;o++)Tt(mo[o],s);break;case"source":Tt("error",s);break;case"img":case"image":case"link":Tt("error",s),Tt("load",s);break;case"details":Tt("toggle",s);break;case"input":Tt("invalid",s),Vi(s,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0),ni(s);break;case"select":Tt("invalid",s);break;case"textarea":Tt("invalid",s),om(s,h.value,h.defaultValue,h.children),ni(s)}o=h.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||s.textContent===""+o||h.suppressHydrationWarning===!0||og(s.textContent,o)?(h.popover!=null&&(Tt("beforetoggle",s),Tt("toggle",s)),h.onScroll!=null&&Tt("scroll",s),h.onScrollEnd!=null&&Tt("scrollend",s),h.onClick!=null&&(s.onclick=uu),s=!0):s=!1,s||Wi(i)}function $m(i){for(ar=i.return;ar;)switch(ar.tag){case 5:case 13:ua=!1;return;case 27:case 3:ua=!0;return;default:ar=ar.return}}function Hl(i){if(i!==ar)return!1;if(!Bt)return $m(i),Bt=!0,!1;var s=i.tag,o;if((o=s!==3&&s!==27)&&((o=s===5)&&(o=i.type,o=!(o!=="form"&&o!=="button")||cd(i.type,i.memoizedProps)),o=!o),o&&dn&&Wi(i),$m(i),s===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(r(317));e:{for(i=i.nextSibling,s=0;i;){if(i.nodeType===8)if(o=i.data,o==="/$"){if(s===0){dn=Qr(i.nextSibling);break e}s--}else o!=="$"&&o!=="$!"&&o!=="$?"||s++;i=i.nextSibling}dn=null}}else s===27?(s=dn,yi(i.type)?(i=hd,hd=null,dn=i):dn=s):dn=ar?Qr(i.stateNode.nextSibling):null;return!0}function Gl(){dn=ar=null,Bt=!1}function Ym(){var i=Yi;return i!==null&&(xr===null?xr=i:xr.push.apply(xr,i),Yi=null),i}function jl(i){Yi===null?Yi=[i]:Yi.push(i)}var Wf=Z(null),Ji=null,La=null;function ai(i,s,o){H(Wf,s._currentValue),s._currentValue=o}function Oa(i){i._currentValue=Wf.current,D(Wf)}function Jf(i,s,o){for(;i!==null;){var h=i.alternate;if((i.childLanes&s)!==s?(i.childLanes|=s,h!==null&&(h.childLanes|=s)):h!==null&&(h.childLanes&s)!==s&&(h.childLanes|=s),i===o)break;i=i.return}}function Xf(i,s,o,h){var v=i.child;for(v!==null&&(v.return=i);v!==null;){var T=v.dependencies;if(T!==null){var A=v.child;T=T.firstContext;e:for(;T!==null;){var I=T;T=v;for(var Q=0;Q<s.length;Q++)if(I.context===s[Q]){T.lanes|=o,I=T.alternate,I!==null&&(I.lanes|=o),Jf(T.return,o,i),h||(A=null);break e}T=I.next}}else if(v.tag===18){if(A=v.return,A===null)throw Error(r(341));A.lanes|=o,T=A.alternate,T!==null&&(T.lanes|=o),Jf(A,o,i),A=null}else A=v.child;if(A!==null)A.return=v;else for(A=v;A!==null;){if(A===i){A=null;break}if(v=A.sibling,v!==null){v.return=A.return,A=v;break}A=A.return}v=A}}function zl(i,s,o,h){i=null;for(var v=s,T=!1;v!==null;){if(!T){if((v.flags&524288)!==0)T=!0;else if((v.flags&262144)!==0)break}if(v.tag===10){var A=v.alternate;if(A===null)throw Error(r(387));if(A=A.memoizedProps,A!==null){var I=v.type;Tr(v.pendingProps.value,A.value)||(i!==null?i.push(I):i=[I])}}else if(v===Te.current){if(A=v.alternate,A===null)throw Error(r(387));A.memoizedState.memoizedState!==v.memoizedState.memoizedState&&(i!==null?i.push(To):i=[To])}v=v.return}i!==null&&Xf(s,i,o,h),s.flags|=262144}function Rc(i){for(i=i.firstContext;i!==null;){if(!Tr(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function Xi(i){Ji=i,La=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function Wn(i){return Wm(Ji,i)}function Dc(i,s){return Ji===null&&Xi(i),Wm(i,s)}function Wm(i,s){var o=s._currentValue;if(s={context:s,memoizedValue:o,next:null},La===null){if(i===null)throw Error(r(308));La=s,i.dependencies={lanes:0,firstContext:s},i.flags|=524288}else La=La.next=s;return o}var pE=typeof AbortController<"u"?AbortController:function(){var i=[],s=this.signal={aborted:!1,addEventListener:function(o,h){i.push(h)}};this.abort=function(){s.aborted=!0,i.forEach(function(o){return o()})}},xE=e.unstable_scheduleCallback,gE=e.unstable_NormalPriority,bn={$$typeof:b,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Kf(){return{controller:new pE,data:new Map,refCount:0}}function ql(i){i.refCount--,i.refCount===0&&xE(gE,function(){i.controller.abort()})}var $l=null,Zf=0,Ps=0,Us=null;function vE(i,s){if($l===null){var o=$l=[];Zf=0,Ps=ed(),Us={status:"pending",value:void 0,then:function(h){o.push(h)}}}return Zf++,s.then(Jm,Jm),s}function Jm(){if(--Zf===0&&$l!==null){Us!==null&&(Us.status="fulfilled");var i=$l;$l=null,Ps=0,Us=null;for(var s=0;s<i.length;s++)(0,i[s])()}}function yE(i,s){var o=[],h={status:"pending",value:null,reason:null,then:function(v){o.push(v)}};return i.then(function(){h.status="fulfilled",h.value=s;for(var v=0;v<o.length;v++)(0,o[v])(s)},function(v){for(h.status="rejected",h.reason=v,v=0;v<o.length;v++)(0,o[v])(void 0)}),h}var Xm=ae.S;ae.S=function(i,s){typeof s=="object"&&s!==null&&typeof s.then=="function"&&vE(i,s),Xm!==null&&Xm(i,s)};var Ki=Z(null);function Qf(){var i=Ki.current;return i!==null?i:Kt.pooledCache}function Ic(i,s){s===null?H(Ki,Ki.current):H(Ki,s.pool)}function Km(){var i=Qf();return i===null?null:{parent:bn._currentValue,pool:i}}var Yl=Error(r(460)),Zm=Error(r(474)),Fc=Error(r(542)),e0={then:function(){}};function Qm(i){return i=i.status,i==="fulfilled"||i==="rejected"}function Lc(){}function ep(i,s,o){switch(o=i[o],o===void 0?i.push(s):o!==s&&(s.then(Lc,Lc),s=o),s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,np(i),i;default:if(typeof s.status=="string")s.then(Lc,Lc);else{if(i=Kt,i!==null&&100<i.shellSuspendCounter)throw Error(r(482));i=s,i.status="pending",i.then(function(h){if(s.status==="pending"){var v=s;v.status="fulfilled",v.value=h}},function(h){if(s.status==="pending"){var v=s;v.status="rejected",v.reason=h}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,np(i),i}throw Wl=s,Yl}}var Wl=null;function tp(){if(Wl===null)throw Error(r(459));var i=Wl;return Wl=null,i}function np(i){if(i===Yl||i===Fc)throw Error(r(483))}var ii=!1;function t0(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function n0(i,s){i=i.updateQueue,s.updateQueue===i&&(s.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function si(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function li(i,s,o){var h=i.updateQueue;if(h===null)return null;if(h=h.shared,(Vt&2)!==0){var v=h.pending;return v===null?s.next=s:(s.next=v.next,v.next=s),h.pending=s,s=bc(i),Gm(i,null,o),s}return Ac(i,h,s,o),bc(i)}function Jl(i,s,o){if(s=s.updateQueue,s!==null&&(s=s.shared,(o&4194048)!==0)){var h=s.lanes;h&=i.pendingLanes,o|=h,s.lanes=o,cn(i,o)}}function r0(i,s){var o=i.updateQueue,h=i.alternate;if(h!==null&&(h=h.updateQueue,o===h)){var v=null,T=null;if(o=o.firstBaseUpdate,o!==null){do{var A={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};T===null?v=T=A:T=T.next=A,o=o.next}while(o!==null);T===null?v=T=s:T=T.next=s}else v=T=s;o={baseState:h.baseState,firstBaseUpdate:v,lastBaseUpdate:T,shared:h.shared,callbacks:h.callbacks},i.updateQueue=o;return}i=o.lastBaseUpdate,i===null?o.firstBaseUpdate=s:i.next=s,o.lastBaseUpdate=s}var a0=!1;function Xl(){if(a0){var i=Us;if(i!==null)throw i}}function Kl(i,s,o,h){a0=!1;var v=i.updateQueue;ii=!1;var T=v.firstBaseUpdate,A=v.lastBaseUpdate,I=v.shared.pending;if(I!==null){v.shared.pending=null;var Q=I,fe=Q.next;Q.next=null,A===null?T=fe:A.next=fe,A=Q;var we=i.alternate;we!==null&&(we=we.updateQueue,I=we.lastBaseUpdate,I!==A&&(I===null?we.firstBaseUpdate=fe:I.next=fe,we.lastBaseUpdate=Q))}if(T!==null){var Ne=v.baseState;A=0,we=fe=Q=null,I=T;do{var pe=I.lane&-536870913,ge=pe!==I.lane;if(ge?(At&pe)===pe:(h&pe)===pe){pe!==0&&pe===Ps&&(a0=!0),we!==null&&(we=we.next={lane:0,tag:I.tag,payload:I.payload,callback:null,next:null});e:{var et=i,Ze=I;pe=s;var $t=o;switch(Ze.tag){case 1:if(et=Ze.payload,typeof et=="function"){Ne=et.call($t,Ne,pe);break e}Ne=et;break e;case 3:et.flags=et.flags&-65537|128;case 0:if(et=Ze.payload,pe=typeof et=="function"?et.call($t,Ne,pe):et,pe==null)break e;Ne=x({},Ne,pe);break e;case 2:ii=!0}}pe=I.callback,pe!==null&&(i.flags|=64,ge&&(i.flags|=8192),ge=v.callbacks,ge===null?v.callbacks=[pe]:ge.push(pe))}else ge={lane:pe,tag:I.tag,payload:I.payload,callback:I.callback,next:null},we===null?(fe=we=ge,Q=Ne):we=we.next=ge,A|=pe;if(I=I.next,I===null){if(I=v.shared.pending,I===null)break;ge=I,I=ge.next,ge.next=null,v.lastBaseUpdate=ge,v.shared.pending=null}}while(!0);we===null&&(Q=Ne),v.baseState=Q,v.firstBaseUpdate=fe,v.lastBaseUpdate=we,T===null&&(v.shared.lanes=0),pi|=A,i.lanes=A,i.memoizedState=Ne}}function rp(i,s){if(typeof i!="function")throw Error(r(191,i));i.call(s)}function ap(i,s){var o=i.callbacks;if(o!==null)for(i.callbacks=null,i=0;i<o.length;i++)rp(o[i],s)}var Bs=Z(null),Oc=Z(0);function ip(i,s){i=ja,H(Oc,i),H(Bs,s),ja=i|s.baseLanes}function i0(){H(Oc,ja),H(Bs,Bs.current)}function s0(){ja=Oc.current,D(Bs),D(Oc)}var oi=0,mt=null,zt=null,yn=null,Pc=!1,Vs=!1,Zi=!1,Uc=0,Zl=0,Hs=null,TE=0;function xn(){throw Error(r(321))}function l0(i,s){if(s===null)return!1;for(var o=0;o<s.length&&o<i.length;o++)if(!Tr(i[o],s[o]))return!1;return!0}function o0(i,s,o,h,v,T){return oi=T,mt=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,ae.H=i===null||i.memoizedState===null?Gp:jp,Zi=!1,T=o(h,v),Zi=!1,Vs&&(T=lp(s,o,h,v)),sp(i),T}function sp(i){ae.H=zc;var s=zt!==null&&zt.next!==null;if(oi=0,yn=zt=mt=null,Pc=!1,Zl=0,Hs=null,s)throw Error(r(300));i===null||Fn||(i=i.dependencies,i!==null&&Rc(i)&&(Fn=!0))}function lp(i,s,o,h){mt=i;var v=0;do{if(Vs&&(Hs=null),Zl=0,Vs=!1,25<=v)throw Error(r(301));if(v+=1,yn=zt=null,i.updateQueue!=null){var T=i.updateQueue;T.lastEffect=null,T.events=null,T.stores=null,T.memoCache!=null&&(T.memoCache.index=0)}ae.H=bE,T=s(o,h)}while(Vs);return T}function _E(){var i=ae.H,s=i.useState()[0];return s=typeof s.then=="function"?Ql(s):s,i=i.useState()[0],(zt!==null?zt.memoizedState:null)!==i&&(mt.flags|=1024),s}function c0(){var i=Uc!==0;return Uc=0,i}function u0(i,s,o){s.updateQueue=i.updateQueue,s.flags&=-2053,i.lanes&=~o}function f0(i){if(Pc){for(i=i.memoizedState;i!==null;){var s=i.queue;s!==null&&(s.pending=null),i=i.next}Pc=!1}oi=0,yn=zt=mt=null,Vs=!1,Zl=Uc=0,Hs=null}function mr(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return yn===null?mt.memoizedState=yn=i:yn=yn.next=i,yn}function Tn(){if(zt===null){var i=mt.alternate;i=i!==null?i.memoizedState:null}else i=zt.next;var s=yn===null?mt.memoizedState:yn.next;if(s!==null)yn=s,zt=i;else{if(i===null)throw mt.alternate===null?Error(r(467)):Error(r(310));zt=i,i={memoizedState:zt.memoizedState,baseState:zt.baseState,baseQueue:zt.baseQueue,queue:zt.queue,next:null},yn===null?mt.memoizedState=yn=i:yn=yn.next=i}return yn}function d0(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ql(i){var s=Zl;return Zl+=1,Hs===null&&(Hs=[]),i=ep(Hs,i,s),s=mt,(yn===null?s.memoizedState:yn.next)===null&&(s=s.alternate,ae.H=s===null||s.memoizedState===null?Gp:jp),i}function Bc(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return Ql(i);if(i.$$typeof===b)return Wn(i)}throw Error(r(438,String(i)))}function h0(i){var s=null,o=mt.updateQueue;if(o!==null&&(s=o.memoCache),s==null){var h=mt.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(s={data:h.data.map(function(v){return v.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),o===null&&(o=d0(),mt.updateQueue=o),o.memoCache=s,o=s.data[s.index],o===void 0)for(o=s.data[s.index]=Array(i),h=0;h<i;h++)o[h]=ee;return s.index++,o}function Pa(i,s){return typeof s=="function"?s(i):s}function Vc(i){var s=Tn();return m0(s,zt,i)}function m0(i,s,o){var h=i.queue;if(h===null)throw Error(r(311));h.lastRenderedReducer=o;var v=i.baseQueue,T=h.pending;if(T!==null){if(v!==null){var A=v.next;v.next=T.next,T.next=A}s.baseQueue=v=T,h.pending=null}if(T=i.baseState,v===null)i.memoizedState=T;else{s=v.next;var I=A=null,Q=null,fe=s,we=!1;do{var Ne=fe.lane&-536870913;if(Ne!==fe.lane?(At&Ne)===Ne:(oi&Ne)===Ne){var pe=fe.revertLane;if(pe===0)Q!==null&&(Q=Q.next={lane:0,revertLane:0,action:fe.action,hasEagerState:fe.hasEagerState,eagerState:fe.eagerState,next:null}),Ne===Ps&&(we=!0);else if((oi&pe)===pe){fe=fe.next,pe===Ps&&(we=!0);continue}else Ne={lane:0,revertLane:fe.revertLane,action:fe.action,hasEagerState:fe.hasEagerState,eagerState:fe.eagerState,next:null},Q===null?(I=Q=Ne,A=T):Q=Q.next=Ne,mt.lanes|=pe,pi|=pe;Ne=fe.action,Zi&&o(T,Ne),T=fe.hasEagerState?fe.eagerState:o(T,Ne)}else pe={lane:Ne,revertLane:fe.revertLane,action:fe.action,hasEagerState:fe.hasEagerState,eagerState:fe.eagerState,next:null},Q===null?(I=Q=pe,A=T):Q=Q.next=pe,mt.lanes|=Ne,pi|=Ne;fe=fe.next}while(fe!==null&&fe!==s);if(Q===null?A=T:Q.next=I,!Tr(T,i.memoizedState)&&(Fn=!0,we&&(o=Us,o!==null)))throw o;i.memoizedState=T,i.baseState=A,i.baseQueue=Q,h.lastRenderedState=T}return v===null&&(h.lanes=0),[i.memoizedState,h.dispatch]}function p0(i){var s=Tn(),o=s.queue;if(o===null)throw Error(r(311));o.lastRenderedReducer=i;var h=o.dispatch,v=o.pending,T=s.memoizedState;if(v!==null){o.pending=null;var A=v=v.next;do T=i(T,A.action),A=A.next;while(A!==v);Tr(T,s.memoizedState)||(Fn=!0),s.memoizedState=T,s.baseQueue===null&&(s.baseState=T),o.lastRenderedState=T}return[T,h]}function op(i,s,o){var h=mt,v=Tn(),T=Bt;if(T){if(o===void 0)throw Error(r(407));o=o()}else o=s();var A=!Tr((zt||v).memoizedState,o);A&&(v.memoizedState=o,Fn=!0),v=v.queue;var I=fp.bind(null,h,v,i);if(eo(2048,8,I,[i]),v.getSnapshot!==s||A||yn!==null&&yn.memoizedState.tag&1){if(h.flags|=2048,Gs(9,Hc(),up.bind(null,h,v,o,s),null),Kt===null)throw Error(r(349));T||(oi&124)!==0||cp(h,s,o)}return o}function cp(i,s,o){i.flags|=16384,i={getSnapshot:s,value:o},s=mt.updateQueue,s===null?(s=d0(),mt.updateQueue=s,s.stores=[i]):(o=s.stores,o===null?s.stores=[i]:o.push(i))}function up(i,s,o,h){s.value=o,s.getSnapshot=h,dp(s)&&hp(i)}function fp(i,s,o){return o(function(){dp(s)&&hp(i)})}function dp(i){var s=i.getSnapshot;i=i.value;try{var o=s();return!Tr(i,o)}catch{return!0}}function hp(i){var s=Is(i,2);s!==null&&Ar(s,i,2)}function x0(i){var s=mr();if(typeof i=="function"){var o=i;if(i=o(),Zi){Ut(!0);try{o()}finally{Ut(!1)}}}return s.memoizedState=s.baseState=i,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Pa,lastRenderedState:i},s}function mp(i,s,o,h){return i.baseState=o,m0(i,zt,typeof h=="function"?h:Pa)}function EE(i,s,o,h,v){if(jc(i))throw Error(r(485));if(i=s.action,i!==null){var T={payload:v,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(A){T.listeners.push(A)}};ae.T!==null?o(!0):T.isTransition=!1,h(T),o=s.pending,o===null?(T.next=s.pending=T,pp(s,T)):(T.next=o.next,s.pending=o.next=T)}}function pp(i,s){var o=s.action,h=s.payload,v=i.state;if(s.isTransition){var T=ae.T,A={};ae.T=A;try{var I=o(v,h),Q=ae.S;Q!==null&&Q(A,I),xp(i,s,I)}catch(fe){g0(i,s,fe)}finally{ae.T=T}}else try{T=o(v,h),xp(i,s,T)}catch(fe){g0(i,s,fe)}}function xp(i,s,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(h){gp(i,s,h)},function(h){return g0(i,s,h)}):gp(i,s,o)}function gp(i,s,o){s.status="fulfilled",s.value=o,vp(s),i.state=o,s=i.pending,s!==null&&(o=s.next,o===s?i.pending=null:(o=o.next,s.next=o,pp(i,o)))}function g0(i,s,o){var h=i.pending;if(i.pending=null,h!==null){h=h.next;do s.status="rejected",s.reason=o,vp(s),s=s.next;while(s!==h)}i.action=null}function vp(i){i=i.listeners;for(var s=0;s<i.length;s++)(0,i[s])()}function yp(i,s){return s}function Tp(i,s){if(Bt){var o=Kt.formState;if(o!==null){e:{var h=mt;if(Bt){if(dn){t:{for(var v=dn,T=ua;v.nodeType!==8;){if(!T){v=null;break t}if(v=Qr(v.nextSibling),v===null){v=null;break t}}T=v.data,v=T==="F!"||T==="F"?v:null}if(v){dn=Qr(v.nextSibling),h=v.data==="F!";break e}}Wi(h)}h=!1}h&&(s=o[0])}}return o=mr(),o.memoizedState=o.baseState=s,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:yp,lastRenderedState:s},o.queue=h,o=Bp.bind(null,mt,h),h.dispatch=o,h=x0(!1),T=E0.bind(null,mt,!1,h.queue),h=mr(),v={state:s,dispatch:null,action:i,pending:null},h.queue=v,o=EE.bind(null,mt,v,T,o),v.dispatch=o,h.memoizedState=i,[s,o,!1]}function _p(i){var s=Tn();return Ep(s,zt,i)}function Ep(i,s,o){if(s=m0(i,s,yp)[0],i=Vc(Pa)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var h=Ql(s)}catch(A){throw A===Yl?Fc:A}else h=s;s=Tn();var v=s.queue,T=v.dispatch;return o!==s.memoizedState&&(mt.flags|=2048,Gs(9,Hc(),SE.bind(null,v,o),null)),[h,T,i]}function SE(i,s){i.action=s}function Sp(i){var s=Tn(),o=zt;if(o!==null)return Ep(s,o,i);Tn(),s=s.memoizedState,o=Tn();var h=o.queue.dispatch;return o.memoizedState=i,[s,h,!1]}function Gs(i,s,o,h){return i={tag:i,create:o,deps:h,inst:s,next:null},s=mt.updateQueue,s===null&&(s=d0(),mt.updateQueue=s),o=s.lastEffect,o===null?s.lastEffect=i.next=i:(h=o.next,o.next=i,i.next=h,s.lastEffect=i),i}function Hc(){return{destroy:void 0,resource:void 0}}function wp(){return Tn().memoizedState}function Gc(i,s,o,h){var v=mr();h=h===void 0?null:h,mt.flags|=i,v.memoizedState=Gs(1|s,Hc(),o,h)}function eo(i,s,o,h){var v=Tn();h=h===void 0?null:h;var T=v.memoizedState.inst;zt!==null&&h!==null&&l0(h,zt.memoizedState.deps)?v.memoizedState=Gs(s,T,o,h):(mt.flags|=i,v.memoizedState=Gs(1|s,T,o,h))}function Cp(i,s){Gc(8390656,8,i,s)}function Ap(i,s){eo(2048,8,i,s)}function bp(i,s){return eo(4,2,i,s)}function kp(i,s){return eo(4,4,i,s)}function Np(i,s){if(typeof s=="function"){i=i();var o=s(i);return function(){typeof o=="function"?o():s(null)}}if(s!=null)return i=i(),s.current=i,function(){s.current=null}}function Mp(i,s,o){o=o!=null?o.concat([i]):null,eo(4,4,Np.bind(null,s,i),o)}function v0(){}function Rp(i,s){var o=Tn();s=s===void 0?null:s;var h=o.memoizedState;return s!==null&&l0(s,h[1])?h[0]:(o.memoizedState=[i,s],i)}function Dp(i,s){var o=Tn();s=s===void 0?null:s;var h=o.memoizedState;if(s!==null&&l0(s,h[1]))return h[0];if(h=i(),Zi){Ut(!0);try{i()}finally{Ut(!1)}}return o.memoizedState=[h,s],h}function y0(i,s,o){return o===void 0||(oi&1073741824)!==0?i.memoizedState=s:(i.memoizedState=o,i=Lx(),mt.lanes|=i,pi|=i,o)}function Ip(i,s,o,h){return Tr(o,s)?o:Bs.current!==null?(i=y0(i,o,h),Tr(i,s)||(Fn=!0),i):(oi&42)===0?(Fn=!0,i.memoizedState=o):(i=Lx(),mt.lanes|=i,pi|=i,s)}function Fp(i,s,o,h,v){var T=de.p;de.p=T!==0&&8>T?T:8;var A=ae.T,I={};ae.T=I,E0(i,!1,s,o);try{var Q=v(),fe=ae.S;if(fe!==null&&fe(I,Q),Q!==null&&typeof Q=="object"&&typeof Q.then=="function"){var we=yE(Q,h);to(i,s,we,Cr(i))}else to(i,s,h,Cr(i))}catch(Ne){to(i,s,{then:function(){},status:"rejected",reason:Ne},Cr())}finally{de.p=T,ae.T=A}}function wE(){}function T0(i,s,o,h){if(i.tag!==5)throw Error(r(476));var v=Lp(i).queue;Fp(i,v,s,re,o===null?wE:function(){return Op(i),o(h)})}function Lp(i){var s=i.memoizedState;if(s!==null)return s;s={memoizedState:re,baseState:re,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Pa,lastRenderedState:re},next:null};var o={};return s.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Pa,lastRenderedState:o},next:null},i.memoizedState=s,i=i.alternate,i!==null&&(i.memoizedState=s),s}function Op(i){var s=Lp(i).next.queue;to(i,s,{},Cr())}function _0(){return Wn(To)}function Pp(){return Tn().memoizedState}function Up(){return Tn().memoizedState}function CE(i){for(var s=i.return;s!==null;){switch(s.tag){case 24:case 3:var o=Cr();i=si(o);var h=li(s,i,o);h!==null&&(Ar(h,s,o),Jl(h,s,o)),s={cache:Kf()},i.payload=s;return}s=s.return}}function AE(i,s,o){var h=Cr();o={lane:h,revertLane:0,action:o,hasEagerState:!1,eagerState:null,next:null},jc(i)?Vp(s,o):(o=Hf(i,s,o,h),o!==null&&(Ar(o,i,h),Hp(o,s,h)))}function Bp(i,s,o){var h=Cr();to(i,s,o,h)}function to(i,s,o,h){var v={lane:h,revertLane:0,action:o,hasEagerState:!1,eagerState:null,next:null};if(jc(i))Vp(s,v);else{var T=i.alternate;if(i.lanes===0&&(T===null||T.lanes===0)&&(T=s.lastRenderedReducer,T!==null))try{var A=s.lastRenderedState,I=T(A,o);if(v.hasEagerState=!0,v.eagerState=I,Tr(I,A))return Ac(i,s,v,0),Kt===null&&Cc(),!1}catch{}finally{}if(o=Hf(i,s,v,h),o!==null)return Ar(o,i,h),Hp(o,s,h),!0}return!1}function E0(i,s,o,h){if(h={lane:2,revertLane:ed(),action:h,hasEagerState:!1,eagerState:null,next:null},jc(i)){if(s)throw Error(r(479))}else s=Hf(i,o,h,2),s!==null&&Ar(s,i,2)}function jc(i){var s=i.alternate;return i===mt||s!==null&&s===mt}function Vp(i,s){Vs=Pc=!0;var o=i.pending;o===null?s.next=s:(s.next=o.next,o.next=s),i.pending=s}function Hp(i,s,o){if((o&4194048)!==0){var h=s.lanes;h&=i.pendingLanes,o|=h,s.lanes=o,cn(i,o)}}var zc={readContext:Wn,use:Bc,useCallback:xn,useContext:xn,useEffect:xn,useImperativeHandle:xn,useLayoutEffect:xn,useInsertionEffect:xn,useMemo:xn,useReducer:xn,useRef:xn,useState:xn,useDebugValue:xn,useDeferredValue:xn,useTransition:xn,useSyncExternalStore:xn,useId:xn,useHostTransitionStatus:xn,useFormState:xn,useActionState:xn,useOptimistic:xn,useMemoCache:xn,useCacheRefresh:xn},Gp={readContext:Wn,use:Bc,useCallback:function(i,s){return mr().memoizedState=[i,s===void 0?null:s],i},useContext:Wn,useEffect:Cp,useImperativeHandle:function(i,s,o){o=o!=null?o.concat([i]):null,Gc(4194308,4,Np.bind(null,s,i),o)},useLayoutEffect:function(i,s){return Gc(4194308,4,i,s)},useInsertionEffect:function(i,s){Gc(4,2,i,s)},useMemo:function(i,s){var o=mr();s=s===void 0?null:s;var h=i();if(Zi){Ut(!0);try{i()}finally{Ut(!1)}}return o.memoizedState=[h,s],h},useReducer:function(i,s,o){var h=mr();if(o!==void 0){var v=o(s);if(Zi){Ut(!0);try{o(s)}finally{Ut(!1)}}}else v=s;return h.memoizedState=h.baseState=v,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:v},h.queue=i,i=i.dispatch=AE.bind(null,mt,i),[h.memoizedState,i]},useRef:function(i){var s=mr();return i={current:i},s.memoizedState=i},useState:function(i){i=x0(i);var s=i.queue,o=Bp.bind(null,mt,s);return s.dispatch=o,[i.memoizedState,o]},useDebugValue:v0,useDeferredValue:function(i,s){var o=mr();return y0(o,i,s)},useTransition:function(){var i=x0(!1);return i=Fp.bind(null,mt,i.queue,!0,!1),mr().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,s,o){var h=mt,v=mr();if(Bt){if(o===void 0)throw Error(r(407));o=o()}else{if(o=s(),Kt===null)throw Error(r(349));(At&124)!==0||cp(h,s,o)}v.memoizedState=o;var T={value:o,getSnapshot:s};return v.queue=T,Cp(fp.bind(null,h,T,i),[i]),h.flags|=2048,Gs(9,Hc(),up.bind(null,h,T,o,s),null),o},useId:function(){var i=mr(),s=Kt.identifierPrefix;if(Bt){var o=Fa,h=Ia;o=(h&~(1<<32-at(h)-1)).toString(32)+o,s=""+s+"R"+o,o=Uc++,0<o&&(s+="H"+o.toString(32)),s+=""}else o=TE++,s=""+s+"r"+o.toString(32)+"";return i.memoizedState=s},useHostTransitionStatus:_0,useFormState:Tp,useActionState:Tp,useOptimistic:function(i){var s=mr();s.memoizedState=s.baseState=i;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=o,s=E0.bind(null,mt,!0,o),o.dispatch=s,[i,s]},useMemoCache:h0,useCacheRefresh:function(){return mr().memoizedState=CE.bind(null,mt)}},jp={readContext:Wn,use:Bc,useCallback:Rp,useContext:Wn,useEffect:Ap,useImperativeHandle:Mp,useInsertionEffect:bp,useLayoutEffect:kp,useMemo:Dp,useReducer:Vc,useRef:wp,useState:function(){return Vc(Pa)},useDebugValue:v0,useDeferredValue:function(i,s){var o=Tn();return Ip(o,zt.memoizedState,i,s)},useTransition:function(){var i=Vc(Pa)[0],s=Tn().memoizedState;return[typeof i=="boolean"?i:Ql(i),s]},useSyncExternalStore:op,useId:Pp,useHostTransitionStatus:_0,useFormState:_p,useActionState:_p,useOptimistic:function(i,s){var o=Tn();return mp(o,zt,i,s)},useMemoCache:h0,useCacheRefresh:Up},bE={readContext:Wn,use:Bc,useCallback:Rp,useContext:Wn,useEffect:Ap,useImperativeHandle:Mp,useInsertionEffect:bp,useLayoutEffect:kp,useMemo:Dp,useReducer:p0,useRef:wp,useState:function(){return p0(Pa)},useDebugValue:v0,useDeferredValue:function(i,s){var o=Tn();return zt===null?y0(o,i,s):Ip(o,zt.memoizedState,i,s)},useTransition:function(){var i=p0(Pa)[0],s=Tn().memoizedState;return[typeof i=="boolean"?i:Ql(i),s]},useSyncExternalStore:op,useId:Pp,useHostTransitionStatus:_0,useFormState:Sp,useActionState:Sp,useOptimistic:function(i,s){var o=Tn();return zt!==null?mp(o,zt,i,s):(o.baseState=i,[i,o.queue.dispatch])},useMemoCache:h0,useCacheRefresh:Up},js=null,no=0;function qc(i){var s=no;return no+=1,js===null&&(js=[]),ep(js,i,s)}function ro(i,s){s=s.props.ref,i.ref=s!==void 0?s:null}function $c(i,s){throw s.$$typeof===y?Error(r(525)):(i=Object.prototype.toString.call(s),Error(r(31,i==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":i)))}function zp(i){var s=i._init;return s(i._payload)}function qp(i){function s(le,ie){if(i){var ce=le.deletions;ce===null?(le.deletions=[ie],le.flags|=16):ce.push(ie)}}function o(le,ie){if(!i)return null;for(;ie!==null;)s(le,ie),ie=ie.sibling;return null}function h(le){for(var ie=new Map;le!==null;)le.key!==null?ie.set(le.key,le):ie.set(le.index,le),le=le.sibling;return ie}function v(le,ie){return le=Da(le,ie),le.index=0,le.sibling=null,le}function T(le,ie,ce){return le.index=ce,i?(ce=le.alternate,ce!==null?(ce=ce.index,ce<ie?(le.flags|=67108866,ie):ce):(le.flags|=67108866,ie)):(le.flags|=1048576,ie)}function A(le){return i&&le.alternate===null&&(le.flags|=67108866),le}function I(le,ie,ce,be){return ie===null||ie.tag!==6?(ie=jf(ce,le.mode,be),ie.return=le,ie):(ie=v(ie,ce),ie.return=le,ie)}function Q(le,ie,ce,be){var qe=ce.type;return qe===w?we(le,ie,ce.props.children,be,ce.key):ie!==null&&(ie.elementType===qe||typeof qe=="object"&&qe!==null&&qe.$$typeof===W&&zp(qe)===ie.type)?(ie=v(ie,ce.props),ro(ie,ce),ie.return=le,ie):(ie=kc(ce.type,ce.key,ce.props,null,le.mode,be),ro(ie,ce),ie.return=le,ie)}function fe(le,ie,ce,be){return ie===null||ie.tag!==4||ie.stateNode.containerInfo!==ce.containerInfo||ie.stateNode.implementation!==ce.implementation?(ie=zf(ce,le.mode,be),ie.return=le,ie):(ie=v(ie,ce.children||[]),ie.return=le,ie)}function we(le,ie,ce,be,qe){return ie===null||ie.tag!==7?(ie=zi(ce,le.mode,be,qe),ie.return=le,ie):(ie=v(ie,ce),ie.return=le,ie)}function Ne(le,ie,ce){if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return ie=jf(""+ie,le.mode,ce),ie.return=le,ie;if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case _:return ce=kc(ie.type,ie.key,ie.props,null,le.mode,ce),ro(ce,ie),ce.return=le,ce;case E:return ie=zf(ie,le.mode,ce),ie.return=le,ie;case W:var be=ie._init;return ie=be(ie._payload),Ne(le,ie,ce)}if(Ee(ie)||te(ie))return ie=zi(ie,le.mode,ce,null),ie.return=le,ie;if(typeof ie.then=="function")return Ne(le,qc(ie),ce);if(ie.$$typeof===b)return Ne(le,Dc(le,ie),ce);$c(le,ie)}return null}function pe(le,ie,ce,be){var qe=ie!==null?ie.key:null;if(typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint")return qe!==null?null:I(le,ie,""+ce,be);if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case _:return ce.key===qe?Q(le,ie,ce,be):null;case E:return ce.key===qe?fe(le,ie,ce,be):null;case W:return qe=ce._init,ce=qe(ce._payload),pe(le,ie,ce,be)}if(Ee(ce)||te(ce))return qe!==null?null:we(le,ie,ce,be,null);if(typeof ce.then=="function")return pe(le,ie,qc(ce),be);if(ce.$$typeof===b)return pe(le,ie,Dc(le,ce),be);$c(le,ce)}return null}function ge(le,ie,ce,be,qe){if(typeof be=="string"&&be!==""||typeof be=="number"||typeof be=="bigint")return le=le.get(ce)||null,I(ie,le,""+be,qe);if(typeof be=="object"&&be!==null){switch(be.$$typeof){case _:return le=le.get(be.key===null?ce:be.key)||null,Q(ie,le,be,qe);case E:return le=le.get(be.key===null?ce:be.key)||null,fe(ie,le,be,qe);case W:var xt=be._init;return be=xt(be._payload),ge(le,ie,ce,be,qe)}if(Ee(be)||te(be))return le=le.get(ce)||null,we(ie,le,be,qe,null);if(typeof be.then=="function")return ge(le,ie,ce,qc(be),qe);if(be.$$typeof===b)return ge(le,ie,ce,Dc(ie,be),qe);$c(ie,be)}return null}function et(le,ie,ce,be){for(var qe=null,xt=null,Je=ie,Qe=ie=0,On=null;Je!==null&&Qe<ce.length;Qe++){Je.index>Qe?(On=Je,Je=null):On=Je.sibling;var Lt=pe(le,Je,ce[Qe],be);if(Lt===null){Je===null&&(Je=On);break}i&&Je&&Lt.alternate===null&&s(le,Je),ie=T(Lt,ie,Qe),xt===null?qe=Lt:xt.sibling=Lt,xt=Lt,Je=On}if(Qe===ce.length)return o(le,Je),Bt&&$i(le,Qe),qe;if(Je===null){for(;Qe<ce.length;Qe++)Je=Ne(le,ce[Qe],be),Je!==null&&(ie=T(Je,ie,Qe),xt===null?qe=Je:xt.sibling=Je,xt=Je);return Bt&&$i(le,Qe),qe}for(Je=h(Je);Qe<ce.length;Qe++)On=ge(Je,le,Qe,ce[Qe],be),On!==null&&(i&&On.alternate!==null&&Je.delete(On.key===null?Qe:On.key),ie=T(On,ie,Qe),xt===null?qe=On:xt.sibling=On,xt=On);return i&&Je.forEach(function(wi){return s(le,wi)}),Bt&&$i(le,Qe),qe}function Ze(le,ie,ce,be){if(ce==null)throw Error(r(151));for(var qe=null,xt=null,Je=ie,Qe=ie=0,On=null,Lt=ce.next();Je!==null&&!Lt.done;Qe++,Lt=ce.next()){Je.index>Qe?(On=Je,Je=null):On=Je.sibling;var wi=pe(le,Je,Lt.value,be);if(wi===null){Je===null&&(Je=On);break}i&&Je&&wi.alternate===null&&s(le,Je),ie=T(wi,ie,Qe),xt===null?qe=wi:xt.sibling=wi,xt=wi,Je=On}if(Lt.done)return o(le,Je),Bt&&$i(le,Qe),qe;if(Je===null){for(;!Lt.done;Qe++,Lt=ce.next())Lt=Ne(le,Lt.value,be),Lt!==null&&(ie=T(Lt,ie,Qe),xt===null?qe=Lt:xt.sibling=Lt,xt=Lt);return Bt&&$i(le,Qe),qe}for(Je=h(Je);!Lt.done;Qe++,Lt=ce.next())Lt=ge(Je,le,Qe,Lt.value,be),Lt!==null&&(i&&Lt.alternate!==null&&Je.delete(Lt.key===null?Qe:Lt.key),ie=T(Lt,ie,Qe),xt===null?qe=Lt:xt.sibling=Lt,xt=Lt);return i&&Je.forEach(function(kS){return s(le,kS)}),Bt&&$i(le,Qe),qe}function $t(le,ie,ce,be){if(typeof ce=="object"&&ce!==null&&ce.type===w&&ce.key===null&&(ce=ce.props.children),typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case _:e:{for(var qe=ce.key;ie!==null;){if(ie.key===qe){if(qe=ce.type,qe===w){if(ie.tag===7){o(le,ie.sibling),be=v(ie,ce.props.children),be.return=le,le=be;break e}}else if(ie.elementType===qe||typeof qe=="object"&&qe!==null&&qe.$$typeof===W&&zp(qe)===ie.type){o(le,ie.sibling),be=v(ie,ce.props),ro(be,ce),be.return=le,le=be;break e}o(le,ie);break}else s(le,ie);ie=ie.sibling}ce.type===w?(be=zi(ce.props.children,le.mode,be,ce.key),be.return=le,le=be):(be=kc(ce.type,ce.key,ce.props,null,le.mode,be),ro(be,ce),be.return=le,le=be)}return A(le);case E:e:{for(qe=ce.key;ie!==null;){if(ie.key===qe)if(ie.tag===4&&ie.stateNode.containerInfo===ce.containerInfo&&ie.stateNode.implementation===ce.implementation){o(le,ie.sibling),be=v(ie,ce.children||[]),be.return=le,le=be;break e}else{o(le,ie);break}else s(le,ie);ie=ie.sibling}be=zf(ce,le.mode,be),be.return=le,le=be}return A(le);case W:return qe=ce._init,ce=qe(ce._payload),$t(le,ie,ce,be)}if(Ee(ce))return et(le,ie,ce,be);if(te(ce)){if(qe=te(ce),typeof qe!="function")throw Error(r(150));return ce=qe.call(ce),Ze(le,ie,ce,be)}if(typeof ce.then=="function")return $t(le,ie,qc(ce),be);if(ce.$$typeof===b)return $t(le,ie,Dc(le,ce),be);$c(le,ce)}return typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint"?(ce=""+ce,ie!==null&&ie.tag===6?(o(le,ie.sibling),be=v(ie,ce),be.return=le,le=be):(o(le,ie),be=jf(ce,le.mode,be),be.return=le,le=be),A(le)):o(le,ie)}return function(le,ie,ce,be){try{no=0;var qe=$t(le,ie,ce,be);return js=null,qe}catch(Je){if(Je===Yl||Je===Fc)throw Je;var xt=_r(29,Je,null,le.mode);return xt.lanes=be,xt.return=le,xt}finally{}}}var zs=qp(!0),$p=qp(!1),Ur=Z(null),fa=null;function ci(i){var s=i.alternate;H(kn,kn.current&1),H(Ur,i),fa===null&&(s===null||Bs.current!==null||s.memoizedState!==null)&&(fa=i)}function Yp(i){if(i.tag===22){if(H(kn,kn.current),H(Ur,i),fa===null){var s=i.alternate;s!==null&&s.memoizedState!==null&&(fa=i)}}else ui()}function ui(){H(kn,kn.current),H(Ur,Ur.current)}function Ua(i){D(Ur),fa===i&&(fa=null),D(kn)}var kn=Z(0);function Yc(i){for(var s=i;s!==null;){if(s.tag===13){var o=s.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||o.data==="$?"||dd(o)))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}function S0(i,s,o,h){s=i.memoizedState,o=o(h,s),o=o==null?s:x({},s,o),i.memoizedState=o,i.lanes===0&&(i.updateQueue.baseState=o)}var w0={enqueueSetState:function(i,s,o){i=i._reactInternals;var h=Cr(),v=si(h);v.payload=s,o!=null&&(v.callback=o),s=li(i,v,h),s!==null&&(Ar(s,i,h),Jl(s,i,h))},enqueueReplaceState:function(i,s,o){i=i._reactInternals;var h=Cr(),v=si(h);v.tag=1,v.payload=s,o!=null&&(v.callback=o),s=li(i,v,h),s!==null&&(Ar(s,i,h),Jl(s,i,h))},enqueueForceUpdate:function(i,s){i=i._reactInternals;var o=Cr(),h=si(o);h.tag=2,s!=null&&(h.callback=s),s=li(i,h,o),s!==null&&(Ar(s,i,o),Jl(s,i,o))}};function Wp(i,s,o,h,v,T,A){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(h,T,A):s.prototype&&s.prototype.isPureReactComponent?!Bl(o,h)||!Bl(v,T):!0}function Jp(i,s,o,h){i=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(o,h),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(o,h),s.state!==i&&w0.enqueueReplaceState(s,s.state,null)}function Qi(i,s){var o=s;if("ref"in s){o={};for(var h in s)h!=="ref"&&(o[h]=s[h])}if(i=i.defaultProps){o===s&&(o=x({},o));for(var v in i)o[v]===void 0&&(o[v]=i[v])}return o}var Wc=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)};function Xp(i){Wc(i)}function Kp(i){console.error(i)}function Zp(i){Wc(i)}function Jc(i,s){try{var o=i.onUncaughtError;o(s.value,{componentStack:s.stack})}catch(h){setTimeout(function(){throw h})}}function Qp(i,s,o){try{var h=i.onCaughtError;h(o.value,{componentStack:o.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(v){setTimeout(function(){throw v})}}function C0(i,s,o){return o=si(o),o.tag=3,o.payload={element:null},o.callback=function(){Jc(i,s)},o}function ex(i){return i=si(i),i.tag=3,i}function tx(i,s,o,h){var v=o.type.getDerivedStateFromError;if(typeof v=="function"){var T=h.value;i.payload=function(){return v(T)},i.callback=function(){Qp(s,o,h)}}var A=o.stateNode;A!==null&&typeof A.componentDidCatch=="function"&&(i.callback=function(){Qp(s,o,h),typeof v!="function"&&(xi===null?xi=new Set([this]):xi.add(this));var I=h.stack;this.componentDidCatch(h.value,{componentStack:I!==null?I:""})})}function kE(i,s,o,h,v){if(o.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(s=o.alternate,s!==null&&zl(s,o,v,!0),o=Ur.current,o!==null){switch(o.tag){case 13:return fa===null?J0():o.alternate===null&&hn===0&&(hn=3),o.flags&=-257,o.flags|=65536,o.lanes=v,h===e0?o.flags|=16384:(s=o.updateQueue,s===null?o.updateQueue=new Set([h]):s.add(h),K0(i,h,v)),!1;case 22:return o.flags|=65536,h===e0?o.flags|=16384:(s=o.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([h])},o.updateQueue=s):(o=s.retryQueue,o===null?s.retryQueue=new Set([h]):o.add(h)),K0(i,h,v)),!1}throw Error(r(435,o.tag))}return K0(i,h,v),J0(),!1}if(Bt)return s=Ur.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=v,h!==Yf&&(i=Error(r(422),{cause:h}),jl(Fr(i,o)))):(h!==Yf&&(s=Error(r(423),{cause:h}),jl(Fr(s,o))),i=i.current.alternate,i.flags|=65536,v&=-v,i.lanes|=v,h=Fr(h,o),v=C0(i.stateNode,h,v),r0(i,v),hn!==4&&(hn=2)),!1;var T=Error(r(520),{cause:h});if(T=Fr(T,o),uo===null?uo=[T]:uo.push(T),hn!==4&&(hn=2),s===null)return!0;h=Fr(h,o),o=s;do{switch(o.tag){case 3:return o.flags|=65536,i=v&-v,o.lanes|=i,i=C0(o.stateNode,h,i),r0(o,i),!1;case 1:if(s=o.type,T=o.stateNode,(o.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(xi===null||!xi.has(T))))return o.flags|=65536,v&=-v,o.lanes|=v,v=ex(v),tx(v,i,o,h),r0(o,v),!1}o=o.return}while(o!==null);return!1}var nx=Error(r(461)),Fn=!1;function Hn(i,s,o,h){s.child=i===null?$p(s,null,o,h):zs(s,i.child,o,h)}function rx(i,s,o,h,v){o=o.render;var T=s.ref;if("ref"in h){var A={};for(var I in h)I!=="ref"&&(A[I]=h[I])}else A=h;return Xi(s),h=o0(i,s,o,A,T,v),I=c0(),i!==null&&!Fn?(u0(i,s,v),Ba(i,s,v)):(Bt&&I&&qf(s),s.flags|=1,Hn(i,s,h,v),s.child)}function ax(i,s,o,h,v){if(i===null){var T=o.type;return typeof T=="function"&&!Gf(T)&&T.defaultProps===void 0&&o.compare===null?(s.tag=15,s.type=T,ix(i,s,T,h,v)):(i=kc(o.type,null,h,s,s.mode,v),i.ref=s.ref,i.return=s,s.child=i)}if(T=i.child,!I0(i,v)){var A=T.memoizedProps;if(o=o.compare,o=o!==null?o:Bl,o(A,h)&&i.ref===s.ref)return Ba(i,s,v)}return s.flags|=1,i=Da(T,h),i.ref=s.ref,i.return=s,s.child=i}function ix(i,s,o,h,v){if(i!==null){var T=i.memoizedProps;if(Bl(T,h)&&i.ref===s.ref)if(Fn=!1,s.pendingProps=h=T,I0(i,v))(i.flags&131072)!==0&&(Fn=!0);else return s.lanes=i.lanes,Ba(i,s,v)}return A0(i,s,o,h,v)}function sx(i,s,o){var h=s.pendingProps,v=h.children,T=i!==null?i.memoizedState:null;if(h.mode==="hidden"){if((s.flags&128)!==0){if(h=T!==null?T.baseLanes|o:o,i!==null){for(v=s.child=i.child,T=0;v!==null;)T=T|v.lanes|v.childLanes,v=v.sibling;s.childLanes=T&~h}else s.childLanes=0,s.child=null;return lx(i,s,h,o)}if((o&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},i!==null&&Ic(s,T!==null?T.cachePool:null),T!==null?ip(s,T):i0(),Yp(s);else return s.lanes=s.childLanes=536870912,lx(i,s,T!==null?T.baseLanes|o:o,o)}else T!==null?(Ic(s,T.cachePool),ip(s,T),ui(),s.memoizedState=null):(i!==null&&Ic(s,null),i0(),ui());return Hn(i,s,v,o),s.child}function lx(i,s,o,h){var v=Qf();return v=v===null?null:{parent:bn._currentValue,pool:v},s.memoizedState={baseLanes:o,cachePool:v},i!==null&&Ic(s,null),i0(),Yp(s),i!==null&&zl(i,s,h,!0),null}function Xc(i,s){var o=s.ref;if(o===null)i!==null&&i.ref!==null&&(s.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(r(284));(i===null||i.ref!==o)&&(s.flags|=4194816)}}function A0(i,s,o,h,v){return Xi(s),o=o0(i,s,o,h,void 0,v),h=c0(),i!==null&&!Fn?(u0(i,s,v),Ba(i,s,v)):(Bt&&h&&qf(s),s.flags|=1,Hn(i,s,o,v),s.child)}function ox(i,s,o,h,v,T){return Xi(s),s.updateQueue=null,o=lp(s,h,o,v),sp(i),h=c0(),i!==null&&!Fn?(u0(i,s,T),Ba(i,s,T)):(Bt&&h&&qf(s),s.flags|=1,Hn(i,s,o,T),s.child)}function cx(i,s,o,h,v){if(Xi(s),s.stateNode===null){var T=Fs,A=o.contextType;typeof A=="object"&&A!==null&&(T=Wn(A)),T=new o(h,T),s.memoizedState=T.state!==null&&T.state!==void 0?T.state:null,T.updater=w0,s.stateNode=T,T._reactInternals=s,T=s.stateNode,T.props=h,T.state=s.memoizedState,T.refs={},t0(s),A=o.contextType,T.context=typeof A=="object"&&A!==null?Wn(A):Fs,T.state=s.memoizedState,A=o.getDerivedStateFromProps,typeof A=="function"&&(S0(s,o,A,h),T.state=s.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof T.getSnapshotBeforeUpdate=="function"||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(A=T.state,typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount(),A!==T.state&&w0.enqueueReplaceState(T,T.state,null),Kl(s,h,T,v),Xl(),T.state=s.memoizedState),typeof T.componentDidMount=="function"&&(s.flags|=4194308),h=!0}else if(i===null){T=s.stateNode;var I=s.memoizedProps,Q=Qi(o,I);T.props=Q;var fe=T.context,we=o.contextType;A=Fs,typeof we=="object"&&we!==null&&(A=Wn(we));var Ne=o.getDerivedStateFromProps;we=typeof Ne=="function"||typeof T.getSnapshotBeforeUpdate=="function",I=s.pendingProps!==I,we||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(I||fe!==A)&&Jp(s,T,h,A),ii=!1;var pe=s.memoizedState;T.state=pe,Kl(s,h,T,v),Xl(),fe=s.memoizedState,I||pe!==fe||ii?(typeof Ne=="function"&&(S0(s,o,Ne,h),fe=s.memoizedState),(Q=ii||Wp(s,o,Q,h,pe,fe,A))?(we||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount()),typeof T.componentDidMount=="function"&&(s.flags|=4194308)):(typeof T.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=h,s.memoizedState=fe),T.props=h,T.state=fe,T.context=A,h=Q):(typeof T.componentDidMount=="function"&&(s.flags|=4194308),h=!1)}else{T=s.stateNode,n0(i,s),A=s.memoizedProps,we=Qi(o,A),T.props=we,Ne=s.pendingProps,pe=T.context,fe=o.contextType,Q=Fs,typeof fe=="object"&&fe!==null&&(Q=Wn(fe)),I=o.getDerivedStateFromProps,(fe=typeof I=="function"||typeof T.getSnapshotBeforeUpdate=="function")||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(A!==Ne||pe!==Q)&&Jp(s,T,h,Q),ii=!1,pe=s.memoizedState,T.state=pe,Kl(s,h,T,v),Xl();var ge=s.memoizedState;A!==Ne||pe!==ge||ii||i!==null&&i.dependencies!==null&&Rc(i.dependencies)?(typeof I=="function"&&(S0(s,o,I,h),ge=s.memoizedState),(we=ii||Wp(s,o,we,h,pe,ge,Q)||i!==null&&i.dependencies!==null&&Rc(i.dependencies))?(fe||typeof T.UNSAFE_componentWillUpdate!="function"&&typeof T.componentWillUpdate!="function"||(typeof T.componentWillUpdate=="function"&&T.componentWillUpdate(h,ge,Q),typeof T.UNSAFE_componentWillUpdate=="function"&&T.UNSAFE_componentWillUpdate(h,ge,Q)),typeof T.componentDidUpdate=="function"&&(s.flags|=4),typeof T.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof T.componentDidUpdate!="function"||A===i.memoizedProps&&pe===i.memoizedState||(s.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||A===i.memoizedProps&&pe===i.memoizedState||(s.flags|=1024),s.memoizedProps=h,s.memoizedState=ge),T.props=h,T.state=ge,T.context=Q,h=we):(typeof T.componentDidUpdate!="function"||A===i.memoizedProps&&pe===i.memoizedState||(s.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||A===i.memoizedProps&&pe===i.memoizedState||(s.flags|=1024),h=!1)}return T=h,Xc(i,s),h=(s.flags&128)!==0,T||h?(T=s.stateNode,o=h&&typeof o.getDerivedStateFromError!="function"?null:T.render(),s.flags|=1,i!==null&&h?(s.child=zs(s,i.child,null,v),s.child=zs(s,null,o,v)):Hn(i,s,o,v),s.memoizedState=T.state,i=s.child):i=Ba(i,s,v),i}function ux(i,s,o,h){return Gl(),s.flags|=256,Hn(i,s,o,h),s.child}var b0={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function k0(i){return{baseLanes:i,cachePool:Km()}}function N0(i,s,o){return i=i!==null?i.childLanes&~o:0,s&&(i|=Br),i}function fx(i,s,o){var h=s.pendingProps,v=!1,T=(s.flags&128)!==0,A;if((A=T)||(A=i!==null&&i.memoizedState===null?!1:(kn.current&2)!==0),A&&(v=!0,s.flags&=-129),A=(s.flags&32)!==0,s.flags&=-33,i===null){if(Bt){if(v?ci(s):ui(),Bt){var I=dn,Q;if(Q=I){e:{for(Q=I,I=ua;Q.nodeType!==8;){if(!I){I=null;break e}if(Q=Qr(Q.nextSibling),Q===null){I=null;break e}}I=Q}I!==null?(s.memoizedState={dehydrated:I,treeContext:qi!==null?{id:Ia,overflow:Fa}:null,retryLane:536870912,hydrationErrors:null},Q=_r(18,null,null,0),Q.stateNode=I,Q.return=s,s.child=Q,ar=s,dn=null,Q=!0):Q=!1}Q||Wi(s)}if(I=s.memoizedState,I!==null&&(I=I.dehydrated,I!==null))return dd(I)?s.lanes=32:s.lanes=536870912,null;Ua(s)}return I=h.children,h=h.fallback,v?(ui(),v=s.mode,I=Kc({mode:"hidden",children:I},v),h=zi(h,v,o,null),I.return=s,h.return=s,I.sibling=h,s.child=I,v=s.child,v.memoizedState=k0(o),v.childLanes=N0(i,A,o),s.memoizedState=b0,h):(ci(s),M0(s,I))}if(Q=i.memoizedState,Q!==null&&(I=Q.dehydrated,I!==null)){if(T)s.flags&256?(ci(s),s.flags&=-257,s=R0(i,s,o)):s.memoizedState!==null?(ui(),s.child=i.child,s.flags|=128,s=null):(ui(),v=h.fallback,I=s.mode,h=Kc({mode:"visible",children:h.children},I),v=zi(v,I,o,null),v.flags|=2,h.return=s,v.return=s,h.sibling=v,s.child=h,zs(s,i.child,null,o),h=s.child,h.memoizedState=k0(o),h.childLanes=N0(i,A,o),s.memoizedState=b0,s=v);else if(ci(s),dd(I)){if(A=I.nextSibling&&I.nextSibling.dataset,A)var fe=A.dgst;A=fe,h=Error(r(419)),h.stack="",h.digest=A,jl({value:h,source:null,stack:null}),s=R0(i,s,o)}else if(Fn||zl(i,s,o,!1),A=(o&i.childLanes)!==0,Fn||A){if(A=Kt,A!==null&&(h=o&-o,h=(h&42)!==0?1:In(h),h=(h&(A.suspendedLanes|o))!==0?0:h,h!==0&&h!==Q.retryLane))throw Q.retryLane=h,Is(i,h),Ar(A,i,h),nx;I.data==="$?"||J0(),s=R0(i,s,o)}else I.data==="$?"?(s.flags|=192,s.child=i.child,s=null):(i=Q.treeContext,dn=Qr(I.nextSibling),ar=s,Bt=!0,Yi=null,ua=!1,i!==null&&(Or[Pr++]=Ia,Or[Pr++]=Fa,Or[Pr++]=qi,Ia=i.id,Fa=i.overflow,qi=s),s=M0(s,h.children),s.flags|=4096);return s}return v?(ui(),v=h.fallback,I=s.mode,Q=i.child,fe=Q.sibling,h=Da(Q,{mode:"hidden",children:h.children}),h.subtreeFlags=Q.subtreeFlags&65011712,fe!==null?v=Da(fe,v):(v=zi(v,I,o,null),v.flags|=2),v.return=s,h.return=s,h.sibling=v,s.child=h,h=v,v=s.child,I=i.child.memoizedState,I===null?I=k0(o):(Q=I.cachePool,Q!==null?(fe=bn._currentValue,Q=Q.parent!==fe?{parent:fe,pool:fe}:Q):Q=Km(),I={baseLanes:I.baseLanes|o,cachePool:Q}),v.memoizedState=I,v.childLanes=N0(i,A,o),s.memoizedState=b0,h):(ci(s),o=i.child,i=o.sibling,o=Da(o,{mode:"visible",children:h.children}),o.return=s,o.sibling=null,i!==null&&(A=s.deletions,A===null?(s.deletions=[i],s.flags|=16):A.push(i)),s.child=o,s.memoizedState=null,o)}function M0(i,s){return s=Kc({mode:"visible",children:s},i.mode),s.return=i,i.child=s}function Kc(i,s){return i=_r(22,i,null,s),i.lanes=0,i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},i}function R0(i,s,o){return zs(s,i.child,null,o),i=M0(s,s.pendingProps.children),i.flags|=2,s.memoizedState=null,i}function dx(i,s,o){i.lanes|=s;var h=i.alternate;h!==null&&(h.lanes|=s),Jf(i.return,s,o)}function D0(i,s,o,h,v){var T=i.memoizedState;T===null?i.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:h,tail:o,tailMode:v}:(T.isBackwards=s,T.rendering=null,T.renderingStartTime=0,T.last=h,T.tail=o,T.tailMode=v)}function hx(i,s,o){var h=s.pendingProps,v=h.revealOrder,T=h.tail;if(Hn(i,s,h.children,o),h=kn.current,(h&2)!==0)h=h&1|2,s.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=s.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&dx(i,o,s);else if(i.tag===19)dx(i,o,s);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}h&=1}switch(H(kn,h),v){case"forwards":for(o=s.child,v=null;o!==null;)i=o.alternate,i!==null&&Yc(i)===null&&(v=o),o=o.sibling;o=v,o===null?(v=s.child,s.child=null):(v=o.sibling,o.sibling=null),D0(s,!1,v,o,T);break;case"backwards":for(o=null,v=s.child,s.child=null;v!==null;){if(i=v.alternate,i!==null&&Yc(i)===null){s.child=v;break}i=v.sibling,v.sibling=o,o=v,v=i}D0(s,!0,o,null,T);break;case"together":D0(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function Ba(i,s,o){if(i!==null&&(s.dependencies=i.dependencies),pi|=s.lanes,(o&s.childLanes)===0)if(i!==null){if(zl(i,s,o,!1),(o&s.childLanes)===0)return null}else return null;if(i!==null&&s.child!==i.child)throw Error(r(153));if(s.child!==null){for(i=s.child,o=Da(i,i.pendingProps),s.child=o,o.return=s;i.sibling!==null;)i=i.sibling,o=o.sibling=Da(i,i.pendingProps),o.return=s;o.sibling=null}return s.child}function I0(i,s){return(i.lanes&s)!==0?!0:(i=i.dependencies,!!(i!==null&&Rc(i)))}function NE(i,s,o){switch(s.tag){case 3:Ae(s,s.stateNode.containerInfo),ai(s,bn,i.memoizedState.cache),Gl();break;case 27:case 5:Ce(s);break;case 4:Ae(s,s.stateNode.containerInfo);break;case 10:ai(s,s.type,s.memoizedProps.value);break;case 13:var h=s.memoizedState;if(h!==null)return h.dehydrated!==null?(ci(s),s.flags|=128,null):(o&s.child.childLanes)!==0?fx(i,s,o):(ci(s),i=Ba(i,s,o),i!==null?i.sibling:null);ci(s);break;case 19:var v=(i.flags&128)!==0;if(h=(o&s.childLanes)!==0,h||(zl(i,s,o,!1),h=(o&s.childLanes)!==0),v){if(h)return hx(i,s,o);s.flags|=128}if(v=s.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),H(kn,kn.current),h)break;return null;case 22:case 23:return s.lanes=0,sx(i,s,o);case 24:ai(s,bn,i.memoizedState.cache)}return Ba(i,s,o)}function mx(i,s,o){if(i!==null)if(i.memoizedProps!==s.pendingProps)Fn=!0;else{if(!I0(i,o)&&(s.flags&128)===0)return Fn=!1,NE(i,s,o);Fn=(i.flags&131072)!==0}else Fn=!1,Bt&&(s.flags&1048576)!==0&&zm(s,Mc,s.index);switch(s.lanes=0,s.tag){case 16:e:{i=s.pendingProps;var h=s.elementType,v=h._init;if(h=v(h._payload),s.type=h,typeof h=="function")Gf(h)?(i=Qi(h,i),s.tag=1,s=cx(null,s,h,i,o)):(s.tag=0,s=A0(null,s,h,i,o));else{if(h!=null){if(v=h.$$typeof,v===U){s.tag=11,s=rx(null,s,h,i,o);break e}else if(v===F){s.tag=14,s=ax(null,s,h,i,o);break e}}throw s=Ie(h)||h,Error(r(306,s,""))}}return s;case 0:return A0(i,s,s.type,s.pendingProps,o);case 1:return h=s.type,v=Qi(h,s.pendingProps),cx(i,s,h,v,o);case 3:e:{if(Ae(s,s.stateNode.containerInfo),i===null)throw Error(r(387));h=s.pendingProps;var T=s.memoizedState;v=T.element,n0(i,s),Kl(s,h,null,o);var A=s.memoizedState;if(h=A.cache,ai(s,bn,h),h!==T.cache&&Xf(s,[bn],o,!0),Xl(),h=A.element,T.isDehydrated)if(T={element:h,isDehydrated:!1,cache:A.cache},s.updateQueue.baseState=T,s.memoizedState=T,s.flags&256){s=ux(i,s,h,o);break e}else if(h!==v){v=Fr(Error(r(424)),s),jl(v),s=ux(i,s,h,o);break e}else{switch(i=s.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(dn=Qr(i.firstChild),ar=s,Bt=!0,Yi=null,ua=!0,o=$p(s,null,h,o),s.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling}else{if(Gl(),h===v){s=Ba(i,s,o);break e}Hn(i,s,h,o)}s=s.child}return s;case 26:return Xc(i,s),i===null?(o=vg(s.type,null,s.pendingProps,null))?s.memoizedState=o:Bt||(o=s.type,i=s.pendingProps,h=fu(se.current).createElement(o),h[tn]=s,h[nn]=i,jn(h,o,i),oe(h),s.stateNode=h):s.memoizedState=vg(s.type,i.memoizedProps,s.pendingProps,i.memoizedState),null;case 27:return Ce(s),i===null&&Bt&&(h=s.stateNode=pg(s.type,s.pendingProps,se.current),ar=s,ua=!0,v=dn,yi(s.type)?(hd=v,dn=Qr(h.firstChild)):dn=v),Hn(i,s,s.pendingProps.children,o),Xc(i,s),i===null&&(s.flags|=4194304),s.child;case 5:return i===null&&Bt&&((v=h=dn)&&(h=rS(h,s.type,s.pendingProps,ua),h!==null?(s.stateNode=h,ar=s,dn=Qr(h.firstChild),ua=!1,v=!0):v=!1),v||Wi(s)),Ce(s),v=s.type,T=s.pendingProps,A=i!==null?i.memoizedProps:null,h=T.children,cd(v,T)?h=null:A!==null&&cd(v,A)&&(s.flags|=32),s.memoizedState!==null&&(v=o0(i,s,_E,null,null,o),To._currentValue=v),Xc(i,s),Hn(i,s,h,o),s.child;case 6:return i===null&&Bt&&((i=o=dn)&&(o=aS(o,s.pendingProps,ua),o!==null?(s.stateNode=o,ar=s,dn=null,i=!0):i=!1),i||Wi(s)),null;case 13:return fx(i,s,o);case 4:return Ae(s,s.stateNode.containerInfo),h=s.pendingProps,i===null?s.child=zs(s,null,h,o):Hn(i,s,h,o),s.child;case 11:return rx(i,s,s.type,s.pendingProps,o);case 7:return Hn(i,s,s.pendingProps,o),s.child;case 8:return Hn(i,s,s.pendingProps.children,o),s.child;case 12:return Hn(i,s,s.pendingProps.children,o),s.child;case 10:return h=s.pendingProps,ai(s,s.type,h.value),Hn(i,s,h.children,o),s.child;case 9:return v=s.type._context,h=s.pendingProps.children,Xi(s),v=Wn(v),h=h(v),s.flags|=1,Hn(i,s,h,o),s.child;case 14:return ax(i,s,s.type,s.pendingProps,o);case 15:return ix(i,s,s.type,s.pendingProps,o);case 19:return hx(i,s,o);case 31:return h=s.pendingProps,o=s.mode,h={mode:h.mode,children:h.children},i===null?(o=Kc(h,o),o.ref=s.ref,s.child=o,o.return=s,s=o):(o=Da(i.child,h),o.ref=s.ref,s.child=o,o.return=s,s=o),s;case 22:return sx(i,s,o);case 24:return Xi(s),h=Wn(bn),i===null?(v=Qf(),v===null&&(v=Kt,T=Kf(),v.pooledCache=T,T.refCount++,T!==null&&(v.pooledCacheLanes|=o),v=T),s.memoizedState={parent:h,cache:v},t0(s),ai(s,bn,v)):((i.lanes&o)!==0&&(n0(i,s),Kl(s,null,null,o),Xl()),v=i.memoizedState,T=s.memoizedState,v.parent!==h?(v={parent:h,cache:h},s.memoizedState=v,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=v),ai(s,bn,h)):(h=T.cache,ai(s,bn,h),h!==v.cache&&Xf(s,[bn],o,!0))),Hn(i,s,s.pendingProps.children,o),s.child;case 29:throw s.pendingProps}throw Error(r(156,s.tag))}function Va(i){i.flags|=4}function px(i,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!Sg(s)){if(s=Ur.current,s!==null&&((At&4194048)===At?fa!==null:(At&62914560)!==At&&(At&536870912)===0||s!==fa))throw Wl=e0,Zm;i.flags|=8192}}function Zc(i,s){s!==null&&(i.flags|=4),i.flags&16384&&(s=i.tag!==22?ba():536870912,i.lanes|=s,Ws|=s)}function ao(i,s){if(!Bt)switch(i.tailMode){case"hidden":s=i.tail;for(var o=null;s!==null;)s.alternate!==null&&(o=s),s=s.sibling;o===null?i.tail=null:o.sibling=null;break;case"collapsed":o=i.tail;for(var h=null;o!==null;)o.alternate!==null&&(h=o),o=o.sibling;h===null?s||i.tail===null?i.tail=null:i.tail.sibling=null:h.sibling=null}}function ln(i){var s=i.alternate!==null&&i.alternate.child===i.child,o=0,h=0;if(s)for(var v=i.child;v!==null;)o|=v.lanes|v.childLanes,h|=v.subtreeFlags&65011712,h|=v.flags&65011712,v.return=i,v=v.sibling;else for(v=i.child;v!==null;)o|=v.lanes|v.childLanes,h|=v.subtreeFlags,h|=v.flags,v.return=i,v=v.sibling;return i.subtreeFlags|=h,i.childLanes=o,s}function ME(i,s,o){var h=s.pendingProps;switch($f(s),s.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ln(s),null;case 1:return ln(s),null;case 3:return o=s.stateNode,h=null,i!==null&&(h=i.memoizedState.cache),s.memoizedState.cache!==h&&(s.flags|=2048),Oa(bn),Re(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(i===null||i.child===null)&&(Hl(s)?Va(s):i===null||i.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,Ym())),ln(s),null;case 26:return o=s.memoizedState,i===null?(Va(s),o!==null?(ln(s),px(s,o)):(ln(s),s.flags&=-16777217)):o?o!==i.memoizedState?(Va(s),ln(s),px(s,o)):(ln(s),s.flags&=-16777217):(i.memoizedProps!==h&&Va(s),ln(s),s.flags&=-16777217),null;case 27:Xe(s),o=se.current;var v=s.type;if(i!==null&&s.stateNode!=null)i.memoizedProps!==h&&Va(s);else{if(!h){if(s.stateNode===null)throw Error(r(166));return ln(s),null}i=q.current,Hl(s)?qm(s):(i=pg(v,h,o),s.stateNode=i,Va(s))}return ln(s),null;case 5:if(Xe(s),o=s.type,i!==null&&s.stateNode!=null)i.memoizedProps!==h&&Va(s);else{if(!h){if(s.stateNode===null)throw Error(r(166));return ln(s),null}if(i=q.current,Hl(s))qm(s);else{switch(v=fu(se.current),i){case 1:i=v.createElementNS("http://www.w3.org/2000/svg",o);break;case 2:i=v.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;default:switch(o){case"svg":i=v.createElementNS("http://www.w3.org/2000/svg",o);break;case"math":i=v.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;case"script":i=v.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild);break;case"select":i=typeof h.is=="string"?v.createElement("select",{is:h.is}):v.createElement("select"),h.multiple?i.multiple=!0:h.size&&(i.size=h.size);break;default:i=typeof h.is=="string"?v.createElement(o,{is:h.is}):v.createElement(o)}}i[tn]=s,i[nn]=h;e:for(v=s.child;v!==null;){if(v.tag===5||v.tag===6)i.appendChild(v.stateNode);else if(v.tag!==4&&v.tag!==27&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===s)break e;for(;v.sibling===null;){if(v.return===null||v.return===s)break e;v=v.return}v.sibling.return=v.return,v=v.sibling}s.stateNode=i;e:switch(jn(i,o,h),o){case"button":case"input":case"select":case"textarea":i=!!h.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&Va(s)}}return ln(s),s.flags&=-16777217,null;case 6:if(i&&s.stateNode!=null)i.memoizedProps!==h&&Va(s);else{if(typeof h!="string"&&s.stateNode===null)throw Error(r(166));if(i=se.current,Hl(s)){if(i=s.stateNode,o=s.memoizedProps,h=null,v=ar,v!==null)switch(v.tag){case 27:case 5:h=v.memoizedProps}i[tn]=s,i=!!(i.nodeValue===o||h!==null&&h.suppressHydrationWarning===!0||og(i.nodeValue,o)),i||Wi(s)}else i=fu(i).createTextNode(h),i[tn]=s,s.stateNode=i}return ln(s),null;case 13:if(h=s.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(v=Hl(s),h!==null&&h.dehydrated!==null){if(i===null){if(!v)throw Error(r(318));if(v=s.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(r(317));v[tn]=s}else Gl(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;ln(s),v=!1}else v=Ym(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=v),v=!0;if(!v)return s.flags&256?(Ua(s),s):(Ua(s),null)}if(Ua(s),(s.flags&128)!==0)return s.lanes=o,s;if(o=h!==null,i=i!==null&&i.memoizedState!==null,o){h=s.child,v=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(v=h.alternate.memoizedState.cachePool.pool);var T=null;h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(T=h.memoizedState.cachePool.pool),T!==v&&(h.flags|=2048)}return o!==i&&o&&(s.child.flags|=8192),Zc(s,s.updateQueue),ln(s),null;case 4:return Re(),i===null&&ad(s.stateNode.containerInfo),ln(s),null;case 10:return Oa(s.type),ln(s),null;case 19:if(D(kn),v=s.memoizedState,v===null)return ln(s),null;if(h=(s.flags&128)!==0,T=v.rendering,T===null)if(h)ao(v,!1);else{if(hn!==0||i!==null&&(i.flags&128)!==0)for(i=s.child;i!==null;){if(T=Yc(i),T!==null){for(s.flags|=128,ao(v,!1),i=T.updateQueue,s.updateQueue=i,Zc(s,i),s.subtreeFlags=0,i=o,o=s.child;o!==null;)jm(o,i),o=o.sibling;return H(kn,kn.current&1|2),s.child}i=i.sibling}v.tail!==null&&ve()>tu&&(s.flags|=128,h=!0,ao(v,!1),s.lanes=4194304)}else{if(!h)if(i=Yc(T),i!==null){if(s.flags|=128,h=!0,i=i.updateQueue,s.updateQueue=i,Zc(s,i),ao(v,!0),v.tail===null&&v.tailMode==="hidden"&&!T.alternate&&!Bt)return ln(s),null}else 2*ve()-v.renderingStartTime>tu&&o!==536870912&&(s.flags|=128,h=!0,ao(v,!1),s.lanes=4194304);v.isBackwards?(T.sibling=s.child,s.child=T):(i=v.last,i!==null?i.sibling=T:s.child=T,v.last=T)}return v.tail!==null?(s=v.tail,v.rendering=s,v.tail=s.sibling,v.renderingStartTime=ve(),s.sibling=null,i=kn.current,H(kn,h?i&1|2:i&1),s):(ln(s),null);case 22:case 23:return Ua(s),s0(),h=s.memoizedState!==null,i!==null?i.memoizedState!==null!==h&&(s.flags|=8192):h&&(s.flags|=8192),h?(o&536870912)!==0&&(s.flags&128)===0&&(ln(s),s.subtreeFlags&6&&(s.flags|=8192)):ln(s),o=s.updateQueue,o!==null&&Zc(s,o.retryQueue),o=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(o=i.memoizedState.cachePool.pool),h=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(h=s.memoizedState.cachePool.pool),h!==o&&(s.flags|=2048),i!==null&&D(Ki),null;case 24:return o=null,i!==null&&(o=i.memoizedState.cache),s.memoizedState.cache!==o&&(s.flags|=2048),Oa(bn),ln(s),null;case 25:return null;case 30:return null}throw Error(r(156,s.tag))}function RE(i,s){switch($f(s),s.tag){case 1:return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 3:return Oa(bn),Re(),i=s.flags,(i&65536)!==0&&(i&128)===0?(s.flags=i&-65537|128,s):null;case 26:case 27:case 5:return Xe(s),null;case 13:if(Ua(s),i=s.memoizedState,i!==null&&i.dehydrated!==null){if(s.alternate===null)throw Error(r(340));Gl()}return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 19:return D(kn),null;case 4:return Re(),null;case 10:return Oa(s.type),null;case 22:case 23:return Ua(s),s0(),i!==null&&D(Ki),i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 24:return Oa(bn),null;case 25:return null;default:return null}}function xx(i,s){switch($f(s),s.tag){case 3:Oa(bn),Re();break;case 26:case 27:case 5:Xe(s);break;case 4:Re();break;case 13:Ua(s);break;case 19:D(kn);break;case 10:Oa(s.type);break;case 22:case 23:Ua(s),s0(),i!==null&&D(Ki);break;case 24:Oa(bn)}}function io(i,s){try{var o=s.updateQueue,h=o!==null?o.lastEffect:null;if(h!==null){var v=h.next;o=v;do{if((o.tag&i)===i){h=void 0;var T=o.create,A=o.inst;h=T(),A.destroy=h}o=o.next}while(o!==v)}}catch(I){Wt(s,s.return,I)}}function fi(i,s,o){try{var h=s.updateQueue,v=h!==null?h.lastEffect:null;if(v!==null){var T=v.next;h=T;do{if((h.tag&i)===i){var A=h.inst,I=A.destroy;if(I!==void 0){A.destroy=void 0,v=s;var Q=o,fe=I;try{fe()}catch(we){Wt(v,Q,we)}}}h=h.next}while(h!==T)}}catch(we){Wt(s,s.return,we)}}function gx(i){var s=i.updateQueue;if(s!==null){var o=i.stateNode;try{ap(s,o)}catch(h){Wt(i,i.return,h)}}}function vx(i,s,o){o.props=Qi(i.type,i.memoizedProps),o.state=i.memoizedState;try{o.componentWillUnmount()}catch(h){Wt(i,s,h)}}function so(i,s){try{var o=i.ref;if(o!==null){switch(i.tag){case 26:case 27:case 5:var h=i.stateNode;break;case 30:h=i.stateNode;break;default:h=i.stateNode}typeof o=="function"?i.refCleanup=o(h):o.current=h}}catch(v){Wt(i,s,v)}}function da(i,s){var o=i.ref,h=i.refCleanup;if(o!==null)if(typeof h=="function")try{h()}catch(v){Wt(i,s,v)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(v){Wt(i,s,v)}else o.current=null}function yx(i){var s=i.type,o=i.memoizedProps,h=i.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":o.autoFocus&&h.focus();break e;case"img":o.src?h.src=o.src:o.srcSet&&(h.srcset=o.srcSet)}}catch(v){Wt(i,i.return,v)}}function F0(i,s,o){try{var h=i.stateNode;ZE(h,i.type,o,s),h[nn]=s}catch(v){Wt(i,i.return,v)}}function Tx(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&yi(i.type)||i.tag===4}function L0(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||Tx(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&yi(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function O0(i,s,o){var h=i.tag;if(h===5||h===6)i=i.stateNode,s?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(i,s):(s=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,s.appendChild(i),o=o._reactRootContainer,o!=null||s.onclick!==null||(s.onclick=uu));else if(h!==4&&(h===27&&yi(i.type)&&(o=i.stateNode,s=null),i=i.child,i!==null))for(O0(i,s,o),i=i.sibling;i!==null;)O0(i,s,o),i=i.sibling}function Qc(i,s,o){var h=i.tag;if(h===5||h===6)i=i.stateNode,s?o.insertBefore(i,s):o.appendChild(i);else if(h!==4&&(h===27&&yi(i.type)&&(o=i.stateNode),i=i.child,i!==null))for(Qc(i,s,o),i=i.sibling;i!==null;)Qc(i,s,o),i=i.sibling}function _x(i){var s=i.stateNode,o=i.memoizedProps;try{for(var h=i.type,v=s.attributes;v.length;)s.removeAttributeNode(v[0]);jn(s,h,o),s[tn]=i,s[nn]=o}catch(T){Wt(i,i.return,T)}}var Ha=!1,gn=!1,P0=!1,Ex=typeof WeakSet=="function"?WeakSet:Set,Ln=null;function DE(i,s){if(i=i.containerInfo,ld=gu,i=Im(i),Lf(i)){if("selectionStart"in i)var o={start:i.selectionStart,end:i.selectionEnd};else e:{o=(o=i.ownerDocument)&&o.defaultView||window;var h=o.getSelection&&o.getSelection();if(h&&h.rangeCount!==0){o=h.anchorNode;var v=h.anchorOffset,T=h.focusNode;h=h.focusOffset;try{o.nodeType,T.nodeType}catch{o=null;break e}var A=0,I=-1,Q=-1,fe=0,we=0,Ne=i,pe=null;t:for(;;){for(var ge;Ne!==o||v!==0&&Ne.nodeType!==3||(I=A+v),Ne!==T||h!==0&&Ne.nodeType!==3||(Q=A+h),Ne.nodeType===3&&(A+=Ne.nodeValue.length),(ge=Ne.firstChild)!==null;)pe=Ne,Ne=ge;for(;;){if(Ne===i)break t;if(pe===o&&++fe===v&&(I=A),pe===T&&++we===h&&(Q=A),(ge=Ne.nextSibling)!==null)break;Ne=pe,pe=Ne.parentNode}Ne=ge}o=I===-1||Q===-1?null:{start:I,end:Q}}else o=null}o=o||{start:0,end:0}}else o=null;for(od={focusedElem:i,selectionRange:o},gu=!1,Ln=s;Ln!==null;)if(s=Ln,i=s.child,(s.subtreeFlags&1024)!==0&&i!==null)i.return=s,Ln=i;else for(;Ln!==null;){switch(s=Ln,T=s.alternate,i=s.flags,s.tag){case 0:break;case 11:case 15:break;case 1:if((i&1024)!==0&&T!==null){i=void 0,o=s,v=T.memoizedProps,T=T.memoizedState,h=o.stateNode;try{var et=Qi(o.type,v,o.elementType===o.type);i=h.getSnapshotBeforeUpdate(et,T),h.__reactInternalSnapshotBeforeUpdate=i}catch(Ze){Wt(o,o.return,Ze)}}break;case 3:if((i&1024)!==0){if(i=s.stateNode.containerInfo,o=i.nodeType,o===9)fd(i);else if(o===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":fd(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(r(163))}if(i=s.sibling,i!==null){i.return=s.return,Ln=i;break}Ln=s.return}}function Sx(i,s,o){var h=o.flags;switch(o.tag){case 0:case 11:case 15:di(i,o),h&4&&io(5,o);break;case 1:if(di(i,o),h&4)if(i=o.stateNode,s===null)try{i.componentDidMount()}catch(A){Wt(o,o.return,A)}else{var v=Qi(o.type,s.memoizedProps);s=s.memoizedState;try{i.componentDidUpdate(v,s,i.__reactInternalSnapshotBeforeUpdate)}catch(A){Wt(o,o.return,A)}}h&64&&gx(o),h&512&&so(o,o.return);break;case 3:if(di(i,o),h&64&&(i=o.updateQueue,i!==null)){if(s=null,o.child!==null)switch(o.child.tag){case 27:case 5:s=o.child.stateNode;break;case 1:s=o.child.stateNode}try{ap(i,s)}catch(A){Wt(o,o.return,A)}}break;case 27:s===null&&h&4&&_x(o);case 26:case 5:di(i,o),s===null&&h&4&&yx(o),h&512&&so(o,o.return);break;case 12:di(i,o);break;case 13:di(i,o),h&4&&Ax(i,o),h&64&&(i=o.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(o=HE.bind(null,o),iS(i,o))));break;case 22:if(h=o.memoizedState!==null||Ha,!h){s=s!==null&&s.memoizedState!==null||gn,v=Ha;var T=gn;Ha=h,(gn=s)&&!T?hi(i,o,(o.subtreeFlags&8772)!==0):di(i,o),Ha=v,gn=T}break;case 30:break;default:di(i,o)}}function wx(i){var s=i.alternate;s!==null&&(i.alternate=null,wx(s)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(s=i.stateNode,s!==null&&P(s)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var an=null,pr=!1;function Ga(i,s,o){for(o=o.child;o!==null;)Cx(i,s,o),o=o.sibling}function Cx(i,s,o){if(Xt&&typeof Xt.onCommitFiberUnmount=="function")try{Xt.onCommitFiberUnmount(Jt,o)}catch{}switch(o.tag){case 26:gn||da(o,s),Ga(i,s,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:gn||da(o,s);var h=an,v=pr;yi(o.type)&&(an=o.stateNode,pr=!1),Ga(i,s,o),xo(o.stateNode),an=h,pr=v;break;case 5:gn||da(o,s);case 6:if(h=an,v=pr,an=null,Ga(i,s,o),an=h,pr=v,an!==null)if(pr)try{(an.nodeType===9?an.body:an.nodeName==="HTML"?an.ownerDocument.body:an).removeChild(o.stateNode)}catch(T){Wt(o,s,T)}else try{an.removeChild(o.stateNode)}catch(T){Wt(o,s,T)}break;case 18:an!==null&&(pr?(i=an,hg(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,o.stateNode),wo(i)):hg(an,o.stateNode));break;case 4:h=an,v=pr,an=o.stateNode.containerInfo,pr=!0,Ga(i,s,o),an=h,pr=v;break;case 0:case 11:case 14:case 15:gn||fi(2,o,s),gn||fi(4,o,s),Ga(i,s,o);break;case 1:gn||(da(o,s),h=o.stateNode,typeof h.componentWillUnmount=="function"&&vx(o,s,h)),Ga(i,s,o);break;case 21:Ga(i,s,o);break;case 22:gn=(h=gn)||o.memoizedState!==null,Ga(i,s,o),gn=h;break;default:Ga(i,s,o)}}function Ax(i,s){if(s.memoizedState===null&&(i=s.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{wo(i)}catch(o){Wt(s,s.return,o)}}function IE(i){switch(i.tag){case 13:case 19:var s=i.stateNode;return s===null&&(s=i.stateNode=new Ex),s;case 22:return i=i.stateNode,s=i._retryCache,s===null&&(s=i._retryCache=new Ex),s;default:throw Error(r(435,i.tag))}}function U0(i,s){var o=IE(i);s.forEach(function(h){var v=GE.bind(null,i,h);o.has(h)||(o.add(h),h.then(v,v))})}function Er(i,s){var o=s.deletions;if(o!==null)for(var h=0;h<o.length;h++){var v=o[h],T=i,A=s,I=A;e:for(;I!==null;){switch(I.tag){case 27:if(yi(I.type)){an=I.stateNode,pr=!1;break e}break;case 5:an=I.stateNode,pr=!1;break e;case 3:case 4:an=I.stateNode.containerInfo,pr=!0;break e}I=I.return}if(an===null)throw Error(r(160));Cx(T,A,v),an=null,pr=!1,T=v.alternate,T!==null&&(T.return=null),v.return=null}if(s.subtreeFlags&13878)for(s=s.child;s!==null;)bx(s,i),s=s.sibling}var Zr=null;function bx(i,s){var o=i.alternate,h=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:Er(s,i),Sr(i),h&4&&(fi(3,i,i.return),io(3,i),fi(5,i,i.return));break;case 1:Er(s,i),Sr(i),h&512&&(gn||o===null||da(o,o.return)),h&64&&Ha&&(i=i.updateQueue,i!==null&&(h=i.callbacks,h!==null&&(o=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=o===null?h:o.concat(h))));break;case 26:var v=Zr;if(Er(s,i),Sr(i),h&512&&(gn||o===null||da(o,o.return)),h&4){var T=o!==null?o.memoizedState:null;if(h=i.memoizedState,o===null)if(h===null)if(i.stateNode===null){e:{h=i.type,o=i.memoizedProps,v=v.ownerDocument||v;t:switch(h){case"title":T=v.getElementsByTagName("title")[0],(!T||T[L]||T[tn]||T.namespaceURI==="http://www.w3.org/2000/svg"||T.hasAttribute("itemprop"))&&(T=v.createElement(h),v.head.insertBefore(T,v.querySelector("head > title"))),jn(T,h,o),T[tn]=i,oe(T),h=T;break e;case"link":var A=_g("link","href",v).get(h+(o.href||""));if(A){for(var I=0;I<A.length;I++)if(T=A[I],T.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&T.getAttribute("rel")===(o.rel==null?null:o.rel)&&T.getAttribute("title")===(o.title==null?null:o.title)&&T.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){A.splice(I,1);break t}}T=v.createElement(h),jn(T,h,o),v.head.appendChild(T);break;case"meta":if(A=_g("meta","content",v).get(h+(o.content||""))){for(I=0;I<A.length;I++)if(T=A[I],T.getAttribute("content")===(o.content==null?null:""+o.content)&&T.getAttribute("name")===(o.name==null?null:o.name)&&T.getAttribute("property")===(o.property==null?null:o.property)&&T.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&T.getAttribute("charset")===(o.charSet==null?null:o.charSet)){A.splice(I,1);break t}}T=v.createElement(h),jn(T,h,o),v.head.appendChild(T);break;default:throw Error(r(468,h))}T[tn]=i,oe(T),h=T}i.stateNode=h}else Eg(v,i.type,i.stateNode);else i.stateNode=Tg(v,h,i.memoizedProps);else T!==h?(T===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):T.count--,h===null?Eg(v,i.type,i.stateNode):Tg(v,h,i.memoizedProps)):h===null&&i.stateNode!==null&&F0(i,i.memoizedProps,o.memoizedProps)}break;case 27:Er(s,i),Sr(i),h&512&&(gn||o===null||da(o,o.return)),o!==null&&h&4&&F0(i,i.memoizedProps,o.memoizedProps);break;case 5:if(Er(s,i),Sr(i),h&512&&(gn||o===null||da(o,o.return)),i.flags&32){v=i.stateNode;try{As(v,"")}catch(ge){Wt(i,i.return,ge)}}h&4&&i.stateNode!=null&&(v=i.memoizedProps,F0(i,v,o!==null?o.memoizedProps:v)),h&1024&&(P0=!0);break;case 6:if(Er(s,i),Sr(i),h&4){if(i.stateNode===null)throw Error(r(162));h=i.memoizedProps,o=i.stateNode;try{o.nodeValue=h}catch(ge){Wt(i,i.return,ge)}}break;case 3:if(mu=null,v=Zr,Zr=du(s.containerInfo),Er(s,i),Zr=v,Sr(i),h&4&&o!==null&&o.memoizedState.isDehydrated)try{wo(s.containerInfo)}catch(ge){Wt(i,i.return,ge)}P0&&(P0=!1,kx(i));break;case 4:h=Zr,Zr=du(i.stateNode.containerInfo),Er(s,i),Sr(i),Zr=h;break;case 12:Er(s,i),Sr(i);break;case 13:Er(s,i),Sr(i),i.child.flags&8192&&i.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(z0=ve()),h&4&&(h=i.updateQueue,h!==null&&(i.updateQueue=null,U0(i,h)));break;case 22:v=i.memoizedState!==null;var Q=o!==null&&o.memoizedState!==null,fe=Ha,we=gn;if(Ha=fe||v,gn=we||Q,Er(s,i),gn=we,Ha=fe,Sr(i),h&8192)e:for(s=i.stateNode,s._visibility=v?s._visibility&-2:s._visibility|1,v&&(o===null||Q||Ha||gn||es(i)),o=null,s=i;;){if(s.tag===5||s.tag===26){if(o===null){Q=o=s;try{if(T=Q.stateNode,v)A=T.style,typeof A.setProperty=="function"?A.setProperty("display","none","important"):A.display="none";else{I=Q.stateNode;var Ne=Q.memoizedProps.style,pe=Ne!=null&&Ne.hasOwnProperty("display")?Ne.display:null;I.style.display=pe==null||typeof pe=="boolean"?"":(""+pe).trim()}}catch(ge){Wt(Q,Q.return,ge)}}}else if(s.tag===6){if(o===null){Q=s;try{Q.stateNode.nodeValue=v?"":Q.memoizedProps}catch(ge){Wt(Q,Q.return,ge)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===i)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;o===s&&(o=null),s=s.return}o===s&&(o=null),s.sibling.return=s.return,s=s.sibling}h&4&&(h=i.updateQueue,h!==null&&(o=h.retryQueue,o!==null&&(h.retryQueue=null,U0(i,o))));break;case 19:Er(s,i),Sr(i),h&4&&(h=i.updateQueue,h!==null&&(i.updateQueue=null,U0(i,h)));break;case 30:break;case 21:break;default:Er(s,i),Sr(i)}}function Sr(i){var s=i.flags;if(s&2){try{for(var o,h=i.return;h!==null;){if(Tx(h)){o=h;break}h=h.return}if(o==null)throw Error(r(160));switch(o.tag){case 27:var v=o.stateNode,T=L0(i);Qc(i,T,v);break;case 5:var A=o.stateNode;o.flags&32&&(As(A,""),o.flags&=-33);var I=L0(i);Qc(i,I,A);break;case 3:case 4:var Q=o.stateNode.containerInfo,fe=L0(i);O0(i,fe,Q);break;default:throw Error(r(161))}}catch(we){Wt(i,i.return,we)}i.flags&=-3}s&4096&&(i.flags&=-4097)}function kx(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var s=i;kx(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),i=i.sibling}}function di(i,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)Sx(i,s.alternate,s),s=s.sibling}function es(i){for(i=i.child;i!==null;){var s=i;switch(s.tag){case 0:case 11:case 14:case 15:fi(4,s,s.return),es(s);break;case 1:da(s,s.return);var o=s.stateNode;typeof o.componentWillUnmount=="function"&&vx(s,s.return,o),es(s);break;case 27:xo(s.stateNode);case 26:case 5:da(s,s.return),es(s);break;case 22:s.memoizedState===null&&es(s);break;case 30:es(s);break;default:es(s)}i=i.sibling}}function hi(i,s,o){for(o=o&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var h=s.alternate,v=i,T=s,A=T.flags;switch(T.tag){case 0:case 11:case 15:hi(v,T,o),io(4,T);break;case 1:if(hi(v,T,o),h=T,v=h.stateNode,typeof v.componentDidMount=="function")try{v.componentDidMount()}catch(fe){Wt(h,h.return,fe)}if(h=T,v=h.updateQueue,v!==null){var I=h.stateNode;try{var Q=v.shared.hiddenCallbacks;if(Q!==null)for(v.shared.hiddenCallbacks=null,v=0;v<Q.length;v++)rp(Q[v],I)}catch(fe){Wt(h,h.return,fe)}}o&&A&64&&gx(T),so(T,T.return);break;case 27:_x(T);case 26:case 5:hi(v,T,o),o&&h===null&&A&4&&yx(T),so(T,T.return);break;case 12:hi(v,T,o);break;case 13:hi(v,T,o),o&&A&4&&Ax(v,T);break;case 22:T.memoizedState===null&&hi(v,T,o),so(T,T.return);break;case 30:break;default:hi(v,T,o)}s=s.sibling}}function B0(i,s){var o=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(o=i.memoizedState.cachePool.pool),i=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(i=s.memoizedState.cachePool.pool),i!==o&&(i!=null&&i.refCount++,o!=null&&ql(o))}function V0(i,s){i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&ql(i))}function ha(i,s,o,h){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Nx(i,s,o,h),s=s.sibling}function Nx(i,s,o,h){var v=s.flags;switch(s.tag){case 0:case 11:case 15:ha(i,s,o,h),v&2048&&io(9,s);break;case 1:ha(i,s,o,h);break;case 3:ha(i,s,o,h),v&2048&&(i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&ql(i)));break;case 12:if(v&2048){ha(i,s,o,h),i=s.stateNode;try{var T=s.memoizedProps,A=T.id,I=T.onPostCommit;typeof I=="function"&&I(A,s.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(Q){Wt(s,s.return,Q)}}else ha(i,s,o,h);break;case 13:ha(i,s,o,h);break;case 23:break;case 22:T=s.stateNode,A=s.alternate,s.memoizedState!==null?T._visibility&2?ha(i,s,o,h):lo(i,s):T._visibility&2?ha(i,s,o,h):(T._visibility|=2,qs(i,s,o,h,(s.subtreeFlags&10256)!==0)),v&2048&&B0(A,s);break;case 24:ha(i,s,o,h),v&2048&&V0(s.alternate,s);break;default:ha(i,s,o,h)}}function qs(i,s,o,h,v){for(v=v&&(s.subtreeFlags&10256)!==0,s=s.child;s!==null;){var T=i,A=s,I=o,Q=h,fe=A.flags;switch(A.tag){case 0:case 11:case 15:qs(T,A,I,Q,v),io(8,A);break;case 23:break;case 22:var we=A.stateNode;A.memoizedState!==null?we._visibility&2?qs(T,A,I,Q,v):lo(T,A):(we._visibility|=2,qs(T,A,I,Q,v)),v&&fe&2048&&B0(A.alternate,A);break;case 24:qs(T,A,I,Q,v),v&&fe&2048&&V0(A.alternate,A);break;default:qs(T,A,I,Q,v)}s=s.sibling}}function lo(i,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var o=i,h=s,v=h.flags;switch(h.tag){case 22:lo(o,h),v&2048&&B0(h.alternate,h);break;case 24:lo(o,h),v&2048&&V0(h.alternate,h);break;default:lo(o,h)}s=s.sibling}}var oo=8192;function $s(i){if(i.subtreeFlags&oo)for(i=i.child;i!==null;)Mx(i),i=i.sibling}function Mx(i){switch(i.tag){case 26:$s(i),i.flags&oo&&i.memoizedState!==null&&vS(Zr,i.memoizedState,i.memoizedProps);break;case 5:$s(i);break;case 3:case 4:var s=Zr;Zr=du(i.stateNode.containerInfo),$s(i),Zr=s;break;case 22:i.memoizedState===null&&(s=i.alternate,s!==null&&s.memoizedState!==null?(s=oo,oo=16777216,$s(i),oo=s):$s(i));break;default:$s(i)}}function Rx(i){var s=i.alternate;if(s!==null&&(i=s.child,i!==null)){s.child=null;do s=i.sibling,i.sibling=null,i=s;while(i!==null)}}function co(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var o=0;o<s.length;o++){var h=s[o];Ln=h,Ix(h,i)}Rx(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Dx(i),i=i.sibling}function Dx(i){switch(i.tag){case 0:case 11:case 15:co(i),i.flags&2048&&fi(9,i,i.return);break;case 3:co(i);break;case 12:co(i);break;case 22:var s=i.stateNode;i.memoizedState!==null&&s._visibility&2&&(i.return===null||i.return.tag!==13)?(s._visibility&=-3,eu(i)):co(i);break;default:co(i)}}function eu(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var o=0;o<s.length;o++){var h=s[o];Ln=h,Ix(h,i)}Rx(i)}for(i=i.child;i!==null;){switch(s=i,s.tag){case 0:case 11:case 15:fi(8,s,s.return),eu(s);break;case 22:o=s.stateNode,o._visibility&2&&(o._visibility&=-3,eu(s));break;default:eu(s)}i=i.sibling}}function Ix(i,s){for(;Ln!==null;){var o=Ln;switch(o.tag){case 0:case 11:case 15:fi(8,o,s);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var h=o.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:ql(o.memoizedState.cache)}if(h=o.child,h!==null)h.return=o,Ln=h;else e:for(o=i;Ln!==null;){h=Ln;var v=h.sibling,T=h.return;if(wx(h),h===o){Ln=null;break e}if(v!==null){v.return=T,Ln=v;break e}Ln=T}}}var FE={getCacheForType:function(i){var s=Wn(bn),o=s.data.get(i);return o===void 0&&(o=i(),s.data.set(i,o)),o}},LE=typeof WeakMap=="function"?WeakMap:Map,Vt=0,Kt=null,yt=null,At=0,Ht=0,wr=null,mi=!1,Ys=!1,H0=!1,ja=0,hn=0,pi=0,ts=0,G0=0,Br=0,Ws=0,uo=null,xr=null,j0=!1,z0=0,tu=1/0,nu=null,xi=null,Gn=0,gi=null,Js=null,Xs=0,q0=0,$0=null,Fx=null,fo=0,Y0=null;function Cr(){if((Vt&2)!==0&&At!==0)return At&-At;if(ae.T!==null){var i=Ps;return i!==0?i:ed()}return Dr()}function Lx(){Br===0&&(Br=(At&536870912)===0||Bt?Aa():536870912);var i=Ur.current;return i!==null&&(i.flags|=32),Br}function Ar(i,s,o){(i===Kt&&(Ht===2||Ht===9)||i.cancelPendingCommit!==null)&&(Ks(i,0),vi(i,At,Br,!1)),Pe(i,o),((Vt&2)===0||i!==Kt)&&(i===Kt&&((Vt&2)===0&&(ts|=o),hn===4&&vi(i,At,Br,!1)),ma(i))}function Ox(i,s,o){if((Vt&6)!==0)throw Error(r(327));var h=!o&&(s&124)===0&&(s&i.expiredLanes)===0||Rr(i,s),v=h?UE(i,s):X0(i,s,!0),T=h;do{if(v===0){Ys&&!h&&vi(i,s,0,!1);break}else{if(o=i.current.alternate,T&&!OE(o)){v=X0(i,s,!1),T=!1;continue}if(v===2){if(T=s,i.errorRecoveryDisabledLanes&T)var A=0;else A=i.pendingLanes&-536870913,A=A!==0?A:A&536870912?536870912:0;if(A!==0){s=A;e:{var I=i;v=uo;var Q=I.current.memoizedState.isDehydrated;if(Q&&(Ks(I,A).flags|=256),A=X0(I,A,!1),A!==2){if(H0&&!Q){I.errorRecoveryDisabledLanes|=T,ts|=T,v=4;break e}T=xr,xr=v,T!==null&&(xr===null?xr=T:xr.push.apply(xr,T))}v=A}if(T=!1,v!==2)continue}}if(v===1){Ks(i,0),vi(i,s,0,!0);break}e:{switch(h=i,T=v,T){case 0:case 1:throw Error(r(345));case 4:if((s&4194048)!==s)break;case 6:vi(h,s,Br,!mi);break e;case 2:xr=null;break;case 3:case 5:break;default:throw Error(r(329))}if((s&62914560)===s&&(v=z0+300-ve(),10<v)){if(vi(h,s,Br,!mi),Jr(h,0,!0)!==0)break e;h.timeoutHandle=fg(Px.bind(null,h,o,xr,nu,j0,s,Br,ts,Ws,mi,T,2,-0,0),v);break e}Px(h,o,xr,nu,j0,s,Br,ts,Ws,mi,T,0,-0,0)}}break}while(!0);ma(i)}function Px(i,s,o,h,v,T,A,I,Q,fe,we,Ne,pe,ge){if(i.timeoutHandle=-1,Ne=s.subtreeFlags,(Ne&8192||(Ne&16785408)===16785408)&&(yo={stylesheets:null,count:0,unsuspend:gS},Mx(s),Ne=yS(),Ne!==null)){i.cancelPendingCommit=Ne(zx.bind(null,i,s,T,o,h,v,A,I,Q,we,1,pe,ge)),vi(i,T,A,!fe);return}zx(i,s,T,o,h,v,A,I,Q)}function OE(i){for(var s=i;;){var o=s.tag;if((o===0||o===11||o===15)&&s.flags&16384&&(o=s.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var h=0;h<o.length;h++){var v=o[h],T=v.getSnapshot;v=v.value;try{if(!Tr(T(),v))return!1}catch{return!1}}if(o=s.child,s.subtreeFlags&16384&&o!==null)o.return=s,s=o;else{if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function vi(i,s,o,h){s&=~G0,s&=~ts,i.suspendedLanes|=s,i.pingedLanes&=~s,h&&(i.warmLanes|=s),h=i.expirationTimes;for(var v=s;0<v;){var T=31-at(v),A=1<<T;h[T]=-1,v&=~A}o!==0&&gt(i,o,s)}function ru(){return(Vt&6)===0?(ho(0),!1):!0}function W0(){if(yt!==null){if(Ht===0)var i=yt.return;else i=yt,La=Ji=null,f0(i),js=null,no=0,i=yt;for(;i!==null;)xx(i.alternate,i),i=i.return;yt=null}}function Ks(i,s){var o=i.timeoutHandle;o!==-1&&(i.timeoutHandle=-1,eS(o)),o=i.cancelPendingCommit,o!==null&&(i.cancelPendingCommit=null,o()),W0(),Kt=i,yt=o=Da(i.current,null),At=s,Ht=0,wr=null,mi=!1,Ys=Rr(i,s),H0=!1,Ws=Br=G0=ts=pi=hn=0,xr=uo=null,j0=!1,(s&8)!==0&&(s|=s&32);var h=i.entangledLanes;if(h!==0)for(i=i.entanglements,h&=s;0<h;){var v=31-at(h),T=1<<v;s|=i[v],h&=~T}return ja=s,Cc(),o}function Ux(i,s){mt=null,ae.H=zc,s===Yl||s===Fc?(s=tp(),Ht=3):s===Zm?(s=tp(),Ht=4):Ht=s===nx?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,wr=s,yt===null&&(hn=1,Jc(i,Fr(s,i.current)))}function Bx(){var i=ae.H;return ae.H=zc,i===null?zc:i}function Vx(){var i=ae.A;return ae.A=FE,i}function J0(){hn=4,mi||(At&4194048)!==At&&Ur.current!==null||(Ys=!0),(pi&134217727)===0&&(ts&134217727)===0||Kt===null||vi(Kt,At,Br,!1)}function X0(i,s,o){var h=Vt;Vt|=2;var v=Bx(),T=Vx();(Kt!==i||At!==s)&&(nu=null,Ks(i,s)),s=!1;var A=hn;e:do try{if(Ht!==0&&yt!==null){var I=yt,Q=wr;switch(Ht){case 8:W0(),A=6;break e;case 3:case 2:case 9:case 6:Ur.current===null&&(s=!0);var fe=Ht;if(Ht=0,wr=null,Zs(i,I,Q,fe),o&&Ys){A=0;break e}break;default:fe=Ht,Ht=0,wr=null,Zs(i,I,Q,fe)}}PE(),A=hn;break}catch(we){Ux(i,we)}while(!0);return s&&i.shellSuspendCounter++,La=Ji=null,Vt=h,ae.H=v,ae.A=T,yt===null&&(Kt=null,At=0,Cc()),A}function PE(){for(;yt!==null;)Hx(yt)}function UE(i,s){var o=Vt;Vt|=2;var h=Bx(),v=Vx();Kt!==i||At!==s?(nu=null,tu=ve()+500,Ks(i,s)):Ys=Rr(i,s);e:do try{if(Ht!==0&&yt!==null){s=yt;var T=wr;t:switch(Ht){case 1:Ht=0,wr=null,Zs(i,s,T,1);break;case 2:case 9:if(Qm(T)){Ht=0,wr=null,Gx(s);break}s=function(){Ht!==2&&Ht!==9||Kt!==i||(Ht=7),ma(i)},T.then(s,s);break e;case 3:Ht=7;break e;case 4:Ht=5;break e;case 7:Qm(T)?(Ht=0,wr=null,Gx(s)):(Ht=0,wr=null,Zs(i,s,T,7));break;case 5:var A=null;switch(yt.tag){case 26:A=yt.memoizedState;case 5:case 27:var I=yt;if(!A||Sg(A)){Ht=0,wr=null;var Q=I.sibling;if(Q!==null)yt=Q;else{var fe=I.return;fe!==null?(yt=fe,au(fe)):yt=null}break t}}Ht=0,wr=null,Zs(i,s,T,5);break;case 6:Ht=0,wr=null,Zs(i,s,T,6);break;case 8:W0(),hn=6;break e;default:throw Error(r(462))}}BE();break}catch(we){Ux(i,we)}while(!0);return La=Ji=null,ae.H=h,ae.A=v,Vt=o,yt!==null?0:(Kt=null,At=0,Cc(),hn)}function BE(){for(;yt!==null&&!pt();)Hx(yt)}function Hx(i){var s=mx(i.alternate,i,ja);i.memoizedProps=i.pendingProps,s===null?au(i):yt=s}function Gx(i){var s=i,o=s.alternate;switch(s.tag){case 15:case 0:s=ox(o,s,s.pendingProps,s.type,void 0,At);break;case 11:s=ox(o,s,s.pendingProps,s.type.render,s.ref,At);break;case 5:f0(s);default:xx(o,s),s=yt=jm(s,ja),s=mx(o,s,ja)}i.memoizedProps=i.pendingProps,s===null?au(i):yt=s}function Zs(i,s,o,h){La=Ji=null,f0(s),js=null,no=0;var v=s.return;try{if(kE(i,v,s,o,At)){hn=1,Jc(i,Fr(o,i.current)),yt=null;return}}catch(T){if(v!==null)throw yt=v,T;hn=1,Jc(i,Fr(o,i.current)),yt=null;return}s.flags&32768?(Bt||h===1?i=!0:Ys||(At&536870912)!==0?i=!1:(mi=i=!0,(h===2||h===9||h===3||h===6)&&(h=Ur.current,h!==null&&h.tag===13&&(h.flags|=16384))),jx(s,i)):au(s)}function au(i){var s=i;do{if((s.flags&32768)!==0){jx(s,mi);return}i=s.return;var o=ME(s.alternate,s,ja);if(o!==null){yt=o;return}if(s=s.sibling,s!==null){yt=s;return}yt=s=i}while(s!==null);hn===0&&(hn=5)}function jx(i,s){do{var o=RE(i.alternate,i);if(o!==null){o.flags&=32767,yt=o;return}if(o=i.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!s&&(i=i.sibling,i!==null)){yt=i;return}yt=i=o}while(i!==null);hn=6,yt=null}function zx(i,s,o,h,v,T,A,I,Q){i.cancelPendingCommit=null;do iu();while(Gn!==0);if((Vt&6)!==0)throw Error(r(327));if(s!==null){if(s===i.current)throw Error(r(177));if(T=s.lanes|s.childLanes,T|=Vf,st(i,o,T,A,I,Q),i===Kt&&(yt=Kt=null,At=0),Js=s,gi=i,Xs=o,q0=T,$0=v,Fx=h,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,jE(Ct,function(){return Jx(),null})):(i.callbackNode=null,i.callbackPriority=0),h=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||h){h=ae.T,ae.T=null,v=de.p,de.p=2,A=Vt,Vt|=4;try{DE(i,s,o)}finally{Vt=A,de.p=v,ae.T=h}}Gn=1,qx(),$x(),Yx()}}function qx(){if(Gn===1){Gn=0;var i=gi,s=Js,o=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||o){o=ae.T,ae.T=null;var h=de.p;de.p=2;var v=Vt;Vt|=4;try{bx(s,i);var T=od,A=Im(i.containerInfo),I=T.focusedElem,Q=T.selectionRange;if(A!==I&&I&&I.ownerDocument&&Dm(I.ownerDocument.documentElement,I)){if(Q!==null&&Lf(I)){var fe=Q.start,we=Q.end;if(we===void 0&&(we=fe),"selectionStart"in I)I.selectionStart=fe,I.selectionEnd=Math.min(we,I.value.length);else{var Ne=I.ownerDocument||document,pe=Ne&&Ne.defaultView||window;if(pe.getSelection){var ge=pe.getSelection(),et=I.textContent.length,Ze=Math.min(Q.start,et),$t=Q.end===void 0?Ze:Math.min(Q.end,et);!ge.extend&&Ze>$t&&(A=$t,$t=Ze,Ze=A);var le=Rm(I,Ze),ie=Rm(I,$t);if(le&&ie&&(ge.rangeCount!==1||ge.anchorNode!==le.node||ge.anchorOffset!==le.offset||ge.focusNode!==ie.node||ge.focusOffset!==ie.offset)){var ce=Ne.createRange();ce.setStart(le.node,le.offset),ge.removeAllRanges(),Ze>$t?(ge.addRange(ce),ge.extend(ie.node,ie.offset)):(ce.setEnd(ie.node,ie.offset),ge.addRange(ce))}}}}for(Ne=[],ge=I;ge=ge.parentNode;)ge.nodeType===1&&Ne.push({element:ge,left:ge.scrollLeft,top:ge.scrollTop});for(typeof I.focus=="function"&&I.focus(),I=0;I<Ne.length;I++){var be=Ne[I];be.element.scrollLeft=be.left,be.element.scrollTop=be.top}}gu=!!ld,od=ld=null}finally{Vt=v,de.p=h,ae.T=o}}i.current=s,Gn=2}}function $x(){if(Gn===2){Gn=0;var i=gi,s=Js,o=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||o){o=ae.T,ae.T=null;var h=de.p;de.p=2;var v=Vt;Vt|=4;try{Sx(i,s.alternate,s)}finally{Vt=v,de.p=h,ae.T=o}}Gn=3}}function Yx(){if(Gn===4||Gn===3){Gn=0,Me();var i=gi,s=Js,o=Xs,h=Fx;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?Gn=5:(Gn=0,Js=gi=null,Wx(i,i.pendingLanes));var v=i.pendingLanes;if(v===0&&(xi=null),Cn(o),s=s.stateNode,Xt&&typeof Xt.onCommitFiberRoot=="function")try{Xt.onCommitFiberRoot(Jt,s,void 0,(s.current.flags&128)===128)}catch{}if(h!==null){s=ae.T,v=de.p,de.p=2,ae.T=null;try{for(var T=i.onRecoverableError,A=0;A<h.length;A++){var I=h[A];T(I.value,{componentStack:I.stack})}}finally{ae.T=s,de.p=v}}(Xs&3)!==0&&iu(),ma(i),v=i.pendingLanes,(o&4194090)!==0&&(v&42)!==0?i===Y0?fo++:(fo=0,Y0=i):fo=0,ho(0)}}function Wx(i,s){(i.pooledCacheLanes&=s)===0&&(s=i.pooledCache,s!=null&&(i.pooledCache=null,ql(s)))}function iu(i){return qx(),$x(),Yx(),Jx()}function Jx(){if(Gn!==5)return!1;var i=gi,s=q0;q0=0;var o=Cn(Xs),h=ae.T,v=de.p;try{de.p=32>o?32:o,ae.T=null,o=$0,$0=null;var T=gi,A=Xs;if(Gn=0,Js=gi=null,Xs=0,(Vt&6)!==0)throw Error(r(331));var I=Vt;if(Vt|=4,Dx(T.current),Nx(T,T.current,A,o),Vt=I,ho(0,!1),Xt&&typeof Xt.onPostCommitFiberRoot=="function")try{Xt.onPostCommitFiberRoot(Jt,T)}catch{}return!0}finally{de.p=v,ae.T=h,Wx(i,s)}}function Xx(i,s,o){s=Fr(o,s),s=C0(i.stateNode,s,2),i=li(i,s,2),i!==null&&(Pe(i,2),ma(i))}function Wt(i,s,o){if(i.tag===3)Xx(i,i,o);else for(;s!==null;){if(s.tag===3){Xx(s,i,o);break}else if(s.tag===1){var h=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(xi===null||!xi.has(h))){i=Fr(o,i),o=ex(2),h=li(s,o,2),h!==null&&(tx(o,h,s,i),Pe(h,2),ma(h));break}}s=s.return}}function K0(i,s,o){var h=i.pingCache;if(h===null){h=i.pingCache=new LE;var v=new Set;h.set(s,v)}else v=h.get(s),v===void 0&&(v=new Set,h.set(s,v));v.has(o)||(H0=!0,v.add(o),i=VE.bind(null,i,s,o),s.then(i,i))}function VE(i,s,o){var h=i.pingCache;h!==null&&h.delete(s),i.pingedLanes|=i.suspendedLanes&o,i.warmLanes&=~o,Kt===i&&(At&o)===o&&(hn===4||hn===3&&(At&62914560)===At&&300>ve()-z0?(Vt&2)===0&&Ks(i,0):G0|=o,Ws===At&&(Ws=0)),ma(i)}function Kx(i,s){s===0&&(s=ba()),i=Is(i,s),i!==null&&(Pe(i,s),ma(i))}function HE(i){var s=i.memoizedState,o=0;s!==null&&(o=s.retryLane),Kx(i,o)}function GE(i,s){var o=0;switch(i.tag){case 13:var h=i.stateNode,v=i.memoizedState;v!==null&&(o=v.retryLane);break;case 19:h=i.stateNode;break;case 22:h=i.stateNode._retryCache;break;default:throw Error(r(314))}h!==null&&h.delete(s),Kx(i,o)}function jE(i,s){return ut(i,s)}var su=null,Qs=null,Z0=!1,lu=!1,Q0=!1,ns=0;function ma(i){i!==Qs&&i.next===null&&(Qs===null?su=Qs=i:Qs=Qs.next=i),lu=!0,Z0||(Z0=!0,qE())}function ho(i,s){if(!Q0&&lu){Q0=!0;do for(var o=!1,h=su;h!==null;){if(i!==0){var v=h.pendingLanes;if(v===0)var T=0;else{var A=h.suspendedLanes,I=h.pingedLanes;T=(1<<31-at(42|i)+1)-1,T&=v&~(A&~I),T=T&201326741?T&201326741|1:T?T|2:0}T!==0&&(o=!0,tg(h,T))}else T=At,T=Jr(h,h===Kt?T:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(T&3)===0||Rr(h,T)||(o=!0,tg(h,T));h=h.next}while(o);Q0=!1}}function zE(){Zx()}function Zx(){lu=Z0=!1;var i=0;ns!==0&&(QE()&&(i=ns),ns=0);for(var s=ve(),o=null,h=su;h!==null;){var v=h.next,T=Qx(h,s);T===0?(h.next=null,o===null?su=v:o.next=v,v===null&&(Qs=o)):(o=h,(i!==0||(T&3)!==0)&&(lu=!0)),h=v}ho(i)}function Qx(i,s){for(var o=i.suspendedLanes,h=i.pingedLanes,v=i.expirationTimes,T=i.pendingLanes&-62914561;0<T;){var A=31-at(T),I=1<<A,Q=v[A];Q===-1?((I&o)===0||(I&h)!==0)&&(v[A]=ti(I,s)):Q<=s&&(i.expiredLanes|=I),T&=~I}if(s=Kt,o=At,o=Jr(i,i===s?o:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),h=i.callbackNode,o===0||i===s&&(Ht===2||Ht===9)||i.cancelPendingCommit!==null)return h!==null&&h!==null&&Ke(h),i.callbackNode=null,i.callbackPriority=0;if((o&3)===0||Rr(i,o)){if(s=o&-o,s===i.callbackPriority)return s;switch(h!==null&&Ke(h),Cn(o)){case 2:case 8:o=Pt;break;case 32:o=Ct;break;case 268435456:o=dt;break;default:o=Ct}return h=eg.bind(null,i),o=ut(o,h),i.callbackPriority=s,i.callbackNode=o,s}return h!==null&&h!==null&&Ke(h),i.callbackPriority=2,i.callbackNode=null,2}function eg(i,s){if(Gn!==0&&Gn!==5)return i.callbackNode=null,i.callbackPriority=0,null;var o=i.callbackNode;if(iu()&&i.callbackNode!==o)return null;var h=At;return h=Jr(i,i===Kt?h:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),h===0?null:(Ox(i,h,s),Qx(i,ve()),i.callbackNode!=null&&i.callbackNode===o?eg.bind(null,i):null)}function tg(i,s){if(iu())return null;Ox(i,s,!0)}function qE(){tS(function(){(Vt&6)!==0?ut(je,zE):Zx()})}function ed(){return ns===0&&(ns=Aa()),ns}function ng(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:vc(""+i)}function rg(i,s){var o=s.ownerDocument.createElement("input");return o.name=s.name,o.value=s.value,i.id&&o.setAttribute("form",i.id),s.parentNode.insertBefore(o,s),i=new FormData(i),o.parentNode.removeChild(o),i}function $E(i,s,o,h,v){if(s==="submit"&&o&&o.stateNode===v){var T=ng((v[nn]||null).action),A=h.submitter;A&&(s=(s=A[nn]||null)?ng(s.formAction):A.getAttribute("formAction"),s!==null&&(T=s,A=null));var I=new Ec("action","action",null,h,v);i.push({event:I,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(ns!==0){var Q=A?rg(v,A):new FormData(v);T0(o,{pending:!0,data:Q,method:v.method,action:T},null,Q)}}else typeof T=="function"&&(I.preventDefault(),Q=A?rg(v,A):new FormData(v),T0(o,{pending:!0,data:Q,method:v.method,action:T},T,Q))},currentTarget:v}]})}}for(var td=0;td<Bf.length;td++){var nd=Bf[td],YE=nd.toLowerCase(),WE=nd[0].toUpperCase()+nd.slice(1);Kr(YE,"on"+WE)}Kr(Om,"onAnimationEnd"),Kr(Pm,"onAnimationIteration"),Kr(Um,"onAnimationStart"),Kr("dblclick","onDoubleClick"),Kr("focusin","onFocus"),Kr("focusout","onBlur"),Kr(fE,"onTransitionRun"),Kr(dE,"onTransitionStart"),Kr(hE,"onTransitionCancel"),Kr(Bm,"onTransitionEnd"),Oe("onMouseEnter",["mouseout","mouseover"]),Oe("onMouseLeave",["mouseout","mouseover"]),Oe("onPointerEnter",["pointerout","pointerover"]),Oe("onPointerLeave",["pointerout","pointerover"]),De("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),De("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),De("onBeforeInput",["compositionend","keypress","textInput","paste"]),De("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),De("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),De("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var mo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),JE=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(mo));function ag(i,s){s=(s&4)!==0;for(var o=0;o<i.length;o++){var h=i[o],v=h.event;h=h.listeners;e:{var T=void 0;if(s)for(var A=h.length-1;0<=A;A--){var I=h[A],Q=I.instance,fe=I.currentTarget;if(I=I.listener,Q!==T&&v.isPropagationStopped())break e;T=I,v.currentTarget=fe;try{T(v)}catch(we){Wc(we)}v.currentTarget=null,T=Q}else for(A=0;A<h.length;A++){if(I=h[A],Q=I.instance,fe=I.currentTarget,I=I.listener,Q!==T&&v.isPropagationStopped())break e;T=I,v.currentTarget=fe;try{T(v)}catch(we){Wc(we)}v.currentTarget=null,T=Q}}}}function Tt(i,s){var o=s[Mt];o===void 0&&(o=s[Mt]=new Set);var h=i+"__bubble";o.has(h)||(ig(s,i,2,!1),o.add(h))}function rd(i,s,o){var h=0;s&&(h|=4),ig(o,i,h,s)}var ou="_reactListening"+Math.random().toString(36).slice(2);function ad(i){if(!i[ou]){i[ou]=!0,me.forEach(function(o){o!=="selectionchange"&&(JE.has(o)||rd(o,!1,i),rd(o,!0,i))});var s=i.nodeType===9?i:i.ownerDocument;s===null||s[ou]||(s[ou]=!0,rd("selectionchange",!1,s))}}function ig(i,s,o,h){switch(Ng(s)){case 2:var v=ES;break;case 8:v=SS;break;default:v=vd}o=v.bind(null,s,o,i),v=void 0,!Af||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(v=!0),h?v!==void 0?i.addEventListener(s,o,{capture:!0,passive:v}):i.addEventListener(s,o,!0):v!==void 0?i.addEventListener(s,o,{passive:v}):i.addEventListener(s,o,!1)}function id(i,s,o,h,v){var T=h;if((s&1)===0&&(s&2)===0&&h!==null)e:for(;;){if(h===null)return;var A=h.tag;if(A===3||A===4){var I=h.stateNode.containerInfo;if(I===v)break;if(A===4)for(A=h.return;A!==null;){var Q=A.tag;if((Q===3||Q===4)&&A.stateNode.containerInfo===v)return;A=A.return}for(;I!==null;){if(A=B(I),A===null)return;if(Q=A.tag,Q===5||Q===6||Q===26||Q===27){h=T=A;continue e}I=I.parentNode}}h=h.return}dm(function(){var fe=T,we=wf(o),Ne=[];e:{var pe=Vm.get(i);if(pe!==void 0){var ge=Ec,et=i;switch(i){case"keypress":if(Tc(o)===0)break e;case"keydown":case"keyup":ge=j_;break;case"focusin":et="focus",ge=Mf;break;case"focusout":et="blur",ge=Mf;break;case"beforeblur":case"afterblur":ge=Mf;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ge=pm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ge=R_;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ge=$_;break;case Om:case Pm:case Um:ge=F_;break;case Bm:ge=W_;break;case"scroll":case"scrollend":ge=N_;break;case"wheel":ge=X_;break;case"copy":case"cut":case"paste":ge=O_;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ge=gm;break;case"toggle":case"beforetoggle":ge=Z_}var Ze=(s&4)!==0,$t=!Ze&&(i==="scroll"||i==="scrollend"),le=Ze?pe!==null?pe+"Capture":null:pe;Ze=[];for(var ie=fe,ce;ie!==null;){var be=ie;if(ce=be.stateNode,be=be.tag,be!==5&&be!==26&&be!==27||ce===null||le===null||(be=Dl(ie,le),be!=null&&Ze.push(po(ie,be,ce))),$t)break;ie=ie.return}0<Ze.length&&(pe=new ge(pe,et,null,o,we),Ne.push({event:pe,listeners:Ze}))}}if((s&7)===0){e:{if(pe=i==="mouseover"||i==="pointerover",ge=i==="mouseout"||i==="pointerout",pe&&o!==Sf&&(et=o.relatedTarget||o.fromElement)&&(B(et)||et[dr]))break e;if((ge||pe)&&(pe=we.window===we?we:(pe=we.ownerDocument)?pe.defaultView||pe.parentWindow:window,ge?(et=o.relatedTarget||o.toElement,ge=fe,et=et?B(et):null,et!==null&&($t=l(et),Ze=et.tag,et!==$t||Ze!==5&&Ze!==27&&Ze!==6)&&(et=null)):(ge=null,et=fe),ge!==et)){if(Ze=pm,be="onMouseLeave",le="onMouseEnter",ie="mouse",(i==="pointerout"||i==="pointerover")&&(Ze=gm,be="onPointerLeave",le="onPointerEnter",ie="pointer"),$t=ge==null?pe:ue(ge),ce=et==null?pe:ue(et),pe=new Ze(be,ie+"leave",ge,o,we),pe.target=$t,pe.relatedTarget=ce,be=null,B(we)===fe&&(Ze=new Ze(le,ie+"enter",et,o,we),Ze.target=ce,Ze.relatedTarget=$t,be=Ze),$t=be,ge&&et)t:{for(Ze=ge,le=et,ie=0,ce=Ze;ce;ce=el(ce))ie++;for(ce=0,be=le;be;be=el(be))ce++;for(;0<ie-ce;)Ze=el(Ze),ie--;for(;0<ce-ie;)le=el(le),ce--;for(;ie--;){if(Ze===le||le!==null&&Ze===le.alternate)break t;Ze=el(Ze),le=el(le)}Ze=null}else Ze=null;ge!==null&&sg(Ne,pe,ge,Ze,!1),et!==null&&$t!==null&&sg(Ne,$t,et,Ze,!0)}}e:{if(pe=fe?ue(fe):window,ge=pe.nodeName&&pe.nodeName.toLowerCase(),ge==="select"||ge==="input"&&pe.type==="file")var qe=Cm;else if(Sm(pe))if(Am)qe=oE;else{qe=sE;var xt=iE}else ge=pe.nodeName,!ge||ge.toLowerCase()!=="input"||pe.type!=="checkbox"&&pe.type!=="radio"?fe&&Ef(fe.elementType)&&(qe=Cm):qe=lE;if(qe&&(qe=qe(i,fe))){wm(Ne,qe,o,we);break e}xt&&xt(i,pe,fe),i==="focusout"&&fe&&pe.type==="number"&&fe.memoizedProps.value!=null&&Xr(pe,"number",pe.value)}switch(xt=fe?ue(fe):window,i){case"focusin":(Sm(xt)||xt.contentEditable==="true")&&(Ms=xt,Of=fe,Vl=null);break;case"focusout":Vl=Of=Ms=null;break;case"mousedown":Pf=!0;break;case"contextmenu":case"mouseup":case"dragend":Pf=!1,Fm(Ne,o,we);break;case"selectionchange":if(uE)break;case"keydown":case"keyup":Fm(Ne,o,we)}var Je;if(Df)e:{switch(i){case"compositionstart":var Qe="onCompositionStart";break e;case"compositionend":Qe="onCompositionEnd";break e;case"compositionupdate":Qe="onCompositionUpdate";break e}Qe=void 0}else Ns?_m(i,o)&&(Qe="onCompositionEnd"):i==="keydown"&&o.keyCode===229&&(Qe="onCompositionStart");Qe&&(vm&&o.locale!=="ko"&&(Ns||Qe!=="onCompositionStart"?Qe==="onCompositionEnd"&&Ns&&(Je=hm()):(ri=we,bf="value"in ri?ri.value:ri.textContent,Ns=!0)),xt=cu(fe,Qe),0<xt.length&&(Qe=new xm(Qe,i,null,o,we),Ne.push({event:Qe,listeners:xt}),Je?Qe.data=Je:(Je=Em(o),Je!==null&&(Qe.data=Je)))),(Je=eE?tE(i,o):nE(i,o))&&(Qe=cu(fe,"onBeforeInput"),0<Qe.length&&(xt=new xm("onBeforeInput","beforeinput",null,o,we),Ne.push({event:xt,listeners:Qe}),xt.data=Je)),$E(Ne,i,fe,o,we)}ag(Ne,s)})}function po(i,s,o){return{instance:i,listener:s,currentTarget:o}}function cu(i,s){for(var o=s+"Capture",h=[];i!==null;){var v=i,T=v.stateNode;if(v=v.tag,v!==5&&v!==26&&v!==27||T===null||(v=Dl(i,o),v!=null&&h.unshift(po(i,v,T)),v=Dl(i,s),v!=null&&h.push(po(i,v,T))),i.tag===3)return h;i=i.return}return[]}function el(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function sg(i,s,o,h,v){for(var T=s._reactName,A=[];o!==null&&o!==h;){var I=o,Q=I.alternate,fe=I.stateNode;if(I=I.tag,Q!==null&&Q===h)break;I!==5&&I!==26&&I!==27||fe===null||(Q=fe,v?(fe=Dl(o,T),fe!=null&&A.unshift(po(o,fe,Q))):v||(fe=Dl(o,T),fe!=null&&A.push(po(o,fe,Q)))),o=o.return}A.length!==0&&i.push({event:s,listeners:A})}var XE=/\r\n?/g,KE=/\u0000|\uFFFD/g;function lg(i){return(typeof i=="string"?i:""+i).replace(XE,`
`).replace(KE,"")}function og(i,s){return s=lg(s),lg(i)===s}function uu(){}function qt(i,s,o,h,v,T){switch(o){case"children":typeof h=="string"?s==="body"||s==="textarea"&&h===""||As(i,h):(typeof h=="number"||typeof h=="bigint")&&s!=="body"&&As(i,""+h);break;case"className":Ue(i,"class",h);break;case"tabIndex":Ue(i,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":Ue(i,o,h);break;case"style":um(i,h,T);break;case"data":if(s!=="object"){Ue(i,"data",h);break}case"src":case"href":if(h===""&&(s!=="a"||o!=="href")){i.removeAttribute(o);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){i.removeAttribute(o);break}h=vc(""+h),i.setAttribute(o,h);break;case"action":case"formAction":if(typeof h=="function"){i.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof T=="function"&&(o==="formAction"?(s!=="input"&&qt(i,s,"name",v.name,v,null),qt(i,s,"formEncType",v.formEncType,v,null),qt(i,s,"formMethod",v.formMethod,v,null),qt(i,s,"formTarget",v.formTarget,v,null)):(qt(i,s,"encType",v.encType,v,null),qt(i,s,"method",v.method,v,null),qt(i,s,"target",v.target,v,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){i.removeAttribute(o);break}h=vc(""+h),i.setAttribute(o,h);break;case"onClick":h!=null&&(i.onclick=uu);break;case"onScroll":h!=null&&Tt("scroll",i);break;case"onScrollEnd":h!=null&&Tt("scrollend",i);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(r(61));if(o=h.__html,o!=null){if(v.children!=null)throw Error(r(60));i.innerHTML=o}}break;case"multiple":i.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":i.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){i.removeAttribute("xlink:href");break}o=vc(""+h),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?i.setAttribute(o,""+h):i.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?i.setAttribute(o,""):i.removeAttribute(o);break;case"capture":case"download":h===!0?i.setAttribute(o,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?i.setAttribute(o,h):i.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?i.setAttribute(o,h):i.removeAttribute(o);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?i.removeAttribute(o):i.setAttribute(o,h);break;case"popover":Tt("beforetoggle",i),Tt("toggle",i),ke(i,"popover",h);break;case"xlinkActuate":ze(i,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":ze(i,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":ze(i,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":ze(i,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":ze(i,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":ze(i,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":ze(i,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":ze(i,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":ze(i,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":ke(i,"is",h);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=b_.get(o)||o,ke(i,o,h))}}function sd(i,s,o,h,v,T){switch(o){case"style":um(i,h,T);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(r(61));if(o=h.__html,o!=null){if(v.children!=null)throw Error(r(60));i.innerHTML=o}}break;case"children":typeof h=="string"?As(i,h):(typeof h=="number"||typeof h=="bigint")&&As(i,""+h);break;case"onScroll":h!=null&&Tt("scroll",i);break;case"onScrollEnd":h!=null&&Tt("scrollend",i);break;case"onClick":h!=null&&(i.onclick=uu);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!xe.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(v=o.endsWith("Capture"),s=o.slice(2,v?o.length-7:void 0),T=i[nn]||null,T=T!=null?T[o]:null,typeof T=="function"&&i.removeEventListener(s,T,v),typeof h=="function")){typeof T!="function"&&T!==null&&(o in i?i[o]=null:i.hasAttribute(o)&&i.removeAttribute(o)),i.addEventListener(s,h,v);break e}o in i?i[o]=h:h===!0?i.setAttribute(o,""):ke(i,o,h)}}}function jn(i,s,o){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Tt("error",i),Tt("load",i);var h=!1,v=!1,T;for(T in o)if(o.hasOwnProperty(T)){var A=o[T];if(A!=null)switch(T){case"src":h=!0;break;case"srcSet":v=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,s));default:qt(i,s,T,A,o,null)}}v&&qt(i,s,"srcSet",o.srcSet,o,null),h&&qt(i,s,"src",o.src,o,null);return;case"input":Tt("invalid",i);var I=T=A=v=null,Q=null,fe=null;for(h in o)if(o.hasOwnProperty(h)){var we=o[h];if(we!=null)switch(h){case"name":v=we;break;case"type":A=we;break;case"checked":Q=we;break;case"defaultChecked":fe=we;break;case"value":T=we;break;case"defaultValue":I=we;break;case"children":case"dangerouslySetInnerHTML":if(we!=null)throw Error(r(137,s));break;default:qt(i,s,h,we,o,null)}}Vi(i,T,I,Q,fe,A,v,!1),ni(i);return;case"select":Tt("invalid",i),h=A=T=null;for(v in o)if(o.hasOwnProperty(v)&&(I=o[v],I!=null))switch(v){case"value":T=I;break;case"defaultValue":A=I;break;case"multiple":h=I;default:qt(i,s,v,I,o,null)}s=T,o=A,i.multiple=!!h,s!=null?yr(i,!!h,s,!1):o!=null&&yr(i,!!h,o,!0);return;case"textarea":Tt("invalid",i),T=v=h=null;for(A in o)if(o.hasOwnProperty(A)&&(I=o[A],I!=null))switch(A){case"value":h=I;break;case"defaultValue":v=I;break;case"children":T=I;break;case"dangerouslySetInnerHTML":if(I!=null)throw Error(r(91));break;default:qt(i,s,A,I,o,null)}om(i,h,v,T),ni(i);return;case"option":for(Q in o)if(o.hasOwnProperty(Q)&&(h=o[Q],h!=null))switch(Q){case"selected":i.selected=h&&typeof h!="function"&&typeof h!="symbol";break;default:qt(i,s,Q,h,o,null)}return;case"dialog":Tt("beforetoggle",i),Tt("toggle",i),Tt("cancel",i),Tt("close",i);break;case"iframe":case"object":Tt("load",i);break;case"video":case"audio":for(h=0;h<mo.length;h++)Tt(mo[h],i);break;case"image":Tt("error",i),Tt("load",i);break;case"details":Tt("toggle",i);break;case"embed":case"source":case"link":Tt("error",i),Tt("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(fe in o)if(o.hasOwnProperty(fe)&&(h=o[fe],h!=null))switch(fe){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,s));default:qt(i,s,fe,h,o,null)}return;default:if(Ef(s)){for(we in o)o.hasOwnProperty(we)&&(h=o[we],h!==void 0&&sd(i,s,we,h,o,void 0));return}}for(I in o)o.hasOwnProperty(I)&&(h=o[I],h!=null&&qt(i,s,I,h,o,null))}function ZE(i,s,o,h){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var v=null,T=null,A=null,I=null,Q=null,fe=null,we=null;for(ge in o){var Ne=o[ge];if(o.hasOwnProperty(ge)&&Ne!=null)switch(ge){case"checked":break;case"value":break;case"defaultValue":Q=Ne;default:h.hasOwnProperty(ge)||qt(i,s,ge,null,h,Ne)}}for(var pe in h){var ge=h[pe];if(Ne=o[pe],h.hasOwnProperty(pe)&&(ge!=null||Ne!=null))switch(pe){case"type":T=ge;break;case"name":v=ge;break;case"checked":fe=ge;break;case"defaultChecked":we=ge;break;case"value":A=ge;break;case"defaultValue":I=ge;break;case"children":case"dangerouslySetInnerHTML":if(ge!=null)throw Error(r(137,s));break;default:ge!==Ne&&qt(i,s,pe,ge,h,Ne)}}An(i,A,I,Q,fe,we,T,v);return;case"select":ge=A=I=pe=null;for(T in o)if(Q=o[T],o.hasOwnProperty(T)&&Q!=null)switch(T){case"value":break;case"multiple":ge=Q;default:h.hasOwnProperty(T)||qt(i,s,T,null,h,Q)}for(v in h)if(T=h[v],Q=o[v],h.hasOwnProperty(v)&&(T!=null||Q!=null))switch(v){case"value":pe=T;break;case"defaultValue":I=T;break;case"multiple":A=T;default:T!==Q&&qt(i,s,v,T,h,Q)}s=I,o=A,h=ge,pe!=null?yr(i,!!o,pe,!1):!!h!=!!o&&(s!=null?yr(i,!!o,s,!0):yr(i,!!o,o?[]:"",!1));return;case"textarea":ge=pe=null;for(I in o)if(v=o[I],o.hasOwnProperty(I)&&v!=null&&!h.hasOwnProperty(I))switch(I){case"value":break;case"children":break;default:qt(i,s,I,null,h,v)}for(A in h)if(v=h[A],T=o[A],h.hasOwnProperty(A)&&(v!=null||T!=null))switch(A){case"value":pe=v;break;case"defaultValue":ge=v;break;case"children":break;case"dangerouslySetInnerHTML":if(v!=null)throw Error(r(91));break;default:v!==T&&qt(i,s,A,v,h,T)}gc(i,pe,ge);return;case"option":for(var et in o)if(pe=o[et],o.hasOwnProperty(et)&&pe!=null&&!h.hasOwnProperty(et))switch(et){case"selected":i.selected=!1;break;default:qt(i,s,et,null,h,pe)}for(Q in h)if(pe=h[Q],ge=o[Q],h.hasOwnProperty(Q)&&pe!==ge&&(pe!=null||ge!=null))switch(Q){case"selected":i.selected=pe&&typeof pe!="function"&&typeof pe!="symbol";break;default:qt(i,s,Q,pe,h,ge)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ze in o)pe=o[Ze],o.hasOwnProperty(Ze)&&pe!=null&&!h.hasOwnProperty(Ze)&&qt(i,s,Ze,null,h,pe);for(fe in h)if(pe=h[fe],ge=o[fe],h.hasOwnProperty(fe)&&pe!==ge&&(pe!=null||ge!=null))switch(fe){case"children":case"dangerouslySetInnerHTML":if(pe!=null)throw Error(r(137,s));break;default:qt(i,s,fe,pe,h,ge)}return;default:if(Ef(s)){for(var $t in o)pe=o[$t],o.hasOwnProperty($t)&&pe!==void 0&&!h.hasOwnProperty($t)&&sd(i,s,$t,void 0,h,pe);for(we in h)pe=h[we],ge=o[we],!h.hasOwnProperty(we)||pe===ge||pe===void 0&&ge===void 0||sd(i,s,we,pe,h,ge);return}}for(var le in o)pe=o[le],o.hasOwnProperty(le)&&pe!=null&&!h.hasOwnProperty(le)&&qt(i,s,le,null,h,pe);for(Ne in h)pe=h[Ne],ge=o[Ne],!h.hasOwnProperty(Ne)||pe===ge||pe==null&&ge==null||qt(i,s,Ne,pe,h,ge)}var ld=null,od=null;function fu(i){return i.nodeType===9?i:i.ownerDocument}function cg(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function ug(i,s){if(i===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&s==="foreignObject"?0:i}function cd(i,s){return i==="textarea"||i==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var ud=null;function QE(){var i=window.event;return i&&i.type==="popstate"?i===ud?!1:(ud=i,!0):(ud=null,!1)}var fg=typeof setTimeout=="function"?setTimeout:void 0,eS=typeof clearTimeout=="function"?clearTimeout:void 0,dg=typeof Promise=="function"?Promise:void 0,tS=typeof queueMicrotask=="function"?queueMicrotask:typeof dg<"u"?function(i){return dg.resolve(null).then(i).catch(nS)}:fg;function nS(i){setTimeout(function(){throw i})}function yi(i){return i==="head"}function hg(i,s){var o=s,h=0,v=0;do{var T=o.nextSibling;if(i.removeChild(o),T&&T.nodeType===8)if(o=T.data,o==="/$"){if(0<h&&8>h){o=h;var A=i.ownerDocument;if(o&1&&xo(A.documentElement),o&2&&xo(A.body),o&4)for(o=A.head,xo(o),A=o.firstChild;A;){var I=A.nextSibling,Q=A.nodeName;A[L]||Q==="SCRIPT"||Q==="STYLE"||Q==="LINK"&&A.rel.toLowerCase()==="stylesheet"||o.removeChild(A),A=I}}if(v===0){i.removeChild(T),wo(s);return}v--}else o==="$"||o==="$?"||o==="$!"?v++:h=o.charCodeAt(0)-48;else h=0;o=T}while(o);wo(s)}function fd(i){var s=i.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var o=s;switch(s=s.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":fd(o),P(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}i.removeChild(o)}}function rS(i,s,o,h){for(;i.nodeType===1;){var v=o;if(i.nodeName.toLowerCase()!==s.toLowerCase()){if(!h&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(h){if(!i[L])switch(s){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(T=i.getAttribute("rel"),T==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(T!==v.rel||i.getAttribute("href")!==(v.href==null||v.href===""?null:v.href)||i.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin)||i.getAttribute("title")!==(v.title==null?null:v.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(T=i.getAttribute("src"),(T!==(v.src==null?null:v.src)||i.getAttribute("type")!==(v.type==null?null:v.type)||i.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin))&&T&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(s==="input"&&i.type==="hidden"){var T=v.name==null?null:""+v.name;if(v.type==="hidden"&&i.getAttribute("name")===T)return i}else return i;if(i=Qr(i.nextSibling),i===null)break}return null}function aS(i,s,o){if(s==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!o||(i=Qr(i.nextSibling),i===null))return null;return i}function dd(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState==="complete"}function iS(i,s){var o=i.ownerDocument;if(i.data!=="$?"||o.readyState==="complete")s();else{var h=function(){s(),o.removeEventListener("DOMContentLoaded",h)};o.addEventListener("DOMContentLoaded",h),i._reactRetry=h}}function Qr(i){for(;i!=null;i=i.nextSibling){var s=i.nodeType;if(s===1||s===3)break;if(s===8){if(s=i.data,s==="$"||s==="$!"||s==="$?"||s==="F!"||s==="F")break;if(s==="/$")return null}}return i}var hd=null;function mg(i){i=i.previousSibling;for(var s=0;i;){if(i.nodeType===8){var o=i.data;if(o==="$"||o==="$!"||o==="$?"){if(s===0)return i;s--}else o==="/$"&&s++}i=i.previousSibling}return null}function pg(i,s,o){switch(s=fu(o),i){case"html":if(i=s.documentElement,!i)throw Error(r(452));return i;case"head":if(i=s.head,!i)throw Error(r(453));return i;case"body":if(i=s.body,!i)throw Error(r(454));return i;default:throw Error(r(451))}}function xo(i){for(var s=i.attributes;s.length;)i.removeAttributeNode(s[0]);P(i)}var Vr=new Map,xg=new Set;function du(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var za=de.d;de.d={f:sS,r:lS,D:oS,C:cS,L:uS,m:fS,X:hS,S:dS,M:mS};function sS(){var i=za.f(),s=ru();return i||s}function lS(i){var s=z(i);s!==null&&s.tag===5&&s.type==="form"?Op(s):za.r(i)}var tl=typeof document>"u"?null:document;function gg(i,s,o){var h=tl;if(h&&typeof s=="string"&&s){var v=vt(s);v='link[rel="'+i+'"][href="'+v+'"]',typeof o=="string"&&(v+='[crossorigin="'+o+'"]'),xg.has(v)||(xg.add(v),i={rel:i,crossOrigin:o,href:s},h.querySelector(v)===null&&(s=h.createElement("link"),jn(s,"link",i),oe(s),h.head.appendChild(s)))}}function oS(i){za.D(i),gg("dns-prefetch",i,null)}function cS(i,s){za.C(i,s),gg("preconnect",i,s)}function uS(i,s,o){za.L(i,s,o);var h=tl;if(h&&i&&s){var v='link[rel="preload"][as="'+vt(s)+'"]';s==="image"&&o&&o.imageSrcSet?(v+='[imagesrcset="'+vt(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(v+='[imagesizes="'+vt(o.imageSizes)+'"]')):v+='[href="'+vt(i)+'"]';var T=v;switch(s){case"style":T=nl(i);break;case"script":T=rl(i)}Vr.has(T)||(i=x({rel:"preload",href:s==="image"&&o&&o.imageSrcSet?void 0:i,as:s},o),Vr.set(T,i),h.querySelector(v)!==null||s==="style"&&h.querySelector(go(T))||s==="script"&&h.querySelector(vo(T))||(s=h.createElement("link"),jn(s,"link",i),oe(s),h.head.appendChild(s)))}}function fS(i,s){za.m(i,s);var o=tl;if(o&&i){var h=s&&typeof s.as=="string"?s.as:"script",v='link[rel="modulepreload"][as="'+vt(h)+'"][href="'+vt(i)+'"]',T=v;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":T=rl(i)}if(!Vr.has(T)&&(i=x({rel:"modulepreload",href:i},s),Vr.set(T,i),o.querySelector(v)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(vo(T)))return}h=o.createElement("link"),jn(h,"link",i),oe(h),o.head.appendChild(h)}}}function dS(i,s,o){za.S(i,s,o);var h=tl;if(h&&i){var v=ye(h).hoistableStyles,T=nl(i);s=s||"default";var A=v.get(T);if(!A){var I={loading:0,preload:null};if(A=h.querySelector(go(T)))I.loading=5;else{i=x({rel:"stylesheet",href:i,"data-precedence":s},o),(o=Vr.get(T))&&md(i,o);var Q=A=h.createElement("link");oe(Q),jn(Q,"link",i),Q._p=new Promise(function(fe,we){Q.onload=fe,Q.onerror=we}),Q.addEventListener("load",function(){I.loading|=1}),Q.addEventListener("error",function(){I.loading|=2}),I.loading|=4,hu(A,s,h)}A={type:"stylesheet",instance:A,count:1,state:I},v.set(T,A)}}}function hS(i,s){za.X(i,s);var o=tl;if(o&&i){var h=ye(o).hoistableScripts,v=rl(i),T=h.get(v);T||(T=o.querySelector(vo(v)),T||(i=x({src:i,async:!0},s),(s=Vr.get(v))&&pd(i,s),T=o.createElement("script"),oe(T),jn(T,"link",i),o.head.appendChild(T)),T={type:"script",instance:T,count:1,state:null},h.set(v,T))}}function mS(i,s){za.M(i,s);var o=tl;if(o&&i){var h=ye(o).hoistableScripts,v=rl(i),T=h.get(v);T||(T=o.querySelector(vo(v)),T||(i=x({src:i,async:!0,type:"module"},s),(s=Vr.get(v))&&pd(i,s),T=o.createElement("script"),oe(T),jn(T,"link",i),o.head.appendChild(T)),T={type:"script",instance:T,count:1,state:null},h.set(v,T))}}function vg(i,s,o,h){var v=(v=se.current)?du(v):null;if(!v)throw Error(r(446));switch(i){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(s=nl(o.href),o=ye(v).hoistableStyles,h=o.get(s),h||(h={type:"style",instance:null,count:0,state:null},o.set(s,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){i=nl(o.href);var T=ye(v).hoistableStyles,A=T.get(i);if(A||(v=v.ownerDocument||v,A={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},T.set(i,A),(T=v.querySelector(go(i)))&&!T._p&&(A.instance=T,A.state.loading=5),Vr.has(i)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},Vr.set(i,o),T||pS(v,i,o,A.state))),s&&h===null)throw Error(r(528,""));return A}if(s&&h!==null)throw Error(r(529,""));return null;case"script":return s=o.async,o=o.src,typeof o=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=rl(o),o=ye(v).hoistableScripts,h=o.get(s),h||(h={type:"script",instance:null,count:0,state:null},o.set(s,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,i))}}function nl(i){return'href="'+vt(i)+'"'}function go(i){return'link[rel="stylesheet"]['+i+"]"}function yg(i){return x({},i,{"data-precedence":i.precedence,precedence:null})}function pS(i,s,o,h){i.querySelector('link[rel="preload"][as="style"]['+s+"]")?h.loading=1:(s=i.createElement("link"),h.preload=s,s.addEventListener("load",function(){return h.loading|=1}),s.addEventListener("error",function(){return h.loading|=2}),jn(s,"link",o),oe(s),i.head.appendChild(s))}function rl(i){return'[src="'+vt(i)+'"]'}function vo(i){return"script[async]"+i}function Tg(i,s,o){if(s.count++,s.instance===null)switch(s.type){case"style":var h=i.querySelector('style[data-href~="'+vt(o.href)+'"]');if(h)return s.instance=h,oe(h),h;var v=x({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return h=(i.ownerDocument||i).createElement("style"),oe(h),jn(h,"style",v),hu(h,o.precedence,i),s.instance=h;case"stylesheet":v=nl(o.href);var T=i.querySelector(go(v));if(T)return s.state.loading|=4,s.instance=T,oe(T),T;h=yg(o),(v=Vr.get(v))&&md(h,v),T=(i.ownerDocument||i).createElement("link"),oe(T);var A=T;return A._p=new Promise(function(I,Q){A.onload=I,A.onerror=Q}),jn(T,"link",h),s.state.loading|=4,hu(T,o.precedence,i),s.instance=T;case"script":return T=rl(o.src),(v=i.querySelector(vo(T)))?(s.instance=v,oe(v),v):(h=o,(v=Vr.get(T))&&(h=x({},o),pd(h,v)),i=i.ownerDocument||i,v=i.createElement("script"),oe(v),jn(v,"link",h),i.head.appendChild(v),s.instance=v);case"void":return null;default:throw Error(r(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(h=s.instance,s.state.loading|=4,hu(h,o.precedence,i));return s.instance}function hu(i,s,o){for(var h=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),v=h.length?h[h.length-1]:null,T=v,A=0;A<h.length;A++){var I=h[A];if(I.dataset.precedence===s)T=I;else if(T!==v)break}T?T.parentNode.insertBefore(i,T.nextSibling):(s=o.nodeType===9?o.head:o,s.insertBefore(i,s.firstChild))}function md(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.title==null&&(i.title=s.title)}function pd(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.integrity==null&&(i.integrity=s.integrity)}var mu=null;function _g(i,s,o){if(mu===null){var h=new Map,v=mu=new Map;v.set(o,h)}else v=mu,h=v.get(o),h||(h=new Map,v.set(o,h));if(h.has(i))return h;for(h.set(i,null),o=o.getElementsByTagName(i),v=0;v<o.length;v++){var T=o[v];if(!(T[L]||T[tn]||i==="link"&&T.getAttribute("rel")==="stylesheet")&&T.namespaceURI!=="http://www.w3.org/2000/svg"){var A=T.getAttribute(s)||"";A=i+A;var I=h.get(A);I?I.push(T):h.set(A,[T])}}return h}function Eg(i,s,o){i=i.ownerDocument||i,i.head.insertBefore(o,s==="title"?i.querySelector("head > title"):null)}function xS(i,s,o){if(o===1||s.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;switch(s.rel){case"stylesheet":return i=s.disabled,typeof s.precedence=="string"&&i==null;default:return!0}case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function Sg(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}var yo=null;function gS(){}function vS(i,s,o){if(yo===null)throw Error(r(475));var h=yo;if(s.type==="stylesheet"&&(typeof o.media!="string"||matchMedia(o.media).matches!==!1)&&(s.state.loading&4)===0){if(s.instance===null){var v=nl(o.href),T=i.querySelector(go(v));if(T){i=T._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(h.count++,h=pu.bind(h),i.then(h,h)),s.state.loading|=4,s.instance=T,oe(T);return}T=i.ownerDocument||i,o=yg(o),(v=Vr.get(v))&&md(o,v),T=T.createElement("link"),oe(T);var A=T;A._p=new Promise(function(I,Q){A.onload=I,A.onerror=Q}),jn(T,"link",o),s.instance=T}h.stylesheets===null&&(h.stylesheets=new Map),h.stylesheets.set(s,i),(i=s.state.preload)&&(s.state.loading&3)===0&&(h.count++,s=pu.bind(h),i.addEventListener("load",s),i.addEventListener("error",s))}}function yS(){if(yo===null)throw Error(r(475));var i=yo;return i.stylesheets&&i.count===0&&xd(i,i.stylesheets),0<i.count?function(s){var o=setTimeout(function(){if(i.stylesheets&&xd(i,i.stylesheets),i.unsuspend){var h=i.unsuspend;i.unsuspend=null,h()}},6e4);return i.unsuspend=s,function(){i.unsuspend=null,clearTimeout(o)}}:null}function pu(){if(this.count--,this.count===0){if(this.stylesheets)xd(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var xu=null;function xd(i,s){i.stylesheets=null,i.unsuspend!==null&&(i.count++,xu=new Map,s.forEach(TS,i),xu=null,pu.call(i))}function TS(i,s){if(!(s.state.loading&4)){var o=xu.get(i);if(o)var h=o.get(null);else{o=new Map,xu.set(i,o);for(var v=i.querySelectorAll("link[data-precedence],style[data-precedence]"),T=0;T<v.length;T++){var A=v[T];(A.nodeName==="LINK"||A.getAttribute("media")!=="not all")&&(o.set(A.dataset.precedence,A),h=A)}h&&o.set(null,h)}v=s.instance,A=v.getAttribute("data-precedence"),T=o.get(A)||h,T===h&&o.set(null,v),o.set(A,v),this.count++,h=pu.bind(this),v.addEventListener("load",h),v.addEventListener("error",h),T?T.parentNode.insertBefore(v,T.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(v,i.firstChild)),s.state.loading|=4}}var To={$$typeof:b,Provider:null,Consumer:null,_currentValue:re,_currentValue2:re,_threadCount:0};function _S(i,s,o,h,v,T,A,I){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ka(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ka(0),this.hiddenUpdates=ka(null),this.identifierPrefix=h,this.onUncaughtError=v,this.onCaughtError=T,this.onRecoverableError=A,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=I,this.incompleteTransitions=new Map}function wg(i,s,o,h,v,T,A,I,Q,fe,we,Ne){return i=new _S(i,s,o,A,I,Q,fe,Ne),s=1,T===!0&&(s|=24),T=_r(3,null,null,s),i.current=T,T.stateNode=i,s=Kf(),s.refCount++,i.pooledCache=s,s.refCount++,T.memoizedState={element:h,isDehydrated:o,cache:s},t0(T),i}function Cg(i){return i?(i=Fs,i):Fs}function Ag(i,s,o,h,v,T){v=Cg(v),h.context===null?h.context=v:h.pendingContext=v,h=si(s),h.payload={element:o},T=T===void 0?null:T,T!==null&&(h.callback=T),o=li(i,h,s),o!==null&&(Ar(o,i,s),Jl(o,i,s))}function bg(i,s){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var o=i.retryLane;i.retryLane=o!==0&&o<s?o:s}}function gd(i,s){bg(i,s),(i=i.alternate)&&bg(i,s)}function kg(i){if(i.tag===13){var s=Is(i,67108864);s!==null&&Ar(s,i,67108864),gd(i,67108864)}}var gu=!0;function ES(i,s,o,h){var v=ae.T;ae.T=null;var T=de.p;try{de.p=2,vd(i,s,o,h)}finally{de.p=T,ae.T=v}}function SS(i,s,o,h){var v=ae.T;ae.T=null;var T=de.p;try{de.p=8,vd(i,s,o,h)}finally{de.p=T,ae.T=v}}function vd(i,s,o,h){if(gu){var v=yd(h);if(v===null)id(i,s,h,vu,o),Mg(i,h);else if(CS(v,i,s,o,h))h.stopPropagation();else if(Mg(i,h),s&4&&-1<wS.indexOf(i)){for(;v!==null;){var T=z(v);if(T!==null)switch(T.tag){case 3:if(T=T.stateNode,T.current.memoizedState.isDehydrated){var A=Yn(T.pendingLanes);if(A!==0){var I=T;for(I.pendingLanes|=2,I.entangledLanes|=2;A;){var Q=1<<31-at(A);I.entanglements[1]|=Q,A&=~Q}ma(T),(Vt&6)===0&&(tu=ve()+500,ho(0))}}break;case 13:I=Is(T,2),I!==null&&Ar(I,T,2),ru(),gd(T,2)}if(T=yd(h),T===null&&id(i,s,h,vu,o),T===v)break;v=T}v!==null&&h.stopPropagation()}else id(i,s,h,null,o)}}function yd(i){return i=wf(i),Td(i)}var vu=null;function Td(i){if(vu=null,i=B(i),i!==null){var s=l(i);if(s===null)i=null;else{var o=s.tag;if(o===13){if(i=c(s),i!==null)return i;i=null}else if(o===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;i=null}else s!==i&&(i=null)}}return vu=i,null}function Ng(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ge()){case je:return 2;case Pt:return 8;case Ct:case en:return 32;case dt:return 268435456;default:return 32}default:return 32}}var _d=!1,Ti=null,_i=null,Ei=null,_o=new Map,Eo=new Map,Si=[],wS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Mg(i,s){switch(i){case"focusin":case"focusout":Ti=null;break;case"dragenter":case"dragleave":_i=null;break;case"mouseover":case"mouseout":Ei=null;break;case"pointerover":case"pointerout":_o.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":Eo.delete(s.pointerId)}}function So(i,s,o,h,v,T){return i===null||i.nativeEvent!==T?(i={blockedOn:s,domEventName:o,eventSystemFlags:h,nativeEvent:T,targetContainers:[v]},s!==null&&(s=z(s),s!==null&&kg(s)),i):(i.eventSystemFlags|=h,s=i.targetContainers,v!==null&&s.indexOf(v)===-1&&s.push(v),i)}function CS(i,s,o,h,v){switch(s){case"focusin":return Ti=So(Ti,i,s,o,h,v),!0;case"dragenter":return _i=So(_i,i,s,o,h,v),!0;case"mouseover":return Ei=So(Ei,i,s,o,h,v),!0;case"pointerover":var T=v.pointerId;return _o.set(T,So(_o.get(T)||null,i,s,o,h,v)),!0;case"gotpointercapture":return T=v.pointerId,Eo.set(T,So(Eo.get(T)||null,i,s,o,h,v)),!0}return!1}function Rg(i){var s=B(i.target);if(s!==null){var o=l(s);if(o!==null){if(s=o.tag,s===13){if(s=c(o),s!==null){i.blockedOn=s,Na(i.priority,function(){if(o.tag===13){var h=Cr();h=In(h);var v=Is(o,h);v!==null&&Ar(v,o,h),gd(o,h)}});return}}else if(s===3&&o.stateNode.current.memoizedState.isDehydrated){i.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}i.blockedOn=null}function yu(i){if(i.blockedOn!==null)return!1;for(var s=i.targetContainers;0<s.length;){var o=yd(i.nativeEvent);if(o===null){o=i.nativeEvent;var h=new o.constructor(o.type,o);Sf=h,o.target.dispatchEvent(h),Sf=null}else return s=z(o),s!==null&&kg(s),i.blockedOn=o,!1;s.shift()}return!0}function Dg(i,s,o){yu(i)&&o.delete(s)}function AS(){_d=!1,Ti!==null&&yu(Ti)&&(Ti=null),_i!==null&&yu(_i)&&(_i=null),Ei!==null&&yu(Ei)&&(Ei=null),_o.forEach(Dg),Eo.forEach(Dg)}function Tu(i,s){i.blockedOn===s&&(i.blockedOn=null,_d||(_d=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,AS)))}var _u=null;function Ig(i){_u!==i&&(_u=i,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){_u===i&&(_u=null);for(var s=0;s<i.length;s+=3){var o=i[s],h=i[s+1],v=i[s+2];if(typeof h!="function"){if(Td(h||o)===null)continue;break}var T=z(o);T!==null&&(i.splice(s,3),s-=3,T0(T,{pending:!0,data:v,method:o.method,action:h},h,v))}}))}function wo(i){function s(Q){return Tu(Q,i)}Ti!==null&&Tu(Ti,i),_i!==null&&Tu(_i,i),Ei!==null&&Tu(Ei,i),_o.forEach(s),Eo.forEach(s);for(var o=0;o<Si.length;o++){var h=Si[o];h.blockedOn===i&&(h.blockedOn=null)}for(;0<Si.length&&(o=Si[0],o.blockedOn===null);)Rg(o),o.blockedOn===null&&Si.shift();if(o=(i.ownerDocument||i).$$reactFormReplay,o!=null)for(h=0;h<o.length;h+=3){var v=o[h],T=o[h+1],A=v[nn]||null;if(typeof T=="function")A||Ig(o);else if(A){var I=null;if(T&&T.hasAttribute("formAction")){if(v=T,A=T[nn]||null)I=A.formAction;else if(Td(v)!==null)continue}else I=A.action;typeof I=="function"?o[h+1]=I:(o.splice(h,3),h-=3),Ig(o)}}}function Ed(i){this._internalRoot=i}Eu.prototype.render=Ed.prototype.render=function(i){var s=this._internalRoot;if(s===null)throw Error(r(409));var o=s.current,h=Cr();Ag(o,h,i,s,null,null)},Eu.prototype.unmount=Ed.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var s=i.containerInfo;Ag(i.current,2,null,i,null,null),ru(),s[dr]=null}};function Eu(i){this._internalRoot=i}Eu.prototype.unstable_scheduleHydration=function(i){if(i){var s=Dr();i={blockedOn:null,target:i,priority:s};for(var o=0;o<Si.length&&s!==0&&s<Si[o].priority;o++);Si.splice(o,0,i),o===0&&Rg(i)}};var Fg=t.version;if(Fg!=="19.1.0")throw Error(r(527,Fg,"19.1.0"));de.findDOMNode=function(i){var s=i._reactInternals;if(s===void 0)throw typeof i.render=="function"?Error(r(188)):(i=Object.keys(i).join(","),Error(r(268,i)));return i=p(s),i=i!==null?m(i):null,i=i===null?null:i.stateNode,i};var bS={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:ae,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Su=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Su.isDisabled&&Su.supportsFiber)try{Jt=Su.inject(bS),Xt=Su}catch{}}return Ao.createRoot=function(i,s){if(!a(i))throw Error(r(299));var o=!1,h="",v=Xp,T=Kp,A=Zp,I=null;return s!=null&&(s.unstable_strictMode===!0&&(o=!0),s.identifierPrefix!==void 0&&(h=s.identifierPrefix),s.onUncaughtError!==void 0&&(v=s.onUncaughtError),s.onCaughtError!==void 0&&(T=s.onCaughtError),s.onRecoverableError!==void 0&&(A=s.onRecoverableError),s.unstable_transitionCallbacks!==void 0&&(I=s.unstable_transitionCallbacks)),s=wg(i,1,!1,null,null,o,h,v,T,A,I,null),i[dr]=s.current,ad(i),new Ed(s)},Ao.hydrateRoot=function(i,s,o){if(!a(i))throw Error(r(299));var h=!1,v="",T=Xp,A=Kp,I=Zp,Q=null,fe=null;return o!=null&&(o.unstable_strictMode===!0&&(h=!0),o.identifierPrefix!==void 0&&(v=o.identifierPrefix),o.onUncaughtError!==void 0&&(T=o.onUncaughtError),o.onCaughtError!==void 0&&(A=o.onCaughtError),o.onRecoverableError!==void 0&&(I=o.onRecoverableError),o.unstable_transitionCallbacks!==void 0&&(Q=o.unstable_transitionCallbacks),o.formState!==void 0&&(fe=o.formState)),s=wg(i,1,!0,s,o??null,h,v,T,A,I,Q,fe),s.context=Cg(null),o=s.current,h=Cr(),h=In(h),v=si(h),v.callback=null,li(o,v,h),o=h,s.current.lanes=o,Pe(s,o),ma(s),i[dr]=s.current,ad(i),new Eu(s)},Ao.version="19.1.0",Ao}var zg;function PS(){if(zg)return Cd.exports;zg=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Cd.exports=OS(),Cd.exports}var US=PS();const BS=Gy(US);var ir=(e=>(e.NOT_STARTED="Not Started",e.IN_PROGRESS="In Progress",e.COMPLETED="Completed",e))(ir||{}),qd=(e=>(e.PENDING="pending",e.ACHIEVED="achieved",e.MISSED="missed",e))(qd||{}),kt=(e=>(e.NOT_STARTED="Not Started",e.IN_PROGRESS="In Progress",e.COMPLETED="Completed",e.BLOCKED="Blocked",e))(kt||{}),Gr=(e=>(e[e.INPUT_FORM=0]="INPUT_FORM",e[e.PROJECT_FLOW=1]="PROJECT_FLOW",e[e.TASK_DETAIL=2]="TASK_DETAIL",e))(Gr||{}),Ot;(function(e){e.assertEqual=a=>{};function t(a){}e.assertIs=t;function n(a){throw new Error}e.assertNever=n,e.arrayToEnum=a=>{const l={};for(const c of a)l[c]=c;return l},e.getValidEnumValues=a=>{const l=e.objectKeys(a).filter(u=>typeof a[a[u]]!="number"),c={};for(const u of l)c[u]=a[u];return e.objectValues(c)},e.objectValues=a=>e.objectKeys(a).map(function(l){return a[l]}),e.objectKeys=typeof Object.keys=="function"?a=>Object.keys(a):a=>{const l=[];for(const c in a)Object.prototype.hasOwnProperty.call(a,c)&&l.push(c);return l},e.find=(a,l)=>{for(const c of a)if(l(c))return c},e.isInteger=typeof Number.isInteger=="function"?a=>Number.isInteger(a):a=>typeof a=="number"&&Number.isFinite(a)&&Math.floor(a)===a;function r(a,l=" | "){return a.map(c=>typeof c=="string"?`'${c}'`:c).join(l)}e.joinValues=r,e.jsonStringifyReplacer=(a,l)=>typeof l=="bigint"?l.toString():l})(Ot||(Ot={}));var qg;(function(e){e.mergeShapes=(t,n)=>({...t,...n})})(qg||(qg={}));const $e=Ot.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Ai=e=>{switch(typeof e){case"undefined":return $e.undefined;case"string":return $e.string;case"number":return Number.isNaN(e)?$e.nan:$e.number;case"boolean":return $e.boolean;case"function":return $e.function;case"bigint":return $e.bigint;case"symbol":return $e.symbol;case"object":return Array.isArray(e)?$e.array:e===null?$e.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?$e.promise:typeof Map<"u"&&e instanceof Map?$e.map:typeof Set<"u"&&e instanceof Set?$e.set:typeof Date<"u"&&e instanceof Date?$e.date:$e.object;default:return $e.unknown}},Le=Ot.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Ja extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=t}format(t){const n=t||function(l){return l.message},r={_errors:[]},a=l=>{for(const c of l.issues)if(c.code==="invalid_union")c.unionErrors.map(a);else if(c.code==="invalid_return_type")a(c.returnTypeError);else if(c.code==="invalid_arguments")a(c.argumentsError);else if(c.path.length===0)r._errors.push(n(c));else{let u=r,p=0;for(;p<c.path.length;){const m=c.path[p];p===c.path.length-1?(u[m]=u[m]||{_errors:[]},u[m]._errors.push(n(c))):u[m]=u[m]||{_errors:[]},u=u[m],p++}}};return a(this),r}static assert(t){if(!(t instanceof Ja))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Ot.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=n=>n.message){const n={},r=[];for(const a of this.issues)if(a.path.length>0){const l=a.path[0];n[l]=n[l]||[],n[l].push(t(a))}else r.push(t(a));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}Ja.create=e=>new Ja(e);const $d=(e,t)=>{let n;switch(e.code){case Le.invalid_type:e.received===$e.undefined?n="Required":n=`Expected ${e.expected}, received ${e.received}`;break;case Le.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,Ot.jsonStringifyReplacer)}`;break;case Le.unrecognized_keys:n=`Unrecognized key(s) in object: ${Ot.joinValues(e.keys,", ")}`;break;case Le.invalid_union:n="Invalid input";break;case Le.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${Ot.joinValues(e.options)}`;break;case Le.invalid_enum_value:n=`Invalid enum value. Expected ${Ot.joinValues(e.options)}, received '${e.received}'`;break;case Le.invalid_arguments:n="Invalid function arguments";break;case Le.invalid_return_type:n="Invalid function return type";break;case Le.invalid_date:n="Invalid date";break;case Le.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:Ot.assertNever(e.validation):e.validation!=="regex"?n=`Invalid ${e.validation}`:n="Invalid";break;case Le.too_small:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="bigint"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:n="Invalid input";break;case Le.too_big:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?n=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:n="Invalid input";break;case Le.custom:n="Invalid input";break;case Le.invalid_intersection_types:n="Intersection results could not be merged";break;case Le.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case Le.not_finite:n="Number must be finite";break;default:n=t.defaultError,Ot.assertNever(e)}return{message:n}};let VS=$d;function HS(){return VS}const GS=e=>{const{data:t,path:n,errorMaps:r,issueData:a}=e,l=[...n,...a.path||[]],c={...a,path:l};if(a.message!==void 0)return{...a,path:l,message:a.message};let u="";const p=r.filter(m=>!!m).slice().reverse();for(const m of p)u=m(c,{data:t,defaultError:u}).message;return{...a,path:l,message:u}};function He(e,t){const n=HS(),r=GS({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===$d?void 0:$d].filter(a=>!!a)});e.common.issues.push(r)}class ur{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,n){const r=[];for(const a of n){if(a.status==="aborted")return rt;a.status==="dirty"&&t.dirty(),r.push(a.value)}return{status:t.value,value:r}}static async mergeObjectAsync(t,n){const r=[];for(const a of n){const l=await a.key,c=await a.value;r.push({key:l,value:c})}return ur.mergeObjectSync(t,r)}static mergeObjectSync(t,n){const r={};for(const a of n){const{key:l,value:c}=a;if(l.status==="aborted"||c.status==="aborted")return rt;l.status==="dirty"&&t.dirty(),c.status==="dirty"&&t.dirty(),l.value!=="__proto__"&&(typeof c.value<"u"||a.alwaysSet)&&(r[l.value]=c.value)}return{status:t.value,value:r}}}const rt=Object.freeze({status:"aborted"}),ko=e=>({status:"dirty",value:e}),Yr=e=>({status:"valid",value:e}),$g=e=>e.status==="aborted",Yg=e=>e.status==="dirty",gl=e=>e.status==="valid",Bu=e=>typeof Promise<"u"&&e instanceof Promise;var Ye;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(Ye||(Ye={}));class _a{constructor(t,n,r,a){this._cachedPath=[],this.parent=t,this.data=n,this._path=r,this._key=a}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Wg=(e,t)=>{if(gl(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new Ja(e.common.issues);return this._error=n,this._error}}};function ft(e){if(!e)return{};const{errorMap:t,invalid_type_error:n,required_error:r,description:a}=e;if(t&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:a}:{errorMap:(c,u)=>{const{message:p}=e;return c.code==="invalid_enum_value"?{message:p??u.defaultError}:typeof u.data>"u"?{message:p??r??u.defaultError}:c.code!=="invalid_type"?{message:u.defaultError}:{message:p??n??u.defaultError}},description:a}}class wt{get description(){return this._def.description}_getType(t){return Ai(t.data)}_getOrReturnCtx(t,n){return n||{common:t.parent.common,data:t.data,parsedType:Ai(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new ur,ctx:{common:t.parent.common,data:t.data,parsedType:Ai(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const n=this._parse(t);if(Bu(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(t){const n=this._parse(t);return Promise.resolve(n)}parse(t,n){const r=this.safeParse(t,n);if(r.success)return r.data;throw r.error}safeParse(t,n){const r={common:{issues:[],async:(n==null?void 0:n.async)??!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Ai(t)},a=this._parseSync({data:t,path:r.path,parent:r});return Wg(r,a)}"~validate"(t){var r,a;const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Ai(t)};if(!this["~standard"].async)try{const l=this._parseSync({data:t,path:[],parent:n});return gl(l)?{value:l.value}:{issues:n.common.issues}}catch(l){(a=(r=l==null?void 0:l.message)==null?void 0:r.toLowerCase())!=null&&a.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:n}).then(l=>gl(l)?{value:l.value}:{issues:n.common.issues})}async parseAsync(t,n){const r=await this.safeParseAsync(t,n);if(r.success)return r.data;throw r.error}async safeParseAsync(t,n){const r={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Ai(t)},a=this._parse({data:t,path:r.path,parent:r}),l=await(Bu(a)?a:Promise.resolve(a));return Wg(r,l)}refine(t,n){const r=a=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(a):n;return this._refinement((a,l)=>{const c=t(a),u=()=>l.addIssue({code:Le.custom,...r(a)});return typeof Promise<"u"&&c instanceof Promise?c.then(p=>p?!0:(u(),!1)):c?!0:(u(),!1)})}refinement(t,n){return this._refinement((r,a)=>t(r)?!0:(a.addIssue(typeof n=="function"?n(r,a):n),!1))}_refinement(t){return new Tl({schema:this,typeName:nt.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return Mi.create(this,this._def)}nullable(){return _l.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Ta.create(this)}promise(){return zu.create(this,this._def)}or(t){return Hu.create([this,t],this._def)}and(t){return Gu.create(this,t,this._def)}transform(t){return new Tl({...ft(this._def),schema:this,typeName:nt.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const n=typeof t=="function"?t:()=>t;return new Xd({...ft(this._def),innerType:this,defaultValue:n,typeName:nt.ZodDefault})}brand(){return new fw({typeName:nt.ZodBranded,type:this,...ft(this._def)})}catch(t){const n=typeof t=="function"?t:()=>t;return new Kd({...ft(this._def),innerType:this,catchValue:n,typeName:nt.ZodCatch})}describe(t){const n=this.constructor;return new n({...this._def,description:t})}pipe(t){return Sh.create(this,t)}readonly(){return Zd.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const jS=/^c[^\s-]{8,}$/i,zS=/^[0-9a-z]+$/,qS=/^[0-9A-HJKMNP-TV-Z]{26}$/i,$S=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,YS=/^[a-z0-9_-]{21}$/i,WS=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,JS=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,XS=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,KS="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Nd;const ZS=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,QS=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ew=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,tw=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,nw=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,rw=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,jy="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",aw=new RegExp(`^${jy}$`);function zy(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`);const n=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${n}`}function iw(e){return new RegExp(`^${zy(e)}$`)}function sw(e){let t=`${jy}T${zy(e)}`;const n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${n.join("|")})`,new RegExp(`^${t}$`)}function lw(e,t){return!!((t==="v4"||!t)&&ZS.test(e)||(t==="v6"||!t)&&ew.test(e))}function ow(e,t){if(!WS.test(e))return!1;try{const[n]=e.split(".");if(!n)return!1;const r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),a=JSON.parse(atob(r));return!(typeof a!="object"||a===null||"typ"in a&&(a==null?void 0:a.typ)!=="JWT"||!a.alg||t&&a.alg!==t)}catch{return!1}}function cw(e,t){return!!((t==="v4"||!t)&&QS.test(e)||(t==="v6"||!t)&&tw.test(e))}class va extends wt{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==$e.string){const l=this._getOrReturnCtx(t);return He(l,{code:Le.invalid_type,expected:$e.string,received:l.parsedType}),rt}const r=new ur;let a;for(const l of this._def.checks)if(l.kind==="min")t.data.length<l.value&&(a=this._getOrReturnCtx(t,a),He(a,{code:Le.too_small,minimum:l.value,type:"string",inclusive:!0,exact:!1,message:l.message}),r.dirty());else if(l.kind==="max")t.data.length>l.value&&(a=this._getOrReturnCtx(t,a),He(a,{code:Le.too_big,maximum:l.value,type:"string",inclusive:!0,exact:!1,message:l.message}),r.dirty());else if(l.kind==="length"){const c=t.data.length>l.value,u=t.data.length<l.value;(c||u)&&(a=this._getOrReturnCtx(t,a),c?He(a,{code:Le.too_big,maximum:l.value,type:"string",inclusive:!0,exact:!0,message:l.message}):u&&He(a,{code:Le.too_small,minimum:l.value,type:"string",inclusive:!0,exact:!0,message:l.message}),r.dirty())}else if(l.kind==="email")XS.test(t.data)||(a=this._getOrReturnCtx(t,a),He(a,{validation:"email",code:Le.invalid_string,message:l.message}),r.dirty());else if(l.kind==="emoji")Nd||(Nd=new RegExp(KS,"u")),Nd.test(t.data)||(a=this._getOrReturnCtx(t,a),He(a,{validation:"emoji",code:Le.invalid_string,message:l.message}),r.dirty());else if(l.kind==="uuid")$S.test(t.data)||(a=this._getOrReturnCtx(t,a),He(a,{validation:"uuid",code:Le.invalid_string,message:l.message}),r.dirty());else if(l.kind==="nanoid")YS.test(t.data)||(a=this._getOrReturnCtx(t,a),He(a,{validation:"nanoid",code:Le.invalid_string,message:l.message}),r.dirty());else if(l.kind==="cuid")jS.test(t.data)||(a=this._getOrReturnCtx(t,a),He(a,{validation:"cuid",code:Le.invalid_string,message:l.message}),r.dirty());else if(l.kind==="cuid2")zS.test(t.data)||(a=this._getOrReturnCtx(t,a),He(a,{validation:"cuid2",code:Le.invalid_string,message:l.message}),r.dirty());else if(l.kind==="ulid")qS.test(t.data)||(a=this._getOrReturnCtx(t,a),He(a,{validation:"ulid",code:Le.invalid_string,message:l.message}),r.dirty());else if(l.kind==="url")try{new URL(t.data)}catch{a=this._getOrReturnCtx(t,a),He(a,{validation:"url",code:Le.invalid_string,message:l.message}),r.dirty()}else l.kind==="regex"?(l.regex.lastIndex=0,l.regex.test(t.data)||(a=this._getOrReturnCtx(t,a),He(a,{validation:"regex",code:Le.invalid_string,message:l.message}),r.dirty())):l.kind==="trim"?t.data=t.data.trim():l.kind==="includes"?t.data.includes(l.value,l.position)||(a=this._getOrReturnCtx(t,a),He(a,{code:Le.invalid_string,validation:{includes:l.value,position:l.position},message:l.message}),r.dirty()):l.kind==="toLowerCase"?t.data=t.data.toLowerCase():l.kind==="toUpperCase"?t.data=t.data.toUpperCase():l.kind==="startsWith"?t.data.startsWith(l.value)||(a=this._getOrReturnCtx(t,a),He(a,{code:Le.invalid_string,validation:{startsWith:l.value},message:l.message}),r.dirty()):l.kind==="endsWith"?t.data.endsWith(l.value)||(a=this._getOrReturnCtx(t,a),He(a,{code:Le.invalid_string,validation:{endsWith:l.value},message:l.message}),r.dirty()):l.kind==="datetime"?sw(l).test(t.data)||(a=this._getOrReturnCtx(t,a),He(a,{code:Le.invalid_string,validation:"datetime",message:l.message}),r.dirty()):l.kind==="date"?aw.test(t.data)||(a=this._getOrReturnCtx(t,a),He(a,{code:Le.invalid_string,validation:"date",message:l.message}),r.dirty()):l.kind==="time"?iw(l).test(t.data)||(a=this._getOrReturnCtx(t,a),He(a,{code:Le.invalid_string,validation:"time",message:l.message}),r.dirty()):l.kind==="duration"?JS.test(t.data)||(a=this._getOrReturnCtx(t,a),He(a,{validation:"duration",code:Le.invalid_string,message:l.message}),r.dirty()):l.kind==="ip"?lw(t.data,l.version)||(a=this._getOrReturnCtx(t,a),He(a,{validation:"ip",code:Le.invalid_string,message:l.message}),r.dirty()):l.kind==="jwt"?ow(t.data,l.alg)||(a=this._getOrReturnCtx(t,a),He(a,{validation:"jwt",code:Le.invalid_string,message:l.message}),r.dirty()):l.kind==="cidr"?cw(t.data,l.version)||(a=this._getOrReturnCtx(t,a),He(a,{validation:"cidr",code:Le.invalid_string,message:l.message}),r.dirty()):l.kind==="base64"?nw.test(t.data)||(a=this._getOrReturnCtx(t,a),He(a,{validation:"base64",code:Le.invalid_string,message:l.message}),r.dirty()):l.kind==="base64url"?rw.test(t.data)||(a=this._getOrReturnCtx(t,a),He(a,{validation:"base64url",code:Le.invalid_string,message:l.message}),r.dirty()):Ot.assertNever(l);return{status:r.value,value:t.data}}_regex(t,n,r){return this.refinement(a=>t.test(a),{validation:n,code:Le.invalid_string,...Ye.errToObj(r)})}_addCheck(t){return new va({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...Ye.errToObj(t)})}url(t){return this._addCheck({kind:"url",...Ye.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...Ye.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...Ye.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...Ye.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...Ye.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...Ye.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...Ye.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...Ye.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...Ye.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...Ye.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...Ye.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...Ye.errToObj(t)})}datetime(t){return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(t==null?void 0:t.offset)??!1,local:(t==null?void 0:t.local)??!1,...Ye.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...Ye.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...Ye.errToObj(t)})}regex(t,n){return this._addCheck({kind:"regex",regex:t,...Ye.errToObj(n)})}includes(t,n){return this._addCheck({kind:"includes",value:t,position:n==null?void 0:n.position,...Ye.errToObj(n==null?void 0:n.message)})}startsWith(t,n){return this._addCheck({kind:"startsWith",value:t,...Ye.errToObj(n)})}endsWith(t,n){return this._addCheck({kind:"endsWith",value:t,...Ye.errToObj(n)})}min(t,n){return this._addCheck({kind:"min",value:t,...Ye.errToObj(n)})}max(t,n){return this._addCheck({kind:"max",value:t,...Ye.errToObj(n)})}length(t,n){return this._addCheck({kind:"length",value:t,...Ye.errToObj(n)})}nonempty(t){return this.min(1,Ye.errToObj(t))}trim(){return new va({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new va({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new va({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxLength(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}va.create=e=>new va({checks:[],typeName:nt.ZodString,coerce:(e==null?void 0:e.coerce)??!1,...ft(e)});function uw(e,t){const n=(e.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,a=n>r?n:r,l=Number.parseInt(e.toFixed(a).replace(".","")),c=Number.parseInt(t.toFixed(a).replace(".",""));return l%c/10**a}class os extends wt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==$e.number){const l=this._getOrReturnCtx(t);return He(l,{code:Le.invalid_type,expected:$e.number,received:l.parsedType}),rt}let r;const a=new ur;for(const l of this._def.checks)l.kind==="int"?Ot.isInteger(t.data)||(r=this._getOrReturnCtx(t,r),He(r,{code:Le.invalid_type,expected:"integer",received:"float",message:l.message}),a.dirty()):l.kind==="min"?(l.inclusive?t.data<l.value:t.data<=l.value)&&(r=this._getOrReturnCtx(t,r),He(r,{code:Le.too_small,minimum:l.value,type:"number",inclusive:l.inclusive,exact:!1,message:l.message}),a.dirty()):l.kind==="max"?(l.inclusive?t.data>l.value:t.data>=l.value)&&(r=this._getOrReturnCtx(t,r),He(r,{code:Le.too_big,maximum:l.value,type:"number",inclusive:l.inclusive,exact:!1,message:l.message}),a.dirty()):l.kind==="multipleOf"?uw(t.data,l.value)!==0&&(r=this._getOrReturnCtx(t,r),He(r,{code:Le.not_multiple_of,multipleOf:l.value,message:l.message}),a.dirty()):l.kind==="finite"?Number.isFinite(t.data)||(r=this._getOrReturnCtx(t,r),He(r,{code:Le.not_finite,message:l.message}),a.dirty()):Ot.assertNever(l);return{status:a.value,value:t.data}}gte(t,n){return this.setLimit("min",t,!0,Ye.toString(n))}gt(t,n){return this.setLimit("min",t,!1,Ye.toString(n))}lte(t,n){return this.setLimit("max",t,!0,Ye.toString(n))}lt(t,n){return this.setLimit("max",t,!1,Ye.toString(n))}setLimit(t,n,r,a){return new os({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:Ye.toString(a)}]})}_addCheck(t){return new os({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:Ye.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Ye.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Ye.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Ye.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Ye.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:Ye.toString(n)})}finite(t){return this._addCheck({kind:"finite",message:Ye.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Ye.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Ye.toString(t)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&Ot.isInteger(t.value))}get isFinite(){let t=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(t===null||r.value<t)&&(t=r.value)}return Number.isFinite(n)&&Number.isFinite(t)}}os.create=e=>new os({checks:[],typeName:nt.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1,...ft(e)});class cs extends wt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==$e.bigint)return this._getInvalidInput(t);let r;const a=new ur;for(const l of this._def.checks)l.kind==="min"?(l.inclusive?t.data<l.value:t.data<=l.value)&&(r=this._getOrReturnCtx(t,r),He(r,{code:Le.too_small,type:"bigint",minimum:l.value,inclusive:l.inclusive,message:l.message}),a.dirty()):l.kind==="max"?(l.inclusive?t.data>l.value:t.data>=l.value)&&(r=this._getOrReturnCtx(t,r),He(r,{code:Le.too_big,type:"bigint",maximum:l.value,inclusive:l.inclusive,message:l.message}),a.dirty()):l.kind==="multipleOf"?t.data%l.value!==BigInt(0)&&(r=this._getOrReturnCtx(t,r),He(r,{code:Le.not_multiple_of,multipleOf:l.value,message:l.message}),a.dirty()):Ot.assertNever(l);return{status:a.value,value:t.data}}_getInvalidInput(t){const n=this._getOrReturnCtx(t);return He(n,{code:Le.invalid_type,expected:$e.bigint,received:n.parsedType}),rt}gte(t,n){return this.setLimit("min",t,!0,Ye.toString(n))}gt(t,n){return this.setLimit("min",t,!1,Ye.toString(n))}lte(t,n){return this.setLimit("max",t,!0,Ye.toString(n))}lt(t,n){return this.setLimit("max",t,!1,Ye.toString(n))}setLimit(t,n,r,a){return new cs({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:Ye.toString(a)}]})}_addCheck(t){return new cs({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Ye.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Ye.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Ye.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Ye.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:Ye.toString(n)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}cs.create=e=>new cs({checks:[],typeName:nt.ZodBigInt,coerce:(e==null?void 0:e.coerce)??!1,...ft(e)});class Vu extends wt{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==$e.boolean){const r=this._getOrReturnCtx(t);return He(r,{code:Le.invalid_type,expected:$e.boolean,received:r.parsedType}),rt}return Yr(t.data)}}Vu.create=e=>new Vu({typeName:nt.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1,...ft(e)});class vl extends wt{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==$e.date){const l=this._getOrReturnCtx(t);return He(l,{code:Le.invalid_type,expected:$e.date,received:l.parsedType}),rt}if(Number.isNaN(t.data.getTime())){const l=this._getOrReturnCtx(t);return He(l,{code:Le.invalid_date}),rt}const r=new ur;let a;for(const l of this._def.checks)l.kind==="min"?t.data.getTime()<l.value&&(a=this._getOrReturnCtx(t,a),He(a,{code:Le.too_small,message:l.message,inclusive:!0,exact:!1,minimum:l.value,type:"date"}),r.dirty()):l.kind==="max"?t.data.getTime()>l.value&&(a=this._getOrReturnCtx(t,a),He(a,{code:Le.too_big,message:l.message,inclusive:!0,exact:!1,maximum:l.value,type:"date"}),r.dirty()):Ot.assertNever(l);return{status:r.value,value:new Date(t.data.getTime())}}_addCheck(t){return new vl({...this._def,checks:[...this._def.checks,t]})}min(t,n){return this._addCheck({kind:"min",value:t.getTime(),message:Ye.toString(n)})}max(t,n){return this._addCheck({kind:"max",value:t.getTime(),message:Ye.toString(n)})}get minDate(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t!=null?new Date(t):null}}vl.create=e=>new vl({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:nt.ZodDate,...ft(e)});class Jg extends wt{_parse(t){if(this._getType(t)!==$e.symbol){const r=this._getOrReturnCtx(t);return He(r,{code:Le.invalid_type,expected:$e.symbol,received:r.parsedType}),rt}return Yr(t.data)}}Jg.create=e=>new Jg({typeName:nt.ZodSymbol,...ft(e)});class Xg extends wt{_parse(t){if(this._getType(t)!==$e.undefined){const r=this._getOrReturnCtx(t);return He(r,{code:Le.invalid_type,expected:$e.undefined,received:r.parsedType}),rt}return Yr(t.data)}}Xg.create=e=>new Xg({typeName:nt.ZodUndefined,...ft(e)});class Kg extends wt{_parse(t){if(this._getType(t)!==$e.null){const r=this._getOrReturnCtx(t);return He(r,{code:Le.invalid_type,expected:$e.null,received:r.parsedType}),rt}return Yr(t.data)}}Kg.create=e=>new Kg({typeName:nt.ZodNull,...ft(e)});class Zg extends wt{constructor(){super(...arguments),this._any=!0}_parse(t){return Yr(t.data)}}Zg.create=e=>new Zg({typeName:nt.ZodAny,...ft(e)});class Yd extends wt{constructor(){super(...arguments),this._unknown=!0}_parse(t){return Yr(t.data)}}Yd.create=e=>new Yd({typeName:nt.ZodUnknown,...ft(e)});class Li extends wt{_parse(t){const n=this._getOrReturnCtx(t);return He(n,{code:Le.invalid_type,expected:$e.never,received:n.parsedType}),rt}}Li.create=e=>new Li({typeName:nt.ZodNever,...ft(e)});class Qg extends wt{_parse(t){if(this._getType(t)!==$e.undefined){const r=this._getOrReturnCtx(t);return He(r,{code:Le.invalid_type,expected:$e.void,received:r.parsedType}),rt}return Yr(t.data)}}Qg.create=e=>new Qg({typeName:nt.ZodVoid,...ft(e)});class Ta extends wt{_parse(t){const{ctx:n,status:r}=this._processInputParams(t),a=this._def;if(n.parsedType!==$e.array)return He(n,{code:Le.invalid_type,expected:$e.array,received:n.parsedType}),rt;if(a.exactLength!==null){const c=n.data.length>a.exactLength.value,u=n.data.length<a.exactLength.value;(c||u)&&(He(n,{code:c?Le.too_big:Le.too_small,minimum:u?a.exactLength.value:void 0,maximum:c?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),r.dirty())}if(a.minLength!==null&&n.data.length<a.minLength.value&&(He(n,{code:Le.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),r.dirty()),a.maxLength!==null&&n.data.length>a.maxLength.value&&(He(n,{code:Le.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((c,u)=>a.type._parseAsync(new _a(n,c,n.path,u)))).then(c=>ur.mergeArray(r,c));const l=[...n.data].map((c,u)=>a.type._parseSync(new _a(n,c,n.path,u)));return ur.mergeArray(r,l)}get element(){return this._def.type}min(t,n){return new Ta({...this._def,minLength:{value:t,message:Ye.toString(n)}})}max(t,n){return new Ta({...this._def,maxLength:{value:t,message:Ye.toString(n)}})}length(t,n){return new Ta({...this._def,exactLength:{value:t,message:Ye.toString(n)}})}nonempty(t){return this.min(1,t)}}Ta.create=(e,t)=>new Ta({type:e,minLength:null,maxLength:null,exactLength:null,typeName:nt.ZodArray,...ft(t)});function ol(e){if(e instanceof wn){const t={};for(const n in e.shape){const r=e.shape[n];t[n]=Mi.create(ol(r))}return new wn({...e._def,shape:()=>t})}else return e instanceof Ta?new Ta({...e._def,type:ol(e.element)}):e instanceof Mi?Mi.create(ol(e.unwrap())):e instanceof _l?_l.create(ol(e.unwrap())):e instanceof us?us.create(e.items.map(t=>ol(t))):e}class wn extends wt{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),n=Ot.objectKeys(t);return this._cached={shape:t,keys:n},this._cached}_parse(t){if(this._getType(t)!==$e.object){const m=this._getOrReturnCtx(t);return He(m,{code:Le.invalid_type,expected:$e.object,received:m.parsedType}),rt}const{status:r,ctx:a}=this._processInputParams(t),{shape:l,keys:c}=this._getCached(),u=[];if(!(this._def.catchall instanceof Li&&this._def.unknownKeys==="strip"))for(const m in a.data)c.includes(m)||u.push(m);const p=[];for(const m of c){const x=l[m],y=a.data[m];p.push({key:{status:"valid",value:m},value:x._parse(new _a(a,y,a.path,m)),alwaysSet:m in a.data})}if(this._def.catchall instanceof Li){const m=this._def.unknownKeys;if(m==="passthrough")for(const x of u)p.push({key:{status:"valid",value:x},value:{status:"valid",value:a.data[x]}});else if(m==="strict")u.length>0&&(He(a,{code:Le.unrecognized_keys,keys:u}),r.dirty());else if(m!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const m=this._def.catchall;for(const x of u){const y=a.data[x];p.push({key:{status:"valid",value:x},value:m._parse(new _a(a,y,a.path,x)),alwaysSet:x in a.data})}}return a.common.async?Promise.resolve().then(async()=>{const m=[];for(const x of p){const y=await x.key,_=await x.value;m.push({key:y,value:_,alwaysSet:x.alwaysSet})}return m}).then(m=>ur.mergeObjectSync(r,m)):ur.mergeObjectSync(r,p)}get shape(){return this._def.shape()}strict(t){return Ye.errToObj,new wn({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(n,r)=>{var l,c;const a=((c=(l=this._def).errorMap)==null?void 0:c.call(l,n,r).message)??r.defaultError;return n.code==="unrecognized_keys"?{message:Ye.errToObj(t).message??a}:{message:a}}}:{}})}strip(){return new wn({...this._def,unknownKeys:"strip"})}passthrough(){return new wn({...this._def,unknownKeys:"passthrough"})}extend(t){return new wn({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new wn({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:nt.ZodObject})}setKey(t,n){return this.augment({[t]:n})}catchall(t){return new wn({...this._def,catchall:t})}pick(t){const n={};for(const r of Ot.objectKeys(t))t[r]&&this.shape[r]&&(n[r]=this.shape[r]);return new wn({...this._def,shape:()=>n})}omit(t){const n={};for(const r of Ot.objectKeys(this.shape))t[r]||(n[r]=this.shape[r]);return new wn({...this._def,shape:()=>n})}deepPartial(){return ol(this)}partial(t){const n={};for(const r of Ot.objectKeys(this.shape)){const a=this.shape[r];t&&!t[r]?n[r]=a:n[r]=a.optional()}return new wn({...this._def,shape:()=>n})}required(t){const n={};for(const r of Ot.objectKeys(this.shape))if(t&&!t[r])n[r]=this.shape[r];else{let l=this.shape[r];for(;l instanceof Mi;)l=l._def.innerType;n[r]=l}return new wn({...this._def,shape:()=>n})}keyof(){return qy(Ot.objectKeys(this.shape))}}wn.create=(e,t)=>new wn({shape:()=>e,unknownKeys:"strip",catchall:Li.create(),typeName:nt.ZodObject,...ft(t)});wn.strictCreate=(e,t)=>new wn({shape:()=>e,unknownKeys:"strict",catchall:Li.create(),typeName:nt.ZodObject,...ft(t)});wn.lazycreate=(e,t)=>new wn({shape:e,unknownKeys:"strip",catchall:Li.create(),typeName:nt.ZodObject,...ft(t)});class Hu extends wt{_parse(t){const{ctx:n}=this._processInputParams(t),r=this._def.options;function a(l){for(const u of l)if(u.result.status==="valid")return u.result;for(const u of l)if(u.result.status==="dirty")return n.common.issues.push(...u.ctx.common.issues),u.result;const c=l.map(u=>new Ja(u.ctx.common.issues));return He(n,{code:Le.invalid_union,unionErrors:c}),rt}if(n.common.async)return Promise.all(r.map(async l=>{const c={...n,common:{...n.common,issues:[]},parent:null};return{result:await l._parseAsync({data:n.data,path:n.path,parent:c}),ctx:c}})).then(a);{let l;const c=[];for(const p of r){const m={...n,common:{...n.common,issues:[]},parent:null},x=p._parseSync({data:n.data,path:n.path,parent:m});if(x.status==="valid")return x;x.status==="dirty"&&!l&&(l={result:x,ctx:m}),m.common.issues.length&&c.push(m.common.issues)}if(l)return n.common.issues.push(...l.ctx.common.issues),l.result;const u=c.map(p=>new Ja(p));return He(n,{code:Le.invalid_union,unionErrors:u}),rt}}get options(){return this._def.options}}Hu.create=(e,t)=>new Hu({options:e,typeName:nt.ZodUnion,...ft(t)});function Wd(e,t){const n=Ai(e),r=Ai(t);if(e===t)return{valid:!0,data:e};if(n===$e.object&&r===$e.object){const a=Ot.objectKeys(t),l=Ot.objectKeys(e).filter(u=>a.indexOf(u)!==-1),c={...e,...t};for(const u of l){const p=Wd(e[u],t[u]);if(!p.valid)return{valid:!1};c[u]=p.data}return{valid:!0,data:c}}else if(n===$e.array&&r===$e.array){if(e.length!==t.length)return{valid:!1};const a=[];for(let l=0;l<e.length;l++){const c=e[l],u=t[l],p=Wd(c,u);if(!p.valid)return{valid:!1};a.push(p.data)}return{valid:!0,data:a}}else return n===$e.date&&r===$e.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class Gu extends wt{_parse(t){const{status:n,ctx:r}=this._processInputParams(t),a=(l,c)=>{if($g(l)||$g(c))return rt;const u=Wd(l.value,c.value);return u.valid?((Yg(l)||Yg(c))&&n.dirty(),{status:n.value,value:u.data}):(He(r,{code:Le.invalid_intersection_types}),rt)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([l,c])=>a(l,c)):a(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}Gu.create=(e,t,n)=>new Gu({left:e,right:t,typeName:nt.ZodIntersection,...ft(n)});class us extends wt{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==$e.array)return He(r,{code:Le.invalid_type,expected:$e.array,received:r.parsedType}),rt;if(r.data.length<this._def.items.length)return He(r,{code:Le.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),rt;!this._def.rest&&r.data.length>this._def.items.length&&(He(r,{code:Le.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const l=[...r.data].map((c,u)=>{const p=this._def.items[u]||this._def.rest;return p?p._parse(new _a(r,c,r.path,u)):null}).filter(c=>!!c);return r.common.async?Promise.all(l).then(c=>ur.mergeArray(n,c)):ur.mergeArray(n,l)}get items(){return this._def.items}rest(t){return new us({...this._def,rest:t})}}us.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new us({items:e,typeName:nt.ZodTuple,rest:null,...ft(t)})};class ju extends wt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==$e.object)return He(r,{code:Le.invalid_type,expected:$e.object,received:r.parsedType}),rt;const a=[],l=this._def.keyType,c=this._def.valueType;for(const u in r.data)a.push({key:l._parse(new _a(r,u,r.path,u)),value:c._parse(new _a(r,r.data[u],r.path,u)),alwaysSet:u in r.data});return r.common.async?ur.mergeObjectAsync(n,a):ur.mergeObjectSync(n,a)}get element(){return this._def.valueType}static create(t,n,r){return n instanceof wt?new ju({keyType:t,valueType:n,typeName:nt.ZodRecord,...ft(r)}):new ju({keyType:va.create(),valueType:t,typeName:nt.ZodRecord,...ft(n)})}}class e1 extends wt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==$e.map)return He(r,{code:Le.invalid_type,expected:$e.map,received:r.parsedType}),rt;const a=this._def.keyType,l=this._def.valueType,c=[...r.data.entries()].map(([u,p],m)=>({key:a._parse(new _a(r,u,r.path,[m,"key"])),value:l._parse(new _a(r,p,r.path,[m,"value"]))}));if(r.common.async){const u=new Map;return Promise.resolve().then(async()=>{for(const p of c){const m=await p.key,x=await p.value;if(m.status==="aborted"||x.status==="aborted")return rt;(m.status==="dirty"||x.status==="dirty")&&n.dirty(),u.set(m.value,x.value)}return{status:n.value,value:u}})}else{const u=new Map;for(const p of c){const m=p.key,x=p.value;if(m.status==="aborted"||x.status==="aborted")return rt;(m.status==="dirty"||x.status==="dirty")&&n.dirty(),u.set(m.value,x.value)}return{status:n.value,value:u}}}}e1.create=(e,t,n)=>new e1({valueType:t,keyType:e,typeName:nt.ZodMap,...ft(n)});class $o extends wt{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==$e.set)return He(r,{code:Le.invalid_type,expected:$e.set,received:r.parsedType}),rt;const a=this._def;a.minSize!==null&&r.data.size<a.minSize.value&&(He(r,{code:Le.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),n.dirty()),a.maxSize!==null&&r.data.size>a.maxSize.value&&(He(r,{code:Le.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),n.dirty());const l=this._def.valueType;function c(p){const m=new Set;for(const x of p){if(x.status==="aborted")return rt;x.status==="dirty"&&n.dirty(),m.add(x.value)}return{status:n.value,value:m}}const u=[...r.data.values()].map((p,m)=>l._parse(new _a(r,p,r.path,m)));return r.common.async?Promise.all(u).then(p=>c(p)):c(u)}min(t,n){return new $o({...this._def,minSize:{value:t,message:Ye.toString(n)}})}max(t,n){return new $o({...this._def,maxSize:{value:t,message:Ye.toString(n)}})}size(t,n){return this.min(t,n).max(t,n)}nonempty(t){return this.min(1,t)}}$o.create=(e,t)=>new $o({valueType:e,minSize:null,maxSize:null,typeName:nt.ZodSet,...ft(t)});class Jd extends wt{get schema(){return this._def.getter()}_parse(t){const{ctx:n}=this._processInputParams(t);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}Jd.create=(e,t)=>new Jd({getter:e,typeName:nt.ZodLazy,...ft(t)});class t1 extends wt{_parse(t){if(t.data!==this._def.value){const n=this._getOrReturnCtx(t);return He(n,{received:n.data,code:Le.invalid_literal,expected:this._def.value}),rt}return{status:"valid",value:t.data}}get value(){return this._def.value}}t1.create=(e,t)=>new t1({value:e,typeName:nt.ZodLiteral,...ft(t)});function qy(e,t){return new yl({values:e,typeName:nt.ZodEnum,...ft(t)})}class yl extends wt{_parse(t){if(typeof t.data!="string"){const n=this._getOrReturnCtx(t),r=this._def.values;return He(n,{expected:Ot.joinValues(r),received:n.parsedType,code:Le.invalid_type}),rt}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(t.data)){const n=this._getOrReturnCtx(t),r=this._def.values;return He(n,{received:n.data,code:Le.invalid_enum_value,options:r}),rt}return Yr(t.data)}get options(){return this._def.values}get enum(){const t={};for(const n of this._def.values)t[n]=n;return t}get Values(){const t={};for(const n of this._def.values)t[n]=n;return t}get Enum(){const t={};for(const n of this._def.values)t[n]=n;return t}extract(t,n=this._def){return yl.create(t,{...this._def,...n})}exclude(t,n=this._def){return yl.create(this.options.filter(r=>!t.includes(r)),{...this._def,...n})}}yl.create=qy;class n1 extends wt{_parse(t){const n=Ot.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(t);if(r.parsedType!==$e.string&&r.parsedType!==$e.number){const a=Ot.objectValues(n);return He(r,{expected:Ot.joinValues(a),received:r.parsedType,code:Le.invalid_type}),rt}if(this._cache||(this._cache=new Set(Ot.getValidEnumValues(this._def.values))),!this._cache.has(t.data)){const a=Ot.objectValues(n);return He(r,{received:r.data,code:Le.invalid_enum_value,options:a}),rt}return Yr(t.data)}get enum(){return this._def.values}}n1.create=(e,t)=>new n1({values:e,typeName:nt.ZodNativeEnum,...ft(t)});class zu extends wt{unwrap(){return this._def.type}_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==$e.promise&&n.common.async===!1)return He(n,{code:Le.invalid_type,expected:$e.promise,received:n.parsedType}),rt;const r=n.parsedType===$e.promise?n.data:Promise.resolve(n.data);return Yr(r.then(a=>this._def.type.parseAsync(a,{path:n.path,errorMap:n.common.contextualErrorMap})))}}zu.create=(e,t)=>new zu({type:e,typeName:nt.ZodPromise,...ft(t)});class Tl extends wt{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===nt.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:n,ctx:r}=this._processInputParams(t),a=this._def.effect||null,l={addIssue:c=>{He(r,c),c.fatal?n.abort():n.dirty()},get path(){return r.path}};if(l.addIssue=l.addIssue.bind(l),a.type==="preprocess"){const c=a.transform(r.data,l);if(r.common.async)return Promise.resolve(c).then(async u=>{if(n.value==="aborted")return rt;const p=await this._def.schema._parseAsync({data:u,path:r.path,parent:r});return p.status==="aborted"?rt:p.status==="dirty"||n.value==="dirty"?ko(p.value):p});{if(n.value==="aborted")return rt;const u=this._def.schema._parseSync({data:c,path:r.path,parent:r});return u.status==="aborted"?rt:u.status==="dirty"||n.value==="dirty"?ko(u.value):u}}if(a.type==="refinement"){const c=u=>{const p=a.refinement(u,l);if(r.common.async)return Promise.resolve(p);if(p instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return u};if(r.common.async===!1){const u=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return u.status==="aborted"?rt:(u.status==="dirty"&&n.dirty(),c(u.value),{status:n.value,value:u.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(u=>u.status==="aborted"?rt:(u.status==="dirty"&&n.dirty(),c(u.value).then(()=>({status:n.value,value:u.value}))))}if(a.type==="transform")if(r.common.async===!1){const c=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!gl(c))return rt;const u=a.transform(c.value,l);if(u instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:u}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(c=>gl(c)?Promise.resolve(a.transform(c.value,l)).then(u=>({status:n.value,value:u})):rt);Ot.assertNever(a)}}Tl.create=(e,t,n)=>new Tl({schema:e,typeName:nt.ZodEffects,effect:t,...ft(n)});Tl.createWithPreprocess=(e,t,n)=>new Tl({schema:t,effect:{type:"preprocess",transform:e},typeName:nt.ZodEffects,...ft(n)});class Mi extends wt{_parse(t){return this._getType(t)===$e.undefined?Yr(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Mi.create=(e,t)=>new Mi({innerType:e,typeName:nt.ZodOptional,...ft(t)});class _l extends wt{_parse(t){return this._getType(t)===$e.null?Yr(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}_l.create=(e,t)=>new _l({innerType:e,typeName:nt.ZodNullable,...ft(t)});class Xd extends wt{_parse(t){const{ctx:n}=this._processInputParams(t);let r=n.data;return n.parsedType===$e.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}Xd.create=(e,t)=>new Xd({innerType:e,typeName:nt.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...ft(t)});class Kd extends wt{_parse(t){const{ctx:n}=this._processInputParams(t),r={...n,common:{...n.common,issues:[]}},a=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return Bu(a)?a.then(l=>({status:"valid",value:l.status==="valid"?l.value:this._def.catchValue({get error(){return new Ja(r.common.issues)},input:r.data})})):{status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new Ja(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}Kd.create=(e,t)=>new Kd({innerType:e,typeName:nt.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...ft(t)});class r1 extends wt{_parse(t){if(this._getType(t)!==$e.nan){const r=this._getOrReturnCtx(t);return He(r,{code:Le.invalid_type,expected:$e.nan,received:r.parsedType}),rt}return{status:"valid",value:t.data}}}r1.create=e=>new r1({typeName:nt.ZodNaN,...ft(e)});class fw extends wt{_parse(t){const{ctx:n}=this._processInputParams(t),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class Sh extends wt{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.common.async)return(async()=>{const l=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return l.status==="aborted"?rt:l.status==="dirty"?(n.dirty(),ko(l.value)):this._def.out._parseAsync({data:l.value,path:r.path,parent:r})})();{const a=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?rt:a.status==="dirty"?(n.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:r.path,parent:r})}}static create(t,n){return new Sh({in:t,out:n,typeName:nt.ZodPipeline})}}class Zd extends wt{_parse(t){const n=this._def.innerType._parse(t),r=a=>(gl(a)&&(a.value=Object.freeze(a.value)),a);return Bu(n)?n.then(a=>r(a)):r(n)}unwrap(){return this._def.innerType}}Zd.create=(e,t)=>new Zd({innerType:e,typeName:nt.ZodReadonly,...ft(t)});var nt;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(nt||(nt={}));const rs=va.create,a1=os.create;cs.create;const dw=Vu.create;vl.create;const i1=Yd.create;Li.create;const No=Ta.create,hw=wn.create,mw=Hu.create;Gu.create;us.create;const pw=ju.create,xw=Jd.create,gw=yl.create;zu.create;Mi.create;_l.create;const al={string:e=>va.create({...e,coerce:!0}),number:e=>os.create({...e,coerce:!0}),boolean:e=>Vu.create({...e,coerce:!0}),bigint:e=>cs.create({...e,coerce:!0}),date:e=>vl.create({...e,coerce:!0})};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let vw,yw;function Tw(){return{geminiUrl:vw,vertexUrl:yw}}function _w(e,t,n){var r,a,l;if(!(!((r=e.httpOptions)===null||r===void 0)&&r.baseUrl)){const c=Tw();return e.vertexai?(a=c.vertexUrl)!==null&&a!==void 0?a:t:(l=c.geminiUrl)!==null&&l!==void 0?l:n}return e.httpOptions.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class xs{}function We(e,t){const n=/\{([^}]+)\}/g;return e.replace(n,(r,a)=>{if(Object.prototype.hasOwnProperty.call(t,a)){const l=t[a];return l!=null?String(l):""}else throw new Error(`Key '${a}' not found in valueMap.`)})}function d(e,t,n){for(let l=0;l<t.length-1;l++){const c=t[l];if(c.endsWith("[]")){const u=c.slice(0,-2);if(!(u in e))if(Array.isArray(n))e[u]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${c}`);if(Array.isArray(e[u])){const p=e[u];if(Array.isArray(n))for(let m=0;m<p.length;m++){const x=p[m];d(x,t.slice(l+1),n[m])}else for(const m of p)d(m,t.slice(l+1),n)}return}else if(c.endsWith("[0]")){const u=c.slice(0,-3);u in e||(e[u]=[{}]);const p=e[u];d(p[0],t.slice(l+1),n);return}(!e[c]||typeof e[c]!="object")&&(e[c]={}),e=e[c]}const r=t[t.length-1],a=e[r];if(a!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===a)return;if(typeof a=="object"&&typeof n=="object"&&a!==null&&n!==null)Object.assign(a,n);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else e[r]=n}function f(e,t){try{if(t.length===1&&t[0]==="_self")return e;for(let n=0;n<t.length;n++){if(typeof e!="object"||e===null)return;const r=t[n];if(r.endsWith("[]")){const a=r.slice(0,-2);if(a in e){const l=e[a];return Array.isArray(l)?l.map(c=>f(c,t.slice(n+1))):void 0}else return}else e=e[r]}return e}catch(n){if(n instanceof TypeError)return;throw n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var s1;(function(e){e.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",e.OUTCOME_OK="OUTCOME_OK",e.OUTCOME_FAILED="OUTCOME_FAILED",e.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(s1||(s1={}));var l1;(function(e){e.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",e.PYTHON="PYTHON"})(l1||(l1={}));var ya;(function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.STRING="STRING",e.NUMBER="NUMBER",e.INTEGER="INTEGER",e.BOOLEAN="BOOLEAN",e.ARRAY="ARRAY",e.OBJECT="OBJECT",e.NULL="NULL"})(ya||(ya={}));var o1;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",e.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",e.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",e.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",e.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT"})(o1||(o1={}));var c1;(function(e){e.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",e.SEVERITY="SEVERITY",e.PROBABILITY="PROBABILITY"})(c1||(c1={}));var u1;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE",e.OFF="OFF"})(u1||(u1={}));var f1;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(f1||(f1={}));var d1;(function(e){e.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",e.NO_AUTH="NO_AUTH",e.API_KEY_AUTH="API_KEY_AUTH",e.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",e.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",e.OAUTH="OAUTH",e.OIDC_AUTH="OIDC_AUTH"})(d1||(d1={}));var h1;(function(e){e.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",e.SIMPLE_SEARCH="SIMPLE_SEARCH",e.ELASTIC_SEARCH="ELASTIC_SEARCH"})(h1||(h1={}));var m1;(function(e){e.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",e.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(m1||(m1={}));var p1;(function(e){e.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",e.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",e.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR"})(p1||(p1={}));var x1;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.IMAGE_SAFETY="IMAGE_SAFETY",e.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL"})(x1||(x1={}));var g1;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(g1||(g1={}));var v1;(function(e){e.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",e.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",e.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",e.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",e.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(v1||(v1={}));var y1;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.IMAGE_SAFETY="IMAGE_SAFETY"})(y1||(y1={}));var T1;(function(e){e.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",e.ON_DEMAND="ON_DEMAND",e.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(T1||(T1={}));var qu;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.AUDIO="AUDIO"})(qu||(qu={}));var _1;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(_1||(_1={}));var Qd;(function(e){e.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",e.JOB_STATE_QUEUED="JOB_STATE_QUEUED",e.JOB_STATE_PENDING="JOB_STATE_PENDING",e.JOB_STATE_RUNNING="JOB_STATE_RUNNING",e.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",e.JOB_STATE_FAILED="JOB_STATE_FAILED",e.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",e.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",e.JOB_STATE_PAUSED="JOB_STATE_PAUSED",e.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",e.JOB_STATE_UPDATING="JOB_STATE_UPDATING",e.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Qd||(Qd={}));var E1;(function(e){e.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",e.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",e.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",e.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",e.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",e.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",e.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(E1||(E1={}));var S1;(function(e){e.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",e.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",e.BALANCED="BALANCED",e.PRIORITIZE_COST="PRIORITIZE_COST"})(S1||(S1={}));var w1;(function(e){e.UNSPECIFIED="UNSPECIFIED",e.BLOCKING="BLOCKING",e.NON_BLOCKING="NON_BLOCKING"})(w1||(w1={}));var C1;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(C1||(C1={}));var A1;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE"})(A1||(A1={}));var b1;(function(e){e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})(b1||(b1={}));var k1;(function(e){e.DONT_ALLOW="DONT_ALLOW",e.ALLOW_ADULT="ALLOW_ADULT",e.ALLOW_ALL="ALLOW_ALL"})(k1||(k1={}));var N1;(function(e){e.auto="auto",e.en="en",e.ja="ja",e.ko="ko",e.hi="hi"})(N1||(N1={}));var M1;(function(e){e.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",e.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",e.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",e.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",e.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(M1||(M1={}));var R1;(function(e){e.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",e.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",e.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",e.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(R1||(R1={}));var D1;(function(e){e.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",e.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",e.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",e.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(D1||(D1={}));var I1;(function(e){e.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",e.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",e.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",e.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",e.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",e.EDIT_MODE_STYLE="EDIT_MODE_STYLE",e.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",e.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(I1||(I1={}));var F1;(function(e){e.OPTIMIZED="OPTIMIZED",e.LOSSLESS="LOSSLESS"})(F1||(F1={}));var L1;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.PROCESSING="PROCESSING",e.ACTIVE="ACTIVE",e.FAILED="FAILED"})(L1||(L1={}));var O1;(function(e){e.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",e.UPLOADED="UPLOADED",e.GENERATED="GENERATED"})(O1||(O1={}));var P1;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e.DOCUMENT="DOCUMENT"})(P1||(P1={}));var U1;(function(e){e.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",e.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",e.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(U1||(U1={}));var B1;(function(e){e.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",e.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",e.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(B1||(B1={}));var V1;(function(e){e.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",e.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",e.NO_INTERRUPTION="NO_INTERRUPTION"})(V1||(V1={}));var H1;(function(e){e.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",e.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",e.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(H1||(H1={}));var G1;(function(e){e.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",e.SILENT="SILENT",e.WHEN_IDLE="WHEN_IDLE",e.INTERRUPT="INTERRUPT"})(G1||(G1={}));var j1;(function(e){e.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",e.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",e.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",e.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",e.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",e.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",e.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",e.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",e.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",e.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",e.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",e.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",e.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(j1||(j1={}));var ul;(function(e){e.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",e.PLAY="PLAY",e.PAUSE="PAUSE",e.STOP="STOP",e.RESET_CONTEXT="RESET_CONTEXT"})(ul||(ul={}));class eh{constructor(t){const n={};for(const r of t.headers.entries())n[r[0]]=r[1];this.headers=n,this.responseInternal=t}json(){return this.responseInternal.json()}}class bo{get text(){var t,n,r,a,l,c,u,p;if(((a=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let m="",x=!1;const y=[];for(const _ of(p=(u=(c=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||c===void 0?void 0:c.content)===null||u===void 0?void 0:u.parts)!==null&&p!==void 0?p:[]){for(const[E,w]of Object.entries(_))E!=="text"&&E!=="thought"&&(w!==null||w!==void 0)&&y.push(E);if(typeof _.text=="string"){if(typeof _.thought=="boolean"&&_.thought)continue;x=!0,m+=_.text}}return y.length>0&&console.warn(`there are non-text parts ${y} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),x?m:void 0}get data(){var t,n,r,a,l,c,u,p;if(((a=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let m="";const x=[];for(const y of(p=(u=(c=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||c===void 0?void 0:c.content)===null||u===void 0?void 0:u.parts)!==null&&p!==void 0?p:[]){for(const[_,E]of Object.entries(y))_!=="inlineData"&&(E!==null||E!==void 0)&&x.push(_);y.inlineData&&typeof y.inlineData.data=="string"&&(m+=atob(y.inlineData.data))}return x.length>0&&console.warn(`there are non-data parts ${x} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),m.length>0?btoa(m):void 0}get functionCalls(){var t,n,r,a,l,c,u,p;if(((a=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const m=(p=(u=(c=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||c===void 0?void 0:c.content)===null||u===void 0?void 0:u.parts)===null||p===void 0?void 0:p.filter(x=>x.functionCall).map(x=>x.functionCall).filter(x=>x!==void 0);if((m==null?void 0:m.length)!==0)return m}get executableCode(){var t,n,r,a,l,c,u,p,m;if(((a=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const x=(p=(u=(c=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||c===void 0?void 0:c.content)===null||u===void 0?void 0:u.parts)===null||p===void 0?void 0:p.filter(y=>y.executableCode).map(y=>y.executableCode).filter(y=>y!==void 0);if((x==null?void 0:x.length)!==0)return(m=x==null?void 0:x[0])===null||m===void 0?void 0:m.code}get codeExecutionResult(){var t,n,r,a,l,c,u,p,m;if(((a=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const x=(p=(u=(c=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||c===void 0?void 0:c.content)===null||u===void 0?void 0:u.parts)===null||p===void 0?void 0:p.filter(y=>y.codeExecutionResult).map(y=>y.codeExecutionResult).filter(y=>y!==void 0);if((x==null?void 0:x.length)!==0)return(m=x==null?void 0:x[0])===null||m===void 0?void 0:m.output}}class z1{}class q1{}class Ew{}class Sw{}class $1{}class Y1{}class W1{}class ww{}class J1{}class X1{}class K1{}class Cw{}class Aw{}class bw{}class Z1{}class kw{get text(){var t,n,r;let a="",l=!1;const c=[];for(const u of(r=(n=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[p,m]of Object.entries(u))p!=="text"&&p!=="thought"&&m!==null&&c.push(p);if(typeof u.text=="string"){if(typeof u.thought=="boolean"&&u.thought)continue;l=!0,a+=u.text}}return c.length>0&&console.warn(`there are non-text parts ${c} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),l?a:void 0}get data(){var t,n,r;let a="";const l=[];for(const c of(r=(n=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[u,p]of Object.entries(c))u!=="inlineData"&&p!==null&&l.push(u);c.inlineData&&typeof c.inlineData.data=="string"&&(a+=atob(c.inlineData.data))}return l.length>0&&console.warn(`there are non-data parts ${l} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),a.length>0?btoa(a):void 0}}class Nw{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Gt(e,t){if(!t||typeof t!="string")throw new Error("model is required and must be a string");if(e.isVertexAI()){if(t.startsWith("publishers/")||t.startsWith("projects/")||t.startsWith("models/"))return t;if(t.indexOf("/")>=0){const n=t.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${t}`}else return t.startsWith("models/")||t.startsWith("tunedModels/")?t:`models/${t}`}function $y(e,t){const n=Gt(e,t);return n?n.startsWith("publishers/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}`:n.startsWith("models/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/publishers/google/${n}`:n:""}function Yy(e){return Array.isArray(e)?e.map(t=>$u(t)):[$u(e)]}function $u(e){if(typeof e=="object"&&e!==null)return e;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof e}`)}function Wy(e){const t=$u(e);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function Jy(e){const t=$u(e);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function Q1(e){if(e==null)throw new Error("PartUnion is required");if(typeof e=="object")return e;if(typeof e=="string")return{text:e};throw new Error(`Unsupported part type: ${typeof e}`)}function Xy(e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("PartListUnion is required");return Array.isArray(e)?e.map(t=>Q1(t)):[Q1(e)]}function th(e){return e!=null&&typeof e=="object"&&"parts"in e&&Array.isArray(e.parts)}function ev(e){return e!=null&&typeof e=="object"&&"functionCall"in e}function tv(e){return e!=null&&typeof e=="object"&&"functionResponse"in e}function Qn(e){if(e==null)throw new Error("ContentUnion is required");return th(e)?e:{role:"user",parts:Xy(e)}}function Ky(e,t){if(!t)return[];if(e.isVertexAI()&&Array.isArray(t))return t.flatMap(n=>{const r=Qn(n);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(e.isVertexAI()){const n=Qn(t);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(t)?t.map(n=>Qn(n)):[Qn(t)]}function qr(e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("contents are required");if(!Array.isArray(e)){if(ev(e)||tv(e))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Qn(e)]}const t=[],n=[],r=th(e[0]);for(const a of e){const l=th(a);if(l!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(l)t.push(a);else{if(ev(a)||tv(a))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(a)}}return r||t.push({role:"user",parts:Xy(n)}),t}const Mw=new Set(["type","format","title","description","default","items","minItems","maxItems","enum","properties","required","minProperties","maxProperties","minimum","maximum","minLength","maxLength","pattern","anyOf","propertyOrdering"]),nv=gw(["string","number","integer","object","array","boolean","null"]),Rw=mw([nv,No(nv)]);function Dw(e=!0){const t=xw(()=>{const n=hw({type:Rw.optional(),format:rs().optional(),title:rs().optional(),description:rs().optional(),default:i1().optional(),items:t.optional(),minItems:al.string().optional(),maxItems:al.string().optional(),enum:No(i1()).optional(),properties:pw(rs(),t).optional(),required:No(rs()).optional(),minProperties:al.string().optional(),maxProperties:al.string().optional(),propertyOrdering:No(rs()).optional(),minimum:a1().optional(),maximum:a1().optional(),minLength:al.string().optional(),maxLength:al.string().optional(),pattern:rs().optional(),anyOf:No(t).optional(),additionalProperties:dw().optional()});return e?n.strict():n});return t}function Iw(e,t){e.includes("null")&&(t.nullable=!0);const n=e.filter(r=>r!=="null");if(n.length===1)t.type=Object.values(ya).includes(n[0].toUpperCase())?n[0].toUpperCase():ya.TYPE_UNSPECIFIED;else{t.anyOf=[];for(const r of n)t.anyOf.push({type:Object.values(ya).includes(r.toUpperCase())?r.toUpperCase():ya.TYPE_UNSPECIFIED})}}function dl(e){const t={},n=["items"],r=["anyOf"],a=["properties"];if(e.type&&e.anyOf)throw new Error("type and anyOf cannot be both populated.");const l=e.anyOf;l!=null&&l.length==2&&(l[0].type==="null"?(t.nullable=!0,e=l[1]):l[1].type==="null"&&(t.nullable=!0,e=l[0])),e.type instanceof Array&&Iw(e.type,t);for(const[c,u]of Object.entries(e))if(u!=null)if(c=="type"){if(u==="null")throw new Error("type: null can not be the only possible type for the field.");if(u instanceof Array)continue;t.type=Object.values(ya).includes(u.toUpperCase())?u.toUpperCase():ya.TYPE_UNSPECIFIED}else if(n.includes(c))t[c]=dl(u);else if(r.includes(c)){const p=[];for(const m of u){if(m.type=="null"){t.nullable=!0;continue}p.push(dl(m))}t[c]=p}else if(a.includes(c)){const p={};for(const[m,x]of Object.entries(u))p[m]=dl(x);t[c]=p}else{if(c==="additionalProperties")continue;t[c]=u}return t}function Yo(e){if(Object.keys(e).includes("$schema")){delete e.$schema;const t=Dw().parse(e);return dl(t)}else return dl(e)}function wh(e){if(typeof e=="object")return e;if(typeof e=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw new Error(`Unsupported speechConfig type: ${typeof e}`)}function Ch(e){if("multiSpeakerVoiceConfig"in e)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return e}function wl(e){if(e.functionDeclarations)for(const t of e.functionDeclarations)t.parameters&&(t.parameters=Yo(t.parameters)),t.response&&(t.response=Yo(t.response));return e}function Cl(e){if(e==null)throw new Error("tools is required");if(!Array.isArray(e))throw new Error("tools is required and must be an array of Tools");const t=[];for(const n of e)t.push(n);return t}function Fw(e,t,n,r=1){const a=!t.startsWith(`${n}/`)&&t.split("/").length===r;return e.isVertexAI()?t.startsWith("projects/")?t:t.startsWith("locations/")?`projects/${e.getProject()}/${t}`:t.startsWith(`${n}/`)?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}`:a?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}/${t}`:t:a?`${n}/${t}`:t}function Za(e,t){if(typeof t!="string")throw new Error("name must be a string");return Fw(e,t,"cachedContents")}function Zy(e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function Qa(e){if(typeof e!="string")throw new Error("fromImageBytes must be a string");return e}function Lw(e){return e!=null&&typeof e=="object"&&"name"in e}function Ow(e){return e!=null&&typeof e=="object"&&"video"in e}function Pw(e){return e!=null&&typeof e=="object"&&"uri"in e}function Qy(e){var t;let n;if(Lw(e)&&(n=e.name),!(Pw(e)&&(n=e.uri,n===void 0))&&!(Ow(e)&&(n=(t=e.video)===null||t===void 0?void 0:t.uri,n===void 0))){if(typeof e=="string"&&(n=e),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const a=n.split("files/")[1].match(/[a-z0-9]+/);if(a===null)throw new Error(`Could not extract file name from URI ${n}`);n=a[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function e2(e,t){let n;return e.isVertexAI()?n=t?"publishers/google/models":"models":n=t?"models":"tunedModels",n}function t2(e){for(const t of["models","tunedModels","publisherModels"])if(Uw(e,t))return e[t];return[]}function Uw(e,t){return e!==null&&typeof e=="object"&&t in e}function Bw(e,t={}){const n=e,r={name:n.name,description:n.description,parameters:dl(of(n.inputSchema))};return t.behavior&&(r.behavior=t.behavior),{functionDeclarations:[r]}}function Vw(e,t={}){const n=[],r=new Set;for(const a of e){const l=a.name;if(r.has(l))throw new Error(`Duplicate function name ${l} found in MCP tools. Please ensure function names are unique.`);r.add(l);const c=Bw(a,t);c.functionDeclarations&&n.push(...c.functionDeclarations)}return{functionDeclarations:n}}function Hw(e){const t=[];for(const n of e)t.push(of(n));return t}function Gw(e){const t={};for(const[n,r]of Object.entries(e)){const a=r;t[n]=of(a)}return t}function of(e){const t=new Set(["items"]),n=new Set(["anyOf"]),r=new Set(["properties"]),a={};for(const[l,c]of Object.entries(e))if(t.has(l))a[l]=of(c);else if(n.has(l))a[l]=Hw(c);else if(r.has(l))a[l]=Gw(c);else if(l==="type"){const u=c.toUpperCase();a[l]=Object.values(ya).includes(u)?u:ya.TYPE_UNSPECIFIED}else Mw.has(l)&&(a[l]=c);return a}function n2(e,t){if(typeof t!="string"&&!Array.isArray(t)){if(e&&e.isVertexAI()){if(t.gcsUri&&t.bigqueryUri)throw new Error("Only one of `gcsUri` or `bigqueryUri` can be set.");if(!t.gcsUri&&!t.bigqueryUri)throw new Error("One of `gcsUri` or `bigqueryUri` must be set.")}else{if(t.inlinedRequests&&t.fileName)throw new Error("Only one of `inlinedRequests` or `fileName` can be set.");if(!t.inlinedRequests&&!t.fileName)throw new Error("One of `inlinedRequests` or `fileName` must be set.")}return t}else{if(Array.isArray(t))return{inlinedRequests:t};if(typeof t=="string"){if(t.startsWith("gs://"))return{format:"jsonl",gcsUri:[t]};if(t.startsWith("bq://"))return{format:"bigquery",bigqueryUri:t};if(t.startsWith("files/"))return{fileName:t}}}throw new Error(`Unsupported source: ${t}`)}function jw(e){const t=e;if(t.startsWith("gs://"))return{format:"jsonl",gcsUri:t};if(t.startsWith("bq://"))return{format:"bigquery",bigqueryUri:t};throw new Error(`Unsupported destination: ${t}`)}function Al(e,t){const n=t;if(!e.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function r2(e){const t=e;return t==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":t==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":t==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":t==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":t==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function zw(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const a=f(e,["startOffset"]);return a!=null&&d(t,["startOffset"],a),t}function qw(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["data"]);n!=null&&d(t,["data"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function $w(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["fileUri"]);n!=null&&d(t,["fileUri"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function Yw(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],zw(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const a=f(e,["inlineData"]);a!=null&&d(t,["inlineData"],qw(a));const l=f(e,["fileData"]);l!=null&&d(t,["fileData"],$w(l));const c=f(e,["thoughtSignature"]);c!=null&&d(t,["thoughtSignature"],c);const u=f(e,["codeExecutionResult"]);u!=null&&d(t,["codeExecutionResult"],u);const p=f(e,["executableCode"]);p!=null&&d(t,["executableCode"],p);const m=f(e,["functionCall"]);m!=null&&d(t,["functionCall"],m);const x=f(e,["functionResponse"]);x!=null&&d(t,["functionResponse"],x);const y=f(e,["text"]);return y!=null&&d(t,["text"],y),t}function a2(e){const t={},n=f(e,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>Yw(l))),d(t,["parts"],a)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function Ww(e){const t={},n=f(e,["anyOf"]);n!=null&&d(t,["anyOf"],n);const r=f(e,["default"]);r!=null&&d(t,["default"],r);const a=f(e,["description"]);a!=null&&d(t,["description"],a);const l=f(e,["enum"]);l!=null&&d(t,["enum"],l);const c=f(e,["example"]);c!=null&&d(t,["example"],c);const u=f(e,["format"]);u!=null&&d(t,["format"],u);const p=f(e,["items"]);p!=null&&d(t,["items"],p);const m=f(e,["maxItems"]);m!=null&&d(t,["maxItems"],m);const x=f(e,["maxLength"]);x!=null&&d(t,["maxLength"],x);const y=f(e,["maxProperties"]);y!=null&&d(t,["maxProperties"],y);const _=f(e,["maximum"]);_!=null&&d(t,["maximum"],_);const E=f(e,["minItems"]);E!=null&&d(t,["minItems"],E);const w=f(e,["minLength"]);w!=null&&d(t,["minLength"],w);const S=f(e,["minProperties"]);S!=null&&d(t,["minProperties"],S);const C=f(e,["minimum"]);C!=null&&d(t,["minimum"],C);const M=f(e,["nullable"]);M!=null&&d(t,["nullable"],M);const k=f(e,["pattern"]);k!=null&&d(t,["pattern"],k);const b=f(e,["properties"]);b!=null&&d(t,["properties"],b);const U=f(e,["propertyOrdering"]);U!=null&&d(t,["propertyOrdering"],U);const G=f(e,["required"]);G!=null&&d(t,["required"],G);const J=f(e,["title"]);J!=null&&d(t,["title"],J);const F=f(e,["type"]);return F!=null&&d(t,["type"],F),t}function Jw(e){const t={};if(f(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=f(e,["category"]);n!=null&&d(t,["category"],n);const r=f(e,["threshold"]);return r!=null&&d(t,["threshold"],r),t}function Xw(e){const t={},n=f(e,["behavior"]);n!=null&&d(t,["behavior"],n);const r=f(e,["description"]);r!=null&&d(t,["description"],r);const a=f(e,["name"]);a!=null&&d(t,["name"],a);const l=f(e,["parameters"]);l!=null&&d(t,["parameters"],l);const c=f(e,["parametersJsonSchema"]);c!=null&&d(t,["parametersJsonSchema"],c);const u=f(e,["response"]);u!=null&&d(t,["response"],u);const p=f(e,["responseJsonSchema"]);return p!=null&&d(t,["responseJsonSchema"],p),t}function Kw(e){const t={},n=f(e,["startTime"]);n!=null&&d(t,["startTime"],n);const r=f(e,["endTime"]);return r!=null&&d(t,["endTime"],r),t}function Zw(e){const t={},n=f(e,["timeRangeFilter"]);return n!=null&&d(t,["timeRangeFilter"],Kw(n)),t}function Qw(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["dynamicThreshold"]);return r!=null&&d(t,["dynamicThreshold"],r),t}function eC(e){const t={},n=f(e,["dynamicRetrievalConfig"]);return n!=null&&d(t,["dynamicRetrievalConfig"],Qw(n)),t}function tC(){return{}}function nC(e){const t={},n=f(e,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(m=>Xw(m))),d(t,["functionDeclarations"],p)}if(f(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=f(e,["googleSearch"]);r!=null&&d(t,["googleSearch"],Zw(r));const a=f(e,["googleSearchRetrieval"]);if(a!=null&&d(t,["googleSearchRetrieval"],eC(a)),f(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(f(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");f(e,["urlContext"])!=null&&d(t,["urlContext"],tC());const c=f(e,["codeExecution"]);c!=null&&d(t,["codeExecution"],c);const u=f(e,["computerUse"]);return u!=null&&d(t,["computerUse"],u),t}function rC(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["allowedFunctionNames"]);return r!=null&&d(t,["allowedFunctionNames"],r),t}function aC(e){const t={},n=f(e,["latitude"]);n!=null&&d(t,["latitude"],n);const r=f(e,["longitude"]);return r!=null&&d(t,["longitude"],r),t}function iC(e){const t={},n=f(e,["latLng"]);n!=null&&d(t,["latLng"],aC(n));const r=f(e,["languageCode"]);return r!=null&&d(t,["languageCode"],r),t}function sC(e){const t={},n=f(e,["functionCallingConfig"]);n!=null&&d(t,["functionCallingConfig"],rC(n));const r=f(e,["retrievalConfig"]);return r!=null&&d(t,["retrievalConfig"],iC(r)),t}function lC(e){const t={},n=f(e,["voiceName"]);return n!=null&&d(t,["voiceName"],n),t}function i2(e){const t={},n=f(e,["prebuiltVoiceConfig"]);return n!=null&&d(t,["prebuiltVoiceConfig"],lC(n)),t}function oC(e){const t={},n=f(e,["speaker"]);n!=null&&d(t,["speaker"],n);const r=f(e,["voiceConfig"]);return r!=null&&d(t,["voiceConfig"],i2(r)),t}function cC(e){const t={},n=f(e,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>oC(a))),d(t,["speakerVoiceConfigs"],r)}return t}function uC(e){const t={},n=f(e,["voiceConfig"]);n!=null&&d(t,["voiceConfig"],i2(n));const r=f(e,["multiSpeakerVoiceConfig"]);r!=null&&d(t,["multiSpeakerVoiceConfig"],cC(r));const a=f(e,["languageCode"]);return a!=null&&d(t,["languageCode"],a),t}function fC(e){const t={},n=f(e,["includeThoughts"]);n!=null&&d(t,["includeThoughts"],n);const r=f(e,["thinkingBudget"]);return r!=null&&d(t,["thinkingBudget"],r),t}function dC(e,t,n){const r={},a=f(t,["systemInstruction"]);n!==void 0&&a!=null&&d(n,["systemInstruction"],a2(Qn(a)));const l=f(t,["temperature"]);l!=null&&d(r,["temperature"],l);const c=f(t,["topP"]);c!=null&&d(r,["topP"],c);const u=f(t,["topK"]);u!=null&&d(r,["topK"],u);const p=f(t,["candidateCount"]);p!=null&&d(r,["candidateCount"],p);const m=f(t,["maxOutputTokens"]);m!=null&&d(r,["maxOutputTokens"],m);const x=f(t,["stopSequences"]);x!=null&&d(r,["stopSequences"],x);const y=f(t,["responseLogprobs"]);y!=null&&d(r,["responseLogprobs"],y);const _=f(t,["logprobs"]);_!=null&&d(r,["logprobs"],_);const E=f(t,["presencePenalty"]);E!=null&&d(r,["presencePenalty"],E);const w=f(t,["frequencyPenalty"]);w!=null&&d(r,["frequencyPenalty"],w);const S=f(t,["seed"]);S!=null&&d(r,["seed"],S);const C=f(t,["responseMimeType"]);C!=null&&d(r,["responseMimeType"],C);const M=f(t,["responseSchema"]);M!=null&&d(r,["responseSchema"],Ww(Yo(M)));const k=f(t,["responseJsonSchema"]);if(k!=null&&d(r,["responseJsonSchema"],k),f(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(f(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const b=f(t,["safetySettings"]);if(n!==void 0&&b!=null){let ne=b;Array.isArray(ne)&&(ne=ne.map(te=>Jw(te))),d(n,["safetySettings"],ne)}const U=f(t,["tools"]);if(n!==void 0&&U!=null){let ne=Cl(U);Array.isArray(ne)&&(ne=ne.map(te=>nC(wl(te)))),d(n,["tools"],ne)}const G=f(t,["toolConfig"]);if(n!==void 0&&G!=null&&d(n,["toolConfig"],sC(G)),f(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const J=f(t,["cachedContent"]);n!==void 0&&J!=null&&d(n,["cachedContent"],Za(e,J));const F=f(t,["responseModalities"]);F!=null&&d(r,["responseModalities"],F);const W=f(t,["mediaResolution"]);W!=null&&d(r,["mediaResolution"],W);const O=f(t,["speechConfig"]);if(O!=null&&d(r,["speechConfig"],uC(wh(O))),f(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const ee=f(t,["thinkingConfig"]);return ee!=null&&d(r,["thinkingConfig"],fC(ee)),r}function hC(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["request","model"],Gt(e,r));const a=f(t,["contents"]);if(a!=null){let c=qr(a);Array.isArray(c)&&(c=c.map(u=>a2(u))),d(n,["request","contents"],c)}const l=f(t,["config"]);return l!=null&&d(n,["request","generationConfig"],dC(e,l,n)),n}function mC(e,t){const n={};if(f(t,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(f(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(f(t,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const r=f(t,["fileName"]);r!=null&&d(n,["fileName"],r);const a=f(t,["inlinedRequests"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(c=>hC(e,c))),d(n,["requests","requests"],l)}return n}function pC(e,t){const n={},r=f(e,["displayName"]);if(t!==void 0&&r!=null&&d(t,["batch","displayName"],r),f(e,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function xC(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],Gt(e,r));const a=f(t,["src"]);a!=null&&d(n,["batch","inputConfig"],mC(e,n2(e,a)));const l=f(t,["config"]);return l!=null&&d(n,["config"],pC(l,n)),n}function gC(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],Al(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],a),n}function vC(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],Al(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],a),n}function yC(e,t){const n={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&d(t,["_query","pageSize"],r);const a=f(e,["pageToken"]);if(t!==void 0&&a!=null&&d(t,["_query","pageToken"],a),f(e,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function TC(e){const t={},n=f(e,["config"]);return n!=null&&d(t,["config"],yC(n,t)),t}function _C(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],Al(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],a),n}function EC(e){const t={},n=f(e,["format"]);n!=null&&d(t,["instancesFormat"],n);const r=f(e,["gcsUri"]);r!=null&&d(t,["gcsSource","uris"],r);const a=f(e,["bigqueryUri"]);if(a!=null&&d(t,["bigquerySource","inputUri"],a),f(e,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(f(e,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return t}function SC(e){const t={},n=f(e,["format"]);n!=null&&d(t,["predictionsFormat"],n);const r=f(e,["gcsUri"]);r!=null&&d(t,["gcsDestination","outputUriPrefix"],r);const a=f(e,["bigqueryUri"]);if(a!=null&&d(t,["bigqueryDestination","outputUri"],a),f(e,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(f(e,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");return t}function wC(e,t){const n={},r=f(e,["displayName"]);t!==void 0&&r!=null&&d(t,["displayName"],r);const a=f(e,["dest"]);return t!==void 0&&a!=null&&d(t,["outputConfig"],SC(jw(a))),n}function CC(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["model"],Gt(e,r));const a=f(t,["src"]);a!=null&&d(n,["inputConfig"],EC(n2(e,a)));const l=f(t,["config"]);return l!=null&&d(n,["config"],wC(l,n)),n}function AC(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],Al(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],a),n}function bC(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],Al(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],a),n}function kC(e,t){const n={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&d(t,["_query","pageSize"],r);const a=f(e,["pageToken"]);t!==void 0&&a!=null&&d(t,["_query","pageToken"],a);const l=f(e,["filter"]);return t!==void 0&&l!=null&&d(t,["_query","filter"],l),n}function NC(e){const t={},n=f(e,["config"]);return n!=null&&d(t,["config"],kC(n,t)),t}function MC(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],Al(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],a),n}function s2(){return{}}function RC(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const a=f(e,["startOffset"]);return a!=null&&d(t,["startOffset"],a),t}function DC(e){const t={},n=f(e,["data"]);n!=null&&d(t,["data"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function IC(e){const t={},n=f(e,["fileUri"]);n!=null&&d(t,["fileUri"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function FC(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],RC(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const a=f(e,["inlineData"]);a!=null&&d(t,["inlineData"],DC(a));const l=f(e,["fileData"]);l!=null&&d(t,["fileData"],IC(l));const c=f(e,["thoughtSignature"]);c!=null&&d(t,["thoughtSignature"],c);const u=f(e,["codeExecutionResult"]);u!=null&&d(t,["codeExecutionResult"],u);const p=f(e,["executableCode"]);p!=null&&d(t,["executableCode"],p);const m=f(e,["functionCall"]);m!=null&&d(t,["functionCall"],m);const x=f(e,["functionResponse"]);x!=null&&d(t,["functionResponse"],x);const y=f(e,["text"]);return y!=null&&d(t,["text"],y),t}function LC(e){const t={},n=f(e,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>FC(l))),d(t,["parts"],a)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function OC(e){const t={},n=f(e,["citationSources"]);return n!=null&&d(t,["citations"],n),t}function PC(e){const t={},n=f(e,["retrievedUrl"]);n!=null&&d(t,["retrievedUrl"],n);const r=f(e,["urlRetrievalStatus"]);return r!=null&&d(t,["urlRetrievalStatus"],r),t}function UC(e){const t={},n=f(e,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>PC(a))),d(t,["urlMetadata"],r)}return t}function BC(e){const t={},n=f(e,["content"]);n!=null&&d(t,["content"],LC(n));const r=f(e,["citationMetadata"]);r!=null&&d(t,["citationMetadata"],OC(r));const a=f(e,["tokenCount"]);a!=null&&d(t,["tokenCount"],a);const l=f(e,["finishReason"]);l!=null&&d(t,["finishReason"],l);const c=f(e,["urlContextMetadata"]);c!=null&&d(t,["urlContextMetadata"],UC(c));const u=f(e,["avgLogprobs"]);u!=null&&d(t,["avgLogprobs"],u);const p=f(e,["groundingMetadata"]);p!=null&&d(t,["groundingMetadata"],p);const m=f(e,["index"]);m!=null&&d(t,["index"],m);const x=f(e,["logprobsResult"]);x!=null&&d(t,["logprobsResult"],x);const y=f(e,["safetyRatings"]);return y!=null&&d(t,["safetyRatings"],y),t}function VC(e){const t={},n=f(e,["candidates"]);if(n!=null){let c=n;Array.isArray(c)&&(c=c.map(u=>BC(u))),d(t,["candidates"],c)}const r=f(e,["modelVersion"]);r!=null&&d(t,["modelVersion"],r);const a=f(e,["promptFeedback"]);a!=null&&d(t,["promptFeedback"],a);const l=f(e,["usageMetadata"]);return l!=null&&d(t,["usageMetadata"],l),t}function HC(e){const t={},n=f(e,["response"]);return n!=null&&d(t,["response"],VC(n)),f(e,["error"])!=null&&d(t,["error"],s2()),t}function GC(e){const t={},n=f(e,["responsesFile"]);n!=null&&d(t,["fileName"],n);const r=f(e,["inlinedResponses","inlinedResponses"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>HC(l))),d(t,["inlinedResponses"],a)}return t}function nh(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["metadata","displayName"]);r!=null&&d(t,["displayName"],r);const a=f(e,["metadata","state"]);a!=null&&d(t,["state"],r2(a));const l=f(e,["metadata","createTime"]);l!=null&&d(t,["createTime"],l);const c=f(e,["metadata","endTime"]);c!=null&&d(t,["endTime"],c);const u=f(e,["metadata","updateTime"]);u!=null&&d(t,["updateTime"],u);const p=f(e,["metadata","model"]);p!=null&&d(t,["model"],p);const m=f(e,["metadata","output"]);return m!=null&&d(t,["dest"],GC(m)),t}function jC(e){const t={},n=f(e,["nextPageToken"]);n!=null&&d(t,["nextPageToken"],n);const r=f(e,["operations"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>nh(l))),d(t,["batchJobs"],a)}return t}function zC(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["done"]);return r!=null&&d(t,["done"],r),f(e,["error"])!=null&&d(t,["error"],s2()),t}function l2(e){const t={},n=f(e,["details"]);n!=null&&d(t,["details"],n);const r=f(e,["code"]);r!=null&&d(t,["code"],r);const a=f(e,["message"]);return a!=null&&d(t,["message"],a),t}function qC(e){const t={},n=f(e,["instancesFormat"]);n!=null&&d(t,["format"],n);const r=f(e,["gcsSource","uris"]);r!=null&&d(t,["gcsUri"],r);const a=f(e,["bigquerySource","inputUri"]);return a!=null&&d(t,["bigqueryUri"],a),t}function $C(e){const t={},n=f(e,["predictionsFormat"]);n!=null&&d(t,["format"],n);const r=f(e,["gcsDestination","outputUriPrefix"]);r!=null&&d(t,["gcsUri"],r);const a=f(e,["bigqueryDestination","outputUri"]);return a!=null&&d(t,["bigqueryUri"],a),t}function rh(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["displayName"]);r!=null&&d(t,["displayName"],r);const a=f(e,["state"]);a!=null&&d(t,["state"],r2(a));const l=f(e,["error"]);l!=null&&d(t,["error"],l2(l));const c=f(e,["createTime"]);c!=null&&d(t,["createTime"],c);const u=f(e,["startTime"]);u!=null&&d(t,["startTime"],u);const p=f(e,["endTime"]);p!=null&&d(t,["endTime"],p);const m=f(e,["updateTime"]);m!=null&&d(t,["updateTime"],m);const x=f(e,["model"]);x!=null&&d(t,["model"],x);const y=f(e,["inputConfig"]);y!=null&&d(t,["src"],qC(y));const _=f(e,["outputConfig"]);return _!=null&&d(t,["dest"],$C(_)),t}function YC(e){const t={},n=f(e,["nextPageToken"]);n!=null&&d(t,["nextPageToken"],n);const r=f(e,["batchPredictionJobs"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>rh(l))),d(t,["batchJobs"],a)}return t}function WC(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["done"]);r!=null&&d(t,["done"],r);const a=f(e,["error"]);return a!=null&&d(t,["error"],l2(a)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var fs;(function(e){e.PAGED_ITEM_BATCH_JOBS="batchJobs",e.PAGED_ITEM_MODELS="models",e.PAGED_ITEM_TUNING_JOBS="tuningJobs",e.PAGED_ITEM_FILES="files",e.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(fs||(fs={}));class sc{constructor(t,n,r,a){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(t,r,a)}init(t,n,r){var a,l;this.nameInternal=t,this.pageInternal=n[this.nameInternal]||[],this.idxInternal=0;let c={config:{}};r?typeof r=="object"?c=Object.assign({},r):c=r:c={config:{}},c.config&&(c.config.pageToken=n.nextPageToken),this.paramsInternal=c,this.pageInternalSize=(l=(a=c.config)===null||a===void 0?void 0:a.pageSize)!==null&&l!==void 0?l:this.pageInternal.length}initNextPage(t){this.init(this.nameInternal,t,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(t){return this.pageInternal[t]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const t=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:t,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const t=await this.requestInternal(this.params);return this.initNextPage(t),this.page}hasNextPage(){var t;return((t=this.params.config)===null||t===void 0?void 0:t.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class JC extends xs{constructor(t){super(),this.apiClient=t,this.create=async n=>{if(this.apiClient.isVertexAI()){const a=Date.now().toString();if(Array.isArray(n.src))throw new Error("InlinedRequest[] is not supported in Vertex AI. Please use Google Cloud Storage URI or BigQuery URI instead.");if(n.config=n.config||{},n.config.displayName===void 0&&(n.config.displayName="genaiBatchJob_${timestampStr}"),n.config.dest===void 0&&typeof n.src=="string")if(n.src.startsWith("gs://")&&n.src.endsWith(".jsonl"))n.config.dest=`${n.src.slice(0,-6)}/dest`;else if(n.src.startsWith("bq://"))n.config.dest=`${n.src}_dest_${a}`;else throw new Error("Unsupported source:"+n.src)}return await this.createInternal(n)},this.list=async(n={})=>new sc(fs.PAGED_ITEM_BATCH_JOBS,r=>this.listInternal(r),await this.listInternal(n),n)}async createInternal(t){var n,r,a,l;let c,u="",p={};if(this.apiClient.isVertexAI()){const m=CC(this.apiClient,t);return u=We("batchPredictionJobs",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(x=>x.json()),c.then(x=>rh(x))}else{const m=xC(this.apiClient,t);return u=We("{model}:batchGenerateContent",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(x=>nh(x))}}async get(t){var n,r,a,l;let c,u="",p={};if(this.apiClient.isVertexAI()){const m=AC(this.apiClient,t);return u=We("batchPredictionJobs/{name}",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(x=>x.json()),c.then(x=>rh(x))}else{const m=gC(this.apiClient,t);return u=We("batches/{name}",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(x=>nh(x))}}async cancel(t){var n,r,a,l;let c="",u={};if(this.apiClient.isVertexAI()){const p=bC(this.apiClient,t);c=We("batchPredictionJobs/{name}:cancel",p._url),u=p._query,delete p.config,delete p._url,delete p._query,await this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal})}else{const p=vC(this.apiClient,t);c=We("batches/{name}:cancel",p._url),u=p._query,delete p.config,delete p._url,delete p._query,await this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal})}}async listInternal(t){var n,r,a,l;let c,u="",p={};if(this.apiClient.isVertexAI()){const m=NC(t);return u=We("batchPredictionJobs",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(x=>x.json()),c.then(x=>{const y=YC(x),_=new Z1;return Object.assign(_,y),_})}else{const m=TC(t);return u=We("batches",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(x=>{const y=jC(x),_=new Z1;return Object.assign(_,y),_})}}async delete(t){var n,r,a,l;let c,u="",p={};if(this.apiClient.isVertexAI()){const m=MC(this.apiClient,t);return u=We("batchPredictionJobs/{name}",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(x=>x.json()),c.then(x=>WC(x))}else{const m=_C(this.apiClient,t);return u=We("batches/{name}",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(x=>zC(x))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function XC(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const a=f(e,["startOffset"]);return a!=null&&d(t,["startOffset"],a),t}function KC(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["data"]);n!=null&&d(t,["data"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function ZC(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["fileUri"]);n!=null&&d(t,["fileUri"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function QC(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],XC(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const a=f(e,["inlineData"]);a!=null&&d(t,["inlineData"],KC(a));const l=f(e,["fileData"]);l!=null&&d(t,["fileData"],ZC(l));const c=f(e,["thoughtSignature"]);c!=null&&d(t,["thoughtSignature"],c);const u=f(e,["codeExecutionResult"]);u!=null&&d(t,["codeExecutionResult"],u);const p=f(e,["executableCode"]);p!=null&&d(t,["executableCode"],p);const m=f(e,["functionCall"]);m!=null&&d(t,["functionCall"],m);const x=f(e,["functionResponse"]);x!=null&&d(t,["functionResponse"],x);const y=f(e,["text"]);return y!=null&&d(t,["text"],y),t}function rv(e){const t={},n=f(e,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>QC(l))),d(t,["parts"],a)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function eA(e){const t={},n=f(e,["behavior"]);n!=null&&d(t,["behavior"],n);const r=f(e,["description"]);r!=null&&d(t,["description"],r);const a=f(e,["name"]);a!=null&&d(t,["name"],a);const l=f(e,["parameters"]);l!=null&&d(t,["parameters"],l);const c=f(e,["parametersJsonSchema"]);c!=null&&d(t,["parametersJsonSchema"],c);const u=f(e,["response"]);u!=null&&d(t,["response"],u);const p=f(e,["responseJsonSchema"]);return p!=null&&d(t,["responseJsonSchema"],p),t}function tA(e){const t={},n=f(e,["startTime"]);n!=null&&d(t,["startTime"],n);const r=f(e,["endTime"]);return r!=null&&d(t,["endTime"],r),t}function nA(e){const t={},n=f(e,["timeRangeFilter"]);return n!=null&&d(t,["timeRangeFilter"],tA(n)),t}function rA(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["dynamicThreshold"]);return r!=null&&d(t,["dynamicThreshold"],r),t}function aA(e){const t={},n=f(e,["dynamicRetrievalConfig"]);return n!=null&&d(t,["dynamicRetrievalConfig"],rA(n)),t}function iA(){return{}}function sA(e){const t={},n=f(e,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(m=>eA(m))),d(t,["functionDeclarations"],p)}if(f(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=f(e,["googleSearch"]);r!=null&&d(t,["googleSearch"],nA(r));const a=f(e,["googleSearchRetrieval"]);if(a!=null&&d(t,["googleSearchRetrieval"],aA(a)),f(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(f(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");f(e,["urlContext"])!=null&&d(t,["urlContext"],iA());const c=f(e,["codeExecution"]);c!=null&&d(t,["codeExecution"],c);const u=f(e,["computerUse"]);return u!=null&&d(t,["computerUse"],u),t}function lA(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["allowedFunctionNames"]);return r!=null&&d(t,["allowedFunctionNames"],r),t}function oA(e){const t={},n=f(e,["latitude"]);n!=null&&d(t,["latitude"],n);const r=f(e,["longitude"]);return r!=null&&d(t,["longitude"],r),t}function cA(e){const t={},n=f(e,["latLng"]);n!=null&&d(t,["latLng"],oA(n));const r=f(e,["languageCode"]);return r!=null&&d(t,["languageCode"],r),t}function uA(e){const t={},n=f(e,["functionCallingConfig"]);n!=null&&d(t,["functionCallingConfig"],lA(n));const r=f(e,["retrievalConfig"]);return r!=null&&d(t,["retrievalConfig"],cA(r)),t}function fA(e,t){const n={},r=f(e,["ttl"]);t!==void 0&&r!=null&&d(t,["ttl"],r);const a=f(e,["expireTime"]);t!==void 0&&a!=null&&d(t,["expireTime"],a);const l=f(e,["displayName"]);t!==void 0&&l!=null&&d(t,["displayName"],l);const c=f(e,["contents"]);if(t!==void 0&&c!=null){let x=qr(c);Array.isArray(x)&&(x=x.map(y=>rv(y))),d(t,["contents"],x)}const u=f(e,["systemInstruction"]);t!==void 0&&u!=null&&d(t,["systemInstruction"],rv(Qn(u)));const p=f(e,["tools"]);if(t!==void 0&&p!=null){let x=p;Array.isArray(x)&&(x=x.map(y=>sA(y))),d(t,["tools"],x)}const m=f(e,["toolConfig"]);if(t!==void 0&&m!=null&&d(t,["toolConfig"],uA(m)),f(e,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function dA(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["model"],$y(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],fA(a,n)),n}function hA(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],Za(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],a),n}function mA(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],Za(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],a),n}function pA(e,t){const n={},r=f(e,["ttl"]);t!==void 0&&r!=null&&d(t,["ttl"],r);const a=f(e,["expireTime"]);return t!==void 0&&a!=null&&d(t,["expireTime"],a),n}function xA(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],Za(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],pA(a,n)),n}function gA(e,t){const n={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&d(t,["_query","pageSize"],r);const a=f(e,["pageToken"]);return t!==void 0&&a!=null&&d(t,["_query","pageToken"],a),n}function vA(e){const t={},n=f(e,["config"]);return n!=null&&d(t,["config"],gA(n,t)),t}function yA(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const a=f(e,["startOffset"]);return a!=null&&d(t,["startOffset"],a),t}function TA(e){const t={},n=f(e,["displayName"]);n!=null&&d(t,["displayName"],n);const r=f(e,["data"]);r!=null&&d(t,["data"],r);const a=f(e,["mimeType"]);return a!=null&&d(t,["mimeType"],a),t}function _A(e){const t={},n=f(e,["displayName"]);n!=null&&d(t,["displayName"],n);const r=f(e,["fileUri"]);r!=null&&d(t,["fileUri"],r);const a=f(e,["mimeType"]);return a!=null&&d(t,["mimeType"],a),t}function EA(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],yA(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const a=f(e,["inlineData"]);a!=null&&d(t,["inlineData"],TA(a));const l=f(e,["fileData"]);l!=null&&d(t,["fileData"],_A(l));const c=f(e,["thoughtSignature"]);c!=null&&d(t,["thoughtSignature"],c);const u=f(e,["codeExecutionResult"]);u!=null&&d(t,["codeExecutionResult"],u);const p=f(e,["executableCode"]);p!=null&&d(t,["executableCode"],p);const m=f(e,["functionCall"]);m!=null&&d(t,["functionCall"],m);const x=f(e,["functionResponse"]);x!=null&&d(t,["functionResponse"],x);const y=f(e,["text"]);return y!=null&&d(t,["text"],y),t}function av(e){const t={},n=f(e,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>EA(l))),d(t,["parts"],a)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function SA(e){const t={};if(f(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=f(e,["description"]);n!=null&&d(t,["description"],n);const r=f(e,["name"]);r!=null&&d(t,["name"],r);const a=f(e,["parameters"]);a!=null&&d(t,["parameters"],a);const l=f(e,["parametersJsonSchema"]);l!=null&&d(t,["parametersJsonSchema"],l);const c=f(e,["response"]);c!=null&&d(t,["response"],c);const u=f(e,["responseJsonSchema"]);return u!=null&&d(t,["responseJsonSchema"],u),t}function wA(e){const t={},n=f(e,["startTime"]);n!=null&&d(t,["startTime"],n);const r=f(e,["endTime"]);return r!=null&&d(t,["endTime"],r),t}function CA(e){const t={},n=f(e,["timeRangeFilter"]);return n!=null&&d(t,["timeRangeFilter"],wA(n)),t}function AA(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["dynamicThreshold"]);return r!=null&&d(t,["dynamicThreshold"],r),t}function bA(e){const t={},n=f(e,["dynamicRetrievalConfig"]);return n!=null&&d(t,["dynamicRetrievalConfig"],AA(n)),t}function kA(){return{}}function NA(e){const t={},n=f(e,["apiKeyString"]);return n!=null&&d(t,["apiKeyString"],n),t}function MA(e){const t={},n=f(e,["apiKeyConfig"]);n!=null&&d(t,["apiKeyConfig"],NA(n));const r=f(e,["authType"]);r!=null&&d(t,["authType"],r);const a=f(e,["googleServiceAccountConfig"]);a!=null&&d(t,["googleServiceAccountConfig"],a);const l=f(e,["httpBasicAuthConfig"]);l!=null&&d(t,["httpBasicAuthConfig"],l);const c=f(e,["oauthConfig"]);c!=null&&d(t,["oauthConfig"],c);const u=f(e,["oidcConfig"]);return u!=null&&d(t,["oidcConfig"],u),t}function RA(e){const t={},n=f(e,["authConfig"]);return n!=null&&d(t,["authConfig"],MA(n)),t}function DA(){return{}}function IA(e){const t={},n=f(e,["functionDeclarations"]);if(n!=null){let y=n;Array.isArray(y)&&(y=y.map(_=>SA(_))),d(t,["functionDeclarations"],y)}const r=f(e,["retrieval"]);r!=null&&d(t,["retrieval"],r);const a=f(e,["googleSearch"]);a!=null&&d(t,["googleSearch"],CA(a));const l=f(e,["googleSearchRetrieval"]);l!=null&&d(t,["googleSearchRetrieval"],bA(l)),f(e,["enterpriseWebSearch"])!=null&&d(t,["enterpriseWebSearch"],kA());const u=f(e,["googleMaps"]);u!=null&&d(t,["googleMaps"],RA(u)),f(e,["urlContext"])!=null&&d(t,["urlContext"],DA());const m=f(e,["codeExecution"]);m!=null&&d(t,["codeExecution"],m);const x=f(e,["computerUse"]);return x!=null&&d(t,["computerUse"],x),t}function FA(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["allowedFunctionNames"]);return r!=null&&d(t,["allowedFunctionNames"],r),t}function LA(e){const t={},n=f(e,["latitude"]);n!=null&&d(t,["latitude"],n);const r=f(e,["longitude"]);return r!=null&&d(t,["longitude"],r),t}function OA(e){const t={},n=f(e,["latLng"]);n!=null&&d(t,["latLng"],LA(n));const r=f(e,["languageCode"]);return r!=null&&d(t,["languageCode"],r),t}function PA(e){const t={},n=f(e,["functionCallingConfig"]);n!=null&&d(t,["functionCallingConfig"],FA(n));const r=f(e,["retrievalConfig"]);return r!=null&&d(t,["retrievalConfig"],OA(r)),t}function UA(e,t){const n={},r=f(e,["ttl"]);t!==void 0&&r!=null&&d(t,["ttl"],r);const a=f(e,["expireTime"]);t!==void 0&&a!=null&&d(t,["expireTime"],a);const l=f(e,["displayName"]);t!==void 0&&l!=null&&d(t,["displayName"],l);const c=f(e,["contents"]);if(t!==void 0&&c!=null){let y=qr(c);Array.isArray(y)&&(y=y.map(_=>av(_))),d(t,["contents"],y)}const u=f(e,["systemInstruction"]);t!==void 0&&u!=null&&d(t,["systemInstruction"],av(Qn(u)));const p=f(e,["tools"]);if(t!==void 0&&p!=null){let y=p;Array.isArray(y)&&(y=y.map(_=>IA(_))),d(t,["tools"],y)}const m=f(e,["toolConfig"]);t!==void 0&&m!=null&&d(t,["toolConfig"],PA(m));const x=f(e,["kmsKeyName"]);return t!==void 0&&x!=null&&d(t,["encryption_spec","kmsKeyName"],x),n}function BA(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["model"],$y(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],UA(a,n)),n}function VA(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],Za(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],a),n}function HA(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],Za(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],a),n}function GA(e,t){const n={},r=f(e,["ttl"]);t!==void 0&&r!=null&&d(t,["ttl"],r);const a=f(e,["expireTime"]);return t!==void 0&&a!=null&&d(t,["expireTime"],a),n}function jA(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],Za(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],GA(a,n)),n}function zA(e,t){const n={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&d(t,["_query","pageSize"],r);const a=f(e,["pageToken"]);return t!==void 0&&a!=null&&d(t,["_query","pageToken"],a),n}function qA(e){const t={},n=f(e,["config"]);return n!=null&&d(t,["config"],zA(n,t)),t}function Ou(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["displayName"]);r!=null&&d(t,["displayName"],r);const a=f(e,["model"]);a!=null&&d(t,["model"],a);const l=f(e,["createTime"]);l!=null&&d(t,["createTime"],l);const c=f(e,["updateTime"]);c!=null&&d(t,["updateTime"],c);const u=f(e,["expireTime"]);u!=null&&d(t,["expireTime"],u);const p=f(e,["usageMetadata"]);return p!=null&&d(t,["usageMetadata"],p),t}function $A(){return{}}function YA(e){const t={},n=f(e,["nextPageToken"]);n!=null&&d(t,["nextPageToken"],n);const r=f(e,["cachedContents"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>Ou(l))),d(t,["cachedContents"],a)}return t}function Pu(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["displayName"]);r!=null&&d(t,["displayName"],r);const a=f(e,["model"]);a!=null&&d(t,["model"],a);const l=f(e,["createTime"]);l!=null&&d(t,["createTime"],l);const c=f(e,["updateTime"]);c!=null&&d(t,["updateTime"],c);const u=f(e,["expireTime"]);u!=null&&d(t,["expireTime"],u);const p=f(e,["usageMetadata"]);return p!=null&&d(t,["usageMetadata"],p),t}function WA(){return{}}function JA(e){const t={},n=f(e,["nextPageToken"]);n!=null&&d(t,["nextPageToken"],n);const r=f(e,["cachedContents"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>Pu(l))),d(t,["cachedContents"],a)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class XA extends xs{constructor(t){super(),this.apiClient=t,this.list=async(n={})=>new sc(fs.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(n),n)}async create(t){var n,r,a,l;let c,u="",p={};if(this.apiClient.isVertexAI()){const m=BA(this.apiClient,t);return u=We("cachedContents",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(x=>x.json()),c.then(x=>Pu(x))}else{const m=dA(this.apiClient,t);return u=We("cachedContents",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(x=>Ou(x))}}async get(t){var n,r,a,l;let c,u="",p={};if(this.apiClient.isVertexAI()){const m=VA(this.apiClient,t);return u=We("{name}",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(x=>x.json()),c.then(x=>Pu(x))}else{const m=hA(this.apiClient,t);return u=We("{name}",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(x=>Ou(x))}}async delete(t){var n,r,a,l;let c,u="",p={};if(this.apiClient.isVertexAI()){const m=HA(this.apiClient,t);return u=We("{name}",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(x=>x.json()),c.then(()=>{const x=WA(),y=new X1;return Object.assign(y,x),y})}else{const m=mA(this.apiClient,t);return u=We("{name}",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(()=>{const x=$A(),y=new X1;return Object.assign(y,x),y})}}async update(t){var n,r,a,l;let c,u="",p={};if(this.apiClient.isVertexAI()){const m=jA(this.apiClient,t);return u=We("{name}",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(x=>x.json()),c.then(x=>Pu(x))}else{const m=xA(this.apiClient,t);return u=We("{name}",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(x=>Ou(x))}}async listInternal(t){var n,r,a,l;let c,u="",p={};if(this.apiClient.isVertexAI()){const m=qA(t);return u=We("cachedContents",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(x=>x.json()),c.then(x=>{const y=JA(x),_=new K1;return Object.assign(_,y),_})}else{const m=vA(t);return u=We("cachedContents",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(x=>{const y=YA(x),_=new K1;return Object.assign(_,y),_})}}}function iv(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function rn(e){return this instanceof rn?(this.v=e,this):new rn(e)}function hl(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(e,t||[]),a,l=[];return a=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",c),a[Symbol.asyncIterator]=function(){return this},a;function c(E){return function(w){return Promise.resolve(w).then(E,y)}}function u(E,w){r[E]&&(a[E]=function(S){return new Promise(function(C,M){l.push([E,S,C,M])>1||p(E,S)})},w&&(a[E]=w(a[E])))}function p(E,w){try{m(r[E](w))}catch(S){_(l[0][3],S)}}function m(E){E.value instanceof rn?Promise.resolve(E.value.v).then(x,y):_(l[0][2],E)}function x(E){p("next",E)}function y(E){p("throw",E)}function _(E,w){E(w),l.shift(),l.length&&p(l[0][0],l[0][1])}}function Lo(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof iv=="function"?iv(e):e[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(l){n[l]=e[l]&&function(c){return new Promise(function(u,p){c=e[l](c),a(u,p,c.done,c.value)})}}function a(l,c,u,p){Promise.resolve(p).then(function(m){l({value:m,done:u})},c)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function KA(e){var t;if(e.candidates==null||e.candidates.length===0)return!1;const n=(t=e.candidates[0])===null||t===void 0?void 0:t.content;return n===void 0?!1:o2(n)}function o2(e){if(e.parts===void 0||e.parts.length===0)return!1;for(const t of e.parts)if(t===void 0||Object.keys(t).length===0||!t.thought&&t.text!==void 0&&t.text==="")return!1;return!0}function ZA(e){if(e.length!==0){for(const t of e)if(t.role!=="user"&&t.role!=="model")throw new Error(`Role must be user or model, but got ${t.role}.`)}}function sv(e){if(e===void 0||e.length===0)return[];const t=[],n=e.length;let r=0;for(;r<n;)if(e[r].role==="user")t.push(e[r]),r++;else{const a=[];let l=!0;for(;r<n&&e[r].role==="model";)a.push(e[r]),l&&!o2(e[r])&&(l=!1),r++;l?t.push(...a):t.pop()}return t}class QA{constructor(t,n){this.modelsModule=t,this.apiClient=n}create(t){return new eb(this.apiClient,this.modelsModule,t.model,t.config,structuredClone(t.history))}}class eb{constructor(t,n,r,a={},l=[]){this.apiClient=t,this.modelsModule=n,this.model=r,this.config=a,this.history=l,this.sendPromise=Promise.resolve(),ZA(l)}async sendMessage(t){var n;await this.sendPromise;const r=Qn(t.message),a=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=t.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var l,c,u;const p=await a,m=(c=(l=p.candidates)===null||l===void 0?void 0:l[0])===null||c===void 0?void 0:c.content,x=p.automaticFunctionCallingHistory,y=this.getHistory(!0).length;let _=[];x!=null&&(_=(u=x.slice(y))!==null&&u!==void 0?u:[]);const E=m?[m]:[];this.recordHistory(r,E,_)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),a}async sendMessageStream(t){var n;await this.sendPromise;const r=Qn(t.message),a=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=t.config)!==null&&n!==void 0?n:this.config});this.sendPromise=a.then(()=>{}).catch(()=>{});const l=await a;return this.processStreamResponse(l,r)}getHistory(t=!1){const n=t?sv(this.history):this.history;return structuredClone(n)}processStreamResponse(t,n){var r,a;return hl(this,arguments,function*(){var c,u,p,m;const x=[];try{for(var y=!0,_=Lo(t),E;E=yield rn(_.next()),c=E.done,!c;y=!0){m=E.value,y=!1;const w=m;if(KA(w)){const S=(a=(r=w.candidates)===null||r===void 0?void 0:r[0])===null||a===void 0?void 0:a.content;S!==void 0&&x.push(S)}yield yield rn(w)}}catch(w){u={error:w}}finally{try{!y&&!c&&(p=_.return)&&(yield rn(p.call(_)))}finally{if(u)throw u.error}}this.recordHistory(n,x)})}recordHistory(t,n,r){let a=[];n.length>0&&n.every(l=>l.role!==void 0)?a=n:a.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...sv(r)):this.history.push(t),this.history.push(...a)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class cf extends Error{constructor(t){super(t.message),this.name="ApiError",this.status=t.status,Object.setPrototypeOf(this,cf.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function tb(e,t){const n={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&d(t,["_query","pageSize"],r);const a=f(e,["pageToken"]);return t!==void 0&&a!=null&&d(t,["_query","pageToken"],a),n}function nb(e){const t={},n=f(e,["config"]);return n!=null&&d(t,["config"],tb(n,t)),t}function rb(e){const t={},n=f(e,["details"]);n!=null&&d(t,["details"],n);const r=f(e,["message"]);r!=null&&d(t,["message"],r);const a=f(e,["code"]);return a!=null&&d(t,["code"],a),t}function ab(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["displayName"]);r!=null&&d(t,["displayName"],r);const a=f(e,["mimeType"]);a!=null&&d(t,["mimeType"],a);const l=f(e,["sizeBytes"]);l!=null&&d(t,["sizeBytes"],l);const c=f(e,["createTime"]);c!=null&&d(t,["createTime"],c);const u=f(e,["expirationTime"]);u!=null&&d(t,["expirationTime"],u);const p=f(e,["updateTime"]);p!=null&&d(t,["updateTime"],p);const m=f(e,["sha256Hash"]);m!=null&&d(t,["sha256Hash"],m);const x=f(e,["uri"]);x!=null&&d(t,["uri"],x);const y=f(e,["downloadUri"]);y!=null&&d(t,["downloadUri"],y);const _=f(e,["state"]);_!=null&&d(t,["state"],_);const E=f(e,["source"]);E!=null&&d(t,["source"],E);const w=f(e,["videoMetadata"]);w!=null&&d(t,["videoMetadata"],w);const S=f(e,["error"]);return S!=null&&d(t,["error"],rb(S)),t}function ib(e){const t={},n=f(e,["file"]);n!=null&&d(t,["file"],ab(n));const r=f(e,["config"]);return r!=null&&d(t,["config"],r),t}function sb(e){const t={},n=f(e,["name"]);n!=null&&d(t,["_url","file"],Qy(n));const r=f(e,["config"]);return r!=null&&d(t,["config"],r),t}function lb(e){const t={},n=f(e,["name"]);n!=null&&d(t,["_url","file"],Qy(n));const r=f(e,["config"]);return r!=null&&d(t,["config"],r),t}function ob(e){const t={},n=f(e,["details"]);n!=null&&d(t,["details"],n);const r=f(e,["message"]);r!=null&&d(t,["message"],r);const a=f(e,["code"]);return a!=null&&d(t,["code"],a),t}function ah(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["displayName"]);r!=null&&d(t,["displayName"],r);const a=f(e,["mimeType"]);a!=null&&d(t,["mimeType"],a);const l=f(e,["sizeBytes"]);l!=null&&d(t,["sizeBytes"],l);const c=f(e,["createTime"]);c!=null&&d(t,["createTime"],c);const u=f(e,["expirationTime"]);u!=null&&d(t,["expirationTime"],u);const p=f(e,["updateTime"]);p!=null&&d(t,["updateTime"],p);const m=f(e,["sha256Hash"]);m!=null&&d(t,["sha256Hash"],m);const x=f(e,["uri"]);x!=null&&d(t,["uri"],x);const y=f(e,["downloadUri"]);y!=null&&d(t,["downloadUri"],y);const _=f(e,["state"]);_!=null&&d(t,["state"],_);const E=f(e,["source"]);E!=null&&d(t,["source"],E);const w=f(e,["videoMetadata"]);w!=null&&d(t,["videoMetadata"],w);const S=f(e,["error"]);return S!=null&&d(t,["error"],ob(S)),t}function cb(e){const t={},n=f(e,["nextPageToken"]);n!=null&&d(t,["nextPageToken"],n);const r=f(e,["files"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>ah(l))),d(t,["files"],a)}return t}function ub(){return{}}function fb(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class db extends xs{constructor(t){super(),this.apiClient=t,this.list=async(n={})=>new sc(fs.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(n),n)}async upload(t){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(t.file,t.config).then(n=>ah(n))}async download(t){await this.apiClient.downloadFile(t)}async listInternal(t){var n,r;let a,l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=nb(t);return l=We("files",u._url),c=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),a.then(p=>{const m=cb(p),x=new Cw;return Object.assign(x,m),x})}}async createInternal(t){var n,r;let a,l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=ib(t);return l=We("upload/v1beta/files",u._url),c=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),a.then(()=>{const p=ub(),m=new Aw;return Object.assign(m,p),m})}}async get(t){var n,r;let a,l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=sb(t);return l=We("files/{file}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),a.then(p=>ah(p))}}async delete(t){var n,r;let a,l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=lb(t);return l=We("files/{file}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),a.then(()=>{const p=fb(),m=new bw;return Object.assign(m,p),m})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function hb(e){const t={},n=f(e,["voiceName"]);return n!=null&&d(t,["voiceName"],n),t}function mb(e){const t={},n=f(e,["voiceName"]);return n!=null&&d(t,["voiceName"],n),t}function c2(e){const t={},n=f(e,["prebuiltVoiceConfig"]);return n!=null&&d(t,["prebuiltVoiceConfig"],hb(n)),t}function pb(e){const t={},n=f(e,["prebuiltVoiceConfig"]);return n!=null&&d(t,["prebuiltVoiceConfig"],mb(n)),t}function xb(e){const t={},n=f(e,["speaker"]);n!=null&&d(t,["speaker"],n);const r=f(e,["voiceConfig"]);return r!=null&&d(t,["voiceConfig"],c2(r)),t}function gb(e){const t={},n=f(e,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>xb(a))),d(t,["speakerVoiceConfigs"],r)}return t}function vb(e){const t={},n=f(e,["voiceConfig"]);n!=null&&d(t,["voiceConfig"],c2(n));const r=f(e,["multiSpeakerVoiceConfig"]);r!=null&&d(t,["multiSpeakerVoiceConfig"],gb(r));const a=f(e,["languageCode"]);return a!=null&&d(t,["languageCode"],a),t}function yb(e){const t={},n=f(e,["voiceConfig"]);if(n!=null&&d(t,["voiceConfig"],pb(n)),f(e,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const r=f(e,["languageCode"]);return r!=null&&d(t,["languageCode"],r),t}function Tb(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const a=f(e,["startOffset"]);return a!=null&&d(t,["startOffset"],a),t}function _b(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const a=f(e,["startOffset"]);return a!=null&&d(t,["startOffset"],a),t}function Eb(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["data"]);n!=null&&d(t,["data"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function Sb(e){const t={},n=f(e,["displayName"]);n!=null&&d(t,["displayName"],n);const r=f(e,["data"]);r!=null&&d(t,["data"],r);const a=f(e,["mimeType"]);return a!=null&&d(t,["mimeType"],a),t}function wb(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["fileUri"]);n!=null&&d(t,["fileUri"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function Cb(e){const t={},n=f(e,["displayName"]);n!=null&&d(t,["displayName"],n);const r=f(e,["fileUri"]);r!=null&&d(t,["fileUri"],r);const a=f(e,["mimeType"]);return a!=null&&d(t,["mimeType"],a),t}function Ab(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],Tb(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const a=f(e,["inlineData"]);a!=null&&d(t,["inlineData"],Eb(a));const l=f(e,["fileData"]);l!=null&&d(t,["fileData"],wb(l));const c=f(e,["thoughtSignature"]);c!=null&&d(t,["thoughtSignature"],c);const u=f(e,["codeExecutionResult"]);u!=null&&d(t,["codeExecutionResult"],u);const p=f(e,["executableCode"]);p!=null&&d(t,["executableCode"],p);const m=f(e,["functionCall"]);m!=null&&d(t,["functionCall"],m);const x=f(e,["functionResponse"]);x!=null&&d(t,["functionResponse"],x);const y=f(e,["text"]);return y!=null&&d(t,["text"],y),t}function bb(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],_b(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const a=f(e,["inlineData"]);a!=null&&d(t,["inlineData"],Sb(a));const l=f(e,["fileData"]);l!=null&&d(t,["fileData"],Cb(l));const c=f(e,["thoughtSignature"]);c!=null&&d(t,["thoughtSignature"],c);const u=f(e,["codeExecutionResult"]);u!=null&&d(t,["codeExecutionResult"],u);const p=f(e,["executableCode"]);p!=null&&d(t,["executableCode"],p);const m=f(e,["functionCall"]);m!=null&&d(t,["functionCall"],m);const x=f(e,["functionResponse"]);x!=null&&d(t,["functionResponse"],x);const y=f(e,["text"]);return y!=null&&d(t,["text"],y),t}function kb(e){const t={},n=f(e,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>Ab(l))),d(t,["parts"],a)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function Nb(e){const t={},n=f(e,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>bb(l))),d(t,["parts"],a)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function Mb(e){const t={},n=f(e,["behavior"]);n!=null&&d(t,["behavior"],n);const r=f(e,["description"]);r!=null&&d(t,["description"],r);const a=f(e,["name"]);a!=null&&d(t,["name"],a);const l=f(e,["parameters"]);l!=null&&d(t,["parameters"],l);const c=f(e,["parametersJsonSchema"]);c!=null&&d(t,["parametersJsonSchema"],c);const u=f(e,["response"]);u!=null&&d(t,["response"],u);const p=f(e,["responseJsonSchema"]);return p!=null&&d(t,["responseJsonSchema"],p),t}function Rb(e){const t={};if(f(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=f(e,["description"]);n!=null&&d(t,["description"],n);const r=f(e,["name"]);r!=null&&d(t,["name"],r);const a=f(e,["parameters"]);a!=null&&d(t,["parameters"],a);const l=f(e,["parametersJsonSchema"]);l!=null&&d(t,["parametersJsonSchema"],l);const c=f(e,["response"]);c!=null&&d(t,["response"],c);const u=f(e,["responseJsonSchema"]);return u!=null&&d(t,["responseJsonSchema"],u),t}function Db(e){const t={},n=f(e,["startTime"]);n!=null&&d(t,["startTime"],n);const r=f(e,["endTime"]);return r!=null&&d(t,["endTime"],r),t}function Ib(e){const t={},n=f(e,["startTime"]);n!=null&&d(t,["startTime"],n);const r=f(e,["endTime"]);return r!=null&&d(t,["endTime"],r),t}function Fb(e){const t={},n=f(e,["timeRangeFilter"]);return n!=null&&d(t,["timeRangeFilter"],Db(n)),t}function Lb(e){const t={},n=f(e,["timeRangeFilter"]);return n!=null&&d(t,["timeRangeFilter"],Ib(n)),t}function Ob(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["dynamicThreshold"]);return r!=null&&d(t,["dynamicThreshold"],r),t}function Pb(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["dynamicThreshold"]);return r!=null&&d(t,["dynamicThreshold"],r),t}function Ub(e){const t={},n=f(e,["dynamicRetrievalConfig"]);return n!=null&&d(t,["dynamicRetrievalConfig"],Ob(n)),t}function Bb(e){const t={},n=f(e,["dynamicRetrievalConfig"]);return n!=null&&d(t,["dynamicRetrievalConfig"],Pb(n)),t}function Vb(){return{}}function Hb(e){const t={},n=f(e,["apiKeyString"]);return n!=null&&d(t,["apiKeyString"],n),t}function Gb(e){const t={},n=f(e,["apiKeyConfig"]);n!=null&&d(t,["apiKeyConfig"],Hb(n));const r=f(e,["authType"]);r!=null&&d(t,["authType"],r);const a=f(e,["googleServiceAccountConfig"]);a!=null&&d(t,["googleServiceAccountConfig"],a);const l=f(e,["httpBasicAuthConfig"]);l!=null&&d(t,["httpBasicAuthConfig"],l);const c=f(e,["oauthConfig"]);c!=null&&d(t,["oauthConfig"],c);const u=f(e,["oidcConfig"]);return u!=null&&d(t,["oidcConfig"],u),t}function jb(e){const t={},n=f(e,["authConfig"]);return n!=null&&d(t,["authConfig"],Gb(n)),t}function zb(){return{}}function qb(){return{}}function $b(e){const t={},n=f(e,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(m=>Mb(m))),d(t,["functionDeclarations"],p)}if(f(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=f(e,["googleSearch"]);r!=null&&d(t,["googleSearch"],Fb(r));const a=f(e,["googleSearchRetrieval"]);if(a!=null&&d(t,["googleSearchRetrieval"],Ub(a)),f(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(f(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");f(e,["urlContext"])!=null&&d(t,["urlContext"],zb());const c=f(e,["codeExecution"]);c!=null&&d(t,["codeExecution"],c);const u=f(e,["computerUse"]);return u!=null&&d(t,["computerUse"],u),t}function Yb(e){const t={},n=f(e,["functionDeclarations"]);if(n!=null){let y=n;Array.isArray(y)&&(y=y.map(_=>Rb(_))),d(t,["functionDeclarations"],y)}const r=f(e,["retrieval"]);r!=null&&d(t,["retrieval"],r);const a=f(e,["googleSearch"]);a!=null&&d(t,["googleSearch"],Lb(a));const l=f(e,["googleSearchRetrieval"]);l!=null&&d(t,["googleSearchRetrieval"],Bb(l)),f(e,["enterpriseWebSearch"])!=null&&d(t,["enterpriseWebSearch"],Vb());const u=f(e,["googleMaps"]);u!=null&&d(t,["googleMaps"],jb(u)),f(e,["urlContext"])!=null&&d(t,["urlContext"],qb());const m=f(e,["codeExecution"]);m!=null&&d(t,["codeExecution"],m);const x=f(e,["computerUse"]);return x!=null&&d(t,["computerUse"],x),t}function Wb(e){const t={},n=f(e,["handle"]);if(n!=null&&d(t,["handle"],n),f(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function Jb(e){const t={},n=f(e,["handle"]);n!=null&&d(t,["handle"],n);const r=f(e,["transparent"]);return r!=null&&d(t,["transparent"],r),t}function lv(){return{}}function ov(){return{}}function Xb(e){const t={},n=f(e,["disabled"]);n!=null&&d(t,["disabled"],n);const r=f(e,["startOfSpeechSensitivity"]);r!=null&&d(t,["startOfSpeechSensitivity"],r);const a=f(e,["endOfSpeechSensitivity"]);a!=null&&d(t,["endOfSpeechSensitivity"],a);const l=f(e,["prefixPaddingMs"]);l!=null&&d(t,["prefixPaddingMs"],l);const c=f(e,["silenceDurationMs"]);return c!=null&&d(t,["silenceDurationMs"],c),t}function Kb(e){const t={},n=f(e,["disabled"]);n!=null&&d(t,["disabled"],n);const r=f(e,["startOfSpeechSensitivity"]);r!=null&&d(t,["startOfSpeechSensitivity"],r);const a=f(e,["endOfSpeechSensitivity"]);a!=null&&d(t,["endOfSpeechSensitivity"],a);const l=f(e,["prefixPaddingMs"]);l!=null&&d(t,["prefixPaddingMs"],l);const c=f(e,["silenceDurationMs"]);return c!=null&&d(t,["silenceDurationMs"],c),t}function Zb(e){const t={},n=f(e,["automaticActivityDetection"]);n!=null&&d(t,["automaticActivityDetection"],Xb(n));const r=f(e,["activityHandling"]);r!=null&&d(t,["activityHandling"],r);const a=f(e,["turnCoverage"]);return a!=null&&d(t,["turnCoverage"],a),t}function Qb(e){const t={},n=f(e,["automaticActivityDetection"]);n!=null&&d(t,["automaticActivityDetection"],Kb(n));const r=f(e,["activityHandling"]);r!=null&&d(t,["activityHandling"],r);const a=f(e,["turnCoverage"]);return a!=null&&d(t,["turnCoverage"],a),t}function ek(e){const t={},n=f(e,["targetTokens"]);return n!=null&&d(t,["targetTokens"],n),t}function tk(e){const t={},n=f(e,["targetTokens"]);return n!=null&&d(t,["targetTokens"],n),t}function nk(e){const t={},n=f(e,["triggerTokens"]);n!=null&&d(t,["triggerTokens"],n);const r=f(e,["slidingWindow"]);return r!=null&&d(t,["slidingWindow"],ek(r)),t}function rk(e){const t={},n=f(e,["triggerTokens"]);n!=null&&d(t,["triggerTokens"],n);const r=f(e,["slidingWindow"]);return r!=null&&d(t,["slidingWindow"],tk(r)),t}function ak(e){const t={},n=f(e,["proactiveAudio"]);return n!=null&&d(t,["proactiveAudio"],n),t}function ik(e){const t={},n=f(e,["proactiveAudio"]);return n!=null&&d(t,["proactiveAudio"],n),t}function sk(e,t){const n={},r=f(e,["generationConfig"]);t!==void 0&&r!=null&&d(t,["setup","generationConfig"],r);const a=f(e,["responseModalities"]);t!==void 0&&a!=null&&d(t,["setup","generationConfig","responseModalities"],a);const l=f(e,["temperature"]);t!==void 0&&l!=null&&d(t,["setup","generationConfig","temperature"],l);const c=f(e,["topP"]);t!==void 0&&c!=null&&d(t,["setup","generationConfig","topP"],c);const u=f(e,["topK"]);t!==void 0&&u!=null&&d(t,["setup","generationConfig","topK"],u);const p=f(e,["maxOutputTokens"]);t!==void 0&&p!=null&&d(t,["setup","generationConfig","maxOutputTokens"],p);const m=f(e,["mediaResolution"]);t!==void 0&&m!=null&&d(t,["setup","generationConfig","mediaResolution"],m);const x=f(e,["seed"]);t!==void 0&&x!=null&&d(t,["setup","generationConfig","seed"],x);const y=f(e,["speechConfig"]);t!==void 0&&y!=null&&d(t,["setup","generationConfig","speechConfig"],vb(Ch(y)));const _=f(e,["enableAffectiveDialog"]);t!==void 0&&_!=null&&d(t,["setup","generationConfig","enableAffectiveDialog"],_);const E=f(e,["systemInstruction"]);t!==void 0&&E!=null&&d(t,["setup","systemInstruction"],kb(Qn(E)));const w=f(e,["tools"]);if(t!==void 0&&w!=null){let G=Cl(w);Array.isArray(G)&&(G=G.map(J=>$b(wl(J)))),d(t,["setup","tools"],G)}const S=f(e,["sessionResumption"]);t!==void 0&&S!=null&&d(t,["setup","sessionResumption"],Wb(S));const C=f(e,["inputAudioTranscription"]);t!==void 0&&C!=null&&d(t,["setup","inputAudioTranscription"],lv());const M=f(e,["outputAudioTranscription"]);t!==void 0&&M!=null&&d(t,["setup","outputAudioTranscription"],lv());const k=f(e,["realtimeInputConfig"]);t!==void 0&&k!=null&&d(t,["setup","realtimeInputConfig"],Zb(k));const b=f(e,["contextWindowCompression"]);t!==void 0&&b!=null&&d(t,["setup","contextWindowCompression"],nk(b));const U=f(e,["proactivity"]);return t!==void 0&&U!=null&&d(t,["setup","proactivity"],ak(U)),n}function lk(e,t){const n={},r=f(e,["generationConfig"]);t!==void 0&&r!=null&&d(t,["setup","generationConfig"],r);const a=f(e,["responseModalities"]);t!==void 0&&a!=null&&d(t,["setup","generationConfig","responseModalities"],a);const l=f(e,["temperature"]);t!==void 0&&l!=null&&d(t,["setup","generationConfig","temperature"],l);const c=f(e,["topP"]);t!==void 0&&c!=null&&d(t,["setup","generationConfig","topP"],c);const u=f(e,["topK"]);t!==void 0&&u!=null&&d(t,["setup","generationConfig","topK"],u);const p=f(e,["maxOutputTokens"]);t!==void 0&&p!=null&&d(t,["setup","generationConfig","maxOutputTokens"],p);const m=f(e,["mediaResolution"]);t!==void 0&&m!=null&&d(t,["setup","generationConfig","mediaResolution"],m);const x=f(e,["seed"]);t!==void 0&&x!=null&&d(t,["setup","generationConfig","seed"],x);const y=f(e,["speechConfig"]);t!==void 0&&y!=null&&d(t,["setup","generationConfig","speechConfig"],yb(Ch(y)));const _=f(e,["enableAffectiveDialog"]);t!==void 0&&_!=null&&d(t,["setup","generationConfig","enableAffectiveDialog"],_);const E=f(e,["systemInstruction"]);t!==void 0&&E!=null&&d(t,["setup","systemInstruction"],Nb(Qn(E)));const w=f(e,["tools"]);if(t!==void 0&&w!=null){let G=Cl(w);Array.isArray(G)&&(G=G.map(J=>Yb(wl(J)))),d(t,["setup","tools"],G)}const S=f(e,["sessionResumption"]);t!==void 0&&S!=null&&d(t,["setup","sessionResumption"],Jb(S));const C=f(e,["inputAudioTranscription"]);t!==void 0&&C!=null&&d(t,["setup","inputAudioTranscription"],ov());const M=f(e,["outputAudioTranscription"]);t!==void 0&&M!=null&&d(t,["setup","outputAudioTranscription"],ov());const k=f(e,["realtimeInputConfig"]);t!==void 0&&k!=null&&d(t,["setup","realtimeInputConfig"],Qb(k));const b=f(e,["contextWindowCompression"]);t!==void 0&&b!=null&&d(t,["setup","contextWindowCompression"],rk(b));const U=f(e,["proactivity"]);return t!==void 0&&U!=null&&d(t,["setup","proactivity"],ik(U)),n}function ok(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["setup","model"],Gt(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],sk(a,n)),n}function ck(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["setup","model"],Gt(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],lk(a,n)),n}function uk(){return{}}function fk(){return{}}function dk(){return{}}function hk(){return{}}function mk(e){const t={},n=f(e,["media"]);n!=null&&d(t,["mediaChunks"],Yy(n));const r=f(e,["audio"]);r!=null&&d(t,["audio"],Jy(r));const a=f(e,["audioStreamEnd"]);a!=null&&d(t,["audioStreamEnd"],a);const l=f(e,["video"]);l!=null&&d(t,["video"],Wy(l));const c=f(e,["text"]);return c!=null&&d(t,["text"],c),f(e,["activityStart"])!=null&&d(t,["activityStart"],uk()),f(e,["activityEnd"])!=null&&d(t,["activityEnd"],dk()),t}function pk(e){const t={},n=f(e,["media"]);n!=null&&d(t,["mediaChunks"],Yy(n));const r=f(e,["audio"]);r!=null&&d(t,["audio"],Jy(r));const a=f(e,["audioStreamEnd"]);a!=null&&d(t,["audioStreamEnd"],a);const l=f(e,["video"]);l!=null&&d(t,["video"],Wy(l));const c=f(e,["text"]);return c!=null&&d(t,["text"],c),f(e,["activityStart"])!=null&&d(t,["activityStart"],fk()),f(e,["activityEnd"])!=null&&d(t,["activityEnd"],hk()),t}function u2(e){const t={},n=f(e,["text"]);n!=null&&d(t,["text"],n);const r=f(e,["weight"]);return r!=null&&d(t,["weight"],r),t}function xk(e){const t={},n=f(e,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>u2(a))),d(t,["weightedPrompts"],r)}return t}function f2(e){const t={},n=f(e,["temperature"]);n!=null&&d(t,["temperature"],n);const r=f(e,["topK"]);r!=null&&d(t,["topK"],r);const a=f(e,["seed"]);a!=null&&d(t,["seed"],a);const l=f(e,["guidance"]);l!=null&&d(t,["guidance"],l);const c=f(e,["bpm"]);c!=null&&d(t,["bpm"],c);const u=f(e,["density"]);u!=null&&d(t,["density"],u);const p=f(e,["brightness"]);p!=null&&d(t,["brightness"],p);const m=f(e,["scale"]);m!=null&&d(t,["scale"],m);const x=f(e,["muteBass"]);x!=null&&d(t,["muteBass"],x);const y=f(e,["muteDrums"]);y!=null&&d(t,["muteDrums"],y);const _=f(e,["onlyBassAndDrums"]);return _!=null&&d(t,["onlyBassAndDrums"],_),t}function gk(e){const t={},n=f(e,["musicGenerationConfig"]);return n!=null&&d(t,["musicGenerationConfig"],f2(n)),t}function d2(e){const t={},n=f(e,["model"]);return n!=null&&d(t,["model"],n),t}function h2(e){const t={},n=f(e,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>u2(a))),d(t,["weightedPrompts"],r)}return t}function ih(e){const t={},n=f(e,["setup"]);n!=null&&d(t,["setup"],d2(n));const r=f(e,["clientContent"]);r!=null&&d(t,["clientContent"],h2(r));const a=f(e,["musicGenerationConfig"]);a!=null&&d(t,["musicGenerationConfig"],f2(a));const l=f(e,["playbackControl"]);return l!=null&&d(t,["playbackControl"],l),t}function vk(){return{}}function yk(e){const t={},n=f(e,["sessionId"]);return n!=null&&d(t,["sessionId"],n),t}function Tk(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const a=f(e,["startOffset"]);return a!=null&&d(t,["startOffset"],a),t}function _k(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const a=f(e,["startOffset"]);return a!=null&&d(t,["startOffset"],a),t}function Ek(e){const t={},n=f(e,["data"]);n!=null&&d(t,["data"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function Sk(e){const t={},n=f(e,["displayName"]);n!=null&&d(t,["displayName"],n);const r=f(e,["data"]);r!=null&&d(t,["data"],r);const a=f(e,["mimeType"]);return a!=null&&d(t,["mimeType"],a),t}function wk(e){const t={},n=f(e,["fileUri"]);n!=null&&d(t,["fileUri"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function Ck(e){const t={},n=f(e,["displayName"]);n!=null&&d(t,["displayName"],n);const r=f(e,["fileUri"]);r!=null&&d(t,["fileUri"],r);const a=f(e,["mimeType"]);return a!=null&&d(t,["mimeType"],a),t}function Ak(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],Tk(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const a=f(e,["inlineData"]);a!=null&&d(t,["inlineData"],Ek(a));const l=f(e,["fileData"]);l!=null&&d(t,["fileData"],wk(l));const c=f(e,["thoughtSignature"]);c!=null&&d(t,["thoughtSignature"],c);const u=f(e,["codeExecutionResult"]);u!=null&&d(t,["codeExecutionResult"],u);const p=f(e,["executableCode"]);p!=null&&d(t,["executableCode"],p);const m=f(e,["functionCall"]);m!=null&&d(t,["functionCall"],m);const x=f(e,["functionResponse"]);x!=null&&d(t,["functionResponse"],x);const y=f(e,["text"]);return y!=null&&d(t,["text"],y),t}function bk(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],_k(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const a=f(e,["inlineData"]);a!=null&&d(t,["inlineData"],Sk(a));const l=f(e,["fileData"]);l!=null&&d(t,["fileData"],Ck(l));const c=f(e,["thoughtSignature"]);c!=null&&d(t,["thoughtSignature"],c);const u=f(e,["codeExecutionResult"]);u!=null&&d(t,["codeExecutionResult"],u);const p=f(e,["executableCode"]);p!=null&&d(t,["executableCode"],p);const m=f(e,["functionCall"]);m!=null&&d(t,["functionCall"],m);const x=f(e,["functionResponse"]);x!=null&&d(t,["functionResponse"],x);const y=f(e,["text"]);return y!=null&&d(t,["text"],y),t}function kk(e){const t={},n=f(e,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>Ak(l))),d(t,["parts"],a)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function Nk(e){const t={},n=f(e,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>bk(l))),d(t,["parts"],a)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function cv(e){const t={},n=f(e,["text"]);n!=null&&d(t,["text"],n);const r=f(e,["finished"]);return r!=null&&d(t,["finished"],r),t}function uv(e){const t={},n=f(e,["text"]);n!=null&&d(t,["text"],n);const r=f(e,["finished"]);return r!=null&&d(t,["finished"],r),t}function Mk(e){const t={},n=f(e,["retrievedUrl"]);n!=null&&d(t,["retrievedUrl"],n);const r=f(e,["urlRetrievalStatus"]);return r!=null&&d(t,["urlRetrievalStatus"],r),t}function Rk(e){const t={},n=f(e,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>Mk(a))),d(t,["urlMetadata"],r)}return t}function Dk(e){const t={},n=f(e,["modelTurn"]);n!=null&&d(t,["modelTurn"],kk(n));const r=f(e,["turnComplete"]);r!=null&&d(t,["turnComplete"],r);const a=f(e,["interrupted"]);a!=null&&d(t,["interrupted"],a);const l=f(e,["groundingMetadata"]);l!=null&&d(t,["groundingMetadata"],l);const c=f(e,["generationComplete"]);c!=null&&d(t,["generationComplete"],c);const u=f(e,["inputTranscription"]);u!=null&&d(t,["inputTranscription"],cv(u));const p=f(e,["outputTranscription"]);p!=null&&d(t,["outputTranscription"],cv(p));const m=f(e,["urlContextMetadata"]);return m!=null&&d(t,["urlContextMetadata"],Rk(m)),t}function Ik(e){const t={},n=f(e,["modelTurn"]);n!=null&&d(t,["modelTurn"],Nk(n));const r=f(e,["turnComplete"]);r!=null&&d(t,["turnComplete"],r);const a=f(e,["interrupted"]);a!=null&&d(t,["interrupted"],a);const l=f(e,["groundingMetadata"]);l!=null&&d(t,["groundingMetadata"],l);const c=f(e,["generationComplete"]);c!=null&&d(t,["generationComplete"],c);const u=f(e,["inputTranscription"]);u!=null&&d(t,["inputTranscription"],uv(u));const p=f(e,["outputTranscription"]);return p!=null&&d(t,["outputTranscription"],uv(p)),t}function Fk(e){const t={},n=f(e,["id"]);n!=null&&d(t,["id"],n);const r=f(e,["args"]);r!=null&&d(t,["args"],r);const a=f(e,["name"]);return a!=null&&d(t,["name"],a),t}function Lk(e){const t={},n=f(e,["args"]);n!=null&&d(t,["args"],n);const r=f(e,["name"]);return r!=null&&d(t,["name"],r),t}function Ok(e){const t={},n=f(e,["functionCalls"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>Fk(a))),d(t,["functionCalls"],r)}return t}function Pk(e){const t={},n=f(e,["functionCalls"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>Lk(a))),d(t,["functionCalls"],r)}return t}function Uk(e){const t={},n=f(e,["ids"]);return n!=null&&d(t,["ids"],n),t}function Bk(e){const t={},n=f(e,["ids"]);return n!=null&&d(t,["ids"],n),t}function wu(e){const t={},n=f(e,["modality"]);n!=null&&d(t,["modality"],n);const r=f(e,["tokenCount"]);return r!=null&&d(t,["tokenCount"],r),t}function Cu(e){const t={},n=f(e,["modality"]);n!=null&&d(t,["modality"],n);const r=f(e,["tokenCount"]);return r!=null&&d(t,["tokenCount"],r),t}function Vk(e){const t={},n=f(e,["promptTokenCount"]);n!=null&&d(t,["promptTokenCount"],n);const r=f(e,["cachedContentTokenCount"]);r!=null&&d(t,["cachedContentTokenCount"],r);const a=f(e,["responseTokenCount"]);a!=null&&d(t,["responseTokenCount"],a);const l=f(e,["toolUsePromptTokenCount"]);l!=null&&d(t,["toolUsePromptTokenCount"],l);const c=f(e,["thoughtsTokenCount"]);c!=null&&d(t,["thoughtsTokenCount"],c);const u=f(e,["totalTokenCount"]);u!=null&&d(t,["totalTokenCount"],u);const p=f(e,["promptTokensDetails"]);if(p!=null){let _=p;Array.isArray(_)&&(_=_.map(E=>wu(E))),d(t,["promptTokensDetails"],_)}const m=f(e,["cacheTokensDetails"]);if(m!=null){let _=m;Array.isArray(_)&&(_=_.map(E=>wu(E))),d(t,["cacheTokensDetails"],_)}const x=f(e,["responseTokensDetails"]);if(x!=null){let _=x;Array.isArray(_)&&(_=_.map(E=>wu(E))),d(t,["responseTokensDetails"],_)}const y=f(e,["toolUsePromptTokensDetails"]);if(y!=null){let _=y;Array.isArray(_)&&(_=_.map(E=>wu(E))),d(t,["toolUsePromptTokensDetails"],_)}return t}function Hk(e){const t={},n=f(e,["promptTokenCount"]);n!=null&&d(t,["promptTokenCount"],n);const r=f(e,["cachedContentTokenCount"]);r!=null&&d(t,["cachedContentTokenCount"],r);const a=f(e,["candidatesTokenCount"]);a!=null&&d(t,["responseTokenCount"],a);const l=f(e,["toolUsePromptTokenCount"]);l!=null&&d(t,["toolUsePromptTokenCount"],l);const c=f(e,["thoughtsTokenCount"]);c!=null&&d(t,["thoughtsTokenCount"],c);const u=f(e,["totalTokenCount"]);u!=null&&d(t,["totalTokenCount"],u);const p=f(e,["promptTokensDetails"]);if(p!=null){let E=p;Array.isArray(E)&&(E=E.map(w=>Cu(w))),d(t,["promptTokensDetails"],E)}const m=f(e,["cacheTokensDetails"]);if(m!=null){let E=m;Array.isArray(E)&&(E=E.map(w=>Cu(w))),d(t,["cacheTokensDetails"],E)}const x=f(e,["candidatesTokensDetails"]);if(x!=null){let E=x;Array.isArray(E)&&(E=E.map(w=>Cu(w))),d(t,["responseTokensDetails"],E)}const y=f(e,["toolUsePromptTokensDetails"]);if(y!=null){let E=y;Array.isArray(E)&&(E=E.map(w=>Cu(w))),d(t,["toolUsePromptTokensDetails"],E)}const _=f(e,["trafficType"]);return _!=null&&d(t,["trafficType"],_),t}function Gk(e){const t={},n=f(e,["timeLeft"]);return n!=null&&d(t,["timeLeft"],n),t}function jk(e){const t={},n=f(e,["timeLeft"]);return n!=null&&d(t,["timeLeft"],n),t}function zk(e){const t={},n=f(e,["newHandle"]);n!=null&&d(t,["newHandle"],n);const r=f(e,["resumable"]);r!=null&&d(t,["resumable"],r);const a=f(e,["lastConsumedClientMessageIndex"]);return a!=null&&d(t,["lastConsumedClientMessageIndex"],a),t}function qk(e){const t={},n=f(e,["newHandle"]);n!=null&&d(t,["newHandle"],n);const r=f(e,["resumable"]);r!=null&&d(t,["resumable"],r);const a=f(e,["lastConsumedClientMessageIndex"]);return a!=null&&d(t,["lastConsumedClientMessageIndex"],a),t}function $k(e){const t={};f(e,["setupComplete"])!=null&&d(t,["setupComplete"],vk());const r=f(e,["serverContent"]);r!=null&&d(t,["serverContent"],Dk(r));const a=f(e,["toolCall"]);a!=null&&d(t,["toolCall"],Ok(a));const l=f(e,["toolCallCancellation"]);l!=null&&d(t,["toolCallCancellation"],Uk(l));const c=f(e,["usageMetadata"]);c!=null&&d(t,["usageMetadata"],Vk(c));const u=f(e,["goAway"]);u!=null&&d(t,["goAway"],Gk(u));const p=f(e,["sessionResumptionUpdate"]);return p!=null&&d(t,["sessionResumptionUpdate"],zk(p)),t}function Yk(e){const t={},n=f(e,["setupComplete"]);n!=null&&d(t,["setupComplete"],yk(n));const r=f(e,["serverContent"]);r!=null&&d(t,["serverContent"],Ik(r));const a=f(e,["toolCall"]);a!=null&&d(t,["toolCall"],Pk(a));const l=f(e,["toolCallCancellation"]);l!=null&&d(t,["toolCallCancellation"],Bk(l));const c=f(e,["usageMetadata"]);c!=null&&d(t,["usageMetadata"],Hk(c));const u=f(e,["goAway"]);u!=null&&d(t,["goAway"],jk(u));const p=f(e,["sessionResumptionUpdate"]);return p!=null&&d(t,["sessionResumptionUpdate"],qk(p)),t}function Wk(){return{}}function Jk(e){const t={},n=f(e,["text"]);n!=null&&d(t,["text"],n);const r=f(e,["weight"]);return r!=null&&d(t,["weight"],r),t}function Xk(e){const t={},n=f(e,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>Jk(a))),d(t,["weightedPrompts"],r)}return t}function Kk(e){const t={},n=f(e,["temperature"]);n!=null&&d(t,["temperature"],n);const r=f(e,["topK"]);r!=null&&d(t,["topK"],r);const a=f(e,["seed"]);a!=null&&d(t,["seed"],a);const l=f(e,["guidance"]);l!=null&&d(t,["guidance"],l);const c=f(e,["bpm"]);c!=null&&d(t,["bpm"],c);const u=f(e,["density"]);u!=null&&d(t,["density"],u);const p=f(e,["brightness"]);p!=null&&d(t,["brightness"],p);const m=f(e,["scale"]);m!=null&&d(t,["scale"],m);const x=f(e,["muteBass"]);x!=null&&d(t,["muteBass"],x);const y=f(e,["muteDrums"]);y!=null&&d(t,["muteDrums"],y);const _=f(e,["onlyBassAndDrums"]);return _!=null&&d(t,["onlyBassAndDrums"],_),t}function Zk(e){const t={},n=f(e,["clientContent"]);n!=null&&d(t,["clientContent"],Xk(n));const r=f(e,["musicGenerationConfig"]);return r!=null&&d(t,["musicGenerationConfig"],Kk(r)),t}function Qk(e){const t={},n=f(e,["data"]);n!=null&&d(t,["data"],n);const r=f(e,["mimeType"]);r!=null&&d(t,["mimeType"],r);const a=f(e,["sourceMetadata"]);return a!=null&&d(t,["sourceMetadata"],Zk(a)),t}function e4(e){const t={},n=f(e,["audioChunks"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>Qk(a))),d(t,["audioChunks"],r)}return t}function t4(e){const t={},n=f(e,["text"]);n!=null&&d(t,["text"],n);const r=f(e,["filteredReason"]);return r!=null&&d(t,["filteredReason"],r),t}function n4(e){const t={};f(e,["setupComplete"])!=null&&d(t,["setupComplete"],Wk());const r=f(e,["serverContent"]);r!=null&&d(t,["serverContent"],e4(r));const a=f(e,["filteredPrompt"]);return a!=null&&d(t,["filteredPrompt"],t4(a)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function r4(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const a=f(e,["startOffset"]);return a!=null&&d(t,["startOffset"],a),t}function a4(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["data"]);n!=null&&d(t,["data"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function i4(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["fileUri"]);n!=null&&d(t,["fileUri"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function s4(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],r4(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const a=f(e,["inlineData"]);a!=null&&d(t,["inlineData"],a4(a));const l=f(e,["fileData"]);l!=null&&d(t,["fileData"],i4(l));const c=f(e,["thoughtSignature"]);c!=null&&d(t,["thoughtSignature"],c);const u=f(e,["codeExecutionResult"]);u!=null&&d(t,["codeExecutionResult"],u);const p=f(e,["executableCode"]);p!=null&&d(t,["executableCode"],p);const m=f(e,["functionCall"]);m!=null&&d(t,["functionCall"],m);const x=f(e,["functionResponse"]);x!=null&&d(t,["functionResponse"],x);const y=f(e,["text"]);return y!=null&&d(t,["text"],y),t}function uf(e){const t={},n=f(e,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>s4(l))),d(t,["parts"],a)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function l4(e){const t={},n=f(e,["anyOf"]);n!=null&&d(t,["anyOf"],n);const r=f(e,["default"]);r!=null&&d(t,["default"],r);const a=f(e,["description"]);a!=null&&d(t,["description"],a);const l=f(e,["enum"]);l!=null&&d(t,["enum"],l);const c=f(e,["example"]);c!=null&&d(t,["example"],c);const u=f(e,["format"]);u!=null&&d(t,["format"],u);const p=f(e,["items"]);p!=null&&d(t,["items"],p);const m=f(e,["maxItems"]);m!=null&&d(t,["maxItems"],m);const x=f(e,["maxLength"]);x!=null&&d(t,["maxLength"],x);const y=f(e,["maxProperties"]);y!=null&&d(t,["maxProperties"],y);const _=f(e,["maximum"]);_!=null&&d(t,["maximum"],_);const E=f(e,["minItems"]);E!=null&&d(t,["minItems"],E);const w=f(e,["minLength"]);w!=null&&d(t,["minLength"],w);const S=f(e,["minProperties"]);S!=null&&d(t,["minProperties"],S);const C=f(e,["minimum"]);C!=null&&d(t,["minimum"],C);const M=f(e,["nullable"]);M!=null&&d(t,["nullable"],M);const k=f(e,["pattern"]);k!=null&&d(t,["pattern"],k);const b=f(e,["properties"]);b!=null&&d(t,["properties"],b);const U=f(e,["propertyOrdering"]);U!=null&&d(t,["propertyOrdering"],U);const G=f(e,["required"]);G!=null&&d(t,["required"],G);const J=f(e,["title"]);J!=null&&d(t,["title"],J);const F=f(e,["type"]);return F!=null&&d(t,["type"],F),t}function o4(e){const t={};if(f(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=f(e,["category"]);n!=null&&d(t,["category"],n);const r=f(e,["threshold"]);return r!=null&&d(t,["threshold"],r),t}function c4(e){const t={},n=f(e,["behavior"]);n!=null&&d(t,["behavior"],n);const r=f(e,["description"]);r!=null&&d(t,["description"],r);const a=f(e,["name"]);a!=null&&d(t,["name"],a);const l=f(e,["parameters"]);l!=null&&d(t,["parameters"],l);const c=f(e,["parametersJsonSchema"]);c!=null&&d(t,["parametersJsonSchema"],c);const u=f(e,["response"]);u!=null&&d(t,["response"],u);const p=f(e,["responseJsonSchema"]);return p!=null&&d(t,["responseJsonSchema"],p),t}function u4(e){const t={},n=f(e,["startTime"]);n!=null&&d(t,["startTime"],n);const r=f(e,["endTime"]);return r!=null&&d(t,["endTime"],r),t}function f4(e){const t={},n=f(e,["timeRangeFilter"]);return n!=null&&d(t,["timeRangeFilter"],u4(n)),t}function d4(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["dynamicThreshold"]);return r!=null&&d(t,["dynamicThreshold"],r),t}function h4(e){const t={},n=f(e,["dynamicRetrievalConfig"]);return n!=null&&d(t,["dynamicRetrievalConfig"],d4(n)),t}function m4(){return{}}function p4(e){const t={},n=f(e,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(m=>c4(m))),d(t,["functionDeclarations"],p)}if(f(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=f(e,["googleSearch"]);r!=null&&d(t,["googleSearch"],f4(r));const a=f(e,["googleSearchRetrieval"]);if(a!=null&&d(t,["googleSearchRetrieval"],h4(a)),f(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(f(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");f(e,["urlContext"])!=null&&d(t,["urlContext"],m4());const c=f(e,["codeExecution"]);c!=null&&d(t,["codeExecution"],c);const u=f(e,["computerUse"]);return u!=null&&d(t,["computerUse"],u),t}function x4(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["allowedFunctionNames"]);return r!=null&&d(t,["allowedFunctionNames"],r),t}function g4(e){const t={},n=f(e,["latitude"]);n!=null&&d(t,["latitude"],n);const r=f(e,["longitude"]);return r!=null&&d(t,["longitude"],r),t}function v4(e){const t={},n=f(e,["latLng"]);n!=null&&d(t,["latLng"],g4(n));const r=f(e,["languageCode"]);return r!=null&&d(t,["languageCode"],r),t}function y4(e){const t={},n=f(e,["functionCallingConfig"]);n!=null&&d(t,["functionCallingConfig"],x4(n));const r=f(e,["retrievalConfig"]);return r!=null&&d(t,["retrievalConfig"],v4(r)),t}function T4(e){const t={},n=f(e,["voiceName"]);return n!=null&&d(t,["voiceName"],n),t}function m2(e){const t={},n=f(e,["prebuiltVoiceConfig"]);return n!=null&&d(t,["prebuiltVoiceConfig"],T4(n)),t}function _4(e){const t={},n=f(e,["speaker"]);n!=null&&d(t,["speaker"],n);const r=f(e,["voiceConfig"]);return r!=null&&d(t,["voiceConfig"],m2(r)),t}function E4(e){const t={},n=f(e,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>_4(a))),d(t,["speakerVoiceConfigs"],r)}return t}function S4(e){const t={},n=f(e,["voiceConfig"]);n!=null&&d(t,["voiceConfig"],m2(n));const r=f(e,["multiSpeakerVoiceConfig"]);r!=null&&d(t,["multiSpeakerVoiceConfig"],E4(r));const a=f(e,["languageCode"]);return a!=null&&d(t,["languageCode"],a),t}function w4(e){const t={},n=f(e,["includeThoughts"]);n!=null&&d(t,["includeThoughts"],n);const r=f(e,["thinkingBudget"]);return r!=null&&d(t,["thinkingBudget"],r),t}function C4(e,t,n){const r={},a=f(t,["systemInstruction"]);n!==void 0&&a!=null&&d(n,["systemInstruction"],uf(Qn(a)));const l=f(t,["temperature"]);l!=null&&d(r,["temperature"],l);const c=f(t,["topP"]);c!=null&&d(r,["topP"],c);const u=f(t,["topK"]);u!=null&&d(r,["topK"],u);const p=f(t,["candidateCount"]);p!=null&&d(r,["candidateCount"],p);const m=f(t,["maxOutputTokens"]);m!=null&&d(r,["maxOutputTokens"],m);const x=f(t,["stopSequences"]);x!=null&&d(r,["stopSequences"],x);const y=f(t,["responseLogprobs"]);y!=null&&d(r,["responseLogprobs"],y);const _=f(t,["logprobs"]);_!=null&&d(r,["logprobs"],_);const E=f(t,["presencePenalty"]);E!=null&&d(r,["presencePenalty"],E);const w=f(t,["frequencyPenalty"]);w!=null&&d(r,["frequencyPenalty"],w);const S=f(t,["seed"]);S!=null&&d(r,["seed"],S);const C=f(t,["responseMimeType"]);C!=null&&d(r,["responseMimeType"],C);const M=f(t,["responseSchema"]);M!=null&&d(r,["responseSchema"],l4(Yo(M)));const k=f(t,["responseJsonSchema"]);if(k!=null&&d(r,["responseJsonSchema"],k),f(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(f(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const b=f(t,["safetySettings"]);if(n!==void 0&&b!=null){let ne=b;Array.isArray(ne)&&(ne=ne.map(te=>o4(te))),d(n,["safetySettings"],ne)}const U=f(t,["tools"]);if(n!==void 0&&U!=null){let ne=Cl(U);Array.isArray(ne)&&(ne=ne.map(te=>p4(wl(te)))),d(n,["tools"],ne)}const G=f(t,["toolConfig"]);if(n!==void 0&&G!=null&&d(n,["toolConfig"],y4(G)),f(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const J=f(t,["cachedContent"]);n!==void 0&&J!=null&&d(n,["cachedContent"],Za(e,J));const F=f(t,["responseModalities"]);F!=null&&d(r,["responseModalities"],F);const W=f(t,["mediaResolution"]);W!=null&&d(r,["mediaResolution"],W);const O=f(t,["speechConfig"]);if(O!=null&&d(r,["speechConfig"],S4(wh(O))),f(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const ee=f(t,["thinkingConfig"]);return ee!=null&&d(r,["thinkingConfig"],w4(ee)),r}function fv(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],Gt(e,r));const a=f(t,["contents"]);if(a!=null){let c=qr(a);Array.isArray(c)&&(c=c.map(u=>uf(u))),d(n,["contents"],c)}const l=f(t,["config"]);return l!=null&&d(n,["generationConfig"],C4(e,l,n)),n}function A4(e,t){const n={},r=f(e,["taskType"]);t!==void 0&&r!=null&&d(t,["requests[]","taskType"],r);const a=f(e,["title"]);t!==void 0&&a!=null&&d(t,["requests[]","title"],a);const l=f(e,["outputDimensionality"]);if(t!==void 0&&l!=null&&d(t,["requests[]","outputDimensionality"],l),f(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(f(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function b4(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],Gt(e,r));const a=f(t,["contents"]);a!=null&&d(n,["requests[]","content"],Ky(e,a));const l=f(t,["config"]);l!=null&&d(n,["config"],A4(l,n));const c=f(t,["model"]);return c!==void 0&&d(n,["requests[]","model"],Gt(e,c)),n}function k4(e,t){const n={};if(f(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(f(e,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const r=f(e,["numberOfImages"]);t!==void 0&&r!=null&&d(t,["parameters","sampleCount"],r);const a=f(e,["aspectRatio"]);t!==void 0&&a!=null&&d(t,["parameters","aspectRatio"],a);const l=f(e,["guidanceScale"]);if(t!==void 0&&l!=null&&d(t,["parameters","guidanceScale"],l),f(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const c=f(e,["safetyFilterLevel"]);t!==void 0&&c!=null&&d(t,["parameters","safetySetting"],c);const u=f(e,["personGeneration"]);t!==void 0&&u!=null&&d(t,["parameters","personGeneration"],u);const p=f(e,["includeSafetyAttributes"]);t!==void 0&&p!=null&&d(t,["parameters","includeSafetyAttributes"],p);const m=f(e,["includeRaiReason"]);t!==void 0&&m!=null&&d(t,["parameters","includeRaiReason"],m);const x=f(e,["language"]);t!==void 0&&x!=null&&d(t,["parameters","language"],x);const y=f(e,["outputMimeType"]);t!==void 0&&y!=null&&d(t,["parameters","outputOptions","mimeType"],y);const _=f(e,["outputCompressionQuality"]);if(t!==void 0&&_!=null&&d(t,["parameters","outputOptions","compressionQuality"],_),f(e,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(f(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function N4(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],Gt(e,r));const a=f(t,["prompt"]);a!=null&&d(n,["instances[0]","prompt"],a);const l=f(t,["config"]);return l!=null&&d(n,["config"],k4(l,n)),n}function M4(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","name"],Gt(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],a),n}function R4(e,t,n){const r={},a=f(t,["pageSize"]);n!==void 0&&a!=null&&d(n,["_query","pageSize"],a);const l=f(t,["pageToken"]);n!==void 0&&l!=null&&d(n,["_query","pageToken"],l);const c=f(t,["filter"]);n!==void 0&&c!=null&&d(n,["_query","filter"],c);const u=f(t,["queryBase"]);return n!==void 0&&u!=null&&d(n,["_url","models_url"],e2(e,u)),r}function D4(e,t){const n={},r=f(t,["config"]);return r!=null&&d(n,["config"],R4(e,r,n)),n}function I4(e,t){const n={},r=f(e,["displayName"]);t!==void 0&&r!=null&&d(t,["displayName"],r);const a=f(e,["description"]);t!==void 0&&a!=null&&d(t,["description"],a);const l=f(e,["defaultCheckpointId"]);return t!==void 0&&l!=null&&d(t,["defaultCheckpointId"],l),n}function F4(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","name"],Gt(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],I4(a,n)),n}function L4(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","name"],Gt(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],a),n}function O4(e){const t={};if(f(e,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(f(e,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(f(e,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return t}function P4(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],Gt(e,r));const a=f(t,["contents"]);if(a!=null){let c=qr(a);Array.isArray(c)&&(c=c.map(u=>uf(u))),d(n,["contents"],c)}const l=f(t,["config"]);return l!=null&&d(n,["config"],O4(l)),n}function U4(e){const t={};if(f(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=f(e,["imageBytes"]);n!=null&&d(t,["bytesBase64Encoded"],Qa(n));const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function B4(e,t){const n={},r=f(e,["numberOfVideos"]);if(t!==void 0&&r!=null&&d(t,["parameters","sampleCount"],r),f(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(f(e,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const a=f(e,["durationSeconds"]);if(t!==void 0&&a!=null&&d(t,["parameters","durationSeconds"],a),f(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=f(e,["aspectRatio"]);if(t!==void 0&&l!=null&&d(t,["parameters","aspectRatio"],l),f(e,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const c=f(e,["personGeneration"]);if(t!==void 0&&c!=null&&d(t,["parameters","personGeneration"],c),f(e,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const u=f(e,["negativePrompt"]);t!==void 0&&u!=null&&d(t,["parameters","negativePrompt"],u);const p=f(e,["enhancePrompt"]);if(t!==void 0&&p!=null&&d(t,["parameters","enhancePrompt"],p),f(e,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");if(f(e,["lastFrame"])!==void 0)throw new Error("lastFrame parameter is not supported in Gemini API.");if(f(e,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function V4(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],Gt(e,r));const a=f(t,["prompt"]);a!=null&&d(n,["instances[0]","prompt"],a);const l=f(t,["image"]);if(l!=null&&d(n,["instances[0]","image"],U4(l)),f(t,["video"])!==void 0)throw new Error("video parameter is not supported in Gemini API.");const c=f(t,["config"]);return c!=null&&d(n,["config"],B4(c,n)),n}function H4(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const a=f(e,["startOffset"]);return a!=null&&d(t,["startOffset"],a),t}function G4(e){const t={},n=f(e,["displayName"]);n!=null&&d(t,["displayName"],n);const r=f(e,["data"]);r!=null&&d(t,["data"],r);const a=f(e,["mimeType"]);return a!=null&&d(t,["mimeType"],a),t}function j4(e){const t={},n=f(e,["displayName"]);n!=null&&d(t,["displayName"],n);const r=f(e,["fileUri"]);r!=null&&d(t,["fileUri"],r);const a=f(e,["mimeType"]);return a!=null&&d(t,["mimeType"],a),t}function z4(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],H4(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const a=f(e,["inlineData"]);a!=null&&d(t,["inlineData"],G4(a));const l=f(e,["fileData"]);l!=null&&d(t,["fileData"],j4(l));const c=f(e,["thoughtSignature"]);c!=null&&d(t,["thoughtSignature"],c);const u=f(e,["codeExecutionResult"]);u!=null&&d(t,["codeExecutionResult"],u);const p=f(e,["executableCode"]);p!=null&&d(t,["executableCode"],p);const m=f(e,["functionCall"]);m!=null&&d(t,["functionCall"],m);const x=f(e,["functionResponse"]);x!=null&&d(t,["functionResponse"],x);const y=f(e,["text"]);return y!=null&&d(t,["text"],y),t}function bl(e){const t={},n=f(e,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>z4(l))),d(t,["parts"],a)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function q4(e){const t={},n=f(e,["anyOf"]);n!=null&&d(t,["anyOf"],n);const r=f(e,["default"]);r!=null&&d(t,["default"],r);const a=f(e,["description"]);a!=null&&d(t,["description"],a);const l=f(e,["enum"]);l!=null&&d(t,["enum"],l);const c=f(e,["example"]);c!=null&&d(t,["example"],c);const u=f(e,["format"]);u!=null&&d(t,["format"],u);const p=f(e,["items"]);p!=null&&d(t,["items"],p);const m=f(e,["maxItems"]);m!=null&&d(t,["maxItems"],m);const x=f(e,["maxLength"]);x!=null&&d(t,["maxLength"],x);const y=f(e,["maxProperties"]);y!=null&&d(t,["maxProperties"],y);const _=f(e,["maximum"]);_!=null&&d(t,["maximum"],_);const E=f(e,["minItems"]);E!=null&&d(t,["minItems"],E);const w=f(e,["minLength"]);w!=null&&d(t,["minLength"],w);const S=f(e,["minProperties"]);S!=null&&d(t,["minProperties"],S);const C=f(e,["minimum"]);C!=null&&d(t,["minimum"],C);const M=f(e,["nullable"]);M!=null&&d(t,["nullable"],M);const k=f(e,["pattern"]);k!=null&&d(t,["pattern"],k);const b=f(e,["properties"]);b!=null&&d(t,["properties"],b);const U=f(e,["propertyOrdering"]);U!=null&&d(t,["propertyOrdering"],U);const G=f(e,["required"]);G!=null&&d(t,["required"],G);const J=f(e,["title"]);J!=null&&d(t,["title"],J);const F=f(e,["type"]);return F!=null&&d(t,["type"],F),t}function $4(e){const t={},n=f(e,["featureSelectionPreference"]);return n!=null&&d(t,["featureSelectionPreference"],n),t}function Y4(e){const t={},n=f(e,["method"]);n!=null&&d(t,["method"],n);const r=f(e,["category"]);r!=null&&d(t,["category"],r);const a=f(e,["threshold"]);return a!=null&&d(t,["threshold"],a),t}function W4(e){const t={};if(f(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=f(e,["description"]);n!=null&&d(t,["description"],n);const r=f(e,["name"]);r!=null&&d(t,["name"],r);const a=f(e,["parameters"]);a!=null&&d(t,["parameters"],a);const l=f(e,["parametersJsonSchema"]);l!=null&&d(t,["parametersJsonSchema"],l);const c=f(e,["response"]);c!=null&&d(t,["response"],c);const u=f(e,["responseJsonSchema"]);return u!=null&&d(t,["responseJsonSchema"],u),t}function J4(e){const t={},n=f(e,["startTime"]);n!=null&&d(t,["startTime"],n);const r=f(e,["endTime"]);return r!=null&&d(t,["endTime"],r),t}function X4(e){const t={},n=f(e,["timeRangeFilter"]);return n!=null&&d(t,["timeRangeFilter"],J4(n)),t}function K4(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["dynamicThreshold"]);return r!=null&&d(t,["dynamicThreshold"],r),t}function Z4(e){const t={},n=f(e,["dynamicRetrievalConfig"]);return n!=null&&d(t,["dynamicRetrievalConfig"],K4(n)),t}function Q4(){return{}}function eN(e){const t={},n=f(e,["apiKeyString"]);return n!=null&&d(t,["apiKeyString"],n),t}function tN(e){const t={},n=f(e,["apiKeyConfig"]);n!=null&&d(t,["apiKeyConfig"],eN(n));const r=f(e,["authType"]);r!=null&&d(t,["authType"],r);const a=f(e,["googleServiceAccountConfig"]);a!=null&&d(t,["googleServiceAccountConfig"],a);const l=f(e,["httpBasicAuthConfig"]);l!=null&&d(t,["httpBasicAuthConfig"],l);const c=f(e,["oauthConfig"]);c!=null&&d(t,["oauthConfig"],c);const u=f(e,["oidcConfig"]);return u!=null&&d(t,["oidcConfig"],u),t}function nN(e){const t={},n=f(e,["authConfig"]);return n!=null&&d(t,["authConfig"],tN(n)),t}function rN(){return{}}function p2(e){const t={},n=f(e,["functionDeclarations"]);if(n!=null){let y=n;Array.isArray(y)&&(y=y.map(_=>W4(_))),d(t,["functionDeclarations"],y)}const r=f(e,["retrieval"]);r!=null&&d(t,["retrieval"],r);const a=f(e,["googleSearch"]);a!=null&&d(t,["googleSearch"],X4(a));const l=f(e,["googleSearchRetrieval"]);l!=null&&d(t,["googleSearchRetrieval"],Z4(l)),f(e,["enterpriseWebSearch"])!=null&&d(t,["enterpriseWebSearch"],Q4());const u=f(e,["googleMaps"]);u!=null&&d(t,["googleMaps"],nN(u)),f(e,["urlContext"])!=null&&d(t,["urlContext"],rN());const m=f(e,["codeExecution"]);m!=null&&d(t,["codeExecution"],m);const x=f(e,["computerUse"]);return x!=null&&d(t,["computerUse"],x),t}function aN(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["allowedFunctionNames"]);return r!=null&&d(t,["allowedFunctionNames"],r),t}function iN(e){const t={},n=f(e,["latitude"]);n!=null&&d(t,["latitude"],n);const r=f(e,["longitude"]);return r!=null&&d(t,["longitude"],r),t}function sN(e){const t={},n=f(e,["latLng"]);n!=null&&d(t,["latLng"],iN(n));const r=f(e,["languageCode"]);return r!=null&&d(t,["languageCode"],r),t}function lN(e){const t={},n=f(e,["functionCallingConfig"]);n!=null&&d(t,["functionCallingConfig"],aN(n));const r=f(e,["retrievalConfig"]);return r!=null&&d(t,["retrievalConfig"],sN(r)),t}function oN(e){const t={},n=f(e,["voiceName"]);return n!=null&&d(t,["voiceName"],n),t}function cN(e){const t={},n=f(e,["prebuiltVoiceConfig"]);return n!=null&&d(t,["prebuiltVoiceConfig"],oN(n)),t}function uN(e){const t={},n=f(e,["voiceConfig"]);if(n!=null&&d(t,["voiceConfig"],cN(n)),f(e,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const r=f(e,["languageCode"]);return r!=null&&d(t,["languageCode"],r),t}function fN(e){const t={},n=f(e,["includeThoughts"]);n!=null&&d(t,["includeThoughts"],n);const r=f(e,["thinkingBudget"]);return r!=null&&d(t,["thinkingBudget"],r),t}function dN(e,t,n){const r={},a=f(t,["systemInstruction"]);n!==void 0&&a!=null&&d(n,["systemInstruction"],bl(Qn(a)));const l=f(t,["temperature"]);l!=null&&d(r,["temperature"],l);const c=f(t,["topP"]);c!=null&&d(r,["topP"],c);const u=f(t,["topK"]);u!=null&&d(r,["topK"],u);const p=f(t,["candidateCount"]);p!=null&&d(r,["candidateCount"],p);const m=f(t,["maxOutputTokens"]);m!=null&&d(r,["maxOutputTokens"],m);const x=f(t,["stopSequences"]);x!=null&&d(r,["stopSequences"],x);const y=f(t,["responseLogprobs"]);y!=null&&d(r,["responseLogprobs"],y);const _=f(t,["logprobs"]);_!=null&&d(r,["logprobs"],_);const E=f(t,["presencePenalty"]);E!=null&&d(r,["presencePenalty"],E);const w=f(t,["frequencyPenalty"]);w!=null&&d(r,["frequencyPenalty"],w);const S=f(t,["seed"]);S!=null&&d(r,["seed"],S);const C=f(t,["responseMimeType"]);C!=null&&d(r,["responseMimeType"],C);const M=f(t,["responseSchema"]);M!=null&&d(r,["responseSchema"],q4(Yo(M)));const k=f(t,["responseJsonSchema"]);k!=null&&d(r,["responseJsonSchema"],k);const b=f(t,["routingConfig"]);b!=null&&d(r,["routingConfig"],b);const U=f(t,["modelSelectionConfig"]);U!=null&&d(r,["modelConfig"],$4(U));const G=f(t,["safetySettings"]);if(n!==void 0&&G!=null){let Ee=G;Array.isArray(Ee)&&(Ee=Ee.map(ae=>Y4(ae))),d(n,["safetySettings"],Ee)}const J=f(t,["tools"]);if(n!==void 0&&J!=null){let Ee=Cl(J);Array.isArray(Ee)&&(Ee=Ee.map(ae=>p2(wl(ae)))),d(n,["tools"],Ee)}const F=f(t,["toolConfig"]);n!==void 0&&F!=null&&d(n,["toolConfig"],lN(F));const W=f(t,["labels"]);n!==void 0&&W!=null&&d(n,["labels"],W);const O=f(t,["cachedContent"]);n!==void 0&&O!=null&&d(n,["cachedContent"],Za(e,O));const ee=f(t,["responseModalities"]);ee!=null&&d(r,["responseModalities"],ee);const ne=f(t,["mediaResolution"]);ne!=null&&d(r,["mediaResolution"],ne);const te=f(t,["speechConfig"]);te!=null&&d(r,["speechConfig"],uN(wh(te)));const _e=f(t,["audioTimestamp"]);_e!=null&&d(r,["audioTimestamp"],_e);const Ie=f(t,["thinkingConfig"]);return Ie!=null&&d(r,["thinkingConfig"],fN(Ie)),r}function dv(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],Gt(e,r));const a=f(t,["contents"]);if(a!=null){let c=qr(a);Array.isArray(c)&&(c=c.map(u=>bl(u))),d(n,["contents"],c)}const l=f(t,["config"]);return l!=null&&d(n,["generationConfig"],dN(e,l,n)),n}function hN(e,t){const n={},r=f(e,["taskType"]);t!==void 0&&r!=null&&d(t,["instances[]","task_type"],r);const a=f(e,["title"]);t!==void 0&&a!=null&&d(t,["instances[]","title"],a);const l=f(e,["outputDimensionality"]);t!==void 0&&l!=null&&d(t,["parameters","outputDimensionality"],l);const c=f(e,["mimeType"]);t!==void 0&&c!=null&&d(t,["instances[]","mimeType"],c);const u=f(e,["autoTruncate"]);return t!==void 0&&u!=null&&d(t,["parameters","autoTruncate"],u),n}function mN(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],Gt(e,r));const a=f(t,["contents"]);a!=null&&d(n,["instances[]","content"],Ky(e,a));const l=f(t,["config"]);return l!=null&&d(n,["config"],hN(l,n)),n}function pN(e,t){const n={},r=f(e,["outputGcsUri"]);t!==void 0&&r!=null&&d(t,["parameters","storageUri"],r);const a=f(e,["negativePrompt"]);t!==void 0&&a!=null&&d(t,["parameters","negativePrompt"],a);const l=f(e,["numberOfImages"]);t!==void 0&&l!=null&&d(t,["parameters","sampleCount"],l);const c=f(e,["aspectRatio"]);t!==void 0&&c!=null&&d(t,["parameters","aspectRatio"],c);const u=f(e,["guidanceScale"]);t!==void 0&&u!=null&&d(t,["parameters","guidanceScale"],u);const p=f(e,["seed"]);t!==void 0&&p!=null&&d(t,["parameters","seed"],p);const m=f(e,["safetyFilterLevel"]);t!==void 0&&m!=null&&d(t,["parameters","safetySetting"],m);const x=f(e,["personGeneration"]);t!==void 0&&x!=null&&d(t,["parameters","personGeneration"],x);const y=f(e,["includeSafetyAttributes"]);t!==void 0&&y!=null&&d(t,["parameters","includeSafetyAttributes"],y);const _=f(e,["includeRaiReason"]);t!==void 0&&_!=null&&d(t,["parameters","includeRaiReason"],_);const E=f(e,["language"]);t!==void 0&&E!=null&&d(t,["parameters","language"],E);const w=f(e,["outputMimeType"]);t!==void 0&&w!=null&&d(t,["parameters","outputOptions","mimeType"],w);const S=f(e,["outputCompressionQuality"]);t!==void 0&&S!=null&&d(t,["parameters","outputOptions","compressionQuality"],S);const C=f(e,["addWatermark"]);t!==void 0&&C!=null&&d(t,["parameters","addWatermark"],C);const M=f(e,["enhancePrompt"]);return t!==void 0&&M!=null&&d(t,["parameters","enhancePrompt"],M),n}function xN(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],Gt(e,r));const a=f(t,["prompt"]);a!=null&&d(n,["instances[0]","prompt"],a);const l=f(t,["config"]);return l!=null&&d(n,["config"],pN(l,n)),n}function ff(e){const t={},n=f(e,["gcsUri"]);n!=null&&d(t,["gcsUri"],n);const r=f(e,["imageBytes"]);r!=null&&d(t,["bytesBase64Encoded"],Qa(r));const a=f(e,["mimeType"]);return a!=null&&d(t,["mimeType"],a),t}function gN(e){const t={},n=f(e,["maskMode"]);n!=null&&d(t,["maskMode"],n);const r=f(e,["segmentationClasses"]);r!=null&&d(t,["maskClasses"],r);const a=f(e,["maskDilation"]);return a!=null&&d(t,["dilation"],a),t}function vN(e){const t={},n=f(e,["controlType"]);n!=null&&d(t,["controlType"],n);const r=f(e,["enableControlImageComputation"]);return r!=null&&d(t,["computeControl"],r),t}function yN(e){const t={},n=f(e,["styleDescription"]);return n!=null&&d(t,["styleDescription"],n),t}function TN(e){const t={},n=f(e,["subjectType"]);n!=null&&d(t,["subjectType"],n);const r=f(e,["subjectDescription"]);return r!=null&&d(t,["subjectDescription"],r),t}function _N(e){const t={},n=f(e,["referenceImage"]);n!=null&&d(t,["referenceImage"],ff(n));const r=f(e,["referenceId"]);r!=null&&d(t,["referenceId"],r);const a=f(e,["referenceType"]);a!=null&&d(t,["referenceType"],a);const l=f(e,["maskImageConfig"]);l!=null&&d(t,["maskImageConfig"],gN(l));const c=f(e,["controlImageConfig"]);c!=null&&d(t,["controlImageConfig"],vN(c));const u=f(e,["styleImageConfig"]);u!=null&&d(t,["styleImageConfig"],yN(u));const p=f(e,["subjectImageConfig"]);return p!=null&&d(t,["subjectImageConfig"],TN(p)),t}function EN(e,t){const n={},r=f(e,["outputGcsUri"]);t!==void 0&&r!=null&&d(t,["parameters","storageUri"],r);const a=f(e,["negativePrompt"]);t!==void 0&&a!=null&&d(t,["parameters","negativePrompt"],a);const l=f(e,["numberOfImages"]);t!==void 0&&l!=null&&d(t,["parameters","sampleCount"],l);const c=f(e,["aspectRatio"]);t!==void 0&&c!=null&&d(t,["parameters","aspectRatio"],c);const u=f(e,["guidanceScale"]);t!==void 0&&u!=null&&d(t,["parameters","guidanceScale"],u);const p=f(e,["seed"]);t!==void 0&&p!=null&&d(t,["parameters","seed"],p);const m=f(e,["safetyFilterLevel"]);t!==void 0&&m!=null&&d(t,["parameters","safetySetting"],m);const x=f(e,["personGeneration"]);t!==void 0&&x!=null&&d(t,["parameters","personGeneration"],x);const y=f(e,["includeSafetyAttributes"]);t!==void 0&&y!=null&&d(t,["parameters","includeSafetyAttributes"],y);const _=f(e,["includeRaiReason"]);t!==void 0&&_!=null&&d(t,["parameters","includeRaiReason"],_);const E=f(e,["language"]);t!==void 0&&E!=null&&d(t,["parameters","language"],E);const w=f(e,["outputMimeType"]);t!==void 0&&w!=null&&d(t,["parameters","outputOptions","mimeType"],w);const S=f(e,["outputCompressionQuality"]);t!==void 0&&S!=null&&d(t,["parameters","outputOptions","compressionQuality"],S);const C=f(e,["editMode"]);t!==void 0&&C!=null&&d(t,["parameters","editMode"],C);const M=f(e,["baseSteps"]);return t!==void 0&&M!=null&&d(t,["parameters","editConfig","baseSteps"],M),n}function SN(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],Gt(e,r));const a=f(t,["prompt"]);a!=null&&d(n,["instances[0]","prompt"],a);const l=f(t,["referenceImages"]);if(l!=null){let u=l;Array.isArray(u)&&(u=u.map(p=>_N(p))),d(n,["instances[0]","referenceImages"],u)}const c=f(t,["config"]);return c!=null&&d(n,["config"],EN(c,n)),n}function wN(e,t){const n={},r=f(e,["includeRaiReason"]);t!==void 0&&r!=null&&d(t,["parameters","includeRaiReason"],r);const a=f(e,["outputMimeType"]);t!==void 0&&a!=null&&d(t,["parameters","outputOptions","mimeType"],a);const l=f(e,["outputCompressionQuality"]);t!==void 0&&l!=null&&d(t,["parameters","outputOptions","compressionQuality"],l);const c=f(e,["enhanceInputImage"]);t!==void 0&&c!=null&&d(t,["parameters","upscaleConfig","enhanceInputImage"],c);const u=f(e,["imagePreservationFactor"]);t!==void 0&&u!=null&&d(t,["parameters","upscaleConfig","imagePreservationFactor"],u);const p=f(e,["numberOfImages"]);t!==void 0&&p!=null&&d(t,["parameters","sampleCount"],p);const m=f(e,["mode"]);return t!==void 0&&m!=null&&d(t,["parameters","mode"],m),n}function CN(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],Gt(e,r));const a=f(t,["image"]);a!=null&&d(n,["instances[0]","image"],ff(a));const l=f(t,["upscaleFactor"]);l!=null&&d(n,["parameters","upscaleConfig","upscaleFactor"],l);const c=f(t,["config"]);return c!=null&&d(n,["config"],wN(c,n)),n}function AN(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","name"],Gt(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],a),n}function bN(e,t,n){const r={},a=f(t,["pageSize"]);n!==void 0&&a!=null&&d(n,["_query","pageSize"],a);const l=f(t,["pageToken"]);n!==void 0&&l!=null&&d(n,["_query","pageToken"],l);const c=f(t,["filter"]);n!==void 0&&c!=null&&d(n,["_query","filter"],c);const u=f(t,["queryBase"]);return n!==void 0&&u!=null&&d(n,["_url","models_url"],e2(e,u)),r}function kN(e,t){const n={},r=f(t,["config"]);return r!=null&&d(n,["config"],bN(e,r,n)),n}function NN(e,t){const n={},r=f(e,["displayName"]);t!==void 0&&r!=null&&d(t,["displayName"],r);const a=f(e,["description"]);t!==void 0&&a!=null&&d(t,["description"],a);const l=f(e,["defaultCheckpointId"]);return t!==void 0&&l!=null&&d(t,["defaultCheckpointId"],l),n}function MN(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],Gt(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],NN(a,n)),n}function RN(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","name"],Gt(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],a),n}function DN(e,t){const n={},r=f(e,["systemInstruction"]);t!==void 0&&r!=null&&d(t,["systemInstruction"],bl(Qn(r)));const a=f(e,["tools"]);if(t!==void 0&&a!=null){let c=a;Array.isArray(c)&&(c=c.map(u=>p2(u))),d(t,["tools"],c)}const l=f(e,["generationConfig"]);return t!==void 0&&l!=null&&d(t,["generationConfig"],l),n}function IN(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],Gt(e,r));const a=f(t,["contents"]);if(a!=null){let c=qr(a);Array.isArray(c)&&(c=c.map(u=>bl(u))),d(n,["contents"],c)}const l=f(t,["config"]);return l!=null&&d(n,["config"],DN(l,n)),n}function FN(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],Gt(e,r));const a=f(t,["contents"]);if(a!=null){let c=qr(a);Array.isArray(c)&&(c=c.map(u=>bl(u))),d(n,["contents"],c)}const l=f(t,["config"]);return l!=null&&d(n,["config"],l),n}function LN(e){const t={},n=f(e,["uri"]);n!=null&&d(t,["gcsUri"],n);const r=f(e,["videoBytes"]);r!=null&&d(t,["bytesBase64Encoded"],Qa(r));const a=f(e,["mimeType"]);return a!=null&&d(t,["mimeType"],a),t}function ON(e,t){const n={},r=f(e,["numberOfVideos"]);t!==void 0&&r!=null&&d(t,["parameters","sampleCount"],r);const a=f(e,["outputGcsUri"]);t!==void 0&&a!=null&&d(t,["parameters","storageUri"],a);const l=f(e,["fps"]);t!==void 0&&l!=null&&d(t,["parameters","fps"],l);const c=f(e,["durationSeconds"]);t!==void 0&&c!=null&&d(t,["parameters","durationSeconds"],c);const u=f(e,["seed"]);t!==void 0&&u!=null&&d(t,["parameters","seed"],u);const p=f(e,["aspectRatio"]);t!==void 0&&p!=null&&d(t,["parameters","aspectRatio"],p);const m=f(e,["resolution"]);t!==void 0&&m!=null&&d(t,["parameters","resolution"],m);const x=f(e,["personGeneration"]);t!==void 0&&x!=null&&d(t,["parameters","personGeneration"],x);const y=f(e,["pubsubTopic"]);t!==void 0&&y!=null&&d(t,["parameters","pubsubTopic"],y);const _=f(e,["negativePrompt"]);t!==void 0&&_!=null&&d(t,["parameters","negativePrompt"],_);const E=f(e,["enhancePrompt"]);t!==void 0&&E!=null&&d(t,["parameters","enhancePrompt"],E);const w=f(e,["generateAudio"]);t!==void 0&&w!=null&&d(t,["parameters","generateAudio"],w);const S=f(e,["lastFrame"]);t!==void 0&&S!=null&&d(t,["instances[0]","lastFrame"],ff(S));const C=f(e,["compressionQuality"]);return t!==void 0&&C!=null&&d(t,["parameters","compressionQuality"],C),n}function PN(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],Gt(e,r));const a=f(t,["prompt"]);a!=null&&d(n,["instances[0]","prompt"],a);const l=f(t,["image"]);l!=null&&d(n,["instances[0]","image"],ff(l));const c=f(t,["video"]);c!=null&&d(n,["instances[0]","video"],LN(c));const u=f(t,["config"]);return u!=null&&d(n,["config"],ON(u,n)),n}function UN(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const a=f(e,["startOffset"]);return a!=null&&d(t,["startOffset"],a),t}function BN(e){const t={},n=f(e,["data"]);n!=null&&d(t,["data"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function VN(e){const t={},n=f(e,["fileUri"]);n!=null&&d(t,["fileUri"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function HN(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],UN(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const a=f(e,["inlineData"]);a!=null&&d(t,["inlineData"],BN(a));const l=f(e,["fileData"]);l!=null&&d(t,["fileData"],VN(l));const c=f(e,["thoughtSignature"]);c!=null&&d(t,["thoughtSignature"],c);const u=f(e,["codeExecutionResult"]);u!=null&&d(t,["codeExecutionResult"],u);const p=f(e,["executableCode"]);p!=null&&d(t,["executableCode"],p);const m=f(e,["functionCall"]);m!=null&&d(t,["functionCall"],m);const x=f(e,["functionResponse"]);x!=null&&d(t,["functionResponse"],x);const y=f(e,["text"]);return y!=null&&d(t,["text"],y),t}function GN(e){const t={},n=f(e,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>HN(l))),d(t,["parts"],a)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function jN(e){const t={},n=f(e,["citationSources"]);return n!=null&&d(t,["citations"],n),t}function zN(e){const t={},n=f(e,["retrievedUrl"]);n!=null&&d(t,["retrievedUrl"],n);const r=f(e,["urlRetrievalStatus"]);return r!=null&&d(t,["urlRetrievalStatus"],r),t}function qN(e){const t={},n=f(e,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>zN(a))),d(t,["urlMetadata"],r)}return t}function $N(e){const t={},n=f(e,["content"]);n!=null&&d(t,["content"],GN(n));const r=f(e,["citationMetadata"]);r!=null&&d(t,["citationMetadata"],jN(r));const a=f(e,["tokenCount"]);a!=null&&d(t,["tokenCount"],a);const l=f(e,["finishReason"]);l!=null&&d(t,["finishReason"],l);const c=f(e,["urlContextMetadata"]);c!=null&&d(t,["urlContextMetadata"],qN(c));const u=f(e,["avgLogprobs"]);u!=null&&d(t,["avgLogprobs"],u);const p=f(e,["groundingMetadata"]);p!=null&&d(t,["groundingMetadata"],p);const m=f(e,["index"]);m!=null&&d(t,["index"],m);const x=f(e,["logprobsResult"]);x!=null&&d(t,["logprobsResult"],x);const y=f(e,["safetyRatings"]);return y!=null&&d(t,["safetyRatings"],y),t}function hv(e){const t={},n=f(e,["candidates"]);if(n!=null){let c=n;Array.isArray(c)&&(c=c.map(u=>$N(u))),d(t,["candidates"],c)}const r=f(e,["modelVersion"]);r!=null&&d(t,["modelVersion"],r);const a=f(e,["promptFeedback"]);a!=null&&d(t,["promptFeedback"],a);const l=f(e,["usageMetadata"]);return l!=null&&d(t,["usageMetadata"],l),t}function YN(e){const t={},n=f(e,["values"]);return n!=null&&d(t,["values"],n),t}function WN(){return{}}function JN(e){const t={},n=f(e,["embeddings"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>YN(l))),d(t,["embeddings"],a)}return f(e,["metadata"])!=null&&d(t,["metadata"],WN()),t}function XN(e){const t={},n=f(e,["bytesBase64Encoded"]);n!=null&&d(t,["imageBytes"],Qa(n));const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function x2(e){const t={},n=f(e,["safetyAttributes","categories"]);n!=null&&d(t,["categories"],n);const r=f(e,["safetyAttributes","scores"]);r!=null&&d(t,["scores"],r);const a=f(e,["contentType"]);return a!=null&&d(t,["contentType"],a),t}function KN(e){const t={},n=f(e,["_self"]);n!=null&&d(t,["image"],XN(n));const r=f(e,["raiFilteredReason"]);r!=null&&d(t,["raiFilteredReason"],r);const a=f(e,["_self"]);return a!=null&&d(t,["safetyAttributes"],x2(a)),t}function ZN(e){const t={},n=f(e,["predictions"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>KN(l))),d(t,["generatedImages"],a)}const r=f(e,["positivePromptSafetyAttributes"]);return r!=null&&d(t,["positivePromptSafetyAttributes"],x2(r)),t}function QN(e){const t={},n=f(e,["baseModel"]);n!=null&&d(t,["baseModel"],n);const r=f(e,["createTime"]);r!=null&&d(t,["createTime"],r);const a=f(e,["updateTime"]);return a!=null&&d(t,["updateTime"],a),t}function sh(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["displayName"]);r!=null&&d(t,["displayName"],r);const a=f(e,["description"]);a!=null&&d(t,["description"],a);const l=f(e,["version"]);l!=null&&d(t,["version"],l);const c=f(e,["_self"]);c!=null&&d(t,["tunedModelInfo"],QN(c));const u=f(e,["inputTokenLimit"]);u!=null&&d(t,["inputTokenLimit"],u);const p=f(e,["outputTokenLimit"]);p!=null&&d(t,["outputTokenLimit"],p);const m=f(e,["supportedGenerationMethods"]);return m!=null&&d(t,["supportedActions"],m),t}function e3(e){const t={},n=f(e,["nextPageToken"]);n!=null&&d(t,["nextPageToken"],n);const r=f(e,["_self"]);if(r!=null){let a=t2(r);Array.isArray(a)&&(a=a.map(l=>sh(l))),d(t,["models"],a)}return t}function t3(){return{}}function n3(e){const t={},n=f(e,["totalTokens"]);n!=null&&d(t,["totalTokens"],n);const r=f(e,["cachedContentTokenCount"]);return r!=null&&d(t,["cachedContentTokenCount"],r),t}function r3(e){const t={},n=f(e,["video","uri"]);n!=null&&d(t,["uri"],n);const r=f(e,["video","encodedVideo"]);r!=null&&d(t,["videoBytes"],Qa(r));const a=f(e,["encoding"]);return a!=null&&d(t,["mimeType"],a),t}function a3(e){const t={},n=f(e,["_self"]);return n!=null&&d(t,["video"],r3(n)),t}function i3(e){const t={},n=f(e,["generatedSamples"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(c=>a3(c))),d(t,["generatedVideos"],l)}const r=f(e,["raiMediaFilteredCount"]);r!=null&&d(t,["raiMediaFilteredCount"],r);const a=f(e,["raiMediaFilteredReasons"]);return a!=null&&d(t,["raiMediaFilteredReasons"],a),t}function s3(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["metadata"]);r!=null&&d(t,["metadata"],r);const a=f(e,["done"]);a!=null&&d(t,["done"],a);const l=f(e,["error"]);l!=null&&d(t,["error"],l);const c=f(e,["response","generateVideoResponse"]);return c!=null&&d(t,["response"],i3(c)),t}function l3(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const a=f(e,["startOffset"]);return a!=null&&d(t,["startOffset"],a),t}function o3(e){const t={},n=f(e,["displayName"]);n!=null&&d(t,["displayName"],n);const r=f(e,["data"]);r!=null&&d(t,["data"],r);const a=f(e,["mimeType"]);return a!=null&&d(t,["mimeType"],a),t}function c3(e){const t={},n=f(e,["displayName"]);n!=null&&d(t,["displayName"],n);const r=f(e,["fileUri"]);r!=null&&d(t,["fileUri"],r);const a=f(e,["mimeType"]);return a!=null&&d(t,["mimeType"],a),t}function u3(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],l3(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const a=f(e,["inlineData"]);a!=null&&d(t,["inlineData"],o3(a));const l=f(e,["fileData"]);l!=null&&d(t,["fileData"],c3(l));const c=f(e,["thoughtSignature"]);c!=null&&d(t,["thoughtSignature"],c);const u=f(e,["codeExecutionResult"]);u!=null&&d(t,["codeExecutionResult"],u);const p=f(e,["executableCode"]);p!=null&&d(t,["executableCode"],p);const m=f(e,["functionCall"]);m!=null&&d(t,["functionCall"],m);const x=f(e,["functionResponse"]);x!=null&&d(t,["functionResponse"],x);const y=f(e,["text"]);return y!=null&&d(t,["text"],y),t}function f3(e){const t={},n=f(e,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>u3(l))),d(t,["parts"],a)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function d3(e){const t={},n=f(e,["citations"]);return n!=null&&d(t,["citations"],n),t}function h3(e){const t={},n=f(e,["retrievedUrl"]);n!=null&&d(t,["retrievedUrl"],n);const r=f(e,["urlRetrievalStatus"]);return r!=null&&d(t,["urlRetrievalStatus"],r),t}function m3(e){const t={},n=f(e,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>h3(a))),d(t,["urlMetadata"],r)}return t}function p3(e){const t={},n=f(e,["content"]);n!=null&&d(t,["content"],f3(n));const r=f(e,["citationMetadata"]);r!=null&&d(t,["citationMetadata"],d3(r));const a=f(e,["finishMessage"]);a!=null&&d(t,["finishMessage"],a);const l=f(e,["finishReason"]);l!=null&&d(t,["finishReason"],l);const c=f(e,["urlContextMetadata"]);c!=null&&d(t,["urlContextMetadata"],m3(c));const u=f(e,["avgLogprobs"]);u!=null&&d(t,["avgLogprobs"],u);const p=f(e,["groundingMetadata"]);p!=null&&d(t,["groundingMetadata"],p);const m=f(e,["index"]);m!=null&&d(t,["index"],m);const x=f(e,["logprobsResult"]);x!=null&&d(t,["logprobsResult"],x);const y=f(e,["safetyRatings"]);return y!=null&&d(t,["safetyRatings"],y),t}function mv(e){const t={},n=f(e,["candidates"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(m=>p3(m))),d(t,["candidates"],p)}const r=f(e,["createTime"]);r!=null&&d(t,["createTime"],r);const a=f(e,["responseId"]);a!=null&&d(t,["responseId"],a);const l=f(e,["modelVersion"]);l!=null&&d(t,["modelVersion"],l);const c=f(e,["promptFeedback"]);c!=null&&d(t,["promptFeedback"],c);const u=f(e,["usageMetadata"]);return u!=null&&d(t,["usageMetadata"],u),t}function x3(e){const t={},n=f(e,["truncated"]);n!=null&&d(t,["truncated"],n);const r=f(e,["token_count"]);return r!=null&&d(t,["tokenCount"],r),t}function g3(e){const t={},n=f(e,["values"]);n!=null&&d(t,["values"],n);const r=f(e,["statistics"]);return r!=null&&d(t,["statistics"],x3(r)),t}function v3(e){const t={},n=f(e,["billableCharacterCount"]);return n!=null&&d(t,["billableCharacterCount"],n),t}function y3(e){const t={},n=f(e,["predictions[]","embeddings"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>g3(l))),d(t,["embeddings"],a)}const r=f(e,["metadata"]);return r!=null&&d(t,["metadata"],v3(r)),t}function T3(e){const t={},n=f(e,["gcsUri"]);n!=null&&d(t,["gcsUri"],n);const r=f(e,["bytesBase64Encoded"]);r!=null&&d(t,["imageBytes"],Qa(r));const a=f(e,["mimeType"]);return a!=null&&d(t,["mimeType"],a),t}function g2(e){const t={},n=f(e,["safetyAttributes","categories"]);n!=null&&d(t,["categories"],n);const r=f(e,["safetyAttributes","scores"]);r!=null&&d(t,["scores"],r);const a=f(e,["contentType"]);return a!=null&&d(t,["contentType"],a),t}function Ah(e){const t={},n=f(e,["_self"]);n!=null&&d(t,["image"],T3(n));const r=f(e,["raiFilteredReason"]);r!=null&&d(t,["raiFilteredReason"],r);const a=f(e,["_self"]);a!=null&&d(t,["safetyAttributes"],g2(a));const l=f(e,["prompt"]);return l!=null&&d(t,["enhancedPrompt"],l),t}function _3(e){const t={},n=f(e,["predictions"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>Ah(l))),d(t,["generatedImages"],a)}const r=f(e,["positivePromptSafetyAttributes"]);return r!=null&&d(t,["positivePromptSafetyAttributes"],g2(r)),t}function E3(e){const t={},n=f(e,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>Ah(a))),d(t,["generatedImages"],r)}return t}function S3(e){const t={},n=f(e,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>Ah(a))),d(t,["generatedImages"],r)}return t}function w3(e){const t={},n=f(e,["endpoint"]);n!=null&&d(t,["name"],n);const r=f(e,["deployedModelId"]);return r!=null&&d(t,["deployedModelId"],r),t}function C3(e){const t={},n=f(e,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&d(t,["baseModel"],n);const r=f(e,["createTime"]);r!=null&&d(t,["createTime"],r);const a=f(e,["updateTime"]);return a!=null&&d(t,["updateTime"],a),t}function A3(e){const t={},n=f(e,["checkpointId"]);n!=null&&d(t,["checkpointId"],n);const r=f(e,["epoch"]);r!=null&&d(t,["epoch"],r);const a=f(e,["step"]);return a!=null&&d(t,["step"],a),t}function lh(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["displayName"]);r!=null&&d(t,["displayName"],r);const a=f(e,["description"]);a!=null&&d(t,["description"],a);const l=f(e,["versionId"]);l!=null&&d(t,["version"],l);const c=f(e,["deployedModels"]);if(c!=null){let y=c;Array.isArray(y)&&(y=y.map(_=>w3(_))),d(t,["endpoints"],y)}const u=f(e,["labels"]);u!=null&&d(t,["labels"],u);const p=f(e,["_self"]);p!=null&&d(t,["tunedModelInfo"],C3(p));const m=f(e,["defaultCheckpointId"]);m!=null&&d(t,["defaultCheckpointId"],m);const x=f(e,["checkpoints"]);if(x!=null){let y=x;Array.isArray(y)&&(y=y.map(_=>A3(_))),d(t,["checkpoints"],y)}return t}function b3(e){const t={},n=f(e,["nextPageToken"]);n!=null&&d(t,["nextPageToken"],n);const r=f(e,["_self"]);if(r!=null){let a=t2(r);Array.isArray(a)&&(a=a.map(l=>lh(l))),d(t,["models"],a)}return t}function k3(){return{}}function N3(e){const t={},n=f(e,["totalTokens"]);return n!=null&&d(t,["totalTokens"],n),t}function M3(e){const t={},n=f(e,["tokensInfo"]);return n!=null&&d(t,["tokensInfo"],n),t}function R3(e){const t={},n=f(e,["gcsUri"]);n!=null&&d(t,["uri"],n);const r=f(e,["bytesBase64Encoded"]);r!=null&&d(t,["videoBytes"],Qa(r));const a=f(e,["mimeType"]);return a!=null&&d(t,["mimeType"],a),t}function D3(e){const t={},n=f(e,["_self"]);return n!=null&&d(t,["video"],R3(n)),t}function I3(e){const t={},n=f(e,["videos"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(c=>D3(c))),d(t,["generatedVideos"],l)}const r=f(e,["raiMediaFilteredCount"]);r!=null&&d(t,["raiMediaFilteredCount"],r);const a=f(e,["raiMediaFilteredReasons"]);return a!=null&&d(t,["raiMediaFilteredReasons"],a),t}function F3(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["metadata"]);r!=null&&d(t,["metadata"],r);const a=f(e,["done"]);a!=null&&d(t,["done"],a);const l=f(e,["error"]);l!=null&&d(t,["error"],l);const c=f(e,["response"]);return c!=null&&d(t,["response"],I3(c)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const L3="Content-Type",O3="X-Server-Timeout",P3="User-Agent",oh="x-goog-api-client",U3="1.8.0",B3=`google-genai-sdk/${U3}`,V3="v1beta1",H3="v1beta",pv=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class G3{constructor(t){var n,r;this.clientOptions=Object.assign(Object.assign({},t),{project:t.project,location:t.location,apiKey:t.apiKey,vertexai:t.vertexai});const a={};this.clientOptions.vertexai?(a.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:V3,a.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(a.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:H3,a.baseUrl="https://generativelanguage.googleapis.com/"),a.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=a,t.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(a,t.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var t;return(t=this.clientOptions.vertexai)!==null&&t!==void 0?t:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(t){if(!t||t.baseUrl===void 0||t.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[t.baseUrl.endsWith("/")?t.baseUrl.slice(0,-1):t.baseUrl];return t.apiVersion&&t.apiVersion!==""&&r.push(t.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const t=this.getBaseUrl(),n=new URL(t);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(t){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=t;else throw new Error("HTTP options are not correctly set.")}constructUrl(t,n,r){const a=[this.getRequestUrlInternal(n)];return r&&a.push(this.getBaseResourcePath()),t!==""&&a.push(t),new URL(`${a.join("/")}`)}shouldPrependVertexProjectPath(t){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||t.path.startsWith("projects/")||t.httpMethod==="GET"&&t.path.startsWith("publishers/google/models"))}async request(t){let n=this.clientOptions.httpOptions;t.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const r=this.shouldPrependVertexProjectPath(t),a=this.constructUrl(t.path,n,r);if(t.queryParams)for(const[c,u]of Object.entries(t.queryParams))a.searchParams.append(c,String(u));let l={};if(t.httpMethod==="GET"){if(t.body&&t.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else l.body=t.body;return l=await this.includeExtraHttpOptionsToRequestInit(l,n,t.abortSignal),this.unaryApiCall(a,l,t.httpMethod)}patchHttpOptions(t,n){const r=JSON.parse(JSON.stringify(t));for(const[a,l]of Object.entries(n))typeof l=="object"?r[a]=Object.assign(Object.assign({},r[a]),l):l!==void 0&&(r[a]=l);return r}async requestStream(t){let n=this.clientOptions.httpOptions;t.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const r=this.shouldPrependVertexProjectPath(t),a=this.constructUrl(t.path,n,r);(!a.searchParams.has("alt")||a.searchParams.get("alt")!=="sse")&&a.searchParams.set("alt","sse");let l={};return l.body=t.body,l=await this.includeExtraHttpOptionsToRequestInit(l,n,t.abortSignal),this.streamApiCall(a,l,t.httpMethod)}async includeExtraHttpOptionsToRequestInit(t,n,r){if(n&&n.timeout||r){const a=new AbortController,l=a.signal;n.timeout&&(n==null?void 0:n.timeout)>0&&setTimeout(()=>a.abort(),n.timeout),r&&r.addEventListener("abort",()=>{a.abort()}),t.signal=l}return n&&n.extraBody!==null&&j3(t,n.extraBody),t.headers=await this.getHeadersInternal(n),t}async unaryApiCall(t,n,r){return this.apiCall(t.toString(),Object.assign(Object.assign({},n),{method:r})).then(async a=>(await xv(a),new eh(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}async streamApiCall(t,n,r){return this.apiCall(t.toString(),Object.assign(Object.assign({},n),{method:r})).then(async a=>(await xv(a),this.processStreamResponse(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}processStreamResponse(t){var n;return hl(this,arguments,function*(){const a=(n=t==null?void 0:t.body)===null||n===void 0?void 0:n.getReader(),l=new TextDecoder("utf-8");if(!a)throw new Error("Response body is empty");try{let c="";for(;;){const{done:u,value:p}=yield rn(a.read());if(u){if(c.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const m=l.decode(p);try{const y=JSON.parse(m);if("error"in y){const _=JSON.parse(JSON.stringify(y.error)),E=_.status,w=_.code,S=`got status: ${E}. ${JSON.stringify(y)}`;if(w>=400&&w<600)throw new cf({message:S,status:w})}}catch(y){if(y.name==="ApiError")throw y}c+=m;let x=c.match(pv);for(;x;){const y=x[1];try{const _=new Response(y,{headers:t==null?void 0:t.headers,status:t==null?void 0:t.status,statusText:t==null?void 0:t.statusText});yield yield rn(new eh(_)),c=c.slice(x[0].length),x=c.match(pv)}catch(_){throw new Error(`exception parsing stream chunk ${y}. ${_}`)}}}}finally{a.releaseLock()}})}async apiCall(t,n){return fetch(t,n).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const t={},n=B3+" "+this.clientOptions.userAgentExtra;return t[P3]=n,t[oh]=n,t[L3]="application/json",t}async getHeadersInternal(t){const n=new Headers;if(t&&t.headers){for(const[r,a]of Object.entries(t.headers))n.append(r,a);t.timeout&&t.timeout>0&&n.append(O3,String(Math.ceil(t.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n),n}async uploadFile(t,n){var r;const a={};n!=null&&(a.mimeType=n.mimeType,a.name=n.name,a.displayName=n.displayName),a.name&&!a.name.startsWith("files/")&&(a.name=`files/${a.name}`);const l=this.clientOptions.uploader,c=await l.stat(t);a.sizeBytes=String(c.size);const u=(r=n==null?void 0:n.mimeType)!==null&&r!==void 0?r:c.type;if(u===void 0||u==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");a.mimeType=u;const p=await this.fetchUploadUrl(a,n);return l.upload(t,p,this)}async downloadFile(t){await this.clientOptions.downloader.download(t,this)}async fetchUploadUrl(t,n){var r;let a={};n!=null&&n.httpOptions?a=n.httpOptions:a={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${t.mimeType}`}};const l={file:t},c=await this.request({path:We("upload/v1beta/files",l._url),body:JSON.stringify(l),httpMethod:"POST",httpOptions:a});if(!c||!(c!=null&&c.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const u=(r=c==null?void 0:c.headers)===null||r===void 0?void 0:r["x-goog-upload-url"];if(u===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return u}}async function xv(e){var t;if(e===void 0)throw new Error("response is undefined");if(!e.ok){const n=e.status;let r;!((t=e.headers.get("content-type"))===null||t===void 0)&&t.includes("application/json")?r=await e.json():r={error:{message:await e.text(),code:e.status,status:e.statusText}};const a=JSON.stringify(r);throw n>=400&&n<600?new cf({message:a,status:n}):new Error(a)}}function j3(e,t){if(!t||Object.keys(t).length===0)return;if(e.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof e.body=="string"&&e.body.length>0)try{const l=JSON.parse(e.body);if(typeof l=="object"&&l!==null&&!Array.isArray(l))n=l;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function r(l,c){const u=Object.assign({},l);for(const p in c)if(Object.prototype.hasOwnProperty.call(c,p)){const m=c[p],x=u[p];m&&typeof m=="object"&&!Array.isArray(m)&&x&&typeof x=="object"&&!Array.isArray(x)?u[p]=r(x,m):(x&&m&&typeof x!=typeof m&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${p}". Original type: ${typeof x}, New type: ${typeof m}. Overwriting.`),u[p]=m)}return u}const a=r(n,t);e.body=JSON.stringify(a)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const z3="mcp_used/unknown";function v2(e){for(const t of e)if(bh(t)||typeof t=="object"&&"inputSchema"in t)return!0;return!1}function y2(e){var t;const n=(t=e[oh])!==null&&t!==void 0?t:"";e[oh]=(n+` ${z3}`).trimStart()}function q3(e){var t,n,r;return(r=(n=(t=e.config)===null||t===void 0?void 0:t.tools)===null||n===void 0?void 0:n.some(a=>bh(a)))!==null&&r!==void 0?r:!1}function $3(e){var t,n,r;return(r=(n=(t=e.config)===null||t===void 0?void 0:t.tools)===null||n===void 0?void 0:n.some(a=>!bh(a)))!==null&&r!==void 0?r:!1}function bh(e){return e!==null&&typeof e=="object"&&e instanceof kh}function Y3(e,t=100){return hl(this,arguments,function*(){let r,a=0;for(;a<t;){const l=yield rn(e.listTools({cursor:r}));for(const c of l.tools)yield yield rn(c),a++;if(!l.nextCursor)break;r=l.nextCursor}})}class kh{constructor(t=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=t,this.config=n}static create(t,n){return new kh(t,n)}async initialize(){var t,n,r,a;if(this.mcpTools.length>0)return;const l={},c=[];for(const x of this.mcpClients)try{for(var u=!0,p=(n=void 0,Lo(Y3(x))),m;m=await p.next(),t=m.done,!t;u=!0){a=m.value,u=!1;const y=a;c.push(y);const _=y.name;if(l[_])throw new Error(`Duplicate function name ${_} found in MCP tools. Please ensure function names are unique.`);l[_]=x}}catch(y){n={error:y}}finally{try{!u&&!t&&(r=p.return)&&await r.call(p)}finally{if(n)throw n.error}}this.mcpTools=c,this.functionNameToMcpClient=l}async tool(){return await this.initialize(),Vw(this.mcpTools,this.config)}async callTool(t){await this.initialize();const n=[];for(const r of t)if(r.name in this.functionNameToMcpClient){const a=this.functionNameToMcpClient[r.name];let l;this.config.timeout&&(l={timeout:this.config.timeout});const c=await a.callTool({name:r.name,arguments:r.args},void 0,l);n.push({functionResponse:{name:r.name,response:c.isError?{error:c}:c}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function W3(e,t,n){const r=new Nw;let a;n.data instanceof Blob?a=JSON.parse(await n.data.text()):a=JSON.parse(n.data);const l=n4(a);Object.assign(r,l),t(r)}class J3{constructor(t,n,r){this.apiClient=t,this.auth=n,this.webSocketFactory=r}async connect(t){var n,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const a=this.apiClient.getWebsocketBaseUrl(),l=this.apiClient.getApiVersion(),c=Z3(this.apiClient.getDefaultHeaders()),u=this.apiClient.getApiKey(),p=`${a}/ws/google.ai.generativelanguage.${l}.GenerativeService.BidiGenerateMusic?key=${u}`;let m=()=>{};const x=new Promise(b=>{m=b}),y=t.callbacks,_=function(){m({})},E=this.apiClient,w={onopen:_,onmessage:b=>{W3(E,y.onmessage,b)},onerror:(n=y==null?void 0:y.onerror)!==null&&n!==void 0?n:function(b){},onclose:(r=y==null?void 0:y.onclose)!==null&&r!==void 0?r:function(b){}},S=this.webSocketFactory.create(p,K3(c),w);S.connect(),await x;const C=Gt(this.apiClient,t.model),M=d2({model:C}),k=ih({setup:M});return S.send(JSON.stringify(k)),new X3(S,this.apiClient)}}class X3{constructor(t,n){this.conn=t,this.apiClient=n}async setWeightedPrompts(t){if(!t.weightedPrompts||Object.keys(t.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=xk(t),r=h2(n);this.conn.send(JSON.stringify({clientContent:r}))}async setMusicGenerationConfig(t){t.musicGenerationConfig||(t.musicGenerationConfig={});const n=gk(t),r=ih(n);this.conn.send(JSON.stringify(r))}sendPlaybackControl(t){const n=ih({playbackControl:t});this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(ul.PLAY)}pause(){this.sendPlaybackControl(ul.PAUSE)}stop(){this.sendPlaybackControl(ul.STOP)}resetContext(){this.sendPlaybackControl(ul.RESET_CONTEXT)}close(){this.conn.close()}}function K3(e){const t={};return e.forEach((n,r)=>{t[r]=n}),t}function Z3(e){const t=new Headers;for(const[n,r]of Object.entries(e))t.append(n,r);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Q3="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function e5(e,t,n){const r=new kw;let a;n.data instanceof Blob?a=await n.data.text():n.data instanceof ArrayBuffer?a=new TextDecoder().decode(n.data):a=n.data;const l=JSON.parse(a);if(e.isVertexAI()){const c=Yk(l);Object.assign(r,c)}else{const c=$k(l);Object.assign(r,c)}t(r)}class t5{constructor(t,n,r){this.apiClient=t,this.auth=n,this.webSocketFactory=r,this.music=new J3(this.apiClient,this.auth,this.webSocketFactory)}async connect(t){var n,r,a,l,c,u;const p=this.apiClient.getWebsocketBaseUrl(),m=this.apiClient.getApiVersion();let x;const y=this.apiClient.getDefaultHeaders();t.config&&t.config.tools&&v2(t.config.tools)&&y2(y);const _=i5(y);if(this.apiClient.isVertexAI())x=`${p}/ws/google.cloud.aiplatform.${m}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(_);else{const O=this.apiClient.getApiKey();let ee="BidiGenerateContent",ne="key";O!=null&&O.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),ee="BidiGenerateContentConstrained",ne="access_token"),x=`${p}/ws/google.ai.generativelanguage.${m}.GenerativeService.${ee}?${ne}=${O}`}let E=()=>{};const w=new Promise(O=>{E=O}),S=t.callbacks,C=function(){var O;(O=S==null?void 0:S.onopen)===null||O===void 0||O.call(S),E({})},M=this.apiClient,k={onopen:C,onmessage:O=>{e5(M,S.onmessage,O)},onerror:(n=S==null?void 0:S.onerror)!==null&&n!==void 0?n:function(O){},onclose:(r=S==null?void 0:S.onclose)!==null&&r!==void 0?r:function(O){}},b=this.webSocketFactory.create(x,a5(_),k);b.connect(),await w;let U=Gt(this.apiClient,t.model);if(this.apiClient.isVertexAI()&&U.startsWith("publishers/")){const O=this.apiClient.getProject(),ee=this.apiClient.getLocation();U=`projects/${O}/locations/${ee}/`+U}let G={};this.apiClient.isVertexAI()&&((a=t.config)===null||a===void 0?void 0:a.responseModalities)===void 0&&(t.config===void 0?t.config={responseModalities:[qu.AUDIO]}:t.config.responseModalities=[qu.AUDIO]),!((l=t.config)===null||l===void 0)&&l.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const J=(u=(c=t.config)===null||c===void 0?void 0:c.tools)!==null&&u!==void 0?u:[],F=[];for(const O of J)if(this.isCallableTool(O)){const ee=O;F.push(await ee.tool())}else F.push(O);F.length>0&&(t.config.tools=F);const W={model:U,config:t.config,callbacks:t.callbacks};return this.apiClient.isVertexAI()?G=ck(this.apiClient,W):G=ok(this.apiClient,W),delete G.config,b.send(JSON.stringify(G)),new r5(b,this.apiClient)}isCallableTool(t){return"callTool"in t&&typeof t.callTool=="function"}}const n5={turnComplete:!0};class r5{constructor(t,n){this.conn=t,this.apiClient=n}tLiveClientContent(t,n){if(n.turns!==null&&n.turns!==void 0){let r=[];try{r=qr(n.turns),t.isVertexAI()?r=r.map(a=>bl(a)):r=r.map(a=>uf(a))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:r,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(t,n){let r=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?r=n.functionResponses:r=[n.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const l of r){if(typeof l!="object"||l===null||!("name"in l)||!("response"in l))throw new Error(`Could not parse function response, type '${typeof l}'.`);if(!t.isVertexAI()&&!("id"in l))throw new Error(Q3)}return{toolResponse:{functionResponses:r}}}sendClientContent(t){t=Object.assign(Object.assign({},n5),t);const n=this.tLiveClientContent(this.apiClient,t);this.conn.send(JSON.stringify(n))}sendRealtimeInput(t){let n={};this.apiClient.isVertexAI()?n={realtimeInput:pk(t)}:n={realtimeInput:mk(t)},this.conn.send(JSON.stringify(n))}sendToolResponse(t){if(t.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,t);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function a5(e){const t={};return e.forEach((n,r)=>{t[r]=n}),t}function i5(e){const t=new Headers;for(const[n,r]of Object.entries(e))t.append(n,r);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const gv=10;function vv(e){var t,n,r;if(!((t=e==null?void 0:e.automaticFunctionCalling)===null||t===void 0)&&t.disable)return!0;let a=!1;for(const c of(n=e==null?void 0:e.tools)!==null&&n!==void 0?n:[])if(Uu(c)){a=!0;break}if(!a)return!0;const l=(r=e==null?void 0:e.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return l&&(l<0||!Number.isInteger(l))||l==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",l),!0):!1}function Uu(e){return"callTool"in e&&typeof e.callTool=="function"}function yv(e){var t;return!(!((t=e==null?void 0:e.automaticFunctionCalling)===null||t===void 0)&&t.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class s5 extends xs{constructor(t){super(),this.apiClient=t,this.generateContent=async n=>{var r,a,l,c,u;const p=await this.processParamsForMcpUsage(n);if(!q3(n)||vv(n.config))return await this.generateContentInternal(p);if($3(n))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let m,x;const y=qr(p.contents),_=(l=(a=(r=p.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||a===void 0?void 0:a.maximumRemoteCalls)!==null&&l!==void 0?l:gv;let E=0;for(;E<_&&(m=await this.generateContentInternal(p),!(!m.functionCalls||m.functionCalls.length===0));){const w=m.candidates[0].content,S=[];for(const C of(u=(c=n.config)===null||c===void 0?void 0:c.tools)!==null&&u!==void 0?u:[])if(Uu(C)){const k=await C.callTool(m.functionCalls);S.push(...k)}E++,x={role:"user",parts:S},p.contents=qr(p.contents),p.contents.push(w),p.contents.push(x),yv(p.config)&&(y.push(w),y.push(x))}return yv(p.config)&&(m.automaticFunctionCallingHistory=y),m},this.generateContentStream=async n=>{if(vv(n.config)){const r=await this.processParamsForMcpUsage(n);return await this.generateContentStreamInternal(r)}else return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(r=>{var a;let l;const c=[];if(r!=null&&r.generatedImages)for(const p of r.generatedImages)p&&(p!=null&&p.safetyAttributes)&&((a=p==null?void 0:p.safetyAttributes)===null||a===void 0?void 0:a.contentType)==="Positive Prompt"?l=p==null?void 0:p.safetyAttributes:c.push(p);let u;return l?u={generatedImages:c,positivePromptSafetyAttributes:l}:u={generatedImages:c},u}),this.list=async n=>{var r;const c={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!c.config.queryBase){if(!((r=c.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");c.config.filter="labels.tune-type:*"}return new sc(fs.PAGED_ITEM_MODELS,u=>this.listInternal(u),await this.listInternal(c),c)},this.editImage=async n=>{const r={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(r.referenceImages=n.referenceImages.map(a=>a.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async n=>{let r={numberOfImages:1,mode:"upscale"};n.config&&(r=Object.assign(Object.assign({},r),n.config));const a={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:r};return await this.upscaleImageInternal(a)}}async processParamsForMcpUsage(t){var n,r,a;const l=(n=t.config)===null||n===void 0?void 0:n.tools;if(!l)return t;const c=await Promise.all(l.map(async p=>Uu(p)?await p.tool():p)),u={model:t.model,contents:t.contents,config:Object.assign(Object.assign({},t.config),{tools:c})};if(u.config.tools=c,t.config&&t.config.tools&&v2(t.config.tools)){const p=(a=(r=t.config.httpOptions)===null||r===void 0?void 0:r.headers)!==null&&a!==void 0?a:{};let m=Object.assign({},p);Object.keys(m).length===0&&(m=this.apiClient.getDefaultHeaders()),y2(m),u.config.httpOptions=Object.assign(Object.assign({},t.config.httpOptions),{headers:m})}return u}async initAfcToolsMap(t){var n,r,a;const l=new Map;for(const c of(r=(n=t.config)===null||n===void 0?void 0:n.tools)!==null&&r!==void 0?r:[])if(Uu(c)){const u=c,p=await u.tool();for(const m of(a=p.functionDeclarations)!==null&&a!==void 0?a:[]){if(!m.name)throw new Error("Function declaration name is required.");if(l.has(m.name))throw new Error(`Duplicate tool declaration name: ${m.name}`);l.set(m.name,u)}}return l}async processAfcStream(t){var n,r,a;const l=(a=(r=(n=t.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&a!==void 0?a:gv;let c=!1,u=0;const p=await this.initAfcToolsMap(t);return function(m,x,y){var _,E;return hl(this,arguments,function*(){for(var w,S,C,M;u<l;){c&&(u++,c=!1);const G=yield rn(m.processParamsForMcpUsage(y)),J=yield rn(m.generateContentStreamInternal(G)),F=[],W=[];try{for(var k=!0,b=(S=void 0,Lo(J)),U;U=yield rn(b.next()),w=U.done,!w;k=!0){M=U.value,k=!1;const O=M;if(yield yield rn(O),O.candidates&&(!((_=O.candidates[0])===null||_===void 0)&&_.content)){W.push(O.candidates[0].content);for(const ee of(E=O.candidates[0].content.parts)!==null&&E!==void 0?E:[])if(u<l&&ee.functionCall){if(!ee.functionCall.name)throw new Error("Function call name was not returned by the model.");if(x.has(ee.functionCall.name)){const ne=yield rn(x.get(ee.functionCall.name).callTool([ee.functionCall]));F.push(...ne)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${x.keys()}, mising tool: ${ee.functionCall.name}`)}}}}catch(O){S={error:O}}finally{try{!k&&!w&&(C=b.return)&&(yield rn(C.call(b)))}finally{if(S)throw S.error}}if(F.length>0){c=!0;const O=new bo;O.candidates=[{content:{role:"user",parts:F}}],yield yield rn(O);const ee=[];ee.push(...W),ee.push({role:"user",parts:F});const ne=qr(y.contents).concat(ee);y.contents=ne}else break}})}(this,p,t)}async generateContentInternal(t){var n,r,a,l;let c,u="",p={};if(this.apiClient.isVertexAI()){const m=dv(this.apiClient,t);return u=We("{model}:generateContent",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(x=>x.json()),c.then(x=>{const y=mv(x),_=new bo;return Object.assign(_,y),_})}else{const m=fv(this.apiClient,t);return u=We("{model}:generateContent",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(x=>{const y=hv(x),_=new bo;return Object.assign(_,y),_})}}async generateContentStreamInternal(t){var n,r,a,l;let c,u="",p={};if(this.apiClient.isVertexAI()){const m=dv(this.apiClient,t);return u=We("{model}:streamGenerateContent?alt=sse",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.requestStream({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}),c.then(function(y){return hl(this,arguments,function*(){var _,E,w,S;try{for(var C=!0,M=Lo(y),k;k=yield rn(M.next()),_=k.done,!_;C=!0){S=k.value,C=!1;const U=mv(yield rn(S.json())),G=new bo;Object.assign(G,U),yield yield rn(G)}}catch(b){E={error:b}}finally{try{!C&&!_&&(w=M.return)&&(yield rn(w.call(M)))}finally{if(E)throw E.error}}})})}else{const m=fv(this.apiClient,t);return u=We("{model}:streamGenerateContent?alt=sse",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.requestStream({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}),c.then(function(y){return hl(this,arguments,function*(){var _,E,w,S;try{for(var C=!0,M=Lo(y),k;k=yield rn(M.next()),_=k.done,!_;C=!0){S=k.value,C=!1;const U=hv(yield rn(S.json())),G=new bo;Object.assign(G,U),yield yield rn(G)}}catch(b){E={error:b}}finally{try{!C&&!_&&(w=M.return)&&(yield rn(w.call(M)))}finally{if(E)throw E.error}}})})}}async embedContent(t){var n,r,a,l;let c,u="",p={};if(this.apiClient.isVertexAI()){const m=mN(this.apiClient,t);return u=We("{model}:predict",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(x=>x.json()),c.then(x=>{const y=y3(x),_=new z1;return Object.assign(_,y),_})}else{const m=b4(this.apiClient,t);return u=We("{model}:batchEmbedContents",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(x=>{const y=JN(x),_=new z1;return Object.assign(_,y),_})}}async generateImagesInternal(t){var n,r,a,l;let c,u="",p={};if(this.apiClient.isVertexAI()){const m=xN(this.apiClient,t);return u=We("{model}:predict",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(x=>x.json()),c.then(x=>{const y=_3(x),_=new q1;return Object.assign(_,y),_})}else{const m=N4(this.apiClient,t);return u=We("{model}:predict",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(x=>{const y=ZN(x),_=new q1;return Object.assign(_,y),_})}}async editImageInternal(t){var n,r;let a,l="",c={};if(this.apiClient.isVertexAI()){const u=SN(this.apiClient,t);return l=We("{model}:predict",u._url),c=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),a.then(p=>{const m=E3(p),x=new Ew;return Object.assign(x,m),x})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(t){var n,r;let a,l="",c={};if(this.apiClient.isVertexAI()){const u=CN(this.apiClient,t);return l=We("{model}:predict",u._url),c=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),a.then(p=>{const m=S3(p),x=new Sw;return Object.assign(x,m),x})}else throw new Error("This method is only supported by the Vertex AI.")}async get(t){var n,r,a,l;let c,u="",p={};if(this.apiClient.isVertexAI()){const m=AN(this.apiClient,t);return u=We("{name}",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(x=>x.json()),c.then(x=>lh(x))}else{const m=M4(this.apiClient,t);return u=We("{name}",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(x=>sh(x))}}async listInternal(t){var n,r,a,l;let c,u="",p={};if(this.apiClient.isVertexAI()){const m=kN(this.apiClient,t);return u=We("{models_url}",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(x=>x.json()),c.then(x=>{const y=b3(x),_=new $1;return Object.assign(_,y),_})}else{const m=D4(this.apiClient,t);return u=We("{models_url}",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(x=>{const y=e3(x),_=new $1;return Object.assign(_,y),_})}}async update(t){var n,r,a,l;let c,u="",p={};if(this.apiClient.isVertexAI()){const m=MN(this.apiClient,t);return u=We("{model}",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(x=>x.json()),c.then(x=>lh(x))}else{const m=F4(this.apiClient,t);return u=We("{name}",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(x=>sh(x))}}async delete(t){var n,r,a,l;let c,u="",p={};if(this.apiClient.isVertexAI()){const m=RN(this.apiClient,t);return u=We("{name}",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(x=>x.json()),c.then(()=>{const x=k3(),y=new Y1;return Object.assign(y,x),y})}else{const m=L4(this.apiClient,t);return u=We("{name}",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(()=>{const x=t3(),y=new Y1;return Object.assign(y,x),y})}}async countTokens(t){var n,r,a,l;let c,u="",p={};if(this.apiClient.isVertexAI()){const m=IN(this.apiClient,t);return u=We("{model}:countTokens",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(x=>x.json()),c.then(x=>{const y=N3(x),_=new W1;return Object.assign(_,y),_})}else{const m=P4(this.apiClient,t);return u=We("{model}:countTokens",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(x=>{const y=n3(x),_=new W1;return Object.assign(_,y),_})}}async computeTokens(t){var n,r;let a,l="",c={};if(this.apiClient.isVertexAI()){const u=FN(this.apiClient,t);return l=We("{model}:computeTokens",u._url),c=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),a.then(p=>{const m=M3(p),x=new ww;return Object.assign(x,m),x})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(t){var n,r,a,l;let c,u="",p={};if(this.apiClient.isVertexAI()){const m=PN(this.apiClient,t);return u=We("{model}:predictLongRunning",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(x=>x.json()),c.then(x=>F3(x))}else{const m=V4(this.apiClient,t);return u=We("{model}:predictLongRunning",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(x=>s3(x))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function l5(e){const t={},n=f(e,["operationName"]);n!=null&&d(t,["_url","operationName"],n);const r=f(e,["config"]);return r!=null&&d(t,["config"],r),t}function o5(e){const t={},n=f(e,["operationName"]);n!=null&&d(t,["_url","operationName"],n);const r=f(e,["config"]);return r!=null&&d(t,["config"],r),t}function c5(e){const t={},n=f(e,["operationName"]);n!=null&&d(t,["operationName"],n);const r=f(e,["resourceName"]);r!=null&&d(t,["_url","resourceName"],r);const a=f(e,["config"]);return a!=null&&d(t,["config"],a),t}function u5(e){const t={},n=f(e,["video","uri"]);n!=null&&d(t,["uri"],n);const r=f(e,["video","encodedVideo"]);r!=null&&d(t,["videoBytes"],Qa(r));const a=f(e,["encoding"]);return a!=null&&d(t,["mimeType"],a),t}function f5(e){const t={},n=f(e,["_self"]);return n!=null&&d(t,["video"],u5(n)),t}function d5(e){const t={},n=f(e,["generatedSamples"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(c=>f5(c))),d(t,["generatedVideos"],l)}const r=f(e,["raiMediaFilteredCount"]);r!=null&&d(t,["raiMediaFilteredCount"],r);const a=f(e,["raiMediaFilteredReasons"]);return a!=null&&d(t,["raiMediaFilteredReasons"],a),t}function h5(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["metadata"]);r!=null&&d(t,["metadata"],r);const a=f(e,["done"]);a!=null&&d(t,["done"],a);const l=f(e,["error"]);l!=null&&d(t,["error"],l);const c=f(e,["response","generateVideoResponse"]);return c!=null&&d(t,["response"],d5(c)),t}function m5(e){const t={},n=f(e,["gcsUri"]);n!=null&&d(t,["uri"],n);const r=f(e,["bytesBase64Encoded"]);r!=null&&d(t,["videoBytes"],Qa(r));const a=f(e,["mimeType"]);return a!=null&&d(t,["mimeType"],a),t}function p5(e){const t={},n=f(e,["_self"]);return n!=null&&d(t,["video"],m5(n)),t}function x5(e){const t={},n=f(e,["videos"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(c=>p5(c))),d(t,["generatedVideos"],l)}const r=f(e,["raiMediaFilteredCount"]);r!=null&&d(t,["raiMediaFilteredCount"],r);const a=f(e,["raiMediaFilteredReasons"]);return a!=null&&d(t,["raiMediaFilteredReasons"],a),t}function Tv(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["metadata"]);r!=null&&d(t,["metadata"],r);const a=f(e,["done"]);a!=null&&d(t,["done"],a);const l=f(e,["error"]);l!=null&&d(t,["error"],l);const c=f(e,["response"]);return c!=null&&d(t,["response"],x5(c)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class g5 extends xs{constructor(t){super(),this.apiClient=t}async getVideosOperation(t){const n=t.operation,r=t.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const a=n.name.split("/operations/")[0];let l;return r&&"httpOptions"in r&&(l=r.httpOptions),this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:a,config:{httpOptions:l}})}else return this.getVideosOperationInternal({operationName:n.name,config:r})}async getVideosOperationInternal(t){var n,r,a,l;let c,u="",p={};if(this.apiClient.isVertexAI()){const m=o5(t);return u=We("{operationName}",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(x=>x.json()),c.then(x=>Tv(x))}else{const m=l5(t);return u=We("{operationName}",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(x=>h5(x))}}async fetchPredictVideosOperationInternal(t){var n,r;let a,l="",c={};if(this.apiClient.isVertexAI()){const u=c5(t);return l=We("{resourceName}:fetchPredictOperation",u._url),c=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),a.then(p=>Tv(p))}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function v5(e){const t={},n=f(e,["voiceName"]);return n!=null&&d(t,["voiceName"],n),t}function T2(e){const t={},n=f(e,["prebuiltVoiceConfig"]);return n!=null&&d(t,["prebuiltVoiceConfig"],v5(n)),t}function y5(e){const t={},n=f(e,["speaker"]);n!=null&&d(t,["speaker"],n);const r=f(e,["voiceConfig"]);return r!=null&&d(t,["voiceConfig"],T2(r)),t}function T5(e){const t={},n=f(e,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>y5(a))),d(t,["speakerVoiceConfigs"],r)}return t}function _5(e){const t={},n=f(e,["voiceConfig"]);n!=null&&d(t,["voiceConfig"],T2(n));const r=f(e,["multiSpeakerVoiceConfig"]);r!=null&&d(t,["multiSpeakerVoiceConfig"],T5(r));const a=f(e,["languageCode"]);return a!=null&&d(t,["languageCode"],a),t}function E5(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const a=f(e,["startOffset"]);return a!=null&&d(t,["startOffset"],a),t}function S5(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["data"]);n!=null&&d(t,["data"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function w5(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["fileUri"]);n!=null&&d(t,["fileUri"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function C5(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],E5(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const a=f(e,["inlineData"]);a!=null&&d(t,["inlineData"],S5(a));const l=f(e,["fileData"]);l!=null&&d(t,["fileData"],w5(l));const c=f(e,["thoughtSignature"]);c!=null&&d(t,["thoughtSignature"],c);const u=f(e,["codeExecutionResult"]);u!=null&&d(t,["codeExecutionResult"],u);const p=f(e,["executableCode"]);p!=null&&d(t,["executableCode"],p);const m=f(e,["functionCall"]);m!=null&&d(t,["functionCall"],m);const x=f(e,["functionResponse"]);x!=null&&d(t,["functionResponse"],x);const y=f(e,["text"]);return y!=null&&d(t,["text"],y),t}function A5(e){const t={},n=f(e,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(l=>C5(l))),d(t,["parts"],a)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function b5(e){const t={},n=f(e,["behavior"]);n!=null&&d(t,["behavior"],n);const r=f(e,["description"]);r!=null&&d(t,["description"],r);const a=f(e,["name"]);a!=null&&d(t,["name"],a);const l=f(e,["parameters"]);l!=null&&d(t,["parameters"],l);const c=f(e,["parametersJsonSchema"]);c!=null&&d(t,["parametersJsonSchema"],c);const u=f(e,["response"]);u!=null&&d(t,["response"],u);const p=f(e,["responseJsonSchema"]);return p!=null&&d(t,["responseJsonSchema"],p),t}function k5(e){const t={},n=f(e,["startTime"]);n!=null&&d(t,["startTime"],n);const r=f(e,["endTime"]);return r!=null&&d(t,["endTime"],r),t}function N5(e){const t={},n=f(e,["timeRangeFilter"]);return n!=null&&d(t,["timeRangeFilter"],k5(n)),t}function M5(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["dynamicThreshold"]);return r!=null&&d(t,["dynamicThreshold"],r),t}function R5(e){const t={},n=f(e,["dynamicRetrievalConfig"]);return n!=null&&d(t,["dynamicRetrievalConfig"],M5(n)),t}function D5(){return{}}function I5(e){const t={},n=f(e,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(m=>b5(m))),d(t,["functionDeclarations"],p)}if(f(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=f(e,["googleSearch"]);r!=null&&d(t,["googleSearch"],N5(r));const a=f(e,["googleSearchRetrieval"]);if(a!=null&&d(t,["googleSearchRetrieval"],R5(a)),f(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(f(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");f(e,["urlContext"])!=null&&d(t,["urlContext"],D5());const c=f(e,["codeExecution"]);c!=null&&d(t,["codeExecution"],c);const u=f(e,["computerUse"]);return u!=null&&d(t,["computerUse"],u),t}function F5(e){const t={},n=f(e,["handle"]);if(n!=null&&d(t,["handle"],n),f(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function _v(){return{}}function L5(e){const t={},n=f(e,["disabled"]);n!=null&&d(t,["disabled"],n);const r=f(e,["startOfSpeechSensitivity"]);r!=null&&d(t,["startOfSpeechSensitivity"],r);const a=f(e,["endOfSpeechSensitivity"]);a!=null&&d(t,["endOfSpeechSensitivity"],a);const l=f(e,["prefixPaddingMs"]);l!=null&&d(t,["prefixPaddingMs"],l);const c=f(e,["silenceDurationMs"]);return c!=null&&d(t,["silenceDurationMs"],c),t}function O5(e){const t={},n=f(e,["automaticActivityDetection"]);n!=null&&d(t,["automaticActivityDetection"],L5(n));const r=f(e,["activityHandling"]);r!=null&&d(t,["activityHandling"],r);const a=f(e,["turnCoverage"]);return a!=null&&d(t,["turnCoverage"],a),t}function P5(e){const t={},n=f(e,["targetTokens"]);return n!=null&&d(t,["targetTokens"],n),t}function U5(e){const t={},n=f(e,["triggerTokens"]);n!=null&&d(t,["triggerTokens"],n);const r=f(e,["slidingWindow"]);return r!=null&&d(t,["slidingWindow"],P5(r)),t}function B5(e){const t={},n=f(e,["proactiveAudio"]);return n!=null&&d(t,["proactiveAudio"],n),t}function V5(e,t){const n={},r=f(e,["generationConfig"]);t!==void 0&&r!=null&&d(t,["setup","generationConfig"],r);const a=f(e,["responseModalities"]);t!==void 0&&a!=null&&d(t,["setup","generationConfig","responseModalities"],a);const l=f(e,["temperature"]);t!==void 0&&l!=null&&d(t,["setup","generationConfig","temperature"],l);const c=f(e,["topP"]);t!==void 0&&c!=null&&d(t,["setup","generationConfig","topP"],c);const u=f(e,["topK"]);t!==void 0&&u!=null&&d(t,["setup","generationConfig","topK"],u);const p=f(e,["maxOutputTokens"]);t!==void 0&&p!=null&&d(t,["setup","generationConfig","maxOutputTokens"],p);const m=f(e,["mediaResolution"]);t!==void 0&&m!=null&&d(t,["setup","generationConfig","mediaResolution"],m);const x=f(e,["seed"]);t!==void 0&&x!=null&&d(t,["setup","generationConfig","seed"],x);const y=f(e,["speechConfig"]);t!==void 0&&y!=null&&d(t,["setup","generationConfig","speechConfig"],_5(Ch(y)));const _=f(e,["enableAffectiveDialog"]);t!==void 0&&_!=null&&d(t,["setup","generationConfig","enableAffectiveDialog"],_);const E=f(e,["systemInstruction"]);t!==void 0&&E!=null&&d(t,["setup","systemInstruction"],A5(Qn(E)));const w=f(e,["tools"]);if(t!==void 0&&w!=null){let G=Cl(w);Array.isArray(G)&&(G=G.map(J=>I5(wl(J)))),d(t,["setup","tools"],G)}const S=f(e,["sessionResumption"]);t!==void 0&&S!=null&&d(t,["setup","sessionResumption"],F5(S));const C=f(e,["inputAudioTranscription"]);t!==void 0&&C!=null&&d(t,["setup","inputAudioTranscription"],_v());const M=f(e,["outputAudioTranscription"]);t!==void 0&&M!=null&&d(t,["setup","outputAudioTranscription"],_v());const k=f(e,["realtimeInputConfig"]);t!==void 0&&k!=null&&d(t,["setup","realtimeInputConfig"],O5(k));const b=f(e,["contextWindowCompression"]);t!==void 0&&b!=null&&d(t,["setup","contextWindowCompression"],U5(b));const U=f(e,["proactivity"]);return t!==void 0&&U!=null&&d(t,["setup","proactivity"],B5(U)),n}function H5(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["setup","model"],Gt(e,r));const a=f(t,["config"]);return a!=null&&d(n,["config"],V5(a,n)),n}function G5(e,t,n){const r={},a=f(t,["expireTime"]);n!==void 0&&a!=null&&d(n,["expireTime"],a);const l=f(t,["newSessionExpireTime"]);n!==void 0&&l!=null&&d(n,["newSessionExpireTime"],l);const c=f(t,["uses"]);n!==void 0&&c!=null&&d(n,["uses"],c);const u=f(t,["liveConnectConstraints"]);n!==void 0&&u!=null&&d(n,["bidiGenerateContentSetup"],H5(e,u));const p=f(t,["lockAdditionalFields"]);return n!==void 0&&p!=null&&d(n,["fieldMask"],p),r}function j5(e,t){const n={},r=f(t,["config"]);return r!=null&&d(n,["config"],G5(e,r,n)),n}function z5(e){const t={},n=f(e,["name"]);return n!=null&&d(t,["name"],n),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function q5(e){const t=[];for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const r=e[n];if(typeof r=="object"&&r!=null&&Object.keys(r).length>0){const a=Object.keys(r).map(l=>`${n}.${l}`);t.push(...a)}else t.push(n)}return t.join(",")}function $5(e,t){let n=null;const r=e.bidiGenerateContentSetup;if(typeof r=="object"&&r!==null&&"setup"in r){const l=r.setup;typeof l=="object"&&l!==null?(e.bidiGenerateContentSetup=l,n=l):delete e.bidiGenerateContentSetup}else r!==void 0&&delete e.bidiGenerateContentSetup;const a=e.fieldMask;if(n){const l=q5(n);if(Array.isArray(t==null?void 0:t.lockAdditionalFields)&&(t==null?void 0:t.lockAdditionalFields.length)===0)l?e.fieldMask=l:delete e.fieldMask;else if(t!=null&&t.lockAdditionalFields&&t.lockAdditionalFields.length>0&&a!==null&&Array.isArray(a)&&a.length>0){const c=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let u=[];a.length>0&&(u=a.map(m=>c.includes(m)?`generationConfig.${m}`:m));const p=[];l&&p.push(l),u.length>0&&p.push(...u),p.length>0?e.fieldMask=p.join(","):delete e.fieldMask}else delete e.fieldMask}else a!==null&&Array.isArray(a)&&a.length>0?e.fieldMask=a.join(","):delete e.fieldMask;return e}class Y5 extends xs{constructor(t){super(),this.apiClient=t}async create(t){var n,r;let a,l="",c={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const u=j5(this.apiClient,t);l=We("auth_tokens",u._url),c=u._query,delete u.config,delete u._url,delete u._query;const p=$5(u,t.config);return a=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),a.then(m=>z5(m))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function W5(e){const t={},n=f(e,["name"]);n!=null&&d(t,["_url","name"],n);const r=f(e,["config"]);return r!=null&&d(t,["config"],r),t}function J5(e,t){const n={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&d(t,["_query","pageSize"],r);const a=f(e,["pageToken"]);t!==void 0&&a!=null&&d(t,["_query","pageToken"],a);const l=f(e,["filter"]);return t!==void 0&&l!=null&&d(t,["_query","filter"],l),n}function X5(e){const t={},n=f(e,["config"]);return n!=null&&d(t,["config"],J5(n,t)),t}function K5(e){const t={},n=f(e,["textInput"]);n!=null&&d(t,["textInput"],n);const r=f(e,["output"]);return r!=null&&d(t,["output"],r),t}function Z5(e){const t={};if(f(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(f(e,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const n=f(e,["examples"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>K5(a))),d(t,["examples","examples"],r)}return t}function Q5(e,t){const n={};if(f(e,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const r=f(e,["tunedModelDisplayName"]);if(t!==void 0&&r!=null&&d(t,["displayName"],r),f(e,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const a=f(e,["epochCount"]);t!==void 0&&a!=null&&d(t,["tuningTask","hyperparameters","epochCount"],a);const l=f(e,["learningRateMultiplier"]);if(l!=null&&d(n,["tuningTask","hyperparameters","learningRateMultiplier"],l),f(e,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(f(e,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const c=f(e,["batchSize"]);t!==void 0&&c!=null&&d(t,["tuningTask","hyperparameters","batchSize"],c);const u=f(e,["learningRate"]);return t!==void 0&&u!=null&&d(t,["tuningTask","hyperparameters","learningRate"],u),n}function eM(e){const t={},n=f(e,["baseModel"]);n!=null&&d(t,["baseModel"],n);const r=f(e,["trainingDataset"]);r!=null&&d(t,["tuningTask","trainingData"],Z5(r));const a=f(e,["config"]);return a!=null&&d(t,["config"],Q5(a,t)),t}function tM(e){const t={},n=f(e,["name"]);n!=null&&d(t,["_url","name"],n);const r=f(e,["config"]);return r!=null&&d(t,["config"],r),t}function nM(e,t){const n={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&d(t,["_query","pageSize"],r);const a=f(e,["pageToken"]);t!==void 0&&a!=null&&d(t,["_query","pageToken"],a);const l=f(e,["filter"]);return t!==void 0&&l!=null&&d(t,["_query","filter"],l),n}function rM(e){const t={},n=f(e,["config"]);return n!=null&&d(t,["config"],nM(n,t)),t}function aM(e,t){const n={},r=f(e,["gcsUri"]);t!==void 0&&r!=null&&d(t,["supervisedTuningSpec","trainingDatasetUri"],r);const a=f(e,["vertexDatasetResource"]);if(t!==void 0&&a!=null&&d(t,["supervisedTuningSpec","trainingDatasetUri"],a),f(e,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return n}function iM(e,t){const n={},r=f(e,["gcsUri"]);r!=null&&d(n,["validationDatasetUri"],r);const a=f(e,["vertexDatasetResource"]);return t!==void 0&&a!=null&&d(t,["supervisedTuningSpec","trainingDatasetUri"],a),n}function sM(e,t){const n={},r=f(e,["validationDataset"]);t!==void 0&&r!=null&&d(t,["supervisedTuningSpec"],iM(r,n));const a=f(e,["tunedModelDisplayName"]);t!==void 0&&a!=null&&d(t,["tunedModelDisplayName"],a);const l=f(e,["description"]);t!==void 0&&l!=null&&d(t,["description"],l);const c=f(e,["epochCount"]);t!==void 0&&c!=null&&d(t,["supervisedTuningSpec","hyperParameters","epochCount"],c);const u=f(e,["learningRateMultiplier"]);t!==void 0&&u!=null&&d(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],u);const p=f(e,["exportLastCheckpointOnly"]);t!==void 0&&p!=null&&d(t,["supervisedTuningSpec","exportLastCheckpointOnly"],p);const m=f(e,["adapterSize"]);if(t!==void 0&&m!=null&&d(t,["supervisedTuningSpec","hyperParameters","adapterSize"],m),f(e,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(f(e,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return n}function lM(e){const t={},n=f(e,["baseModel"]);n!=null&&d(t,["baseModel"],n);const r=f(e,["trainingDataset"]);r!=null&&d(t,["supervisedTuningSpec","trainingDatasetUri"],aM(r,t));const a=f(e,["config"]);return a!=null&&d(t,["config"],sM(a,t)),t}function oM(e){const t={},n=f(e,["name"]);n!=null&&d(t,["model"],n);const r=f(e,["name"]);return r!=null&&d(t,["endpoint"],r),t}function _2(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["state"]);r!=null&&d(t,["state"],Zy(r));const a=f(e,["createTime"]);a!=null&&d(t,["createTime"],a);const l=f(e,["tuningTask","startTime"]);l!=null&&d(t,["startTime"],l);const c=f(e,["tuningTask","completeTime"]);c!=null&&d(t,["endTime"],c);const u=f(e,["updateTime"]);u!=null&&d(t,["updateTime"],u);const p=f(e,["description"]);p!=null&&d(t,["description"],p);const m=f(e,["baseModel"]);m!=null&&d(t,["baseModel"],m);const x=f(e,["_self"]);x!=null&&d(t,["tunedModel"],oM(x));const y=f(e,["distillationSpec"]);y!=null&&d(t,["distillationSpec"],y);const _=f(e,["experiment"]);_!=null&&d(t,["experiment"],_);const E=f(e,["labels"]);E!=null&&d(t,["labels"],E);const w=f(e,["pipelineJob"]);w!=null&&d(t,["pipelineJob"],w);const S=f(e,["satisfiesPzi"]);S!=null&&d(t,["satisfiesPzi"],S);const C=f(e,["satisfiesPzs"]);C!=null&&d(t,["satisfiesPzs"],C);const M=f(e,["serviceAccount"]);M!=null&&d(t,["serviceAccount"],M);const k=f(e,["tunedModelDisplayName"]);return k!=null&&d(t,["tunedModelDisplayName"],k),t}function cM(e){const t={},n=f(e,["nextPageToken"]);n!=null&&d(t,["nextPageToken"],n);const r=f(e,["tunedModels"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>_2(l))),d(t,["tuningJobs"],a)}return t}function uM(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["metadata"]);r!=null&&d(t,["metadata"],r);const a=f(e,["done"]);a!=null&&d(t,["done"],a);const l=f(e,["error"]);return l!=null&&d(t,["error"],l),t}function fM(e){const t={},n=f(e,["checkpointId"]);n!=null&&d(t,["checkpointId"],n);const r=f(e,["epoch"]);r!=null&&d(t,["epoch"],r);const a=f(e,["step"]);a!=null&&d(t,["step"],a);const l=f(e,["endpoint"]);return l!=null&&d(t,["endpoint"],l),t}function dM(e){const t={},n=f(e,["model"]);n!=null&&d(t,["model"],n);const r=f(e,["endpoint"]);r!=null&&d(t,["endpoint"],r);const a=f(e,["checkpoints"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(c=>fM(c))),d(t,["checkpoints"],l)}return t}function ch(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["state"]);r!=null&&d(t,["state"],Zy(r));const a=f(e,["createTime"]);a!=null&&d(t,["createTime"],a);const l=f(e,["startTime"]);l!=null&&d(t,["startTime"],l);const c=f(e,["endTime"]);c!=null&&d(t,["endTime"],c);const u=f(e,["updateTime"]);u!=null&&d(t,["updateTime"],u);const p=f(e,["error"]);p!=null&&d(t,["error"],p);const m=f(e,["description"]);m!=null&&d(t,["description"],m);const x=f(e,["baseModel"]);x!=null&&d(t,["baseModel"],x);const y=f(e,["tunedModel"]);y!=null&&d(t,["tunedModel"],dM(y));const _=f(e,["supervisedTuningSpec"]);_!=null&&d(t,["supervisedTuningSpec"],_);const E=f(e,["tuningDataStats"]);E!=null&&d(t,["tuningDataStats"],E);const w=f(e,["encryptionSpec"]);w!=null&&d(t,["encryptionSpec"],w);const S=f(e,["partnerModelTuningSpec"]);S!=null&&d(t,["partnerModelTuningSpec"],S);const C=f(e,["distillationSpec"]);C!=null&&d(t,["distillationSpec"],C);const M=f(e,["experiment"]);M!=null&&d(t,["experiment"],M);const k=f(e,["labels"]);k!=null&&d(t,["labels"],k);const b=f(e,["pipelineJob"]);b!=null&&d(t,["pipelineJob"],b);const U=f(e,["satisfiesPzi"]);U!=null&&d(t,["satisfiesPzi"],U);const G=f(e,["satisfiesPzs"]);G!=null&&d(t,["satisfiesPzs"],G);const J=f(e,["serviceAccount"]);J!=null&&d(t,["serviceAccount"],J);const F=f(e,["tunedModelDisplayName"]);return F!=null&&d(t,["tunedModelDisplayName"],F),t}function hM(e){const t={},n=f(e,["nextPageToken"]);n!=null&&d(t,["nextPageToken"],n);const r=f(e,["tuningJobs"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>ch(l))),d(t,["tuningJobs"],a)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class mM extends xs{constructor(t){super(),this.apiClient=t,this.get=async n=>await this.getInternal(n),this.list=async(n={})=>new sc(fs.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.tune=async n=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(n);{const r=await this.tuneMldevInternal(n);let a="";return r.metadata!==void 0&&r.metadata.tunedModel!==void 0?a=r.metadata.tunedModel:r.name!==void 0&&r.name.includes("/operations/")&&(a=r.name.split("/operations/")[0]),{name:a,state:Qd.JOB_STATE_QUEUED}}}}async getInternal(t){var n,r,a,l;let c,u="",p={};if(this.apiClient.isVertexAI()){const m=tM(t);return u=We("{name}",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(x=>x.json()),c.then(x=>ch(x))}else{const m=W5(t);return u=We("{name}",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(x=>_2(x))}}async listInternal(t){var n,r,a,l;let c,u="",p={};if(this.apiClient.isVertexAI()){const m=rM(t);return u=We("tuningJobs",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(x=>x.json()),c.then(x=>{const y=hM(x),_=new J1;return Object.assign(_,y),_})}else{const m=X5(t);return u=We("tunedModels",m._url),p=m._query,delete m.config,delete m._url,delete m._query,c=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(x=>{const y=cM(x),_=new J1;return Object.assign(_,y),_})}}async tuneInternal(t){var n,r;let a,l="",c={};if(this.apiClient.isVertexAI()){const u=lM(t);return l=We("tuningJobs",u._url),c=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),a.then(p=>ch(p))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(t){var n,r;let a,l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=eM(t);return l=We("tunedModels",u._url),c=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),a.then(p=>uM(p))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class pM{async download(t,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const xM=1024*1024*8,gM=3,vM=1e3,yM=2,Md="x-goog-upload-status";async function TM(e,t,n){var r,a,l;let c=0,u=0,p=new eh(new Response),m="upload";for(c=e.size;u<c;){const y=Math.min(xM,c-u),_=e.slice(u,u+y);u+y>=c&&(m+=", finalize");let E=0,w=vM;for(;E<gM&&(p=await n.request({path:"",body:_,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":m,"X-Goog-Upload-Offset":String(u),"Content-Length":String(y)}}}),!(!((r=p==null?void 0:p.headers)===null||r===void 0)&&r[Md]));)E++,await EM(w),w=w*yM;if(u+=y,((a=p==null?void 0:p.headers)===null||a===void 0?void 0:a[Md])!=="active")break;if(c<=u)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const x=await(p==null?void 0:p.json());if(((l=p==null?void 0:p.headers)===null||l===void 0?void 0:l[Md])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return x.file}async function _M(e){return{size:e.size,type:e.type}}function EM(e){return new Promise(t=>setTimeout(t,e))}class SM{async upload(t,n,r){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await TM(t,n,r)}async stat(t){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await _M(t)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class wM{create(t,n,r){return new CM(t,n,r)}}class CM{constructor(t,n,r){this.url=t,this.headers=n,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(t){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(t)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ev="x-goog-api-key";class AM{constructor(t){this.apiKey=t}async addAuthHeaders(t){if(t.get(Ev)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");t.append(Ev,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const bM="gl-node/";class kM{constructor(t){var n;if(t.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(t.project||t.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=t.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=t.apiKey;const r=_w(t,void 0,void 0);r&&(t.httpOptions?t.httpOptions.baseUrl=r:t.httpOptions={baseUrl:r}),this.apiVersion=t.apiVersion;const a=new AM(this.apiKey);this.apiClient=new G3({auth:a,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:t.httpOptions,userAgentExtra:bM+"web",uploader:new SM,downloader:new pM}),this.models=new s5(this.apiClient),this.live=new t5(this.apiClient,a,new wM),this.batches=new JC(this.apiClient),this.chats=new QA(this.models,this.apiClient),this.caches=new XA(this.apiClient),this.files=new db(this.apiClient),this.operations=new g5(this.apiClient),this.authTokens=new Y5(this.apiClient),this.tunings=new mM(this.apiClient)}}const la="gemini-2.5-flash-preview-04-17";let Qt=null;const Sv=e=>{if(!e){Qt=null;return}try{Qt=new kM({apiKey:e})}catch(t){console.error("Failed to initialize Gemini AI:",t),Qt=null}},gs=e=>{const t=n=>{const{position:r,extendedDetails:a,...l}=n,c={...l};if(a){const{reportDeck:u,attachments:p,subSteps:m,decisions:x,...y}=a,_={...y};u&&u.slides.length>0&&(_.reportDeckExists=!0,_.reportDeckSlideCount=u.slides.length),p&&p.length>0&&(_.attachments=p.map(E=>({id:E.id,name:E.name,type:E.type}))),m&&m.length>0&&(_.subSteps=m.map(E=>{const{position:w,attachments:S,actionItems:C,...M}=E,k={...M};return S&&S.length>0&&(k.attachments=S.map(b=>({id:b.id,name:b.name,type:b.type}))),C&&C.length>0&&(k.actionItems=C.map(b=>{const{report:U,...G}=b,J={...G};if(U){const{attachments:F,...W}=U,O={...W};F&&F.length>0&&(O.attachments=F.map(ee=>({id:ee.id,name:ee.name,type:ee.type}))),J.report=O}return J})),k})),c.extendedDetails=_}return c};return Array.isArray(e)?e.map(t):t(e)},df=e=>({...e,slides:e.slides.map(t=>{if(t.isLocked)return{id:t.id,isLocked:!0,summary:`Locked Slide: Contains ${t.elements.length} elements. Content is preserved and must not be changed.`,elements:[]};const{elements:n,...r}=t;return{...r,elements:n.map(a=>{var l;if(a.type==="flowchart"&&((l=a.data)!=null&&l.subSteps)){const c=a;return{...c,data:{subStepCount:c.data.subSteps.length,subSteps:`[Sub-step data omitted for brevity, count: ${c.data.subSteps.length}]`}}}return a})}})}),NM=e=>{const t=/"dependencies"\s*:\s*\[([\s\S]*?)\]/g;return e.replace(t,(n,r)=>{const a=r.match(/"[^"]*"/g);return`"dependencies": [${a?a.join(", "):""}]`})},Sa=e=>{let t=e.trim();const n=/^```(?:json)?\s*\n?(.*?)\n?\s*```$/s,r=t.match(n);if(r&&r[1]&&(t=r[1].trim()),t=NM(t),t=t.replace(/"((?:\\.|[^"\\])*)"/g,(a,l)=>`"${l.replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t")}"`),!r){const a=t.indexOf("{"),l=t.indexOf("[");if(a===-1&&l===-1)throw console.error("No JSON object or array found in the response string.",e),new Error(`AI response did not contain a valid JSON structure. Raw response: ${e.substring(0,500)}...`);const c=a===-1?l:l===-1?a:Math.min(a,l),u=t.lastIndexOf("}"),p=t.lastIndexOf("]"),m=Math.max(u,p);c>-1&&m>c&&(t=t.substring(c,m+1))}try{return JSON.parse(t)}catch(a){throw console.error("Failed to parse JSON response:",a,`
Original text:`,e,`
Processed string:`,t),new Error(`Failed to parse AI response as JSON. Raw response: ${e.substring(0,500)}...`)}},oa=(e,t)=>{console.error(`Error in Gemini API call during ${t}:`,e);let n=`AI (${t})`;if(e instanceof Error){const r=e.message.toLowerCase();r.includes("api key not valid")||r.includes("api key is invalid")?n="API(API key not valid. Please pass a valid API key.)":r.includes("quota")?n="APIGoogle AI Platform(You have exceeded your API quota.)":n=`AI (${t}): ${e.message}`}throw new Error(n)},MM=async(e,t)=>{if(!Qt)throw new Error("AI Service not initialized. Please set an API Key.");const n=`
    You are an expert project planner. Your task is to break down a high-level project goal into a sequence of actionable tasks.
    CONTEXT:
    - Project Goal: "${e}"
    - Target Completion Date: "${t}"
    INSTRUCTIONS:
    1.  Generate a sequence of 3 to 7 high-level, actionable tasks.
    2.  Provide a concise title (max 10 words) and a brief description (1-2 sentences) for each.
    3.  Your response MUST be a single, valid JSON array of objects. Do NOT include any explanations or markdown fences.
    4.  The language of the output should match the language of the input goal.
    5.  Each object MUST have this structure: { "id": "unique_string_id", "title": "Task Title", "description": "Task Description" }
  `;try{const r=await Qt.models.generateContent({model:la,contents:n,config:{responseMimeType:"application/json"}}),a=Sa(r.text);if(!a||!Array.isArray(a)||a.some(l=>!l.id||!l.title||!l.description))throw new Error("AI returned an unexpected format for project tasks.");return a}catch(r){oa(r,"project plan generation")}},RM=async e=>{var n;if(!Qt)throw new Error("AI Service not initialized. Please set an API Key.");const t=`
    You are a project management expert. Analyze the given task and propose a list of concrete next steps to accomplish it.
    CONTEXT:
    - Task Title: "${e.title}"
    - Task Description: "${e.description}"
    - Required Resources: "${((n=e.extendedDetails)==null?void 0:n.resources)||"Not specified"}"
    INSTRUCTIONS:
    1.  Generate a list of 3 to 6 actionable proposals (sub-steps).
    2.  Each proposal must have a concise 'title' and a 'description'.
    3.  Focus on breaking down the main task into logical phases or components.
    4.  Your response MUST be a single, valid JSON array of objects. Do not include any explanations.
    5.  The language must match the input task language.
    6.  The JSON structure for each item must be: { "title": "...", "description": "..." }
  `;try{const r=await Qt.models.generateContent({model:la,contents:t,config:{responseMimeType:"application/json"}}),a=Sa(r.text);if(!a||!Array.isArray(a)||a.some(l=>!l.title||!l.description))throw new Error("AI returned an unexpected format for step proposals.");if(a.length===0)throw new Error("AI did not generate any proposals. The task might be too abstract.");return a}catch(r){oa(r,"step proposal generation")}},DM=async(e,t)=>{if(!Qt)throw new Error("AI Service not initialized. Please set an API Key.");const n=`
        You are a senior project analyst AI. Your task is to intelligently update a list of critical project decisions based on the latest task data. You will merge new findings with an existing list.

        CONTEXT:
        - Full Task Data (JSON, pruned for brevity): ${JSON.stringify(gs(e))}
        - Existing Decisions List: ${JSON.stringify(t)}
        - Today's Date: ${new Date().toISOString().split("T")[0]}

        INSTRUCTIONS:
        1.  **Analyze Task Data**: Holistically review the 'Full Task Data' to understand the current state, including sub-steps, action items, and notes.
        2.  **Review Existing Decisions**: Go through each item in the 'Existing Decisions List'.
        3.  **Merge and Update**:
            *   **For each existing decision**: Check if the latest task data provides new information.
                *   If an 'undecided' item now has a clear answer in the task data, update its 'status' to 'decided', fill in the 'decision' and 'reasoning', and set the 'date'.
                *   You may also refine the 'question' or 'reasoning' of existing items if the new data provides more clarity.
                *   Keep the original 'id' for all existing items.
            *   **Identify New Decisions**: Look for any *new* critical questions or decision points in the task data that are NOT present in the existing list.
            *   For each new decision you find, create a new decision object.
        4.  **Construct Final List**: Your output MUST be a single JSON array containing the complete, merged list of decisions. This list must include:
            *   All the original decisions, updated as necessary.
            *   All the newly identified decisions.
        5.  **JSON Structure**: Every object in the output array MUST strictly follow this structure. For new items, you MUST set the 'id' field to 'NEW'. For existing items, you MUST preserve their original 'id'.
            {
              "id": "string (original ID or 'NEW' for new items)",
              "question": "The question that needs a decision.",
              "decision": "The final outcome (string, or empty string for 'undecided').",
              "reasoning": "Justification for the decision, or explanation of importance for 'undecided'.",
              "date": "YYYY-MM-DD (string, or empty string for 'undecided').",
              "status": "'decided' or 'undecided'."
            }
        6.  **Language and Format**: The output language must match the input task language. The response must be only the JSON array, without any markdown or explanations.
    `;try{const r=await Qt.models.generateContent({model:la,contents:n,config:{responseMimeType:"application/json"}}),a=Sa(r.text);if(!a||!Array.isArray(a)||a.some(l=>!l.question||!l.status||!l.id))throw new Error("AI returned an unexpected format for decisions. Expected fields: id, question, status.");return a}catch(r){oa(r,"decision generation")}},IM=async(e,t,n)=>{if(!Qt)throw new Error("AI Service not initialized. Please set an API Key.");const r=`
      You are a presentation designer and project analyst. Your task is to update a project status report slide deck based on new data, while preserving slides that have been manually locked by the user.
      CONTEXT:
      - Overall Project Goal: "${n}"
      - Updated Full Task Data (JSON, pruned for brevity): ${JSON.stringify(gs(t))}
      - Existing Slide Deck (pruned for brevity): ${JSON.stringify(df(e))}

      INSTRUCTIONS:
      1.  Analyze 'existingDeck'. Slides with '"isLocked": true' have been summarized and their 'elements' are empty. You MUST NOT change these slides. Return them exactly as they are in the input (id, isLocked, summary, empty elements array).
      2.  For all other slides (unlocked), REGENERATE their content from scratch based on the 'updatedTaskData'.
      3.  This includes regenerating 'flowchart' slides to reflect the latest sub-step data.
      4.  **ACTION ITEM FOCUS**: When regenerating, pay close attention to the progress and reports within each sub-step's 'actionItems'.
      5.  The final output MUST be a single, valid JSON object representing the complete slide deck, with all slides (locked and regenerated) in their original order.
      6.  Follow the same JSON structure and rules as the initial generation.
    `;try{const a=await Qt.models.generateContent({model:la,contents:r,config:{responseMimeType:"application/json"}}),l=Sa(a.text);if(!l||!Array.isArray(l.slides))throw new Error("AI returned an invalid format for the regenerated slide deck.");return l}catch(a){oa(a,"slide deck regeneration")}},FM=async e=>{if(!Qt)throw new Error("AI Service not initialized. Please set an API Key.");const t=`
        You are an expert presentation designer. The following JSON represents a slide deck.
        Analyze its content and structure. Your task is to improve the layout, wording, and visual hierarchy for maximum clarity and impact.
        You can rephrase text for conciseness, change element positions and sizes, and adjust font properties. Do not change element types or IDs.
        Return the updated slide deck as a valid JSON object with the exact same structure as the input. Do not use markdown.
        CRITICAL: Textbox elements use a "content" field, NOT a "text" field.
        
        Input Deck (pruned for brevity):
        ${JSON.stringify(df(e))}
    `;try{const n=await Qt.models.generateContent({model:la,contents:t,config:{responseMimeType:"application/json"}}),r=Sa(n.text);if(!r||!Array.isArray(r.slides))throw new Error("AI returned an invalid format for the optimized slide deck.");return r}catch(n){oa(n,"slide layout optimization")}},LM=async(e,t,n)=>{if(!Qt)throw new Error("AI Service not initialized. Please set an API Key.");const r=`
      You are a senior project manager AI. Your task is to conduct a holistic health check of the entire project.
      CONTEXT:
      - Overall Project Goal: "${t}"
      - Final Target Date: "${n}"
      - Current Date: "${new Date().toISOString().split("T")[0]}"
      - Full Project Data (JSON, pruned for brevity): ${JSON.stringify(gs(e),null,2)}

      INSTRUCTIONS:
      1.  **Holistic Analysis**: Review ALL provided data. Compare task/sub-step due dates with the current date. Analyze dependencies, blockers, and the completion rate of action items.
      2.  **Determine Overall Status**: Categorize the project's health as 'On Track', 'At Risk', or 'Off Track'.
      3.  **Identify Positives**: List 2-3 key accomplishments or areas that are progressing well.
      4.  **Identify Concerns**: List the most critical risks or issues. For each, explain WHY it's a concern (e.g., "Task 'X' is 2 weeks overdue and blocking 3 other tasks"). Note the related task IDs.
      5.  **Propose Solutions**: For each major concern, provide concrete, actionable suggestions for improvement. (e.g., "Re-allocate resources from Task Y to Task X", "Hold a risk mitigation meeting for Z").
      6.  **Summarize**: Write a concise, executive-level summary of the project's current state.
      7.  **JSON Output**: Your response MUST be a single, valid JSON object following the ProjectHealthReport structure. Do not include markdown or explanations.
      8.  **The output language MUST be Japanese.**

      JSON Structure to follow:
      {
        "overallStatus": "'On Track' | 'At Risk' | 'Off Track'",
        "summary": "string",
        "positivePoints": ["string"],
        "areasOfConcern": [{ "description": "string", "relatedTaskIds": ["string"] }],
        "suggestions": ["string"]
      }
    `;try{const a=await Qt.models.generateContent({model:la,contents:r,config:{responseMimeType:"application/json"}}),l=Sa(a.text);if(!l||!l.overallStatus||!l.summary)throw new Error("AI returned an invalid format for the project health report.");return l}catch(a){oa(a,"project health report generation")}},OM=async(e,t,n)=>{if(!Qt)throw new Error("AI Service not initialized. Please set an API Key.");const r=`
        You are a senior project analyst AI. Your task is to create a comprehensive slide deck summarizing the ENTIRE project status.
        CONTEXT:
        - Overall Project Goal: "${t}"
        - Final Target Date: "${n}"
        - Full Project Data (JSON, pruned for brevity): ${JSON.stringify(gs(e),null,2)}
        INSTRUCTIONS:
        1.  Synthesize a comprehensive slide deck (6-10 slides) summarizing the entire project.
        2.  The response MUST be a single, valid JSON object following the SlideDeck structure. Do NOT use markdown.
        3.  The output language MUST be Japanese.
        4.  **CRITICAL SYNTHESIS**:
            - **Title & Overview**: Create a title slide and a project overview slide.
            - **Task Summary & Flowchart**: For each major task in the 'tasks' array, create one or two summary slides. One slide should show a \`flowchart\` of its sub-steps if they exist, following the structure \`{"type": "flowchart", "data": {"subSteps": [...]}}\`. You MUST copy the task's specific \`subSteps\` array from the input JSON into the \`data.subSteps\` field. Another slide can summarize the task's status and outcomes.
            - **Key Project Decisions**: Analyze the 'decisions' data from all tasks. Create a dedicated slide titled "". List the top 3-5 most important 'decided' items and their outcomes. Separately, list any critical 'undecided' questions that pose a risk to the project timeline or goals.
            - **Key Achievements & Risks**: Create dedicated slides for significant achievements and project-level risks.
            - **Conclusion**: A final slide summarizing the project's outlook and next steps.
        5.  Use the standard JSON format for slides and elements. Remember "content" for textboxes.
    `;try{const a=await Qt.models.generateContent({model:la,contents:r,config:{responseMimeType:"application/json"}}),l=Sa(a.text);if(!l||!Array.isArray(l.slides))throw new Error("AI returned an invalid format for the project slide deck.");return l}catch(a){oa(a,"project report deck generation")}},PM=async(e,t,n,r)=>{if(!Qt)throw new Error("AI Service not initialized. Please set an API Key.");const a=`
      You are a senior project analyst AI. Your task is to update a project-wide status report slide deck based on new data, while preserving slides that have been manually locked by the user.
      CONTEXT:
      - Overall Project Goal: "${n}"
      - Final Target Date: "${r}"
      - Updated Full Project Data (JSON, pruned for brevity): ${JSON.stringify(gs(t),null,2)}
      - Existing Slide Deck (pruned for brevity): ${JSON.stringify(df(e))}

      INSTRUCTIONS:
      1.  Analyze 'existingDeck'. Slides with '"isLocked": true' have been summarized and their 'elements' are empty. You MUST NOT change these slides. Return them exactly as they are in the input (id, isLocked, summary, empty elements array).
      2.  For all other slides (unlocked slides), REGENERATE their content from scratch based on the updated project data.
      3.  This includes regenerating any 'flowchart' elements on unlocked slides to show the latest sub-step data.
      4.  Synthesize information across all tasks to provide a holistic project view in the regenerated slides.
      5.  The final output MUST be a single, valid JSON object for the complete slide deck, in the original slide order.
      6.  The output language MUST be Japanese.
    `;try{const l=await Qt.models.generateContent({model:la,contents:a,config:{responseMimeType:"application/json"}}),c=Sa(l.text);if(!c||!Array.isArray(c.slides))throw new Error("AI returned an invalid format for the regenerated project slide deck.");return c}catch(l){oa(l,"project report deck regeneration")}},UM=e=>{const t=e.match(/^data:(.+);base64,(.*)$/);return t?{mimeType:t[1],data:t[2]}:null},E2=e=>{if(!Qt)throw new Error("AI Service not initialized. Please set an API Key.");const t=[];for(const n of e){if(t.push({text:`
--- START OF SOURCE: ${n.name} ---
`}),n.type==="image"&&typeof n.content=="string"){const r=UM(n.content);r?t.push({inlineData:{mimeType:r.mimeType,data:r.data}}):t.push({text:"[Image data was invalid or in wrong format]"})}else if(n.type==="json"){const r=n.content.slides?df(n.content):gs(n.content);t.push({text:`Type: JSON Data
Content: ${JSON.stringify(r,null,2)}`})}else t.push({text:`Type: Text
Content: ${n.content}`});t.push({text:`
--- END OF SOURCE: ${n.name} ---
`})}return t},S2=async(e,t)=>{if(!Qt)throw new Error("AI Service not initialized. Please set an API Key.");const r=[{text:`
        You are a professional presentation designer AI. Your task is to create a slide deck based on a user's objective and provided source materials.

        **USER OBJECTIVE**: "${t}"

        **CRITICAL INSTRUCTIONS**:
        1.  **Strict JSON Output**: Your entire response MUST be a single, valid JSON object. Do NOT include any text, explanations, or markdown fences (like \`\`\`json\`) outside of the JSON object. Your response should start with \`{\` and end with \`}\`.
        2.  **Schema Adherence**: The JSON object MUST strictly conform to the following TypeScript interfaces for \`SlideDeck\`, \`Slide\`, and \`SlideElement\`.
            \`\`\`typescript
            // The main container for the presentation
            interface SlideDeck {
              slides: Slide[];
              theme?: 'light' | 'dark' | 'business';
            }

            // Represents a single slide in the deck
            interface Slide {
              id: string; // A unique identifier for the slide
              layout: 'title_slide' | 'title_and_content' | 'section_header' | 'two_column' | 'blank';
              elements: SlideElement[];
              isLocked?: boolean; // Must be false for all generated slides
              notes?: string; // Optional speaker notes
            }

            // Union type for all possible elements on a slide
            type SlideElement = TextboxElement | ImageElement | TableElement | ChartElement | FlowchartElement;

            // Base interface for all elements
            interface BaseSlideElement {
              id: string; // A unique identifier for the element
              type: 'textbox' | 'image' | 'table' | 'chart' | 'flowchart';
              position: { x: number; y: number; width: number; height: number; }; // Position in percentages
            }

            // For displaying text
            interface TextboxElement extends BaseSlideElement {
              type: 'textbox';
              content: string; // IMPORTANT: The text content field MUST be named "content".
            }
            
            // For displaying an image from the source materials
            interface ImageElement extends BaseSlideElement {
              type: 'image';
              // You MUST find a relevant image from the source materials and reference its properties here.
              // These IDs must correspond to actual data in the sources provided.
              subStepId: string;
              actionItemId: string; 
              attachmentId: string;
            }

            // For displaying a flowchart of sub-steps
            interface FlowchartElement extends BaseSlideElement {
                type: 'flowchart';
                // You MUST copy the entire 'subSteps' array from the source task data into this field.
                data: {
                    subSteps: any[]; 
                };
            }
            \`\`\`
        3.  **Content Synthesis**:
            *   Analyze ALL provided source materials to create a coherent 4-7 slide presentation that directly addresses the user's objective.
            *   If image sources are provided, you MUST incorporate them into the slides using the 'image' element type.
            *   Do not just copy-paste. Interpret, summarize, and visualize the information effectively.
        4.  **Language**: The output language MUST be Japanese.
        5.  **IDs**: Generate unique string IDs for all 'id' fields in slides and elements.

        **SOURCE MATERIALS FOLLOW**:
    `},...E2(e)];r.push({text:`
Reminder: Create the slide deck now based on the objective and all the sources provided above. The response must be only the JSON object.`});try{const a=await Qt.models.generateContent({model:la,contents:{parts:r},config:{responseMimeType:"application/json"}}),l=Sa(a.text);if(!l||!Array.isArray(l.slides))throw new Error("AI returned an invalid format for the custom slide deck.");return l}catch(a){oa(a,"custom slide deck generation")}},BM=async(e,t)=>{if(!Qt)throw new Error("AI Service not initialized. Please set an API Key.");const r=[{text:`
        You are an expert project analyst. Your task is to write a text-based report based on a specific user objective and a collection of source materials.
        USER OBJECTIVE:
        "${t}"
        INSTRUCTIONS:
        1.  Synthesize the information from ALL provided source materials to create a coherent and insightful report that directly addresses the user's objective.
        2.  Do not simply copy-paste data. Interpret and summarize the information in a clear, professional manner.
        3.  Format the output using Markdown for readability (e.g., use headings, bullet points, bold text).
        4.  If image sources are provided, reference them by name in your report (e.g., "(see image: 'chart.png')"). Do not try to embed them.
        5.  The language of the output should be Japanese.
        6.  Your response MUST be only the text report. Do not include any other explanations.
        SOURCE MATERIALS FOLLOW:
    `},...E2(e)];r.push({text:`
Reminder: Write the report now based on the objective and all the sources provided above. The response must be only the text report.`});try{return(await Qt.models.generateContent({model:la,contents:{parts:r}})).text}catch(a){oa(a,"custom text report generation")}},wv=async(e,t,n)=>{if(!Qt)throw new Error("AI Service not initialized. Please set an API Key.");const r=`
      You are a project management assistant AI. Your task is to convert a project structure into data for a Gantt chart.
      CONTEXT:
      - Project Goal: "${t}"
      - Project Start Date: "${new Date().toISOString().split("T")[0]}"
      - Project Target End Date: "${n}"
      - Full Project Data (JSON, pruned for brevity): ${JSON.stringify(gs(e),null,2)}

      INSTRUCTIONS:
      1.  Create a flat list of items for the Gantt chart. Include every ProjectTask, every SubStep, and every ActionItem from all tasks.
      2.  For each item, generate a JSON object with this exact structure:
          { "id": "string", "name": "string", "start": "YYYY-MM-DD", "end": "YYYY-MM-DD", "progress": number, "dependencies": ["string"], "type": "'task' | 'substep' | 'actionitem'", "parentId": "string | null" }
      3.  **Date Estimation**:
          - The project must fit between the start and target dates.
          - Use an item's \`dueDate\` as its 'end' date if available for tasks and sub-steps.
          - Estimate 'start' and 'end' dates logically. An item must start after its dependencies end.
          - For 'actionitem', estimate a short duration (e.g., 1-2 days) within the parent sub-step's timeframe.
      4.  **Progress Calculation**:
          - For a 'task': 'Completed' is 100, 'Not Started' is 0. For 'In Progress' or 'Blocked', average the progress of its sub-steps. If no sub-steps, 'In Progress' is 50.
          - For a 'substep': Calculate progress from its \`actionItems\` (% of completed items). If no action items, use its \`status\`: 'Completed' is 100, 'In Progress' is 50, 'Not Started' is 0.
          - For an 'actionitem': 'completed: true' is 100, 'completed: false' is 0.
      5.  **Dependencies & Parent ID**:
          - **Rule**: The 'dependencies' array models the sequential workflow. A dependency can ONLY exist between items of the SAME \`type\` AND with the SAME \`parentId\`.
          - **Tasks**: A task's 'parentId' is ALWAYS null. Use \`nextTaskIds\` to establish dependencies between tasks.
          - **Sub-steps**: A sub-step's 'parentId' MUST BE the ID of its parent ProjectTask. Use \`nextSubStepIds\` to establish dependencies ONLY between sub-steps within the same task.
          - **Action Items**: An action item's 'parentId' MUST BE the ID of its parent SubStep. Create sequential dependencies ONLY between action items within the same sub-step (item 2 depends on item 1, etc.).
          - **CRITICAL**: Do NOT create dependencies across different parents (e.g., from a sub-step in Task A to one in Task B) or across different types (e.g., from a task to a sub-step).
      6.  Your response MUST be a single, valid JSON array of GanttItem objects. Do not use markdown.
    `;try{const a=await Qt.models.generateContent({model:la,contents:r,config:{responseMimeType:"application/json"}}),l=Sa(a.text);if(!l||!Array.isArray(l))throw new Error("AI returned an invalid format for the Gantt chart data.");return l}catch(a){oa(a,"Gantt chart data generation")}},ia=({size:e="md",color:t="border-blue-500",text:n})=>{const r={sm:"w-6 h-6",md:"w-10 h-10",lg:"w-16 h-16"};return g.jsxs("div",{className:"flex flex-col items-center justify-center space-y-2",children:[g.jsx("div",{className:`animate-spin rounded-full border-4 ${t} border-t-transparent ${r[e]}`}),n&&g.jsx("p",{className:"text-slate-600 text-sm",children:n})]})},w2=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5m-9-3.75h.008v.008H12v-.008ZM12 15h.008v.008H12v-.008ZM9.75 15h.008v.008H9.75v-.008ZM7.5 15h.008v.008H7.5v-.008ZM9.75 18.75h.008v.008H9.75v-.008ZM7.5 18.75h.008v.008H7.5v-.008ZM14.25 15h.008v.008H14.25v-.008ZM16.5 15h.008v.008H16.5v-.008ZM14.25 18.75h.008v.008H14.25v-.008ZM16.5 18.75h.008v.008H16.5v-.008Z"})}),C2=e=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:[g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 21a9 9 0 1 0 0-18 9 9 0 0 0 0 18Z"}),g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"}),g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m12 12 4.243 4.243"})]}),VM=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"})}),HM=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"})}),ca=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"})}),A2=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"})}),b2=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5"})}),hf=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"})}),Nh=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v6m3-3H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),Xa=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12.56 0c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"})}),mf=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),Oo=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"})}),Mh=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18v-5.25m0 0a6.01 6.01 0 0 0 1.5-.189m-1.5.189a6.01 6.01 0 0 1-1.5-.189m3.75 7.478a12.06 12.06 0 0 1-4.5 0m3.75 2.354a15.055 15.055 0 0 1-3 0M12.75 4.5v-.75a.75.75 0 0 0-.75-.75h-.75a.75.75 0 0 0-.75.75v.75m0 0A2.25 2.25 0 0 0 9.75 6.75h4.5A2.25 2.25 0 0 0 12.75 4.5M12 18.75h.008v.008H12v-.008Z"})}),Yu=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})}),GM=({title:e,...t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[e&&g.jsx("title",{children:e}),g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9.75V12m0 0H9.75M12 12h2.25m-2.25 0V9.75M12 12v2.25m0 0H9.75M12 14.25h2.25M12 6.75a5.25 5.25 0 1 1-10.5 0 5.25 5.25 0 0 1 10.5 0Zm0 0V3m0 3.75h.008v.008H12V6.75Zm-5.25 0H3.75m0 0V3m0 3.75h.008v.008H3.75V6.75Zm10.5 0h2.25m0 0V3m0 3.75h.008v.008H16.5V6.75Z"}),g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})]}),lc=e=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:[g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 3.75h16.5v16.5H3.75V3.75Z"}),g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9 12.75 3 3 6-6"})]}),pf=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 7.5A2.25 2.25 0 0 1 7.5 5.25h9a2.25 2.25 0 0 1 2.25 2.25v9a2.25 2.25 0 0 1-2.25-2.25h-9a2.25 2.25 0 0 1-2.25-2.25v-9Z"})}),jM=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 6.75h7.5M8.25 12h7.5m-7.5 5.25h7.5M3.75 6.75h.007v.008H3.75V6.75Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 5.25h.007v.008H3.75v-.008Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 5.25h.007v.008H3.75v-.008Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"})}),xf=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"})}),Rh=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),zM=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),qM=e=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:[g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}),g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.91 11.672a.375.375 0 0 1 0 .656l-5.603 3.113A.375.375 0 0 1 9.75 15.113V8.887c0-.286.307-.466.557-.332l5.603 3.118Z"})]}),$M=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.75 9.75l4.5 4.5m0-4.5l-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),YM=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"})}),WM=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 7.125A3.375 3.375 0 005.625 4.5h12.75c1.72 0 3.125 1.119 3.375 2.625M9.75 10.5h4.5m-4.5 3h4.5M11.25 3v1.5m0 15V21m0-16.5a1.5 1.5 0 00-3 0V21a1.5 1.5 0 003 0V3.062A3.375 3.375 0 0112 2.25c.465 0 .91.095 1.312.281M14.25 9a3 3 0 10-6 0 3 3 0 006 0z"})}),k2=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z"})}),N2=e=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:[g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 3v11.25A2.25 2.25 0 006 16.5h12A2.25 2.25 0 0020.25 14.25V3M3.75 21h16.5M16.5 3.75h.008v.008H16.5V3.75zm-3.75 0h.008v.008H12.75V3.75zm-3.75 0h.008v.008H9V3.75zm-3.75 0h.008v.008H5.25V3.75z"}),g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.5h18M9.75 16.5a.75.75 0 01.75-.75h3a.75.75 0 01.75.75v4.5a.75.75 0 01-.75.75h-3a.75.75 0 01-.75-.75v-4.5z"})]}),JM=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"})}),M2=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 15 3 9m0 0 6-6M3 9h12a6 6 0 0 1 0 12h-3"})}),R2=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m15 15 6-6m0 0-6-6m6 6H3a6 6 0 0 0 0 12h3"})}),Ri=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m18.375 12.739-7.693 7.693a4.5 4.5 0 0 1-6.364-6.364l10.94-10.94A3 3 0 1 1 19.5 7.372L8.552 18.32m.009-.01-.01.01m5.699-9.941-7.81 7.81a1.5 1.5 0 0 0 2.122 2.122l7.81-7.81"})}),oc=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.375 19.5h17.25m-17.25 0a1.125 1.125 0 0 1-1.125-1.125v-1.5c0-.621.504-1.125 1.125-1.125h17.25c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125m-17.25 0h-1.5m1.5 0v-1.5m17.25 1.5v-1.5m0 0h1.5m-1.5 0h-17.25m0 0H3.375c-.621 0-1.125-.504-1.125-1.125v-12.75c0-.621.504-1.125 1.125-1.125h17.25c.621 0 1.125.504 1.125 1.125v12.75c0 .621-.504 1.125-1.125 1.125m-17.25 0h-1.5m1.5 0v-1.5m17.25 1.5v-1.5m0 0h1.5m-1.5 0h-17.25m17.25 0v-12.75a1.125 1.125 0 0 0-1.125-1.125H3.375A1.125 1.125 0 0 0 2.25 4.5v12.75c0 .621.504 1.125 1.125 1.125M12 4.5v15m0 0H9m3 0h3"})}),XM=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",...e,children:g.jsx("path",{fillRule:"evenodd",d:"M10 1a4.5 4.5 0 00-4.5 4.5V9H5a2 2 0 00-2 2v6a2 2 0 002 2h10a2 2 0 002-2v-6a2 2 0 00-2-2h-.5V5.5A4.5 4.5 0 0010 1zm3 8V5.5a3 3 0 10-6 0V9h6z",clipRule:"evenodd"})}),KM=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",...e,children:g.jsx("path",{d:"M10 2a5 5 0 00-5 5v2a2 2 0 00-2 2v6a2 2 0 002 2h10a2 2 0 002-2v-6a2 2 0 00-2-2h-1V7a5 5 0 00-5-5zm0 2.5a2.5 2.5 0 00-2.5 2.5V9h5V7a2.5 2.5 0 00-2.5-2.5z"})}),cc=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.898 20.572L16.5 21.75l-.398-1.178a3.375 3.375 0 00-2.455-2.456L12.5 17.25l1.178-.398a3.375 3.375 0 002.455-2.456L16.5 13.5l.398 1.178a3.375 3.375 0 002.456 2.456L20.25 17.25l-1.178.398a3.375 3.375 0 00-2.456 2.456z"})}),D2=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75c0-.231-.035-.454-.1-.664M6.75 7.5H18v2.25H6.75V7.5zM3 12h3v6.75a2.25 2.25 0 002.25 2.25h9.75a2.25 2.25 0 002.25-2.25V12h3m-3.498 6.75H15"})}),Rd=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75v4.5m0-4.5h-4.5m4.5 0L15 9m5.25 11.25v-4.5m0 4.5h-4.5m4.5 0L15 15"})}),Dd=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 9V4.5M9 9H4.5M9 9 3.75 3.75M9 15v4.5M9 15H4.5M9 15l-5.25 5.25M15 9V4.5M15 9h4.5M15 9l5.25-5.25M15 15v4.5M15 15h4.5M15 15l5.25 5.25"})}),I2=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25H12"})}),Wo=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 12.75V12A2.25 2.25 0 0 1 4.5 9.75h15A2.25 2.25 0 0 1 21.75 12v.75m-8.69-6.44-2.12-2.12a1.5 1.5 0 0 0-1.061-.44H4.5A2.25 2.25 0 0 0 2.25 6v12a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9a2.25 2.25 0 0 0-2.25-2.25h-5.379a1.5 1.5 0 0 1-1.06-.44Z"})}),Jo=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 16 16",...e,children:g.jsx("path",{d:"M7.247 4.86l-4.796 5.481c-.566.647-.106 1.659.753 1.659h9.592a1 1 0 0 0 .753-1.659l-4.796-5.48a1 1 0 0 0-1.506 0z"})}),ds=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 16 16",...e,children:g.jsx("path",{d:"M7.247 11.14l-4.796-5.481c-.566-.647-.106-1.659.753-1.659h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z"})}),F2=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 5.25a3 3 0 0 1 3 3m3 0a6 6 0 0 1-7.029 5.912c-.563-.097-1.159.026-1.563.43L10.5 17.25H8.25v2.25H6v2.25H2.25v-2.818c0-.597.237-1.17.659-1.591l6.499-6.499c.404-.404.527-1 .43-1.563A6 6 0 1 1 21.75 8.25z"})}),ZM=({onSubmit:e,isLoading:t,onImportProject:n,onLoadTemplate:r,initialGoal:a="",initialDate:l=""})=>{const[c,u]=he.useState(a),[p,m]=he.useState(l),x=he.useRef(null);Wa.useEffect(()=>{u(a)},[a]),Wa.useEffect(()=>{m(l)},[l]);const y=new Date().toISOString().split("T")[0],_=M=>{if(M.preventDefault(),!c.trim()||!p){alert("");return}e(c,p)},E=()=>{var M;(M=x.current)==null||M.click()},w=M=>{var b;const k=(b=M.target.files)==null?void 0:b[0];k&&(n(k),M.target.value="")},S=M=>{if(!c.trim()||!p){alert("");return}r(M,c,p)},C=({template:M,title:k,description:b,disabled:U})=>g.jsxs("button",{type:"button",onClick:()=>S(M),disabled:U,className:"text-left p-4 bg-purple-600 hover:bg-purple-700 disabled:bg-slate-400 text-white rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 transition duration-150 ease-in-out transform hover:scale-105",children:[g.jsx("div",{className:"font-semibold text-md",children:k}),g.jsx("div",{className:"text-xs text-purple-200 mt-1",children:b})]});return g.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-slate-900 to-slate-700 p-4",children:[g.jsxs("div",{className:"w-full max-w-2xl bg-white shadow-2xl rounded-xl p-8 md:p-12",children:[g.jsxs("div",{className:"text-center mb-10",children:[g.jsx("h1",{className:"text-4xl font-bold text-slate-800 mb-3",children:"AI"}),g.jsx("p",{className:"text-slate-600 text-lg",children:"AI"})]}),g.jsxs("form",{onSubmit:_,className:"space-y-6",children:[g.jsxs("div",{children:[g.jsxs("label",{htmlFor:"projectGoal",className:"block text-sm font-semibold text-slate-700 mb-2 flex items-center",children:[g.jsx(C2,{className:"w-5 h-5 mr-2 text-blue-600"})," ()"]}),g.jsx("textarea",{id:"projectGoal",value:c,onChange:M=>u(M.target.value),placeholder:": E1000",rows:3,className:"w-full px-4 py-3 bg-slate-800 border border-slate-600 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150 ease-in-out text-base text-slate-100 placeholder-slate-400"})]}),g.jsxs("div",{children:[g.jsxs("label",{htmlFor:"targetDate",className:"block text-sm font-semibold text-slate-700 mb-2 flex items-center",children:[g.jsx(w2,{className:"w-5 h-5 mr-2 text-blue-600"}),""]}),g.jsx("input",{type:"date",id:"targetDate",value:p,onChange:M=>m(M.target.value),min:y,className:"w-full px-4 py-3 bg-slate-800 border border-slate-600 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150 ease-in-out text-base text-slate-100",style:{colorScheme:"dark"}})]}),g.jsx("p",{className:"text-sm text-slate-500 text-center",children:""}),g.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[g.jsx("button",{type:"submit",disabled:t,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-slate-400 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition duration-150 ease-in-out transform hover:scale-105 flex items-center justify-center text-md",children:t?g.jsx(ia,{size:"sm",color:"border-white"}):"AI"}),g.jsxs("button",{type:"button",onClick:E,disabled:t,className:"w-full bg-green-600 hover:bg-green-700 disabled:bg-slate-400 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition duration-150 ease-in-out transform hover:scale-105 flex items-center justify-center text-md",children:[g.jsx(b2,{className:"w-5 h-5 mr-2"})," (.json)"]}),g.jsx("input",{type:"file",ref:x,onChange:w,accept:".json",className:"hidden","aria-hidden":"true"})]}),g.jsxs("div",{className:"sm:col-span-2 pt-4",children:[g.jsx("p",{className:"text-center text-sm font-semibold text-slate-600 mb-3",children:":"}),g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:[g.jsx(C,{template:"process-design",disabled:t,title:" (APQP)",description:"APQP"}),g.jsx(C,{template:"process-change",disabled:t,title:" (ISO/IATF)",description:""}),g.jsx(C,{template:"new-product-eval",disabled:t,title:"",description:""}),g.jsx(C,{template:"improvement-project",disabled:t,title:"",description:"DMAIC"}),g.jsx(C,{template:"equipment-modification",disabled:t,title:"",description:""})]})]})]})]}),g.jsx("footer",{className:"mt-12 text-center",children:g.jsx("p",{className:"text-slate-400 text-sm",children:"Powered by Gemini API"})})]})},Au=e=>{switch(e){case kt.IN_PROGRESS:return{icon:g.jsx(qM,{className:"w-3.5 h-3.5"}),color:"text-blue-700",text:"",bgColor:"bg-blue-100"};case kt.COMPLETED:return{icon:g.jsx(mf,{className:"w-3.5 h-3.5"}),color:"text-green-700",text:"",bgColor:"bg-green-100"};case kt.BLOCKED:return{icon:g.jsx($M,{className:"w-3.5 h-3.5"}),color:"text-red-700",text:"",bgColor:"bg-red-100"};case kt.NOT_STARTED:default:return{icon:g.jsx(zM,{className:"w-3.5 h-3.5"}),color:"text-slate-600",text:"",bgColor:"bg-slate-100"}}},QM=({task:e,onSelectTask:t,onRemoveTask:n,onUpdateStatus:r,onDragCardStart:a,index:l,cardRef:c,onStartConnection:u,onEndConnection:p})=>{var J,F,W,O;const[m,x]=he.useState(!1),y=he.useRef(null);he.useEffect(()=>{const ee=ne=>{y.current&&!y.current.contains(ne.target)&&x(!1)};return document.addEventListener("mousedown",ee),()=>{document.removeEventListener("mousedown",ee)}},[y]);const _=ee=>{r(e.id,ee),x(!1)},E=(J=e.extendedDetails)==null?void 0:J.numericalTarget;let w="text-slate-500";E&&(E.status===qd.ACHIEVED?w="text-green-600":E.status===qd.MISSED?w="text-red-600":w="text-yellow-600");const S=Au(e.status),C=(F=e.extendedDetails)==null?void 0:F.dueDate,M=C?new Date(C+"T00:00:00Z").toLocaleDateString("ja-JP",{month:"short",day:"numeric"}):null,k=e.status===kt.IN_PROGRESS,b="task-card-in-flow bg-white rounded-xl shadow-lg hover:shadow-2xl transition-all duration-300 ease-in-out overflow-hidden flex-shrink-0 w-80 md:w-96 m-1 cursor-grab active:cursor-grabbing",U=k?"border-4 border-blue-500 ring-2 ring-blue-500 ring-offset-1":"border border-transparent",G=ee=>{ee.stopPropagation(),u(e.id,ee)};return g.jsxs("div",{ref:c,id:`taskcard-${e.id}`,draggable:"true",onDragStart:ee=>a(ee,e.id),onMouseUp:()=>p(e.id),className:`${b} ${U}`,style:{position:"absolute",left:((W=e.position)==null?void 0:W.x)||0,top:((O=e.position)==null?void 0:O.y)||0,touchAction:"none"},children:[g.jsxs("div",{className:"p-5 relative",children:[g.jsx("div",{onMouseDown:G,className:"absolute right-[-6px] top-1/2 -translate-y-1/2 w-4 h-4 bg-blue-500 border-2 border-white rounded-full cursor-crosshair hover:scale-125 transition-transform z-10",title:""}),g.jsxs("div",{className:"flex items-start justify-between mb-2",children:[g.jsxs("div",{className:"flex items-center flex-grow min-w-0 mr-2",children:[g.jsx("span",{className:"bg-blue-600 text-white rounded-full w-7 h-7 flex items-center justify-center font-bold text-xs mr-3 flex-shrink-0",children:l+1}),g.jsx("div",{className:"flex-grow min-w-0",children:g.jsx("div",{className:"text-lg font-bold text-slate-900 break-words","aria-label":`task title for ${e.title}`,children:e.title})})]}),g.jsxs("div",{className:"flex space-x-1 flex-shrink-0 items-center",children:[E&&g.jsx(GM,{className:`w-5 h-5 ${w}`,title:`: ${E.description} (${E.status})`}),g.jsx("button",{onClick:ee=>{ee.stopPropagation(),t(e)},className:"text-blue-600 hover:text-blue-800 transition-colors p-1 rounded-full hover:bg-blue-100",title:"","aria-label":`: ${e.title}`,children:g.jsx(HM,{className:"w-5 h-5"})}),g.jsx("button",{onClick:ee=>{ee.stopPropagation(),n(e.id)},className:"text-red-500 hover:text-red-700 transition-colors p-1 rounded-full hover:bg-red-100",title:"","aria-label":`: ${e.title}`,children:g.jsx(Xa,{className:"w-5 h-5"})})]})]}),g.jsx("div",{className:"h-20 mb-3",children:g.jsx("p",{className:"text-slate-800 text-sm leading-relaxed line-clamp-4 overflow-hidden h-full",children:e.description})}),g.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-500 mb-2",children:[g.jsxs("div",{className:"relative",ref:y,children:[g.jsxs("button",{onClick:()=>x(ee=>!ee),className:`inline-flex items-center px-2 py-0.5 rounded-full cursor-pointer ${S.bgColor} ${S.color} hover:ring-2 hover:ring-offset-1 hover:ring-blue-400 transition-all`,title:"",children:[Wa.cloneElement(S.icon,{className:`w-3 h-3 mr-1 ${S.color}`}),S.text]}),m&&g.jsx("div",{className:"absolute bottom-full mb-1 w-36 bg-white border border-slate-200 rounded-md shadow-lg z-20 py-1",children:Object.values(kt).map(ee=>g.jsxs("button",{onClick:()=>_(ee),className:"w-full text-left px-3 py-1.5 text-sm text-slate-700 hover:bg-slate-100 flex items-center",children:[Wa.cloneElement(Au(ee).icon,{className:`w-3.5 h-3.5 mr-2 ${Au(ee).color}`}),Au(ee).text]},ee))})]}),M&&g.jsxs("div",{className:"flex items-center text-orange-600",children:[g.jsx(Rh,{className:"w-3.5 h-3.5 mr-1"}),": ",M]})]})]}),g.jsx("button",{onClick:ee=>{ee.stopPropagation(),t(e)},className:"block w-full text-left bg-slate-100 hover:bg-slate-200 text-blue-700 font-medium py-3 px-5 transition-colors text-xs border-t border-slate-200",children:" "})]})},eR=he.memo(QM),Xo=({from:e,to:t,id:n,onDelete:r})=>{const c=e.x,u=t.x,p=(c+u)/2,m=(e.y+t.y)/2,x=`M${c},${e.y} C${c+50},${e.y} ${u-50},${t.y} ${u},${t.y}`;return g.jsxs("svg",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none",overflow:"visible"},"aria-hidden":"true",children:[g.jsx("defs",{children:g.jsx("marker",{id:`arrowhead-${n}`,markerWidth:8,markerHeight:8*.7,refX:8,refY:8*.35,orient:"auto",markerUnits:"strokeWidth",children:g.jsx("path",{d:`M0,0 L8,${8*.35} L0,${8*.7} Z`,fill:"#64748b"})})}),g.jsxs("g",{style:{pointerEvents:r?"auto":"none"},children:[g.jsx("path",{d:x,stroke:"#64748b",strokeWidth:2,markerEnd:`url(#arrowhead-${n})`,fill:"none"}),g.jsx("path",{d:x,stroke:"transparent",strokeWidth:"16",fill:"none",className:r?"cursor-pointer group":"",onClick:r}),r&&g.jsxs("g",{transform:`translate(${p}, ${m})`,className:"opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer",onClick:r,children:[g.jsx("circle",{cx:"0",cy:"0",r:"8",fill:"white",stroke:"#ef4444",strokeWidth:"1"}),g.jsx("path",{d:"M -3.5 -3.5 L 3.5 3.5 M -3.5 3.5 L 3.5 -3.5",stroke:"#ef4444",strokeWidth:"1.5",strokeLinecap:"round"})]})]})]})},tR=({tasks:e,onClose:t})=>{const[n,r]=he.useState("all"),[a,l]=he.useState(""),[c,u]=he.useState(null),p=he.useMemo(()=>{const w=[];return e.forEach(S=>{var C,M;(M=(C=S.extendedDetails)==null?void 0:C.subSteps)==null||M.forEach(k=>{var b;(b=k.actionItems)==null||b.forEach(U=>{w.push({actionItem:U,subStep:k,task:S})})})}),w},[e]),m=he.useMemo(()=>p.filter(w=>n==="completed"?w.actionItem.completed:n==="pending"?!w.actionItem.completed:!0).filter(w=>{const S=a.toLowerCase();return w.actionItem.text.toLowerCase().includes(S)||w.subStep.text.toLowerCase().includes(S)||(w.subStep.responsible||"").toLowerCase().includes(S)||w.task.title.toLowerCase().includes(S)}),[p,n,a]),x=he.useMemo(()=>{let w=[...m];return c!==null&&w.sort((S,C)=>{let M="",k="";switch(c.key){case"status":M=S.actionItem.completed,k=C.actionItem.completed;break;case"actionItem":M=S.actionItem.text.toLowerCase(),k=C.actionItem.text.toLowerCase();break;case"responsible":M=(S.subStep.responsible||"").toLowerCase(),k=(C.subStep.responsible||"").toLowerCase();break;case"subStep":M=S.subStep.text.toLowerCase(),k=C.subStep.text.toLowerCase();break;case"task":M=S.task.title.toLowerCase(),k=C.task.title.toLowerCase();break;case"dueDate":M=S.actionItem.dueDate||S.subStep.dueDate||"9999-12-31",k=C.actionItem.dueDate||C.subStep.dueDate||"9999-12-31";break}return M<k?c.direction==="ascending"?-1:1:M>k?c.direction==="ascending"?1:-1:0}),w},[m,c]),y=w=>{let S="ascending";c&&c.key===w&&c.direction==="ascending"&&(S="descending"),u({key:w,direction:S})},_=w=>!c||c.key!==w?g.jsx(Jo,{className:"w-3 h-3 ml-1 opacity-20"}):c.direction==="ascending"?g.jsx(Jo,{className:"w-3 h-3 ml-1 text-blue-600"}):g.jsx(ds,{className:"w-3 h-3 ml-1 text-blue-600"}),E=({sortKey:w,label:S,className:C})=>g.jsx("th",{scope:"col",className:`px-6 py-3 ${C||""}`,children:g.jsxs("button",{onClick:()=>y(w),className:"flex items-center gap-1 hover:text-blue-600 transition-colors",children:[S,_(w)]})});return g.jsxs("div",{className:"fixed inset-0 bg-slate-100 z-[60] flex flex-col",children:[g.jsx("header",{className:"flex-shrink-0 bg-white shadow-md",children:g.jsxs("div",{className:"flex items-center justify-between p-4 border-b w-full max-w-7xl mx-auto",children:[g.jsx("h3",{className:"text-xl font-bold text-slate-800",children:""}),g.jsxs("button",{onClick:t,className:"flex items-center gap-2 px-4 py-2 text-sm font-semibold text-slate-700 bg-slate-200 rounded-md hover:bg-slate-300",children:[g.jsx(A2,{className:"w-5 h-5"}),""]})]})}),g.jsxs("main",{className:"flex-grow flex flex-col overflow-hidden p-4 w-full max-w-7xl mx-auto",children:[g.jsx("div",{className:"p-4 flex-shrink-0 bg-white rounded-t-lg border-x border-t",children:g.jsxs("div",{className:"flex flex-wrap gap-4 items-center",children:[g.jsx("input",{type:"text",placeholder:"...",value:a,onChange:w=>l(w.target.value),className:"px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-sm w-full sm:w-auto flex-grow"}),g.jsxs("div",{className:"flex items-center gap-2 rounded-lg bg-slate-100 p-1",children:[g.jsx("button",{onClick:()=>r("all"),className:`px-3 py-1 text-sm rounded-md ${n==="all"?"bg-white shadow":"hover:bg-slate-200"}`,children:""}),g.jsx("button",{onClick:()=>r("pending"),className:`px-3 py-1 text-sm rounded-md ${n==="pending"?"bg-white shadow":"hover:bg-slate-200"}`,children:""}),g.jsx("button",{onClick:()=>r("completed"),className:`px-3 py-1 text-sm rounded-md ${n==="completed"?"bg-white shadow":"hover:bg-slate-200"}`,children:""})]})]})}),g.jsx("div",{className:"flex-grow overflow-y-auto bg-white rounded-b-lg border",children:g.jsxs("table",{className:"w-full text-sm text-left text-slate-600",children:[g.jsx("thead",{className:"text-xs text-slate-700 uppercase bg-slate-100 sticky top-0 z-10",children:g.jsxs("tr",{children:[g.jsx(E,{sortKey:"status",label:"",className:"w-24"}),g.jsx(E,{sortKey:"actionItem",label:""}),g.jsx(E,{sortKey:"responsible",label:""}),g.jsx(E,{sortKey:"subStep",label:""}),g.jsx(E,{sortKey:"task",label:""}),g.jsx(E,{sortKey:"dueDate",label:""})]})}),g.jsxs("tbody",{className:"divide-y divide-slate-200",children:[x.map(({actionItem:w,subStep:S,task:C},M)=>g.jsxs("tr",{className:"hover:bg-slate-50",children:[g.jsx("td",{className:"px-6 py-3",children:w.completed?g.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[g.jsx(lc,{className:"w-4 h-4 mr-1"}),""]}):g.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-800",children:[g.jsx(pf,{className:"w-4 h-4 mr-1"}),""]})}),g.jsx("td",{className:"px-6 py-3 font-medium text-slate-900",children:w.text}),g.jsx("td",{className:"px-6 py-3",children:S.responsible||""}),g.jsx("td",{className:"px-6 py-3",children:S.text}),g.jsx("td",{className:"px-6 py-3",children:C.title}),g.jsx("td",{className:"px-6 py-3",children:w.dueDate||S.dueDate?new Date((w.dueDate||S.dueDate)+"T00:00:00Z").toLocaleDateString("ja-JP",{year:"numeric",month:"long",day:"numeric"}):""})]},w.id+M)),x.length===0&&g.jsx("tr",{children:g.jsx("td",{colSpan:6,className:"text-center py-8 text-slate-500",children:""})})]})]})})]})]})},Cv={"On Track":{bgColor:"bg-green-100",textColor:"text-green-800",icon:g.jsx(mf,{className:"w-12 h-12 text-green-500"})},"At Risk":{bgColor:"bg-yellow-100",textColor:"text-yellow-800",icon:g.jsx(Oo,{className:"w-12 h-12 text-yellow-500"})},"Off Track":{bgColor:"bg-red-100",textColor:"text-red-800",icon:g.jsx(Oo,{className:"w-12 h-12 text-red-500"})},Unknown:{bgColor:"bg-slate-100",textColor:"text-slate-800",icon:g.jsx(Oo,{className:"w-12 h-12 text-slate-500"})}},nR=({report:e,onClose:t})=>{if(!e)return null;const n=Cv[e.overallStatus]||Cv.Unknown;return g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[60]",children:g.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-3xl h-[90vh] flex flex-col",children:[g.jsxs("header",{className:"flex items-center justify-between p-5 border-b border-slate-200 flex-shrink-0",children:[g.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"AI"}),g.jsx("button",{onClick:t,className:"p-1 rounded-full hover:bg-slate-100",children:g.jsx(ca,{className:"w-6 h-6 text-slate-500"})})]}),g.jsxs("div",{className:"flex-grow p-6 overflow-y-auto space-y-6",children:[g.jsxs("section",{className:`p-6 rounded-lg flex items-center gap-6 ${n.bgColor}`,children:[g.jsx("div",{className:"flex-shrink-0",children:n.icon}),g.jsxs("div",{children:[g.jsx("h4",{className:`text-2xl font-bold ${n.textColor}`,children:e.overallStatus}),g.jsx("p",{className:`mt-1 text-base ${n.textColor}`,children:e.summary})]})]}),g.jsxs("section",{children:[g.jsxs("h5",{className:"text-lg font-semibold text-slate-700 mb-3 flex items-center",children:[g.jsx(mf,{className:"w-5 h-5 mr-2 text-green-500"}),""]}),g.jsx("ul",{className:"list-disc list-inside space-y-2 text-slate-600 pl-2",children:e.positivePoints.map((r,a)=>g.jsx("li",{children:r},a))})]}),g.jsxs("section",{children:[g.jsxs("h5",{className:"text-lg font-semibold text-slate-700 mb-3 flex items-center",children:[g.jsx(Oo,{className:"w-5 h-5 mr-2 text-yellow-500"}),""]}),g.jsx("div",{className:"space-y-3",children:e.areasOfConcern.map((r,a)=>g.jsxs("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-r-lg",children:[g.jsx("p",{className:"font-semibold text-yellow-800",children:r.description}),r.relatedTaskIds.length>0&&g.jsxs("p",{className:"text-xs text-yellow-700 mt-1",children:["ID: ",r.relatedTaskIds.join(", ")]})]},a))})]}),g.jsxs("section",{children:[g.jsxs("h5",{className:"text-lg font-semibold text-slate-700 mb-3 flex items-center",children:[g.jsx(Mh,{className:"w-5 h-5 mr-2 text-blue-500"}),"AI"]}),g.jsx("div",{className:"space-y-3",children:e.suggestions.map((r,a)=>g.jsx("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-4 rounded-r-lg",children:g.jsx("p",{className:"text-blue-800",children:r})},a))})]})]}),g.jsx("footer",{className:"p-4 bg-slate-50 border-t flex justify-end",children:g.jsx("button",{onClick:t,className:"px-5 py-2 text-sm font-medium text-white bg-slate-600 rounded-md hover:bg-slate-700",children:""})})]})})},Av=e=>{const t=Math.cos(2*Math.PI*e),n=Math.sin(2*Math.PI*e);return[t,n]},rR=({data:e,title:t})=>{const n=e.reduce((c,u)=>c+u.value,0);if(n===0)return g.jsx("div",{className:"flex items-center justify-center h-full text-xs text-slate-500",children:"No data to display"});let r=0;const a=["#4a90e2","#50e3c2","#f5a623","#f8e71c","#7ed321","#9013fe"],l=e.map((c,u)=>{const p=c.value/n,[m,x]=Av(r);r+=p;const[y,_]=Av(r),E=p>.5?1:0;return{path:[`M ${m} ${x}`,`A 1 1 0 ${E} 1 ${y} ${_}`,"L 0 0"].join(" "),color:a[u%a.length],label:c.label}});return g.jsxs("div",{className:"w-full h-full flex flex-col bg-white p-2",children:[g.jsx("text",{x:"50%",y:"10",textAnchor:"middle",fontSize:"10",fontWeight:"bold",fill:"#333",className:"block text-center",children:t}),g.jsxs("div",{className:"flex-grow flex items-center",children:[g.jsx("svg",{viewBox:"-1 -1 2 2",className:"w-2/3 h-full",children:l.map((c,u)=>g.jsx("path",{d:c.path,fill:c.color},u))}),g.jsx("div",{className:"w-1/3 text-[8px] space-y-1",children:l.map((c,u)=>g.jsxs("div",{className:"flex items-center",children:[g.jsx("span",{className:"w-2 h-2 rounded-full mr-1",style:{backgroundColor:c.color}}),g.jsx("span",{className:"truncate",children:c.label})]},u))})]})]})},aR=({data:e,title:t})=>{const n=Math.max(...e.map(m=>m.value),0),r=300,a=150,l={top:20,right:10,bottom:30,left:30},c=r-l.left-l.right,u=a-l.top-l.bottom,p=e.map((m,x)=>{const y=x/(e.length-1)*c,_=u-m.value/n*u;return`${y},${_}`}).join(" ");return g.jsxs("svg",{viewBox:`0 0 ${r} ${a}`,className:"w-full h-full bg-white",children:[g.jsx("text",{x:r/2,y:l.top/2+5,textAnchor:"middle",fontSize:"10",fontWeight:"bold",fill:"#333",children:t}),g.jsxs("g",{transform:`translate(${l.left}, ${l.top})`,children:[g.jsx("line",{x1:"0",y1:"0",x2:"0",y2:u,stroke:"#ddd",strokeWidth:"0.5"}),g.jsx("line",{x1:"0",y1:u,x2:c,y2:u,stroke:"#ddd",strokeWidth:"0.5"}),g.jsx("polyline",{fill:"none",stroke:"#4a90e2",strokeWidth:"1.5",points:p}),e.map((m,x)=>{const y=x/(e.length-1)*c,_=u-m.value/n*u;return g.jsx("circle",{cx:y,cy:_,r:"2",fill:"#4a90e2"},x)})]})]})},iR=({data:e,title:t})=>{const n=Math.max(...e.map(m=>m.value),0),r=300,a=150,l={top:20,right:10,bottom:30,left:30},c=r-l.left-l.right,u=a-l.top-l.bottom,p=e.length>0?c/e.length*.8:0;return g.jsxs("svg",{viewBox:`0 0 ${r} ${a}`,className:"w-full h-full bg-white",children:[g.jsx("text",{x:r/2,y:l.top/2+5,textAnchor:"middle",fontSize:"10",fontWeight:"bold",fill:"#333",children:t}),g.jsxs("g",{transform:`translate(${l.left}, ${l.top})`,children:[g.jsx("line",{x1:"0",y1:"0",x2:"0",y2:u,stroke:"#999",strokeWidth:"0.5"}),[0,n/2,n].map(m=>g.jsxs("g",{transform:`translate(0, ${u-m/n*u})`,children:[g.jsx("line",{x1:"-3",y1:"0",x2:"0",y2:"0",stroke:"#999",strokeWidth:"0.5"}),g.jsx("text",{x:"-5",y:"3",textAnchor:"end",fontSize:"6",fill:"#666",children:m.toFixed(0)})]},m)),e.map((m,x)=>g.jsxs("g",{transform:`translate(${x*c/e.length+c/e.length*.1}, 0)`,children:[g.jsx("rect",{x:"0",y:u-m.value/n*u,width:p,height:m.value/n*u,fill:"#4a90e2"}),g.jsx("text",{x:p/2,y:u+8,textAnchor:"middle",fontSize:"6",fill:"#666",transform:`rotate(-45, ${p/2}, ${u+8})`,children:m.label})]},m.label))]})]})},sR=({subStep:e,statusColor:t})=>{var n,r;return g.jsx("div",{style:{position:"absolute",left:((n=e.position)==null?void 0:n.x)||0,top:((r=e.position)==null?void 0:r.y)||0,width:192,minHeight:76,padding:"8px",borderRadius:"8px",backgroundColor:"white",borderLeft:`4px solid ${t}`,boxShadow:"0 2px 4px rgba(0,0,0,0.1)",fontSize:"12px",fontFamily:"sans-serif",color:"#333",display:"flex",flexDirection:"column",justifyContent:"center"},children:g.jsx("p",{className:`font-bold break-words ${e.status===ir.COMPLETED?"line-through text-slate-500":""}`,children:e.text})})},lR=({subSteps:e})=>{if(!e||e.length===0)return g.jsx("div",{className:"w-full h-full flex items-center justify-center bg-slate-100 text-slate-500 text-sm",children:"No sub-steps to display."});const t=c=>{switch(c){case ir.COMPLETED:return"#22c55e";case ir.IN_PROGRESS:return"#3b82f6";default:return"#94a3b8"}},n=192,r=76,a=he.useMemo(()=>{const c=[];return(e||[]).forEach(u=>{var p;if((p=u==null?void 0:u.nextSubStepIds)!=null&&p.length&&u.position){const m={x:u.position.x+n,y:u.position.y+r/2};u.nextSubStepIds.forEach(x=>{const y=e.find(_=>_.id===x);if(y&&y.position){const _={x:y.position.x,y:y.position.y+r/2};c.push({id:`fc-render-${u.id}-${x}`,from:m,to:_,sourceId:u.id,targetId:x})}})}}),c},[e,n,r]),l=he.useMemo(()=>{if(!e||e.length===0)return{minX:0,minY:0,width:400,height:300};let c=0,u=0;return e.forEach(p=>{p.position&&(c=Math.max(c,p.position.x+n),u=Math.max(u,p.position.y+r))}),{minX:0,minY:0,width:c+20,height:u+20}},[e,n,r]);return g.jsx("div",{className:"w-full h-full bg-slate-50 overflow-hidden",style:{fontFamily:"Inter, sans-serif"},children:g.jsxs("svg",{width:"100%",height:"100%",viewBox:`${l.minX} ${l.minY} ${l.width} ${l.height}`,children:[g.jsx("style",{children:`
                    .flowchart-card-container {
                        position: relative;
                        width: 100%;
                        height: 100%;
                        font-family: Inter, sans-serif;
                    }
                    `}),g.jsx("foreignObject",{x:"0",y:"0",width:l.width,height:l.height,children:g.jsx("div",{className:"flowchart-card-container",children:(e||[]).map(c=>g.jsx(sR,{subStep:c,statusColor:t(c.status)},c.id))})}),a.map(c=>g.jsx(Xo,{from:c.from,to:c.to,id:c.id},c.id))]})})},oR=({el:e,onUpdate:t,children:n,isSelected:r,onClick:a})=>g.jsx("div",{onClick:l=>{l.stopPropagation(),a()},style:{position:"absolute",left:`${e.position.x}%`,top:`${e.position.y}%`,width:`${e.position.width}%`,height:`${e.position.height}%`,outline:r?"2px solid #3b82f6":"1px dashed transparent",cursor:"move"},className:"transition-all duration-150 hover:outline-dashed hover:outline-slate-400",children:n}),Dh=({tasks:e,initialDeck:t,onSave:n,onClose:r,generateUniqueId:a,projectGoal:l,targetDate:c,reportScope:u})=>{const[p,m]=he.useState(t),[x,y]=he.useState(0),[_,E]=he.useState(null),[w,S]=he.useState(!1),[C,M]=he.useState(null),[k,b]=he.useState(!1),U=he.useRef(null),G=(re,Y)=>{m(N=>({...N,slides:N.slides.map(Z=>Z.id===re?{...Z,...typeof Y=="function"?Y(Z):Z}:Z)}))},J=re=>{const Y=p.slides[re];G(Y.id,{isLocked:!Y.isLocked})},F=(re,Y,N)=>{G(re,Z=>({elements:Z.elements.map(D=>D.id===Y?{...D,...N}:D)}))},W=async()=>{S(!0),M(null);try{const re={...p,slides:p.slides.map(Z=>Z.isLocked?Z:{...Z,isLocked:void 0})},Y=await FM(re),N={...Y,slides:Y.slides.map((Z,D)=>({...Z,isLocked:p.slides[D].isLocked}))};m(N)}catch(re){M(re instanceof Error?re.message:"")}finally{S(!1)}},O=async()=>{S(!0),M(null);try{let re;u==="project"?re=await PM(p,e,l,c):re=await IM(p,e[0],l),m(re)}catch(re){M(re instanceof Error?re.message:"")}finally{S(!1)}},ee=(re,Y)=>{var N,Z,D;for(const H of e){const q=(Z=(N=H.extendedDetails)==null?void 0:N.subSteps)==null?void 0:Z.find(j=>j.id===re);if(q){const j=(D=q==null?void 0:q.actionItems)==null?void 0:D.find(se=>se.id===Y);if(j)return j}}},ne=re=>{var Y,N,Z,D,H;switch(re.type){case"textbox":const q=re;return g.jsx("textarea",{value:q.content,onChange:j=>F(p.slides[x].id,re.id,{content:j.target.value}),className:"w-full h-full bg-transparent resize-none border-none outline-none p-2",style:{fontSize:q.fontSize,fontWeight:q.fontWeight,textAlign:q.textAlign,color:"#333"}});case"image":{const j=re,se=ee(j.subStepId,j.actionItemId),Te=(N=(Y=se==null?void 0:se.report)==null?void 0:Y.attachments)==null?void 0:N.find(Ae=>Ae.id===j.attachmentId);return Te?g.jsx("img",{src:Te.dataUrl,className:"w-full h-full object-contain",alt:Te.name}):g.jsx("div",{className:"bg-slate-200 flex items-center justify-center text-xs text-slate-500",children:""})}case"table":{const j=re,se=ee(j.subStepId,j.actionItemId),Te=(Z=se==null?void 0:se.report)==null?void 0:Z.matrixData;return Te?g.jsx("div",{className:"p-2 overflow-auto h-full",children:g.jsxs("table",{className:"w-full text-[8px] border-collapse bg-white",children:[g.jsx("thead",{children:g.jsx("tr",{className:"bg-slate-200",children:Te.headers.map((Ae,Re)=>g.jsx("th",{className:"border border-slate-300 p-1 font-semibold",children:Ae},Re))})}),g.jsx("tbody",{children:Te.rows.map((Ae,Re)=>g.jsx("tr",{children:Ae.map((Ce,Xe)=>g.jsx("td",{className:"border border-slate-300 p-1",children:Ce},`${Re}-${Xe}`))},Re))})]})}):g.jsx("div",{className:"bg-slate-200 flex items-center justify-center text-xs text-slate-500",children:""})}case"chart":{const j=re,se=ee(j.subStepId,j.actionItemId),Te=(((H=(D=se==null?void 0:se.report)==null?void 0:D.matrixData)==null?void 0:H.rows)||[]).map(Ae=>({label:Ae[0],value:parseFloat(Ae[1])||0})).filter(Ae=>Ae.label&&!isNaN(Ae.value));if(Te.length===0)return g.jsx("div",{className:"bg-slate-200 flex items-center justify-center text-xs text-slate-500",children:""});switch(j.chartType){case"line":return g.jsx(aR,{data:Te,title:j.title});case"pie":return g.jsx(rR,{data:Te,title:j.title});case"bar":default:return g.jsx(iR,{data:Te,title:j.title})}}case"flowchart":{const j=re;return j.data&&j.data.subSteps?g.jsx(lR,{subSteps:j.data.subSteps}):g.jsx("div",{className:"bg-slate-200 flex items-center justify-center text-xs text-slate-500",children:""})}default:return null}},te=()=>window.print(),_e=(re,Y)=>{const N=JSON.stringify(re,null,2),Z=new Blob([N],{type:"application/json"}),D=URL.createObjectURL(Z),H=document.createElement("a");H.href=D,H.download=Y,document.body.appendChild(H),H.click(),document.body.removeChild(H),URL.revokeObjectURL(D)},Ie=re=>{re==="pdf"?te():_e(p,"report-deck.json"),b(!1)},Ee=()=>{n(p),r()},ae=p.slides[x],de=u==="project"?`: ${l}`:`: ${e[0].title}`;return g.jsxs(g.Fragment,{children:[g.jsx("style",{children:"@media print { body { -webkit-print-color-adjust: exact; print-color-adjust: exact; } .no-print { display: none !important; } .slide-print-page { page-break-after: always; width: 100vw; height: 56.25vw; /* 16:9 aspect ratio */ box-shadow: none !important; border: none; } }"}),g.jsxs("div",{className:"fixed inset-0 bg-slate-900 bg-opacity-80 z-[100] flex flex-col p-4 no-print",onClick:()=>E(null),children:[g.jsxs("header",{className:"flex items-center justify-between pb-4 flex-shrink-0",children:[g.jsx("h2",{className:"text-xl font-bold text-white truncate pr-4",children:de}),g.jsxs("div",{className:"flex items-center space-x-2",children:[g.jsxs("button",{onClick:O,disabled:w,className:"flex items-center gap-2 px-3 py-1.5 text-xs font-semibold text-white bg-green-600 rounded-md hover:bg-green-700 disabled:bg-slate-400",children:[g.jsx(xf,{className:"w-4 h-4"})," ",w?"...":""]}),g.jsxs("button",{onClick:W,disabled:w,className:"flex items-center gap-2 px-3 py-1.5 text-xs font-semibold text-white bg-purple-600 rounded-md hover:bg-purple-700 disabled:bg-slate-400",children:[g.jsx(Mh,{className:"w-4 h-4"})," ",w?"...":"AI"]}),g.jsxs("div",{className:"relative",ref:U,children:[g.jsx("button",{onClick:()=>b(re=>!re),className:"p-2 bg-slate-600 text-white rounded-md hover:bg-slate-500",title:"",children:g.jsx(hf,{className:"w-5 h-5"})}),k&&g.jsxs("div",{className:"absolute right-0 mt-2 w-32 bg-white rounded-md shadow-lg z-10",children:[g.jsx("button",{onClick:()=>Ie("pdf"),className:"block w-full text-left px-4 py-2 text-sm text-slate-700 hover:bg-slate-100",children:"PDF"}),g.jsx("button",{onClick:()=>Ie("json"),className:"block w-full text-left px-4 py-2 text-sm text-slate-700 hover:bg-slate-100",children:"JSON"})]})]}),g.jsxs("button",{onClick:r,className:"p-2 bg-slate-600 text-white rounded-md hover:bg-slate-500",title:"",children:[" ",g.jsx(ca,{className:"w-5 h-5"})]}),g.jsx("button",{onClick:Ee,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-semibold text-sm",children:""})]})]}),C&&g.jsx("div",{className:"text-red-400 text-sm mb-2 bg-red-100 border border-red-400 p-2 rounded-md",children:C}),g.jsxs("div",{className:"flex-grow flex gap-4 min-h-0",children:[g.jsx("aside",{className:"w-40 bg-slate-800 rounded-lg p-2 flex flex-col gap-2 overflow-y-auto",children:p.slides.map((re,Y)=>g.jsxs("div",{onClick:()=>y(Y),className:`relative group aspect-video bg-white rounded cursor-pointer transition-all p-1 ${x===Y?"ring-4 ring-blue-500":"hover:ring-2 ring-blue-400"}`,children:[g.jsx("div",{className:"absolute top-1 right-1 z-10 opacity-50 group-hover:opacity-100 transition-opacity",children:g.jsx("button",{onClick:N=>{N.stopPropagation(),J(Y)},title:re.isLocked?"":"",className:`p-1 rounded-full ${re.isLocked?"bg-blue-600 text-white":"bg-slate-500 text-white"}`,children:re.isLocked?g.jsx(XM,{className:"w-3 h-3"}):g.jsx(KM,{className:"w-3 h-3"})})}),g.jsx("div",{className:"w-full h-full transform scale-[0.1] origin-top-left overflow-hidden relative",children:re.elements.map(N=>g.jsx("div",{style:{position:"absolute",left:`${N.position.x}%`,top:`${N.position.y}%`,width:`${N.position.width}%`,height:`${N.position.height}%`,backgroundColor:"#ccc"}},N.id))}),g.jsx("span",{className:"text-white text-xs block text-center -mt-2",children:Y+1})]},re.id))}),g.jsx("main",{className:"flex-grow flex items-center justify-center",children:ae&&g.jsx("div",{className:"aspect-video w-full max-w-[100vh] bg-white shadow-2xl rounded-lg relative overflow-hidden",children:ae.elements.map(re=>g.jsx(oR,{el:re,onUpdate:()=>{},isSelected:_===re.id,onClick:()=>E(re.id),children:ne(re)},re.id))})}),g.jsxs("aside",{className:"w-64 bg-slate-800 rounded-lg p-3 text-white overflow-y-auto",children:[g.jsx("h3",{className:"font-bold border-b border-slate-600 pb-2 mb-3",children:""}),g.jsx("p",{className:"text-xs text-slate-400",children:""})]})]})]}),g.jsx("div",{className:"hidden print:block",children:p.slides.map((re,Y)=>g.jsx("div",{className:"slide-print-page bg-white relative",children:g.jsx("div",{className:"w-full h-full relative",children:re.elements.map(N=>g.jsx("div",{style:{position:"absolute",left:`${N.position.x}%`,top:`${N.position.y}%`,width:`${N.position.width}%`,height:`${N.position.height}%`},children:ne(N)},N.id))})},re.id))})]})},cR=({onClose:e,onDownloadAndStartNew:t,onStartNewWithoutSaving:n})=>g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center p-4 z-[60]",children:g.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md",children:[g.jsxs("header",{className:"flex items-center justify-between p-5 border-b border-slate-200",children:[g.jsxs("h3",{className:"text-lg font-bold text-slate-800 flex items-center",children:[g.jsx(Oo,{className:"w-6 h-6 mr-2 text-yellow-500"}),""]}),g.jsx("button",{onClick:e,className:"text-slate-500 hover:text-slate-700 transition-colors p-1 rounded-full hover:bg-slate-100",title:"","aria-label":"",children:g.jsx(ca,{className:"w-5 h-5"})})]}),g.jsxs("div",{className:"p-6",children:[g.jsx("p",{className:"text-slate-700",children:""}),g.jsx("p",{className:"text-sm text-slate-500 mt-2",children:"JSON"})]}),g.jsxs("footer",{className:"p-4 bg-slate-50 border-t border-slate-200 flex flex-col sm:flex-row justify-end gap-3 rounded-b-xl",children:[g.jsx("button",{type:"button",onClick:e,className:"w-full sm:w-auto px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md shadow-sm hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:""}),g.jsx("button",{type:"button",onClick:n,className:"w-full sm:w-auto px-4 py-2 text-sm font-medium text-red-700 bg-red-100 border border-transparent rounded-md shadow-sm hover:bg-red-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:""}),g.jsxs("button",{type:"submit",onClick:t,className:"w-full sm:w-auto px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 flex items-center justify-center gap-2",children:[g.jsx(hf,{className:"w-4 h-4"}),""]})]})]})});function uR(e,t){if(e.match(/^[a-z]+:\/\//i))return e;if(e.match(/^\/\//))return window.location.protocol+e;if(e.match(/^[a-z]+:/i))return e;const n=document.implementation.createHTMLDocument(),r=n.createElement("base"),a=n.createElement("a");return n.head.appendChild(r),n.body.appendChild(a),t&&(r.href=t),a.href=e,a.href}const fR=(()=>{let e=0;const t=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(e+=1,`u${t()}${e}`)})();function Di(e){const t=[];for(let n=0,r=e.length;n<r;n++)t.push(e[n]);return t}let il=null;function L2(e={}){return il||(e.includeStyleProperties?(il=e.includeStyleProperties,il):(il=Di(window.getComputedStyle(document.documentElement)),il))}function Wu(e,t){const r=(e.ownerDocument.defaultView||window).getComputedStyle(e).getPropertyValue(t);return r?parseFloat(r.replace("px","")):0}function dR(e){const t=Wu(e,"border-left-width"),n=Wu(e,"border-right-width");return e.clientWidth+t+n}function hR(e){const t=Wu(e,"border-top-width"),n=Wu(e,"border-bottom-width");return e.clientHeight+t+n}function O2(e,t={}){const n=t.width||dR(e),r=t.height||hR(e);return{width:n,height:r}}function mR(){let e,t;try{t=process}catch{}const n=t&&t.env?t.env.devicePixelRatio:null;return n&&(e=parseInt(n,10),Number.isNaN(e)&&(e=1)),e||window.devicePixelRatio||1}const br=16384;function pR(e){(e.width>br||e.height>br)&&(e.width>br&&e.height>br?e.width>e.height?(e.height*=br/e.width,e.width=br):(e.width*=br/e.height,e.height=br):e.width>br?(e.height*=br/e.width,e.width=br):(e.width*=br/e.height,e.height=br))}function Ju(e){return new Promise((t,n)=>{const r=new Image;r.onload=()=>{r.decode().then(()=>{requestAnimationFrame(()=>t(r))})},r.onerror=n,r.crossOrigin="anonymous",r.decoding="async",r.src=e})}async function xR(e){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(e)).then(encodeURIComponent).then(t=>`data:image/svg+xml;charset=utf-8,${t}`)}async function gR(e,t,n){const r="http://www.w3.org/2000/svg",a=document.createElementNS(r,"svg"),l=document.createElementNS(r,"foreignObject");return a.setAttribute("width",`${t}`),a.setAttribute("height",`${n}`),a.setAttribute("viewBox",`0 0 ${t} ${n}`),l.setAttribute("width","100%"),l.setAttribute("height","100%"),l.setAttribute("x","0"),l.setAttribute("y","0"),l.setAttribute("externalResourcesRequired","true"),a.appendChild(l),l.appendChild(e),xR(a)}const vr=(e,t)=>{if(e instanceof t)return!0;const n=Object.getPrototypeOf(e);return n===null?!1:n.constructor.name===t.name||vr(n,t)};function vR(e){const t=e.getPropertyValue("content");return`${e.cssText} content: '${t.replace(/'|"/g,"")}';`}function yR(e,t){return L2(t).map(n=>{const r=e.getPropertyValue(n),a=e.getPropertyPriority(n);return`${n}: ${r}${a?" !important":""};`}).join(" ")}function TR(e,t,n,r){const a=`.${e}:${t}`,l=n.cssText?vR(n):yR(n,r);return document.createTextNode(`${a}{${l}}`)}function bv(e,t,n,r){const a=window.getComputedStyle(e,n),l=a.getPropertyValue("content");if(l===""||l==="none")return;const c=fR();try{t.className=`${t.className} ${c}`}catch{return}const u=document.createElement("style");u.appendChild(TR(c,n,a,r)),t.appendChild(u)}function _R(e,t,n){bv(e,t,":before",n),bv(e,t,":after",n)}const kv="application/font-woff",Nv="image/jpeg",ER={woff:kv,woff2:kv,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:Nv,jpeg:Nv,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function SR(e){const t=/\.([^./]*?)$/g.exec(e);return t?t[1]:""}function Ih(e){const t=SR(e).toLowerCase();return ER[t]||""}function wR(e){return e.split(/,/)[1]}function uh(e){return e.search(/^(data:)/)!==-1}function CR(e,t){return`data:${t};base64,${e}`}async function P2(e,t,n){const r=await fetch(e,t);if(r.status===404)throw new Error(`Resource "${r.url}" not found`);const a=await r.blob();return new Promise((l,c)=>{const u=new FileReader;u.onerror=c,u.onloadend=()=>{try{l(n({res:r,result:u.result}))}catch(p){c(p)}},u.readAsDataURL(a)})}const Id={};function AR(e,t,n){let r=e.replace(/\?.*/,"");return n&&(r=e),/ttf|otf|eot|woff2?/i.test(r)&&(r=r.replace(/.*\//,"")),t?`[${t}]${r}`:r}async function Fh(e,t,n){const r=AR(e,t,n.includeQueryParams);if(Id[r]!=null)return Id[r];n.cacheBust&&(e+=(/\?/.test(e)?"&":"?")+new Date().getTime());let a;try{const l=await P2(e,n.fetchRequestInit,({res:c,result:u})=>(t||(t=c.headers.get("Content-Type")||""),wR(u)));a=CR(l,t)}catch(l){a=n.imagePlaceholder||"";let c=`Failed to fetch resource: ${e}`;l&&(c=typeof l=="string"?l:l.message),c&&console.warn(c)}return Id[r]=a,a}async function bR(e){const t=e.toDataURL();return t==="data:,"?e.cloneNode(!1):Ju(t)}async function kR(e,t){if(e.currentSrc){const l=document.createElement("canvas"),c=l.getContext("2d");l.width=e.clientWidth,l.height=e.clientHeight,c==null||c.drawImage(e,0,0,l.width,l.height);const u=l.toDataURL();return Ju(u)}const n=e.poster,r=Ih(n),a=await Fh(n,r,t);return Ju(a)}async function NR(e,t){var n;try{if(!((n=e==null?void 0:e.contentDocument)===null||n===void 0)&&n.body)return await gf(e.contentDocument.body,t,!0)}catch{}return e.cloneNode(!1)}async function MR(e,t){return vr(e,HTMLCanvasElement)?bR(e):vr(e,HTMLVideoElement)?kR(e,t):vr(e,HTMLIFrameElement)?NR(e,t):e.cloneNode(U2(e))}const RR=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SLOT",U2=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SVG";async function DR(e,t,n){var r,a;if(U2(t))return t;let l=[];return RR(e)&&e.assignedNodes?l=Di(e.assignedNodes()):vr(e,HTMLIFrameElement)&&(!((r=e.contentDocument)===null||r===void 0)&&r.body)?l=Di(e.contentDocument.body.childNodes):l=Di(((a=e.shadowRoot)!==null&&a!==void 0?a:e).childNodes),l.length===0||vr(e,HTMLVideoElement)||await l.reduce((c,u)=>c.then(()=>gf(u,n)).then(p=>{p&&t.appendChild(p)}),Promise.resolve()),t}function IR(e,t,n){const r=t.style;if(!r)return;const a=window.getComputedStyle(e);a.cssText?(r.cssText=a.cssText,r.transformOrigin=a.transformOrigin):L2(n).forEach(l=>{let c=a.getPropertyValue(l);l==="font-size"&&c.endsWith("px")&&(c=`${Math.floor(parseFloat(c.substring(0,c.length-2)))-.1}px`),vr(e,HTMLIFrameElement)&&l==="display"&&c==="inline"&&(c="block"),l==="d"&&t.getAttribute("d")&&(c=`path(${t.getAttribute("d")})`),r.setProperty(l,c,a.getPropertyPriority(l))})}function FR(e,t){vr(e,HTMLTextAreaElement)&&(t.innerHTML=e.value),vr(e,HTMLInputElement)&&t.setAttribute("value",e.value)}function LR(e,t){if(vr(e,HTMLSelectElement)){const n=t,r=Array.from(n.children).find(a=>e.value===a.getAttribute("value"));r&&r.setAttribute("selected","")}}function OR(e,t,n){return vr(t,Element)&&(IR(e,t,n),_R(e,t,n),FR(e,t),LR(e,t)),t}async function PR(e,t){const n=e.querySelectorAll?e.querySelectorAll("use"):[];if(n.length===0)return e;const r={};for(let l=0;l<n.length;l++){const u=n[l].getAttribute("xlink:href");if(u){const p=e.querySelector(u),m=document.querySelector(u);!p&&m&&!r[u]&&(r[u]=await gf(m,t,!0))}}const a=Object.values(r);if(a.length){const l="http://www.w3.org/1999/xhtml",c=document.createElementNS(l,"svg");c.setAttribute("xmlns",l),c.style.position="absolute",c.style.width="0",c.style.height="0",c.style.overflow="hidden",c.style.display="none";const u=document.createElementNS(l,"defs");c.appendChild(u);for(let p=0;p<a.length;p++)u.appendChild(a[p]);e.appendChild(c)}return e}async function gf(e,t,n){return!n&&t.filter&&!t.filter(e)?null:Promise.resolve(e).then(r=>MR(r,t)).then(r=>DR(e,r,t)).then(r=>OR(e,r,t)).then(r=>PR(r,t))}const B2=/url\((['"]?)([^'"]+?)\1\)/g,UR=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,BR=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function VR(e){const t=e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${t})(['"]?\\))`,"g")}function HR(e){const t=[];return e.replace(B2,(n,r,a)=>(t.push(a),n)),t.filter(n=>!uh(n))}async function GR(e,t,n,r,a){try{const l=n?uR(t,n):t,c=Ih(t);let u;return a||(u=await Fh(l,c,r)),e.replace(VR(t),`$1${u}$3`)}catch{}return e}function jR(e,{preferredFontFormat:t}){return t?e.replace(BR,n=>{for(;;){const[r,,a]=UR.exec(n)||[];if(!a)return"";if(a===t)return`src: ${r};`}}):e}function V2(e){return e.search(B2)!==-1}async function H2(e,t,n){if(!V2(e))return e;const r=jR(e,n);return HR(r).reduce((l,c)=>l.then(u=>GR(u,c,t,n)),Promise.resolve(r))}async function sl(e,t,n){var r;const a=(r=t.style)===null||r===void 0?void 0:r.getPropertyValue(e);if(a){const l=await H2(a,null,n);return t.style.setProperty(e,l,t.style.getPropertyPriority(e)),!0}return!1}async function zR(e,t){await sl("background",e,t)||await sl("background-image",e,t),await sl("mask",e,t)||await sl("-webkit-mask",e,t)||await sl("mask-image",e,t)||await sl("-webkit-mask-image",e,t)}async function qR(e,t){const n=vr(e,HTMLImageElement);if(!(n&&!uh(e.src))&&!(vr(e,SVGImageElement)&&!uh(e.href.baseVal)))return;const r=n?e.src:e.href.baseVal,a=await Fh(r,Ih(r),t);await new Promise((l,c)=>{e.onload=l,e.onerror=t.onImageErrorHandler?(...p)=>{try{l(t.onImageErrorHandler(...p))}catch(m){c(m)}}:c;const u=e;u.decode&&(u.decode=l),u.loading==="lazy"&&(u.loading="eager"),n?(e.srcset="",e.src=a):e.href.baseVal=a})}async function $R(e,t){const r=Di(e.childNodes).map(a=>G2(a,t));await Promise.all(r).then(()=>e)}async function G2(e,t){vr(e,Element)&&(await zR(e,t),await qR(e,t),await $R(e,t))}function YR(e,t){const{style:n}=e;t.backgroundColor&&(n.backgroundColor=t.backgroundColor),t.width&&(n.width=`${t.width}px`),t.height&&(n.height=`${t.height}px`);const r=t.style;return r!=null&&Object.keys(r).forEach(a=>{n[a]=r[a]}),e}const Mv={};async function Rv(e){let t=Mv[e];if(t!=null)return t;const r=await(await fetch(e)).text();return t={url:e,cssText:r},Mv[e]=t,t}async function Dv(e,t){let n=e.cssText;const r=/url\(["']?([^"')]+)["']?\)/g,l=(n.match(/url\([^)]+\)/g)||[]).map(async c=>{let u=c.replace(r,"$1");return u.startsWith("https://")||(u=new URL(u,e.url).href),P2(u,t.fetchRequestInit,({result:p})=>(n=n.replace(c,`url(${p})`),[c,p]))});return Promise.all(l).then(()=>n)}function Iv(e){if(e==null)return[];const t=[],n=/(\/\*[\s\S]*?\*\/)/gi;let r=e.replace(n,"");const a=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const p=a.exec(r);if(p===null)break;t.push(p[0])}r=r.replace(a,"");const l=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,c="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",u=new RegExp(c,"gi");for(;;){let p=l.exec(r);if(p===null){if(p=u.exec(r),p===null)break;l.lastIndex=u.lastIndex}else u.lastIndex=l.lastIndex;t.push(p[0])}return t}async function WR(e,t){const n=[],r=[];return e.forEach(a=>{if("cssRules"in a)try{Di(a.cssRules||[]).forEach((l,c)=>{if(l.type===CSSRule.IMPORT_RULE){let u=c+1;const p=l.href,m=Rv(p).then(x=>Dv(x,t)).then(x=>Iv(x).forEach(y=>{try{a.insertRule(y,y.startsWith("@import")?u+=1:a.cssRules.length)}catch(_){console.error("Error inserting rule from remote css",{rule:y,error:_})}})).catch(x=>{console.error("Error loading remote css",x.toString())});r.push(m)}})}catch(l){const c=e.find(u=>u.href==null)||document.styleSheets[0];a.href!=null&&r.push(Rv(a.href).then(u=>Dv(u,t)).then(u=>Iv(u).forEach(p=>{c.insertRule(p,c.cssRules.length)})).catch(u=>{console.error("Error loading remote stylesheet",u)})),console.error("Error inlining remote css file",l)}}),Promise.all(r).then(()=>(e.forEach(a=>{if("cssRules"in a)try{Di(a.cssRules||[]).forEach(l=>{n.push(l)})}catch(l){console.error(`Error while reading CSS rules from ${a.href}`,l)}}),n))}function JR(e){return e.filter(t=>t.type===CSSRule.FONT_FACE_RULE).filter(t=>V2(t.style.getPropertyValue("src")))}async function XR(e,t){if(e.ownerDocument==null)throw new Error("Provided element is not within a Document");const n=Di(e.ownerDocument.styleSheets),r=await WR(n,t);return JR(r)}function j2(e){return e.trim().replace(/["']/g,"")}function KR(e){const t=new Set;function n(r){(r.style.fontFamily||getComputedStyle(r).fontFamily).split(",").forEach(l=>{t.add(j2(l))}),Array.from(r.children).forEach(l=>{l instanceof HTMLElement&&n(l)})}return n(e),t}async function ZR(e,t){const n=await XR(e,t),r=KR(e);return(await Promise.all(n.filter(l=>r.has(j2(l.style.fontFamily))).map(l=>{const c=l.parentStyleSheet?l.parentStyleSheet.href:null;return H2(l.cssText,c,t)}))).join(`
`)}async function QR(e,t){const n=t.fontEmbedCSS!=null?t.fontEmbedCSS:t.skipFonts?null:await ZR(e,t);if(n){const r=document.createElement("style"),a=document.createTextNode(n);r.appendChild(a),e.firstChild?e.insertBefore(r,e.firstChild):e.appendChild(r)}}async function eD(e,t={}){const{width:n,height:r}=O2(e,t),a=await gf(e,t,!0);return await QR(a,t),await G2(a,t),YR(a,t),await gR(a,n,r)}async function tD(e,t={}){const{width:n,height:r}=O2(e,t),a=await eD(e,t),l=await Ju(a),c=document.createElement("canvas"),u=c.getContext("2d"),p=t.pixelRatio||mR(),m=t.canvasWidth||n,x=t.canvasHeight||r;return c.width=m*p,c.height=x*p,t.skipAutoScale||pR(c),c.style.width=`${m}`,c.style.height=`${x}`,t.backgroundColor&&(u.fillStyle=t.backgroundColor,u.fillRect(0,0,c.width,c.height)),u.drawImage(l,0,0,c.width,c.height),c}async function nD(e,t={}){return(await tD(e,t)).toDataURL()}const Mo=40,Fv=64,Lv=320,Ov=["#3B82F6","#F59E0B","#10B981","#EF4444","#6B7280","#6366F1","#EC4899","#8B5CF6"],rD=({data:e,onClose:t,onItemClick:n,onRegenerate:r,isRegenerating:a})=>{const[l,c]=he.useState(!0),[u,p]=he.useState(new Set),[m,x]=he.useState("all"),y=he.useRef(null),[_,E]=he.useState(!1),[w,S]=he.useState("day"),[C,M]=he.useState({start:"",end:""}),b={day:40,week:15,month:5}[w],U=he.useMemo(()=>{const re=new Map;return e.filter(Y=>Y.type==="task").forEach((Y,N)=>{re.set(Y.id,Ov[N%Ov.length])}),re},[e]),G=he.useCallback((re,Y)=>{if(re.type==="task")return re.id;let N=re;for(;N.parentId;){const Z=Y.get(N.parentId);if(!Z)return null;if(Z.type==="task")return Z.id;N=Z}return null},[]),J=he.useMemo(()=>new Map(e.map(re=>[re.id,re])),[e]),F=he.useCallback(re=>{const Y=G(re,J);return Y&&U.get(Y)||"#9CA3AF"},[J,U,G]);he.useEffect(()=>{const re=new Set(e.filter(Y=>Y.type==="task").map(Y=>Y.id));p(re)},[e]);const W=re=>{p(Y=>{const N=new Set(Y);return N.has(re)?N.delete(re):N.add(re),N})},O=he.useMemo(()=>{const re=[];return e.filter(N=>N.type==="task").forEach(N=>{re.push(N),u.has(N.id)&&e.filter(D=>D.type==="substep"&&D.parentId===N.id).forEach(D=>{if(re.push(D),u.has(D.id)){const H=e.filter(q=>{if(q.type!=="actionitem"||q.parentId!==D.id)return!1;if(m==="all")return!0;const j=q.progress===100;return m==="completed"?j:m==="pending"?!j:!0});re.push(...H)}})}),re},[e,u,m]),{timelineStart:ee,totalDays:ne}=he.useMemo(()=>{if(e.length===0)return{timelineStart:new Date,totalDays:30};const re=e.map(j=>new Date(j.start)).filter(j=>!isNaN(j.getTime())),Y=e.map(j=>new Date(j.end)).filter(j=>!isNaN(j.getTime()));let N,Z;re.length===0||Y.length===0?(N=new Date,Z=new Date,Z.setMonth(Z.getMonth()+1)):(N=new Date(Math.min(...re.map(j=>j.getTime()))),Z=new Date(Math.max(...Y.map(j=>j.getTime()))));let D=C.start?new Date(C.start):N,H=C.end?new Date(C.end):Z;isNaN(D.getTime())&&(D=N),isNaN(H.getTime())&&(H=Z),H<D&&(H=D),D.setDate(D.getDate()-2),H.setDate(H.getDate()+5);const q=(H.getTime()-D.getTime())/(1e3*3600*24);return{timelineStart:D,totalDays:Math.ceil(q)}},[e,C]),te=he.useMemo(()=>{const re=Z=>{Z=new Date(Date.UTC(Z.getFullYear(),Z.getMonth(),Z.getDate())),Z.setUTCDate(Z.getUTCDate()+4-(Z.getUTCDay()||7));const D=new Date(Date.UTC(Z.getUTCFullYear(),0,1));return Math.ceil(((Z.getTime()-D.getTime())/864e5+1)/7)},Y=[];let N=new Date(ee);if(w==="day")for(let Z=0;Z<ne;Z++)Y.push({secondaryLabel:N.toLocaleDateString("ja-JP",{weekday:"short"}),label:String(N.getDate()),width:b}),N.setDate(N.getDate()+1);else if(w==="week")for(let Z=0;Z<ne;Z++)(N.getDay()===1||Y.length===0)&&Y.push({label:`W${re(N)}`,secondaryLabel:N.toLocaleDateString("ja-JP",{month:"short"}),width:0}),Y[Y.length-1].width+=b,N.setDate(N.getDate()+1);else if(w==="month"){let Z=-1;for(let D=0;D<ne;D++){const H=N.getMonth();H!==Z&&(Z=H,Y.push({label:N.toLocaleDateString("ja-JP",{month:"long",year:"numeric"}),width:0})),Y[Y.length-1].width+=b,N.setDate(N.getDate()+1)}}return Y},[ee,ne,w,b]),_e=re=>{const Y=new Date(re);return isNaN(Y.getTime())?-1:(Y.getTime()-ee.getTime())/(1e3*3600*24)},Ie=re=>{switch(re){case"substep":return"pl-5";case"actionitem":return"pl-9";default:return"pl-1"}},Ee=re=>e.some(Y=>Y.parentId===re),ae=he.useCallback(()=>{if(y.current===null){alert("");return}E(!0),nD(y.current,{cacheBust:!0,backgroundColor:"#ffffff",width:y.current.scrollWidth,height:y.current.scrollHeight}).then(re=>{const Y=document.createElement("a");Y.download="gantt-chart.png",Y.href=re,Y.click()}).catch(re=>{console.error("",re),alert("")}).finally(()=>{E(!1)})},[]),de=he.useMemo(()=>te.reduce((re,Y)=>re+Y.width,0),[te]);return g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex flex-col p-4 z-[80]",children:g.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full h-full flex flex-col",children:[g.jsxs("header",{className:"flex-shrink-0 flex flex-wrap items-center justify-between p-4 border-b gap-4",children:[g.jsx("h2",{className:"text-xl font-bold text-slate-800",children:""}),g.jsxs("div",{className:"flex items-center flex-wrap gap-x-6 gap-y-2",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("span",{className:"text-sm font-medium text-slate-600",children:":"}),g.jsx("div",{className:"flex items-center rounded-md bg-slate-100 p-1",children:["day","week","month"].map(re=>g.jsx("button",{onClick:()=>S(re),className:`px-3 py-1 text-xs capitalize rounded-md ${w===re?"bg-white shadow-sm font-semibold text-blue-600":""}`,children:re},re))})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("span",{className:"text-sm font-medium text-slate-600",children:":"}),g.jsx("input",{type:"date",value:C.start,onChange:re=>M(Y=>({...Y,start:re.target.value})),className:"p-1 border rounded-md text-sm"}),g.jsx("span",{children:"-"}),g.jsx("input",{type:"date",value:C.end,onChange:re=>M(Y=>({...Y,end:re.target.value})),className:"p-1 border rounded-md text-sm"}),g.jsx("button",{onClick:()=>M({start:"",end:""}),className:"text-xs px-2 py-1 bg-slate-200 rounded-md hover:bg-slate-300",children:""})]}),g.jsxs("button",{onClick:ae,disabled:_,className:"inline-flex items-center gap-2 px-3 py-1.5 text-sm font-semibold text-white bg-green-600 rounded-md hover:bg-green-700 disabled:bg-slate-400",children:[_?g.jsx(ia,{size:"sm",color:"border-white"}):g.jsx(hf,{className:"w-4 h-4"}),"PNG"]}),g.jsxs("button",{onClick:t,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-semibold text-slate-700 bg-slate-100 rounded-md hover:bg-slate-200",children:[g.jsx(ca,{className:"w-5 h-5"}),""]})]})]}),g.jsxs("div",{className:"flex-shrink-0 p-4 border-b flex items-center justify-between",children:[g.jsxs("div",{className:"flex items-center gap-1 rounded-full bg-slate-100 p-1",children:[g.jsx("button",{onClick:()=>x("all"),className:`px-3 py-1 text-xs rounded-full ${m==="all"?"bg-white shadow-sm":""}`,children:""}),g.jsx("button",{onClick:()=>x("pending"),className:`px-3 py-1 text-xs rounded-full ${m==="pending"?"bg-white shadow-sm":""}`,children:""}),g.jsx("button",{onClick:()=>x("completed"),className:`px-3 py-1 text-xs rounded-full ${m==="completed"?"bg-white shadow-sm":""}`,children:""})]}),g.jsxs("div",{className:"flex items-center gap-4",children:[g.jsxs("button",{onClick:r,disabled:a,className:"inline-flex items-center gap-2 px-3 py-1.5 text-sm font-semibold text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:bg-slate-400",children:[a?g.jsx(ia,{size:"sm",color:"border-white"}):g.jsx(xf,{className:"w-4 h-4"}),"AI"]}),g.jsxs("label",{className:"flex items-center text-sm text-slate-600 cursor-pointer",children:[g.jsx("input",{type:"checkbox",checked:l,onChange:()=>c(re=>!re),className:"w-4 h-4 mr-2 accent-blue-600"}),""]})]})]}),g.jsx("div",{className:"flex-grow overflow-auto relative",children:g.jsxs("div",{ref:y,className:"grid",style:{gridTemplateColumns:`${Lv}px 1fr`,width:`${Lv+de}px`},children:[g.jsx("div",{className:"sticky top-0 left-0 z-30 flex items-center p-2 font-semibold text-sm border-b border-r bg-slate-100 text-slate-800",style:{gridColumn:1,gridRow:1,height:Fv},children:" / "}),g.jsx("div",{className:"sticky top-0 z-20 border-b bg-slate-50",style:{gridColumn:2,gridRow:1,height:Fv},children:g.jsx("div",{className:"flex h-full",children:te.map((re,Y)=>g.jsxs("div",{className:"border-r text-center text-[10px] flex flex-col items-center justify-center",style:{width:re.width},children:[re.secondaryLabel&&g.jsx("span",{className:"font-semibold text-slate-600",children:re.secondaryLabel}),g.jsx("div",{className:`font-bold text-slate-800 ${w==="day"?"text-lg":"text-sm"}`,children:re.label})]},Y))})}),g.jsx("div",{className:"pointer-events-none flex",style:{gridColumn:2,gridRow:`2 / span ${O.length}`},children:te.map((re,Y)=>g.jsx("div",{className:"h-full border-r border-slate-200",style:{width:re.width}},Y))}),O.map((re,Y)=>{const N=F(re),Z=(()=>{const Te=O[Y+1];return Te?G(re,J)!==G(Te,J):!0})(),D=_e(re.start),H=Math.max(.2,_e(re.end)-D+1),q=D*b,j=H*b,se={task:{height:"24px"},substep:{height:"20px"},actionitem:{height:"8px"}};return g.jsxs(Wa.Fragment,{children:[g.jsxs("div",{className:"sticky left-0 z-10 flex items-center border-r bg-slate-50",style:{gridColumn:1,gridRow:Y+2,height:Mo,borderBottom:Z?`2px solid ${N}`:"1px solid #e5e7eb"},children:[g.jsx("div",{className:"w-1 h-full flex-shrink-0",style:{backgroundColor:N}}),g.jsxs("div",{className:`flex items-center w-full ${Ie(re.type)}`,children:[(re.type==="task"||re.type==="substep")&&(Ee(re.id)?g.jsx(JM,{onClick:()=>W(re.id),className:`w-4 h-4 mr-1 text-slate-500 cursor-pointer transition-transform ${u.has(re.id)?"rotate-0":"-rotate-90"}`}):g.jsx("div",{className:"w-4 h-4 mr-1"})),re.type==="actionitem"&&(re.progress===100?g.jsx(lc,{className:"w-3.5 h-3.5 text-green-600 mr-2 flex-shrink-0"}):g.jsx(pf,{className:"w-3.5 h-3.5 text-slate-400 mr-2 flex-shrink-0"})),g.jsx("span",{onClick:()=>n==null?void 0:n(re),className:`truncate text-xs ${re.type==="task"?"font-semibold text-slate-800":"text-slate-600"} ${n?"cursor-pointer hover:text-blue-600":""}`,title:re.name,children:re.name})]})]}),g.jsx("div",{className:"relative",style:{gridColumn:2,gridRow:Y+2,borderBottom:Z?`2px solid ${N}`:"1px solid #e5e7eb"},children:D>=0&&g.jsx("div",{title:`${re.name} (${re.progress}%)`,onClick:()=>n==null?void 0:n(re),className:"absolute h-full flex items-center group",style:{left:q,width:j,cursor:n?"pointer":"default"},children:g.jsx("div",{className:"w-full rounded",style:{...se[re.type],backgroundColor:N},children:g.jsx("div",{className:"bg-black bg-opacity-30 h-full rounded",style:{width:`${re.progress}%`}})})})})]},re.id)}),g.jsx("div",{style:{gridColumn:2,gridRow:`2 / span ${O.length}`,position:"relative",pointerEvents:"none"},children:l&&g.jsx(aD,{items:O,getDaysFromStart:_e,dayWidth:b})})]})})]})})},aD=({items:e,getDaysFromStart:t,dayWidth:n})=>{const r=he.useMemo(()=>{const a=[],l=new Map(e.map((c,u)=>[c.id,u]));return e.forEach((c,u)=>{(c.dependencies||[]).forEach(p=>{const m=l.get(p),x=m!==void 0?e[m]:void 0;if(x&&m!==void 0){const y=t(x.end),_=t(c.start);if(y<0||_<0)return;const E=(y+1)*n,w=m*Mo+Mo/2,S=_*n,C=u*Mo+Mo/2,M=E+20,k=S-20,b=`M ${E} ${w} C ${M} ${w}, ${k} ${C}, ${S} ${C}`;a.push({key:`${p}-${c.id}`,d:b})}})}),a},[e,t,n]);return g.jsxs("svg",{className:"absolute top-0 left-0 w-full h-full pointer-events-none",overflow:"visible",children:[g.jsx("defs",{children:g.jsx("marker",{id:"gantt_arrowhead",markerWidth:"5",markerHeight:"4",refX:"5",refY:"2",orient:"auto",children:g.jsx("polygon",{points:"0 0, 5 2, 0 4",fill:"#4b5563"})})}),r.map(a=>g.jsx("path",{d:a.d,stroke:"#4b5563",strokeWidth:"1",fill:"none",markerEnd:"url(#gantt_arrowhead)"},a.key))]})},uc=({message:e})=>e?g.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-md relative",role:"alert",children:[g.jsx("strong",{className:"font-bold",children:"Error: "}),g.jsx("span",{className:"block sm:inline",children:e})]}):null,iD=({tasks:e,projectGoal:t,targetDate:n,ganttData:r,projectReportDeck:a,onClose:l,onReportGenerated:c,generateUniqueId:u})=>{const[p,m]=he.useState("list"),[x,y]=he.useState(new Set),[_,E]=he.useState(""),[w,S]=he.useState(!1),[C,M]=he.useState(null),[k,b]=he.useState({key:"taskName",direction:"ascending"}),[U,G]=he.useState("slides"),[J,F]=he.useState(null),W=he.useMemo(()=>{const N=[];return r&&N.push({id:"gantt-chart-main",name:" ",type:"Gantt Chart",taskName:"",subStepName:"",actionItemName:"",source:{name:" ",type:"json",content:r}}),a&&N.push({id:"project-report-main",name:"",type:"Project Report",taskName:"",subStepName:"",actionItemName:"",source:{name:"",type:"json",content:a}}),e.forEach(Z=>{var D,H,q,j,se;(D=Z.extendedDetails)!=null&&D.reportDeck&&N.push({id:`task-report-${Z.id}`,name:`: ${Z.title}`,type:"Task Report",taskName:Z.title,subStepName:"",actionItemName:"",source:{name:`: ${Z.title}`,type:"json",content:Z.extendedDetails.reportDeck}}),(q=(H=Z.extendedDetails)==null?void 0:H.attachments)==null||q.forEach(Te=>{N.push({id:Te.id,name:Te.name,type:"Attachment",taskName:Z.title,subStepName:"",actionItemName:"",source:{name:Te.name,type:Te.type.startsWith("image/")?"image":"text",content:Te.dataUrl,dataUrl:Te.dataUrl}})}),(se=(j=Z.extendedDetails)==null?void 0:j.subSteps)==null||se.forEach(Te=>{var Ae,Re;(Ae=Te.attachments)==null||Ae.forEach(Ce=>{N.push({id:Ce.id,name:Ce.name,type:"Attachment",taskName:Z.title,subStepName:Te.text,actionItemName:"",source:{name:Ce.name,type:Ce.type.startsWith("image/")?"image":"text",content:Ce.dataUrl,dataUrl:Ce.dataUrl}})}),(Re=Te.actionItems)==null||Re.forEach(Ce=>{var Xe,X,ut;(X=(Xe=Ce.report)==null?void 0:Xe.attachments)==null||X.forEach(Ke=>{N.push({id:Ke.id,name:Ke.name,type:"Attachment",taskName:Z.title,subStepName:Te.text,actionItemName:Ce.text,source:{name:Ke.name,type:Ke.type.startsWith("image/")?"image":"text",content:Ke.dataUrl,dataUrl:Ke.dataUrl}})}),(ut=Ce.report)!=null&&ut.matrixData&&N.push({id:`matrix-${Ce.id}`,name:`: ${Ce.text}`,type:"Data Matrix",taskName:Z.title,subStepName:Te.text,actionItemName:Ce.text,source:{name:`: ${Ce.text}`,type:"json",content:Ce.report.matrixData}})})})}),N},[e,r,a]),O=he.useMemo(()=>{let N=[...W];return k!==null&&N.sort((Z,D)=>{const H=(Z[k.key]||"").toLowerCase(),q=(D[k.key]||"").toLowerCase();return H<q?k.direction==="ascending"?-1:1:H>q?k.direction==="ascending"?1:-1:0}),N},[W,k]),ee=N=>{let Z="ascending";k&&k.key===N&&k.direction==="ascending"&&(Z="descending"),b({key:N,direction:Z})},ne=N=>!k||k.key!==N?g.jsx(ds,{className:"w-3 h-3 ml-1 opacity-30 group-hover:opacity-100"}):k.direction==="ascending"?g.jsx(Jo,{className:"w-3 h-3 ml-1 text-blue-600"}):g.jsx(ds,{className:"w-3 h-3 ml-1 text-blue-600"}),te=N=>{y(Z=>{const D=new Set(Z);return D.has(N)?D.delete(N):D.add(N),D})},_e=()=>{x.size===W.length?y(new Set):y(new Set(W.map(N=>N.id)))},Ie=async()=>{if(x.size===0){M("1");return}if(!_.trim()){M("");return}S(!0),M(null),F(null);const N=W.filter(Z=>x.has(Z.id)).map(Z=>Z.source);try{if(U==="slides"){const Z=await S2(N,_);c(Z)}else{const Z=await BM(N,_);F(Z)}}catch(Z){M(Z instanceof Error?Z.message:"")}finally{S(!1)}},Ee=N=>{switch(N){case"Gantt Chart":return g.jsx(I2,{className:"w-5 h-5 text-amber-600"});case"Project Report":case"Task Report":return g.jsx(N2,{className:"w-5 h-5 text-teal-600"});case"Attachment":return g.jsx(Ri,{className:"w-5 h-5 text-slate-600"});case"Data Matrix":return g.jsx(oc,{className:"w-5 h-5 text-purple-600"});default:return g.jsx(Wo,{className:"w-5 h-5 text-slate-500"})}},ae=N=>{if(N.dataUrl)return N.dataUrl;if(N.type==="json")try{const Z=JSON.stringify(N.content,null,2),D=new Blob([Z],{type:"application/json"});return URL.createObjectURL(D)}catch{return}},de=he.useMemo(()=>W.filter(N=>x.has(N.id)),[x,W]),re=()=>g.jsxs(g.Fragment,{children:[g.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:g.jsxs("table",{className:"w-full min-w-[1000px] border-collapse text-sm",children:[g.jsx("thead",{className:"sticky top-0 bg-slate-200 z-10",children:g.jsxs("tr",{children:[g.jsx("th",{className:"p-2 border border-slate-300 w-10 text-center",children:g.jsx("input",{type:"checkbox",checked:x.size===W.length&&W.length>0,onChange:_e,className:"w-4 h-4 accent-blue-600"})}),g.jsx("th",{className:"p-0 border border-slate-300 w-1/4",children:g.jsxs("button",{onClick:()=>ee("name"),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50",children:[g.jsx("span",{children:""}),ne("name")]})}),g.jsx("th",{className:"p-0 border border-slate-300 w-40",children:g.jsxs("button",{onClick:()=>ee("type"),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50",children:[g.jsx("span",{children:""}),ne("type")]})}),g.jsx("th",{className:"p-0 border border-slate-300 w-1/4",children:g.jsxs("button",{onClick:()=>ee("taskName"),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50",children:[g.jsx("span",{children:""}),ne("taskName")]})}),g.jsx("th",{className:"p-0 border border-slate-300 w-1/4",children:g.jsxs("button",{onClick:()=>ee("subStepName"),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50",children:[g.jsx("span",{children:""}),ne("subStepName")]})}),g.jsx("th",{className:"p-0 border border-slate-300 w-1/4",children:g.jsxs("button",{onClick:()=>ee("actionItemName"),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50",children:[g.jsx("span",{children:""}),ne("actionItemName")]})})]})}),g.jsx("tbody",{children:O.map(N=>{const Z=ae(N.source);return g.jsxs("tr",{className:"bg-white hover:bg-slate-50 transition-colors",children:[g.jsx("td",{className:"border border-slate-300 align-middle text-center p-2",children:g.jsx("input",{type:"checkbox",checked:x.has(N.id),onChange:()=>te(N.id),className:"w-4 h-4 accent-blue-600"})}),g.jsx("td",{className:"border border-slate-300 p-2 font-medium text-slate-800",children:Z?g.jsx("a",{href:Z,target:"_blank",rel:"noopener noreferrer",className:"hover:underline",children:N.name}):g.jsx("span",{children:N.name})}),g.jsx("td",{className:"border border-slate-300 p-2 text-slate-600",children:g.jsxs("div",{className:"flex items-center gap-2",children:[Ee(N.type),g.jsx("span",{children:N.type})]})}),g.jsx("td",{className:"border border-slate-300 p-2 text-slate-600 truncate",children:N.taskName}),g.jsx("td",{className:"border border-slate-300 p-2 text-slate-600 truncate",children:N.subStepName}),g.jsx("td",{className:"border border-slate-300 p-2 text-slate-600 truncate",children:N.actionItemName})]},N.id)})})]})}),g.jsxs("footer",{className:"flex-shrink-0 p-4 bg-white border-t flex justify-between items-center rounded-b-xl",children:[g.jsxs("span",{className:"text-sm text-slate-600",children:[x.size," / ",W.length," "]}),g.jsx("button",{onClick:()=>m("generate"),disabled:x.size===0,className:"px-6 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700 disabled:bg-slate-400 disabled:cursor-not-allowed",children:""})]})]}),Y=()=>g.jsxs(g.Fragment,{children:[g.jsxs("main",{className:"flex-grow p-6 overflow-y-auto grid grid-cols-1 md:grid-cols-2 gap-6",children:[g.jsxs("div",{children:[g.jsxs("h4",{className:"font-semibold text-lg text-slate-800 mb-2",children:[" (",de.length,")"]}),g.jsx("div",{className:"bg-slate-50 border rounded-lg p-3 max-h-96 overflow-y-auto space-y-2",children:de.map(N=>g.jsxs("div",{className:"text-sm text-slate-700 flex items-center gap-2",children:[Ee(N.type),g.jsx("span",{className:"truncate",title:N.name,children:N.name})]},N.id))}),g.jsx("h4",{className:"font-semibold text-lg text-slate-800 mt-6 mb-2",children:""}),g.jsxs("div",{className:"flex gap-4",children:[g.jsxs("label",{className:"flex items-center gap-2 p-3 border rounded-lg cursor-pointer flex-1 hover:bg-slate-50",children:[g.jsx("input",{type:"radio",name:"reportFormat",value:"slides",checked:U==="slides",onChange:()=>G("slides"),className:"w-4 h-4 accent-blue-600"}),""]}),g.jsxs("label",{className:"flex items-center gap-2 p-3 border rounded-lg cursor-pointer flex-1 hover:bg-slate-50",children:[g.jsx("input",{type:"radio",name:"reportFormat",value:"text",checked:U==="text",onChange:()=>G("text"),className:"w-4 h-4 accent-blue-600"}),""]})]})]}),g.jsxs("div",{children:[g.jsx("h4",{className:"font-semibold text-lg text-slate-800 mb-2",children:""}),g.jsx("textarea",{value:_,onChange:N=>E(N.target.value),placeholder:"",rows:6,className:"w-full p-3 border border-slate-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition text-sm"}),C&&g.jsx("div",{className:"mt-2",children:g.jsx(uc,{message:C})}),J&&g.jsxs("div",{className:"mt-4 p-4 border rounded-lg bg-slate-50",children:[g.jsx("h5",{className:"font-semibold text-md text-slate-800 mb-2",children:""}),g.jsx("pre",{className:"text-sm text-slate-700 bg-white p-3 rounded whitespace-pre-wrap max-h-60 overflow-y-auto",children:J}),g.jsx("button",{onClick:()=>navigator.clipboard.writeText(J),className:"text-xs mt-2 px-2 py-1 bg-slate-200 rounded",children:""})]})]})]}),g.jsxs("footer",{className:"flex-shrink-0 p-4 bg-white border-t flex justify-between items-center rounded-b-xl",children:[g.jsxs("button",{onClick:()=>{m("list"),F(null)},className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-slate-700 bg-slate-100 border border-slate-300 rounded-md shadow-sm hover:bg-slate-200",children:[g.jsx(A2,{className:"w-4 h-4"}),""]}),g.jsxs("button",{onClick:Ie,disabled:w,className:"flex items-center gap-2 px-6 py-2 text-sm font-medium text-white bg-green-600 rounded-md shadow-sm hover:bg-green-700 disabled:bg-slate-400",children:[w?g.jsx(ia,{size:"sm",color:"border-white"}):g.jsx(cc,{className:"w-5 h-5"}),g.jsx("span",{children:w?"...":""})]})]})]});return g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex flex-col p-4 sm:p-6 md:p-8 z-[70]",children:g.jsxs("div",{className:"bg-slate-100 rounded-xl shadow-2xl w-full h-full flex flex-col",children:[g.jsxs("header",{className:"flex-shrink-0 flex items-center justify-between p-4 border-b border-slate-200 bg-white rounded-t-xl",children:[g.jsxs("h3",{className:"text-xl font-bold text-slate-800 flex items-center gap-3",children:[g.jsx(Wo,{className:"w-7 h-7 text-blue-600"}),g.jsx("span",{children:""})]}),g.jsx("button",{onClick:l,className:"p-1.5 rounded-full hover:bg-slate-100",children:g.jsx(ca,{className:"w-6 h-6 text-slate-500"})})]}),p==="list"?re():Y()]})})},sD=({tasks:e,projectGoal:t,targetDate:n,onSelectTask:r,onUpdateTaskExtendedDetails:a,onUpdateTaskPosition:l,onUpdateTaskStatus:c,onStartNewProject:u,onExportProject:p,onAddTask:m,onRemoveTask:x,onImportSingleTask:y,onAutoLayout:_,onUndo:E,canUndo:w,onRedo:S,canRedo:C,generateUniqueId:M,onUpdateTaskConnections:k,ganttData:b,setGanttData:U,onCustomReportGenerated:G,onClearApiKey:J})=>{he.useRef(null);const F=he.useRef(null),[W,O]=he.useState(new Map),[ee,ne]=he.useState([]),te=he.useRef(null),_e=he.useRef({x:0,y:0}),[Ie,Ee]=he.useState(!1),[ae,de]=he.useState(!1),[re,Y]=he.useState(null),[N,Z]=he.useState(!1),[D,H]=he.useState(null),[q,j]=he.useState(!1),[se,Te]=he.useState(null),[Ae,Re]=he.useState(!1),[Ce,Xe]=he.useState(null),[X,ut]=he.useState(!1),[Ke,pt]=he.useState(!1),[Me,ve]=he.useState(null),[Ge,je]=he.useState(!1),[Pt,Ct]=he.useState(!1),[en,dt]=he.useState(null),[on,Bn]=he.useState({x:0,y:0});he.useEffect(()=>{const Pe=new Map;e.forEach(st=>{Pe.set(st.id,W.get(st.id)||he.createRef())}),O(Pe)},[e]);const Jt=he.useCallback(()=>{if(!F.current||W.size===0){ne([]);return}const Pe=[];e.forEach(st=>{var gt,cn;if(st.nextTaskIds&&st.nextTaskIds.length>0){const In=W.get(st.id),Cn=In==null?void 0:In.current;if(!Cn)return;const Dr=((gt=st.position)==null?void 0:gt.x)||0,Na=((cn=st.position)==null?void 0:cn.y)||0,Vn=Cn.getBoundingClientRect(),tn={x:Dr+Vn.width,y:Na+Vn.height/2};st.nextTaskIds.forEach(nn=>{var B,z;const dr=e.find(ue=>ue.id===nn);if(!dr)return;const Mt=W.get(nn),Ma=Mt==null?void 0:Mt.current;if(!Ma)return;const R=((B=dr.position)==null?void 0:B.x)||0,V=((z=dr.position)==null?void 0:z.y)||0,L=Ma.getBoundingClientRect(),P={x:R,y:V+L.height/2};Pe.push({id:`conn-${st.id}-${nn}`,from:tn,to:P,sourceId:st.id,targetId:nn})})}}),ne(Pe)},[e,W]);he.useEffect(()=>{const Pe=setTimeout(Jt,50);return()=>clearTimeout(Pe)},[Jt,e]),he.useEffect(()=>{window.addEventListener("resize",Jt);const Pe=new MutationObserver(Jt);return F.current&&Pe.observe(F.current,{childList:!0,subtree:!0,attributes:!0,characterData:!0}),()=>{window.removeEventListener("resize",Jt),Pe.disconnect()}},[Jt]);const Xt=(Pe,st)=>{var cn,In;te.current=st;const gt=e.find(Cn=>Cn.id===st);if(F.current){const Cn=F.current.getBoundingClientRect();_e.current.x=Pe.clientX-Cn.left-(((cn=gt==null?void 0:gt.position)==null?void 0:cn.x)||0),_e.current.y=Pe.clientY-Cn.top-(((In=gt==null?void 0:gt.position)==null?void 0:In.y)||0)}Pe.dataTransfer.effectAllowed="move"},Ut=Pe=>{Pe.preventDefault(),Pe.dataTransfer.dropEffect="move"},at=Pe=>{var tn;if(Pe.preventDefault(),!te.current||!F.current)return;const st=F.current.getBoundingClientRect(),gt=(tn=W.get(te.current))==null?void 0:tn.current,cn=(gt==null?void 0:gt.offsetWidth)||380,In=(gt==null?void 0:gt.offsetHeight)||280;let Cn=Pe.clientX-st.left-_e.current.x,Dr=Pe.clientY-st.top-_e.current.y;const Na=F.current.scrollWidth,Vn=F.current.scrollHeight;Cn=Math.max(0,Math.min(Cn,Na-cn)),Dr=Math.max(0,Math.min(Dr,Vn-In)),l(te.current,{x:Cn,y:Dr}),te.current=null,setTimeout(Jt,0)},Ve=async()=>{Z(!0),H(null);try{const Pe=await LM(e,t,n);Y(Pe),de(!0)}catch(Pe){H(Pe instanceof Error?Pe.message:"")}finally{Z(!1)}},ht=async()=>{if(se){j(!0);return}Re(!0),Xe(null);try{const Pe=await OM(e,t,n);Te(Pe),j(!0)}catch(Pe){Xe(Pe instanceof Error?Pe.message:"")}finally{Re(!1)}},Yt=async()=>{if(b){ut(!0);return}pt(!0),ve(null);try{const Pe=await wv(e,t,n);U(Pe),ut(!0)}catch(Pe){ve(Pe instanceof Error?Pe.message:"")}finally{pt(!1)}},_t=async()=>{pt(!0),ve(null);try{const Pe=await wv(e,t,n);U(Pe)}catch(Pe){ve(Pe instanceof Error?Pe.message:"")}finally{pt(!1)}},Dn=(Pe,st)=>{if(!F.current)return;const gt=F.current.getBoundingClientRect(),cn={x:st.clientX-gt.left+F.current.scrollLeft,y:st.clientY-gt.top+F.current.scrollTop};dt({fromId:Pe,fromPos:cn})},Yn=Pe=>{if(!en||en.fromId===Pe){dt(null);return}const st=e.find(gt=>gt.id===en.fromId);if(st){const gt=Array.from(new Set([...st.nextTaskIds||[],Pe]));k(st.id,gt)}dt(null)},Jr=(Pe,st)=>{const gt=e.find(cn=>cn.id===Pe);if(gt){const cn=(gt.nextTaskIds||[]).filter(In=>In!==st);k(gt.id,cn)}},Rr=Pe=>{if(!en||!F.current)return;const st=F.current.getBoundingClientRect();Bn({x:Pe.clientX-st.left+F.current.scrollLeft,y:Pe.clientY-st.top+F.current.scrollTop})},ti=()=>{en&&dt(null)},Aa=Pe=>{const st=Pe.type==="task"?Pe.id:Pe.parentId;if(!st)return;const gt=e.find(cn=>cn.id===st);gt&&(ut(!1),r(gt))},ba=Pe=>{G(Pe),Ct(!1)},ka=n?new Date(n+"T00:00:00Z").toLocaleDateString("ja-JP",{year:"numeric",month:"long",day:"numeric"}):"";return q&&se?g.jsx(Dh,{tasks:e,initialDeck:se,onSave:Pe=>Te(Pe),onClose:()=>j(!1),projectGoal:t,targetDate:n,reportScope:"project",generateUniqueId:M}):g.jsxs(g.Fragment,{children:[g.jsxs("div",{className:"min-h-screen bg-slate-100 p-4 md:p-6 flex flex-col overflow-hidden",children:[g.jsxs("div",{className:"max-w-full mx-auto w-full",children:[g.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4 mb-6",children:[g.jsxs("button",{onClick:()=>je(!0),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-slate-600 hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-500 transition-transform hover:scale-105",children:[g.jsx(Yu,{className:"w-5 h-5 mr-2"}),""]}),g.jsxs("div",{className:"flex flex-wrap gap-2",children:[g.jsx("button",{onClick:E,disabled:!w,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-slate-800 bg-white hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-400 disabled:bg-slate-300 disabled:cursor-not-allowed",title:"",children:g.jsx(M2,{className:"w-5 h-5"})}),g.jsx("button",{onClick:S,disabled:!C,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-slate-800 bg-white hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-400 disabled:bg-slate-300 disabled:cursor-not-allowed",title:"",children:g.jsx(R2,{className:"w-5 h-5"})}),g.jsx("button",{onClick:J,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-slate-800 bg-white hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-400",title:"API",children:g.jsx(F2,{className:"w-5 h-5 text-yellow-600"})}),g.jsxs("button",{onClick:m,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700",children:[g.jsx(Nh,{className:"w-5 h-5 mr-2"}),""]}),g.jsxs("button",{onClick:p,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700",children:[g.jsx(hf,{className:"w-5 h-5 mr-2"}),""]}),g.jsxs("button",{onClick:_,className:"inline-flex items-center px-4 py-2 border border-slate-300 text-sm font-medium rounded-md shadow-sm text-slate-700 bg-white hover:bg-slate-50",title:"",children:[g.jsx(xf,{className:"w-5 h-5 mr-2"}),""]})]})]}),g.jsxs("header",{className:"mb-6 p-6 bg-white rounded-xl shadow-lg",children:[g.jsxs("div",{className:"flex flex-wrap justify-between items-start gap-4",children:[g.jsxs("div",{children:[g.jsx("h1",{className:"text-3xl font-bold text-slate-800 mb-3",children:""}),g.jsxs("div",{className:"space-y-2 text-slate-700",children:[g.jsxs("p",{className:"flex items-start",children:[g.jsx(C2,{className:"w-5 h-5 mr-2 text-blue-600 flex-shrink-0 mt-1"}),g.jsx("strong",{children:":"}),"",g.jsx("span",{className:"break-all",children:t})]}),g.jsxs("p",{className:"flex items-center",children:[g.jsx(w2,{className:"w-5 h-5 mr-2 text-blue-600 flex-shrink-0"}),g.jsx("strong",{children:":"}),"",ka]})]})]}),g.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 flex-shrink-0",children:[g.jsxs("button",{onClick:()=>Ee(!0),className:"inline-flex items-center justify-center px-4 py-2 border border-slate-300 text-sm font-medium rounded-md shadow-sm text-slate-700 bg-white hover:bg-slate-50",children:[g.jsx(D2,{className:"w-5 h-5 mr-2"}),""]}),g.jsxs("button",{onClick:()=>Ct(!0),className:"inline-flex items-center justify-center px-4 py-2 border border-slate-300 text-sm font-medium rounded-md shadow-sm text-slate-700 bg-white hover:bg-slate-50",children:[g.jsx(Wo,{className:"w-5 h-5 mr-2"}),""]}),g.jsxs("button",{onClick:Yt,disabled:Ke,className:"inline-flex items-center justify-center px-4 py-2 border border-amber-300 text-sm font-medium rounded-md shadow-sm text-amber-800 bg-amber-100 hover:bg-amber-200 disabled:bg-slate-400",children:[Ke?g.jsx(ia,{size:"sm"}):g.jsx(I2,{className:"w-5 h-5 mr-2"}),""]}),g.jsxs("button",{onClick:Ve,disabled:N,className:"inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-purple-600 hover:bg-purple-700 disabled:bg-slate-400",children:[N?g.jsx(ia,{size:"sm"}):g.jsx(cc,{className:"w-5 h-5 mr-2"}),"AI"]}),g.jsxs("button",{onClick:ht,disabled:Ae,className:"inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-teal-600 hover:bg-teal-700 disabled:bg-slate-400",children:[Ae?g.jsx(ia,{size:"sm"}):g.jsx(N2,{className:"w-5 h-5 mr-2"}),""]})]})]}),D&&g.jsx("div",{className:"mt-4",children:g.jsx("p",{className:"text-red-600 text-sm",children:D})}),Ce&&g.jsx("div",{className:"mt-4",children:g.jsx("p",{className:"text-red-600 text-sm",children:Ce})}),Me&&g.jsx("div",{className:"mt-4",children:g.jsx("p",{className:"text-red-600 text-sm",children:Me})})]})]}),g.jsxs("div",{ref:F,className:"flex-grow overflow-auto pb-8 relative min-h-[600px] border border-slate-300 rounded-lg bg-slate-50 p-4 shadow-inner",onDragOver:Ut,onDrop:at,onMouseMove:Rr,onMouseUp:ti,children:[g.jsxs("div",{className:"relative w-full h-full min-w-[1200px] min-h-[800px]",children:[e.map((Pe,st)=>g.jsx(eR,{cardRef:W.get(Pe.id),task:Pe,onSelectTask:r,onRemoveTask:x,onUpdateStatus:c,onDragCardStart:Xt,onStartConnection:Dn,onEndConnection:Yn,index:st},Pe.id)),ee.map(Pe=>g.jsx(Xo,{from:Pe.from,to:Pe.to,id:Pe.id,onDelete:()=>Jr(Pe.sourceId,Pe.targetId)},Pe.id)),en&&g.jsx(Xo,{from:en.fromPos,to:on,id:"preview-connector"})]}),e.length===0&&g.jsx("div",{className:"text-center py-10 flex-grow flex items-center justify-center",children:g.jsx("p",{className:"text-slate-500 text-lg",children:""})})]})]}),X&&b&&g.jsx(rD,{data:b,onClose:()=>ut(!1),onItemClick:Aa,onRegenerate:_t,isRegenerating:Ke}),Pt&&g.jsx(iD,{tasks:e,projectGoal:t,targetDate:n,ganttData:b,projectReportDeck:se,onClose:()=>Ct(!1),onReportGenerated:ba,generateUniqueId:M}),Ie&&g.jsx(tR,{tasks:e,onClose:()=>Ee(!1)}),ae&&g.jsx(nR,{report:re,onClose:()=>de(!1)}),Ge&&g.jsx(cR,{onClose:()=>je(!1),onDownloadAndStartNew:()=>{p(),u()},onStartNewWithoutSaving:u})]})},lD=({proposals:e,existingSubSteps:t,onConfirm:n,onClose:r})=>{const[a,l]=he.useState(()=>{const p={};return e.forEach((m,x)=>{p[x]={decision:"NEW",targetSubStepId:void 0}}),p}),c=(p,m,x)=>{l(y=>({...y,[p]:{...y[p],[m]:x}}))},u=()=>{const p=[],m=[];Object.entries(a).forEach(([x,y])=>{const _=parseInt(x,10),E=e[_];y.decision==="NEW"?p.push(E):y.decision==="ADD"&&y.targetSubStepId&&m.push({targetSubStepId:y.targetSubStepId,title:E.title})}),n({newSubSteps:p,newActionItems:m})};return g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[60]",children:g.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-3xl max-h-[90vh] flex flex-col",children:[g.jsxs("header",{className:"flex items-center justify-between p-5 border-b border-slate-200",children:[g.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"AI"}),g.jsx("button",{onClick:r,className:"p-1 rounded-full hover:bg-slate-100",children:g.jsx(ca,{className:"w-6 h-6 text-slate-500"})})]}),g.jsxs("div",{className:"flex-grow p-5 overflow-y-auto space-y-4",children:[g.jsx("p",{className:"text-sm text-slate-600",children:"AI"}),g.jsx("div",{className:"space-y-3",children:e.map((p,m)=>g.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border border-slate-200",children:[g.jsx("p",{className:"font-semibold text-slate-800",children:p.title}),g.jsx("p",{className:"text-sm text-slate-600 mb-3",children:p.description}),g.jsxs("div",{className:"flex items-center gap-4",children:[g.jsxs("select",{value:a[m].decision,onChange:x=>c(m,"decision",x.target.value),className:"p-2 border border-slate-300 rounded-md text-sm",children:[g.jsx("option",{value:"NEW",children:""}),t.length>0&&g.jsx("option",{value:"ADD",children:""}),g.jsx("option",{value:"IGNORE",children:""})]}),a[m].decision==="ADD"&&g.jsxs("select",{value:a[m].targetSubStepId||"",onChange:x=>c(m,"targetSubStepId",x.target.value),className:"flex-grow p-2 border border-slate-300 rounded-md text-sm",children:[g.jsx("option",{value:"",disabled:!0,children:"..."}),t.map(x=>g.jsx("option",{value:x.id,children:x.text},x.id))]})]})]},m))})]}),g.jsxs("footer",{className:"p-5 bg-slate-100 border-t flex justify-end gap-3",children:[g.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md shadow-sm hover:bg-slate-50",children:""}),g.jsx("button",{onClick:u,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700",children:""})]})]})})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var z2=1252,oD=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Lh={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Oh=function(e){oD.indexOf(e)!=-1&&(z2=Lh[0]=e)};function cD(){Oh(1252)}var ra=function(e){Oh(e)};function q2(){ra(1200),cD()}function Pv(e){for(var t=[],n=0,r=e.length;n<r;++n)t[n]=e.charCodeAt(n);return t}function uD(e){for(var t=[],n=0;n<e.length>>1;++n)t[n]=String.fromCharCode(e.charCodeAt(2*n)+(e.charCodeAt(2*n+1)<<8));return t.join("")}function $2(e){for(var t=[],n=0;n<e.length>>1;++n)t[n]=String.fromCharCode(e.charCodeAt(2*n+1)+(e.charCodeAt(2*n)<<8));return t.join("")}var Ro=function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1);return t==255&&n==254?uD(e.slice(2)):t==254&&n==255?$2(e.slice(2)):t==65279?e.slice(1):e},bu=function(t){return String.fromCharCode(t)},Uv=function(t){return String.fromCharCode(t)},Ko,ki="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Bv(e){for(var t="",n=0,r=0,a=0,l=0,c=0,u=0,p=0,m=0;m<e.length;)n=e.charCodeAt(m++),l=n>>2,r=e.charCodeAt(m++),c=(n&3)<<4|r>>4,a=e.charCodeAt(m++),u=(r&15)<<2|a>>6,p=a&63,isNaN(r)?u=p=64:isNaN(a)&&(p=64),t+=ki.charAt(l)+ki.charAt(c)+ki.charAt(u)+ki.charAt(p);return t}function Mr(e){var t="",n=0,r=0,a=0,l=0,c=0,u=0,p=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var m=0;m<e.length;)l=ki.indexOf(e.charAt(m++)),c=ki.indexOf(e.charAt(m++)),n=l<<2|c>>4,t+=String.fromCharCode(n),u=ki.indexOf(e.charAt(m++)),r=(c&15)<<4|u>>2,u!==64&&(t+=String.fromCharCode(r)),p=ki.indexOf(e.charAt(m++)),a=(u&3)<<6|p,p!==64&&(t+=String.fromCharCode(a));return t}var St=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),vs=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,n){return n?new Buffer(t,n):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Oi(e){return St?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Vv(e){return St?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var na=function(t){return St?vs(t,"binary"):t.split("").map(function(n){return n.charCodeAt(0)&255})};function ys(e){if(Array.isArray(e))return e.map(function(r){return String.fromCharCode(r)}).join("");for(var t=[],n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}function Ph(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Ph(new Uint8Array(e));for(var t=new Array(e.length),n=0;n<e.length;++n)t[n]=e[n];return t}var bi=St?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:vs(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,n=0;for(t=0;t<e.length;++t)n+=e[t].length;var r=new Uint8Array(n),a=0;for(t=0,n=0;t<e.length;n+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)r.set(e[t],n);else{if(typeof e[t]=="string")throw"wtf";r.set(new Uint8Array(e[t]),n)}return r}return[].concat.apply([],e.map(function(l){return Array.isArray(l)?l:[].slice.call(l)}))};function fD(e){for(var t=[],n=0,r=e.length+250,a=Oi(e.length+255),l=0;l<e.length;++l){var c=e.charCodeAt(l);if(c<128)a[n++]=c;else if(c<2048)a[n++]=192|c>>6&31,a[n++]=128|c&63;else if(c>=55296&&c<57344){c=(c&1023)+64;var u=e.charCodeAt(++l)&1023;a[n++]=240|c>>8&7,a[n++]=128|c>>2&63,a[n++]=128|u>>6&15|(c&3)<<4,a[n++]=128|u&63}else a[n++]=224|c>>12&15,a[n++]=128|c>>6&63,a[n++]=128|c&63;n>r&&(t.push(a.slice(0,n)),n=0,a=Oi(65535),r=65530)}return t.push(a.slice(0,n)),bi(t)}var cr=/\u0000/g,Do=/[\u0001-\u0006]/g;function ml(e){for(var t="",n=e.length-1;n>=0;)t+=e.charAt(n--);return t}function aa(e,t){var n=""+e;return n.length>=t?n:mn("0",t-n.length)+n}function Uh(e,t){var n=""+e;return n.length>=t?n:mn(" ",t-n.length)+n}function Xu(e,t){var n=""+e;return n.length>=t?n:n+mn(" ",t-n.length)}function dD(e,t){var n=""+Math.round(e);return n.length>=t?n:mn("0",t-n.length)+n}function hD(e,t){var n=""+e;return n.length>=t?n:mn("0",t-n.length)+n}var Hv=Math.pow(2,32);function ll(e,t){if(e>Hv||e<-Hv)return dD(e,t);var n=Math.round(e);return hD(n,t)}function Ku(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Gv=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Fd=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function mD(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var lt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},jv={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},pD={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Zu(e,t,n){for(var r=e<0?-1:1,a=e*r,l=0,c=1,u=0,p=1,m=0,x=0,y=Math.floor(a);m<t&&(y=Math.floor(a),u=y*c+l,x=y*m+p,!(a-y<5e-8));)a=1/(a-y),l=c,c=u,p=m,m=x;if(x>t&&(m>t?(x=p,u=l):(x=m,u=c)),!n)return[0,r*u,x];var _=Math.floor(r*u/x);return[_,r*u-_*x,x]}function is(e,t,n){if(e>2958465||e<0)return null;var r=e|0,a=Math.floor(86400*(e-r)),l=0,c=[],u={D:r,T:a,u:86400*(e-r)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),t&&t.date1904&&(r+=1462),u.u>.9999&&(u.u=0,++a==86400&&(u.T=a=0,++r,++u.D)),r===60)c=n?[1317,10,29]:[1900,2,29],l=3;else if(r===0)c=n?[1317,8,29]:[1900,1,0],l=6;else{r>60&&--r;var p=new Date(1900,0,1);p.setDate(p.getDate()+r-1),c=[p.getFullYear(),p.getMonth()+1,p.getDate()],l=p.getDay(),r<60&&(l=(l+6)%7),n&&(l=_D(p,c))}return u.y=c[0],u.m=c[1],u.d=c[2],u.S=a%60,a=Math.floor(a/60),u.M=a%60,a=Math.floor(a/60),u.H=a,u.q=l,u}var Y2=new Date(1899,11,31,0,0,0),xD=Y2.getTime(),gD=new Date(1900,2,1,0,0,0);function W2(e,t){var n=e.getTime();return t?n-=1461*24*60*60*1e3:e>=gD&&(n+=24*60*60*1e3),(n-(xD+(e.getTimezoneOffset()-Y2.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Bh(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function vD(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function yD(e){var t=e<0?12:11,n=Bh(e.toFixed(12));return n.length<=t||(n=e.toPrecision(10),n.length<=t)?n:e.toExponential(5)}function TD(e){var t=Bh(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Zo(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),n;return t>=-4&&t<=-1?n=e.toPrecision(10+t):Math.abs(t)<=9?n=yD(e):t===10?n=e.toFixed(10).substr(0,12):n=TD(e),Bh(vD(n.toUpperCase()))}function hs(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Zo(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return $r(14,W2(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function _D(e,t){t[0]-=581;var n=e.getDay();return e<60&&(n=(n+6)%7),n}function ED(e,t,n,r){var a="",l=0,c=0,u=n.y,p,m=0;switch(e){case 98:u=n.y+543;case 121:switch(t.length){case 1:case 2:p=u%100,m=2;break;default:p=u%1e4,m=4;break}break;case 109:switch(t.length){case 1:case 2:p=n.m,m=t.length;break;case 3:return Fd[n.m-1][1];case 5:return Fd[n.m-1][0];default:return Fd[n.m-1][2]}break;case 100:switch(t.length){case 1:case 2:p=n.d,m=t.length;break;case 3:return Gv[n.q][0];default:return Gv[n.q][1]}break;case 104:switch(t.length){case 1:case 2:p=1+(n.H+11)%12,m=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:p=n.H,m=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:p=n.M,m=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return n.u===0&&(t=="s"||t=="ss")?aa(n.S,t.length):(r>=2?c=r===3?1e3:100:c=r===1?10:1,l=Math.round(c*(n.S+n.u)),l>=60*c&&(l=0),t==="s"?l===0?"0":""+l/c:(a=aa(l,2+r),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":p=n.D*24+n.H;break;case"[m]":case"[mm]":p=(n.D*24+n.H)*60+n.M;break;case"[s]":case"[ss]":p=((n.D*24+n.H)*60+n.M)*60+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+t}m=t.length===3?1:2;break;case 101:p=u,m=1;break}var x=m>0?aa(p,m):"";return x}function Ni(e){var t=3;if(e.length<=t)return e;for(var n=e.length%t,r=e.substr(0,n);n!=e.length;n+=t)r+=(r.length>0?",":"")+e.substr(n,t);return r}var J2=/%/g;function SD(e,t,n){var r=t.replace(J2,""),a=t.length-r.length;return $a(e,r,n*Math.pow(10,2*a))+mn("%",a)}function wD(e,t,n){for(var r=t.length-1;t.charCodeAt(r-1)===44;)--r;return $a(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}function X2(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+X2(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var l=Math.floor(Math.log(t)*Math.LOG10E)%a;if(l<0&&(l+=a),n=(t/Math.pow(10,l)).toPrecision(r+1+(a+l)%a),n.indexOf("e")===-1){var c=Math.floor(Math.log(t)*Math.LOG10E);for(n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(c-n.length+l):n+="E+"+(c-l);n.substr(0,2)==="0.";)n=n.charAt(0)+n.substr(2,a)+"."+n.substr(2+a),n=n.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,p,m,x){return p+m+x.substr(0,(a+l)%a)+"."+x.substr(l)+"E"})}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}var K2=/# (\?+)( ?)\/( ?)(\d+)/;function CD(e,t,n){var r=parseInt(e[4],10),a=Math.round(t*r),l=Math.floor(a/r),c=a-l*r,u=r;return n+(l===0?"":""+l)+" "+(c===0?mn(" ",e[1].length+1+e[4].length):Uh(c,e[1].length)+e[2]+"/"+e[3]+aa(u,e[4].length))}function AD(e,t,n){return n+(t===0?"":""+t)+mn(" ",e[1].length+2+e[4].length)}var Z2=/^#*0*\.([0#]+)/,Q2=/\).*[0#]/,eT=/\(###\) ###\\?-####/;function sr(e){for(var t="",n,r=0;r!=e.length;++r)switch(n=e.charCodeAt(r)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(n)}return t}function zv(e,t){var n=Math.pow(10,t);return""+Math.round(e*n)/n}function qv(e,t){var n=e-Math.floor(e),r=Math.pow(10,t);return t<(""+Math.round(n*r)).length?0:Math.round(n*r)}function bD(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function kD(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function jr(e,t,n){if(e.charCodeAt(0)===40&&!t.match(Q2)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?jr("n",r,n):"("+jr("n",r,-n)+")"}if(t.charCodeAt(t.length-1)===44)return wD(e,t,n);if(t.indexOf("%")!==-1)return SD(e,t,n);if(t.indexOf("E")!==-1)return X2(t,n);if(t.charCodeAt(0)===36)return"$"+jr(e,t.substr(t.charAt(1)==" "?2:1),n);var a,l,c,u,p=Math.abs(n),m=n<0?"-":"";if(t.match(/^00+$/))return m+ll(p,t.length);if(t.match(/^[#?]+$/))return a=ll(n,0),a==="0"&&(a=""),a.length>t.length?a:sr(t.substr(0,t.length-a.length))+a;if(l=t.match(K2))return CD(l,p,m);if(t.match(/^#+0+$/))return m+ll(p,t.length-t.indexOf("0"));if(l=t.match(Z2))return a=zv(n,l[1].length).replace(/^([^\.]+)$/,"$1."+sr(l[1])).replace(/\.$/,"."+sr(l[1])).replace(/\.(\d*)$/,function(w,S){return"."+S+mn("0",sr(l[1]).length-S.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),l=t.match(/^(0*)\.(#*)$/))return m+zv(p,l[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=t.match(/^#{1,3},##0(\.?)$/))return m+Ni(ll(p,0));if(l=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+jr(e,t,-n):Ni(""+(Math.floor(n)+bD(n,l[1].length)))+"."+aa(qv(n,l[1].length),l[1].length);if(l=t.match(/^#,#*,#0/))return jr(e,t.replace(/^#,#*,/,""),n);if(l=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=ml(jr(e,t.replace(/[\\-]/g,""),n)),c=0,ml(ml(t.replace(/\\/g,"")).replace(/[0#]/g,function(w){return c<a.length?a.charAt(c++):w==="0"?"0":""}));if(t.match(eT))return a=jr(e,"##########",n),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var x="";if(l=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(l[4].length,7),u=Zu(p,Math.pow(10,c)-1,!1),a=""+m,x=$a("n",l[1],u[1]),x.charAt(x.length-1)==" "&&(x=x.substr(0,x.length-1)+"0"),a+=x+l[2]+"/"+l[3],x=Xu(u[2],c),x.length<l[4].length&&(x=sr(l[4].substr(l[4].length-x.length))+x),a+=x,a;if(l=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(l[1].length,l[4].length),7),u=Zu(p,Math.pow(10,c)-1,!0),m+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Uh(u[1],c)+l[2]+"/"+l[3]+Xu(u[2],c):mn(" ",2*c+1+l[2].length+l[3].length));if(l=t.match(/^[#0?]+$/))return a=ll(n,0),t.length<=a.length?a:sr(t.substr(0,t.length-a.length))+a;if(l=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+n.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),c=a.indexOf(".");var y=t.indexOf(".")-c,_=t.length-a.length-y;return sr(t.substr(0,y)+a+t.substr(t.length-_))}if(l=t.match(/^00,000\.([#0]*0)$/))return c=qv(n,l[1].length),n<0?"-"+jr(e,t,-n):Ni(kD(n)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?aa(0,3-w.length):"")+w})+"."+aa(c,l[1].length);switch(t){case"###,##0.00":return jr(e,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var E=Ni(ll(p,0));return E!=="0"?m+E:"";case"###,###.00":return jr(e,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return jr(e,"#,##0.00",n).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function ND(e,t,n){for(var r=t.length-1;t.charCodeAt(r-1)===44;)--r;return $a(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}function MD(e,t,n){var r=t.replace(J2,""),a=t.length-r.length;return $a(e,r,n*Math.pow(10,2*a))+mn("%",a)}function tT(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+tT(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var l=Math.floor(Math.log(t)*Math.LOG10E)%a;if(l<0&&(l+=a),n=(t/Math.pow(10,l)).toPrecision(r+1+(a+l)%a),!n.match(/[Ee]/)){var c=Math.floor(Math.log(t)*Math.LOG10E);n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(c-n.length+l):n+="E+"+(c-l),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,p,m,x){return p+m+x.substr(0,(a+l)%a)+"."+x.substr(l)+"E"})}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}function ga(e,t,n){if(e.charCodeAt(0)===40&&!t.match(Q2)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?ga("n",r,n):"("+ga("n",r,-n)+")"}if(t.charCodeAt(t.length-1)===44)return ND(e,t,n);if(t.indexOf("%")!==-1)return MD(e,t,n);if(t.indexOf("E")!==-1)return tT(t,n);if(t.charCodeAt(0)===36)return"$"+ga(e,t.substr(t.charAt(1)==" "?2:1),n);var a,l,c,u,p=Math.abs(n),m=n<0?"-":"";if(t.match(/^00+$/))return m+aa(p,t.length);if(t.match(/^[#?]+$/))return a=""+n,n===0&&(a=""),a.length>t.length?a:sr(t.substr(0,t.length-a.length))+a;if(l=t.match(K2))return AD(l,p,m);if(t.match(/^#+0+$/))return m+aa(p,t.length-t.indexOf("0"));if(l=t.match(Z2))return a=(""+n).replace(/^([^\.]+)$/,"$1."+sr(l[1])).replace(/\.$/,"."+sr(l[1])),a=a.replace(/\.(\d*)$/,function(w,S){return"."+S+mn("0",sr(l[1]).length-S.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),l=t.match(/^(0*)\.(#*)$/))return m+(""+p).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=t.match(/^#{1,3},##0(\.?)$/))return m+Ni(""+p);if(l=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+ga(e,t,-n):Ni(""+n)+"."+mn("0",l[1].length);if(l=t.match(/^#,#*,#0/))return ga(e,t.replace(/^#,#*,/,""),n);if(l=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=ml(ga(e,t.replace(/[\\-]/g,""),n)),c=0,ml(ml(t.replace(/\\/g,"")).replace(/[0#]/g,function(w){return c<a.length?a.charAt(c++):w==="0"?"0":""}));if(t.match(eT))return a=ga(e,"##########",n),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var x="";if(l=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(l[4].length,7),u=Zu(p,Math.pow(10,c)-1,!1),a=""+m,x=$a("n",l[1],u[1]),x.charAt(x.length-1)==" "&&(x=x.substr(0,x.length-1)+"0"),a+=x+l[2]+"/"+l[3],x=Xu(u[2],c),x.length<l[4].length&&(x=sr(l[4].substr(l[4].length-x.length))+x),a+=x,a;if(l=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(l[1].length,l[4].length),7),u=Zu(p,Math.pow(10,c)-1,!0),m+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Uh(u[1],c)+l[2]+"/"+l[3]+Xu(u[2],c):mn(" ",2*c+1+l[2].length+l[3].length));if(l=t.match(/^[#0?]+$/))return a=""+n,t.length<=a.length?a:sr(t.substr(0,t.length-a.length))+a;if(l=t.match(/^([#0]+)\.([#0]+)$/)){a=""+n.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),c=a.indexOf(".");var y=t.indexOf(".")-c,_=t.length-a.length-y;return sr(t.substr(0,y)+a+t.substr(t.length-_))}if(l=t.match(/^00,000\.([#0]*0)$/))return n<0?"-"+ga(e,t,-n):Ni(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?aa(0,3-w.length):"")+w})+"."+aa(0,l[1].length);switch(t){case"###,###":case"##,###":case"#,###":var E=Ni(""+p);return E!=="0"?m+E:"";default:if(t.match(/\.[0#?]*$/))return ga(e,t.slice(0,t.lastIndexOf(".")),n)+sr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function $a(e,t,n){return(n|0)===n?ga(e,t,n):jr(e,t,n)}function RD(e){for(var t=[],n=!1,r=0,a=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:n=!n;break;case 95:case 42:case 92:++r;break;case 59:t[t.length]=e.substr(a,r-a),a=r+1}if(t[t.length]=e.substr(a),n===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var nT=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function kl(e){for(var t=0,n="",r="";t<e.length;)switch(n=e.charAt(t)){case"G":Ku(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(r=n;e.charAt(t++)!=="]"&&t<e.length;)r+=e.charAt(t);if(r.match(nT))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(n=e.charAt(++t))>-1||n=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===n;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function DD(e,t,n,r){for(var a=[],l="",c=0,u="",p="t",m,x,y,_="H";c<e.length;)switch(u=e.charAt(c)){case"G":if(!Ku(e,c))throw new Error("unrecognized character "+u+" in "+e);a[a.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";(y=e.charCodeAt(++c))!==34&&c<e.length;)l+=String.fromCharCode(y);a[a.length]={t:"t",v:l},++c;break;case"\\":var E=e.charAt(++c),w=E==="("||E===")"?E:"t";a[a.length]={t:w,v:E},++c;break;case"_":a[a.length]={t:"t",v:" "},c+=2;break;case"@":a[a.length]={t:"T",v:t},++c;break;case"B":case"b":if(e.charAt(c+1)==="1"||e.charAt(c+1)==="2"){if(m==null&&(m=is(t,n,e.charAt(c+1)==="2"),m==null))return"";a[a.length]={t:"X",v:e.substr(c,2)},p=u,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||m==null&&(m=is(t,n),m==null))return"";for(l=u;++c<e.length&&e.charAt(c).toLowerCase()===u;)l+=u;u==="m"&&p.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=_),a[a.length]={t:u,v:l},p=u;break;case"A":case"a":case"":var S={t:u,v:u};if(m==null&&(m=is(t,n)),e.substr(c,3).toUpperCase()==="A/P"?(m!=null&&(S.v=m.H>=12?"P":"A"),S.t="T",_="h",c+=3):e.substr(c,5).toUpperCase()==="AM/PM"?(m!=null&&(S.v=m.H>=12?"PM":"AM"),S.t="T",c+=5,_="h"):e.substr(c,5).toUpperCase()==="/"?(m!=null&&(S.v=m.H>=12?"":""),S.t="T",c+=5,_="h"):(S.t="t",++c),m==null&&S.t==="T")return"";a[a.length]=S,p=u;break;case"[":for(l=u;e.charAt(c++)!=="]"&&c<e.length;)l+=e.charAt(c);if(l.slice(-1)!=="]")throw'unterminated "[" block: |'+l+"|";if(l.match(nT)){if(m==null&&(m=is(t,n),m==null))return"";a[a.length]={t:"Z",v:l.toLowerCase()},p=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",kl(e)||(a[a.length]={t:"t",v:l}));break;case".":if(m!=null){for(l=u;++c<e.length&&(u=e.charAt(c))==="0";)l+=u;a[a.length]={t:"s",v:l};break}case"0":case"#":for(l=u;++c<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(c))>-1;)l+=u;a[a.length]={t:"n",v:l};break;case"?":for(l=u;e.charAt(++c)===u;)l+=u;a[a.length]={t:u,v:l},p=u;break;case"*":++c,(e.charAt(c)==" "||e.charAt(c)=="*")&&++c;break;case"(":case")":a[a.length]={t:r===1?"t":u,v:u},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=u;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)l+=e.charAt(c);a[a.length]={t:"D",v:l};break;case" ":a[a.length]={t:u,v:u},++c;break;case"$":a[a.length]={t:"t",v:"$"},++c;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+e);a[a.length]={t:"t",v:u},++c;break}var C=0,M=0,k;for(c=a.length-1,p="t";c>=0;--c)switch(a[c].t){case"h":case"H":a[c].t=_,p="h",C<1&&(C=1);break;case"s":(k=a[c].v.match(/\.0+$/))&&(M=Math.max(M,k[0].length-1)),C<3&&(C=3);case"d":case"y":case"M":case"e":p=a[c].t;break;case"m":p==="s"&&(a[c].t="M",C<2&&(C=2));break;case"X":break;case"Z":C<1&&a[c].v.match(/[Hh]/)&&(C=1),C<2&&a[c].v.match(/[Mm]/)&&(C=2),C<3&&a[c].v.match(/[Ss]/)&&(C=3)}switch(C){case 0:break;case 1:m.u>=.5&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M),m.M>=60&&(m.M=0,++m.H);break;case 2:m.u>=.5&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M);break}var b="",U;for(c=0;c<a.length;++c)switch(a[c].t){case"t":case"T":case" ":case"D":break;case"X":a[c].v="",a[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[c].v=ED(a[c].t.charCodeAt(0),a[c].v,m,M),a[c].t="t";break;case"n":case"?":for(U=c+1;a[U]!=null&&((u=a[U].t)==="?"||u==="D"||(u===" "||u==="t")&&a[U+1]!=null&&(a[U+1].t==="?"||a[U+1].t==="t"&&a[U+1].v==="/")||a[c].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(a[U].v==="/"||a[U].v===" "&&a[U+1]!=null&&a[U+1].t=="?"));)a[c].v+=a[U].v,a[U]={v:"",t:";"},++U;b+=a[c].v,c=U-1;break;case"G":a[c].t="t",a[c].v=hs(t,n);break}var G="",J,F;if(b.length>0){b.charCodeAt(0)==40?(J=t<0&&b.charCodeAt(0)===45?-t:t,F=$a("n",b,J)):(J=t<0&&r>1?-t:t,F=$a("n",b,J),J<0&&a[0]&&a[0].t=="t"&&(F=F.substr(1),a[0].v="-"+a[0].v)),U=F.length-1;var W=a.length;for(c=0;c<a.length;++c)if(a[c]!=null&&a[c].t!="t"&&a[c].v.indexOf(".")>-1){W=c;break}var O=a.length;if(W===a.length&&F.indexOf("E")===-1){for(c=a.length-1;c>=0;--c)a[c]==null||"n?".indexOf(a[c].t)===-1||(U>=a[c].v.length-1?(U-=a[c].v.length,a[c].v=F.substr(U+1,a[c].v.length)):U<0?a[c].v="":(a[c].v=F.substr(0,U+1),U=-1),a[c].t="t",O=c);U>=0&&O<a.length&&(a[O].v=F.substr(0,U+1)+a[O].v)}else if(W!==a.length&&F.indexOf("E")===-1){for(U=F.indexOf(".")-1,c=W;c>=0;--c)if(!(a[c]==null||"n?".indexOf(a[c].t)===-1)){for(x=a[c].v.indexOf(".")>-1&&c===W?a[c].v.indexOf(".")-1:a[c].v.length-1,G=a[c].v.substr(x+1);x>=0;--x)U>=0&&(a[c].v.charAt(x)==="0"||a[c].v.charAt(x)==="#")&&(G=F.charAt(U--)+G);a[c].v=G,a[c].t="t",O=c}for(U>=0&&O<a.length&&(a[O].v=F.substr(0,U+1)+a[O].v),U=F.indexOf(".")+1,c=W;c<a.length;++c)if(!(a[c]==null||"n?(".indexOf(a[c].t)===-1&&c!==W)){for(x=a[c].v.indexOf(".")>-1&&c===W?a[c].v.indexOf(".")+1:0,G=a[c].v.substr(0,x);x<a[c].v.length;++x)U<F.length&&(G+=F.charAt(U++));a[c].v=G,a[c].t="t",O=c}}}for(c=0;c<a.length;++c)a[c]!=null&&"n?".indexOf(a[c].t)>-1&&(J=r>1&&t<0&&c>0&&a[c-1].v==="-"?-t:t,a[c].v=$a(a[c].t,a[c].v,J),a[c].t="t");var ee="";for(c=0;c!==a.length;++c)a[c]!=null&&(ee+=a[c].v);return ee}var $v=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Yv(e,t){if(t==null)return!1;var n=parseFloat(t[2]);switch(t[1]){case"=":if(e==n)return!0;break;case">":if(e>n)return!0;break;case"<":if(e<n)return!0;break;case"<>":if(e!=n)return!0;break;case">=":if(e>=n)return!0;break;case"<=":if(e<=n)return!0;break}return!1}function ID(e,t){var n=RD(e),r=n.length,a=n[r-1].indexOf("@");if(r<4&&a>-1&&--r,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if(typeof t!="number")return[4,n.length===4||a>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=a>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=a>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=a>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"];break}var l=t>0?n[0]:t<0?n[1]:n[2];if(n[0].indexOf("[")===-1&&n[1].indexOf("[")===-1)return[r,l];if(n[0].match(/\[[=<>]/)!=null||n[1].match(/\[[=<>]/)!=null){var c=n[0].match($v),u=n[1].match($v);return Yv(t,c)?[r,n[0]]:Yv(t,u)?[r,n[1]]:[r,n[c!=null&&u!=null?2:1]]}return[r,l]}function $r(e,t,n){n==null&&(n={});var r="";switch(typeof e){case"string":e=="m/d/yy"&&n.dateNF?r=n.dateNF:r=e;break;case"number":e==14&&n.dateNF?r=n.dateNF:r=(n.table!=null?n.table:lt)[e],r==null&&(r=n.table&&n.table[jv[e]]||lt[jv[e]]),r==null&&(r=pD[e]||"General");break}if(Ku(r,0))return hs(t,n);t instanceof Date&&(t=W2(t,n.date1904));var a=ID(r,t);if(Ku(a[1]))return hs(t,n);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return DD(a[1],t,n,a[0])}function ss(e,t){if(typeof t!="number"){t=+t||-1;for(var n=0;n<392;++n){if(lt[n]==null){t<0&&(t=n);continue}if(lt[n]==e){t=n;break}}t<0&&(t=391)}return lt[t]=e,t}function rT(){lt=mD()}var FD={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},aT=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function LD(e){var t=typeof e=="number"?lt[e]:e;return t=t.replace(aT,"(\\d+)"),new RegExp("^"+t+"$")}function OD(e,t,n){var r=-1,a=-1,l=-1,c=-1,u=-1,p=-1;(t.match(aT)||[]).forEach(function(y,_){var E=parseInt(n[_+1],10);switch(y.toLowerCase().charAt(0)){case"y":r=E;break;case"d":l=E;break;case"h":c=E;break;case"s":p=E;break;case"m":c>=0?u=E:a=E;break}}),p>=0&&u==-1&&a>=0&&(u=a,a=-1);var m=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(l>=1?l:1)).slice(-2);m.length==7&&(m="0"+m),m.length==8&&(m="20"+m);var x=("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(p>=0?p:0)).slice(-2);return c==-1&&u==-1&&p==-1?m:r==-1&&a==-1&&l==-1?x:m+"T"+x}var PD=function(){var e={};e.version="1.2.0";function t(){for(var F=0,W=new Array(256),O=0;O!=256;++O)F=O,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,W[O]=F;return typeof Int32Array<"u"?new Int32Array(W):W}var n=t();function r(F){var W=0,O=0,ee=0,ne=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(ee=0;ee!=256;++ee)ne[ee]=F[ee];for(ee=0;ee!=256;++ee)for(O=F[ee],W=256+ee;W<4096;W+=256)O=ne[W]=O>>>8^F[O&255];var te=[];for(ee=1;ee!=16;++ee)te[ee-1]=typeof Int32Array<"u"?ne.subarray(ee*256,ee*256+256):ne.slice(ee*256,ee*256+256);return te}var a=r(n),l=a[0],c=a[1],u=a[2],p=a[3],m=a[4],x=a[5],y=a[6],_=a[7],E=a[8],w=a[9],S=a[10],C=a[11],M=a[12],k=a[13],b=a[14];function U(F,W){for(var O=W^-1,ee=0,ne=F.length;ee<ne;)O=O>>>8^n[(O^F.charCodeAt(ee++))&255];return~O}function G(F,W){for(var O=W^-1,ee=F.length-15,ne=0;ne<ee;)O=b[F[ne++]^O&255]^k[F[ne++]^O>>8&255]^M[F[ne++]^O>>16&255]^C[F[ne++]^O>>>24]^S[F[ne++]]^w[F[ne++]]^E[F[ne++]]^_[F[ne++]]^y[F[ne++]]^x[F[ne++]]^m[F[ne++]]^p[F[ne++]]^u[F[ne++]]^c[F[ne++]]^l[F[ne++]]^n[F[ne++]];for(ee+=15;ne<ee;)O=O>>>8^n[(O^F[ne++])&255];return~O}function J(F,W){for(var O=W^-1,ee=0,ne=F.length,te=0,_e=0;ee<ne;)te=F.charCodeAt(ee++),te<128?O=O>>>8^n[(O^te)&255]:te<2048?(O=O>>>8^n[(O^(192|te>>6&31))&255],O=O>>>8^n[(O^(128|te&63))&255]):te>=55296&&te<57344?(te=(te&1023)+64,_e=F.charCodeAt(ee++)&1023,O=O>>>8^n[(O^(240|te>>8&7))&255],O=O>>>8^n[(O^(128|te>>2&63))&255],O=O>>>8^n[(O^(128|_e>>6&15|(te&3)<<4))&255],O=O>>>8^n[(O^(128|_e&63))&255]):(O=O>>>8^n[(O^(224|te>>12&15))&255],O=O>>>8^n[(O^(128|te>>6&63))&255],O=O>>>8^n[(O^(128|te&63))&255]);return~O}return e.table=n,e.bstr=U,e.buf=G,e.str=J,e}(),bt=function(){var t={};t.version="1.2.1";function n(R,V){for(var L=R.split("/"),P=V.split("/"),B=0,z=0,ue=Math.min(L.length,P.length);B<ue;++B){if(z=L[B].length-P[B].length)return z;if(L[B]!=P[B])return L[B]<P[B]?-1:1}return L.length-P.length}function r(R){if(R.charAt(R.length-1)=="/")return R.slice(0,-1).indexOf("/")===-1?R:r(R.slice(0,-1));var V=R.lastIndexOf("/");return V===-1?R:R.slice(0,V+1)}function a(R){if(R.charAt(R.length-1)=="/")return a(R.slice(0,-1));var V=R.lastIndexOf("/");return V===-1?R:R.slice(V+1)}function l(R,V){typeof V=="string"&&(V=new Date(V));var L=V.getHours();L=L<<6|V.getMinutes(),L=L<<5|V.getSeconds()>>>1,R.write_shift(2,L);var P=V.getFullYear()-1980;P=P<<4|V.getMonth()+1,P=P<<5|V.getDate(),R.write_shift(2,P)}function c(R){var V=R.read_shift(2)&65535,L=R.read_shift(2)&65535,P=new Date,B=L&31;L>>>=5;var z=L&15;L>>>=4,P.setMilliseconds(0),P.setFullYear(L+1980),P.setMonth(z-1),P.setDate(B);var ue=V&31;V>>>=5;var ye=V&63;return V>>>=6,P.setHours(V),P.setMinutes(ye),P.setSeconds(ue<<1),P}function u(R){zn(R,0);for(var V={},L=0;R.l<=R.length-4;){var P=R.read_shift(2),B=R.read_shift(2),z=R.l+B,ue={};switch(P){case 21589:L=R.read_shift(1),L&1&&(ue.mtime=R.read_shift(4)),B>5&&(L&2&&(ue.atime=R.read_shift(4)),L&4&&(ue.ctime=R.read_shift(4))),ue.mtime&&(ue.mt=new Date(ue.mtime*1e3));break}R.l=z,V[P]=ue}return V}var p;function m(){return p||(p={})}function x(R,V){if(R[0]==80&&R[1]==75)return ba(R,V);if((R[0]|32)==109&&(R[1]|32)==105)return Na(R,V);if(R.length<512)throw new Error("CFB file size "+R.length+" < 512");var L=3,P=512,B=0,z=0,ue=0,ye=0,oe=0,me=[],xe=R.slice(0,512);zn(xe,0);var De=y(xe);switch(L=De[0],L){case 3:P=512;break;case 4:P=4096;break;case 0:if(De[1]==0)return ba(R,V);default:throw new Error("Major Version: Expected 3 or 4 saw "+L)}P!==512&&(xe=R.slice(0,P),zn(xe,28));var Oe=R.slice(0,P);_(xe,L);var Be=xe.read_shift(4,"i");if(L===3&&Be!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Be);xe.l+=4,ue=xe.read_shift(4,"i"),xe.l+=4,xe.chk("00100000","Mini Stream Cutoff Size: "),ye=xe.read_shift(4,"i"),B=xe.read_shift(4,"i"),oe=xe.read_shift(4,"i"),z=xe.read_shift(4,"i");for(var Fe=-1,K=0;K<109&&(Fe=xe.read_shift(4,"i"),!(Fe<0));++K)me[K]=Fe;var Se=E(R,P);C(oe,z,Se,P,me);var ke=k(Se,ue,me,P);ke[ue].name="!Directory",B>0&&ye!==_e&&(ke[ye].name="!MiniFAT"),ke[me[0]].name="!FAT",ke.fat_addrs=me,ke.ssz=P;var Ue={},ze=[],ot=[],Dt=[];b(ue,ke,Se,ze,B,Ue,ot,ye),w(ot,Dt,ze),ze.shift();var Et={FileIndex:ot,FullPaths:Dt};return V&&V.raw&&(Et.raw={header:Oe,sectors:Se}),Et}function y(R){if(R[R.l]==80&&R[R.l+1]==75)return[0,0];R.chk(Ie,"Header Signature: "),R.l+=16;var V=R.read_shift(2,"u");return[R.read_shift(2,"u"),V]}function _(R,V){var L=9;switch(R.l+=2,L=R.read_shift(2)){case 9:if(V!=3)throw new Error("Sector Shift: Expected 9 saw "+L);break;case 12:if(V!=4)throw new Error("Sector Shift: Expected 12 saw "+L);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+L)}R.chk("0600","Mini Sector Shift: "),R.chk("000000000000","Reserved: ")}function E(R,V){for(var L=Math.ceil(R.length/V)-1,P=[],B=1;B<L;++B)P[B-1]=R.slice(B*V,(B+1)*V);return P[L-1]=R.slice(L*V),P}function w(R,V,L){for(var P=0,B=0,z=0,ue=0,ye=0,oe=L.length,me=[],xe=[];P<oe;++P)me[P]=xe[P]=P,V[P]=L[P];for(;ye<xe.length;++ye)P=xe[ye],B=R[P].L,z=R[P].R,ue=R[P].C,me[P]===P&&(B!==-1&&me[B]!==B&&(me[P]=me[B]),z!==-1&&me[z]!==z&&(me[P]=me[z])),ue!==-1&&(me[ue]=P),B!==-1&&P!=me[P]&&(me[B]=me[P],xe.lastIndexOf(B)<ye&&xe.push(B)),z!==-1&&P!=me[P]&&(me[z]=me[P],xe.lastIndexOf(z)<ye&&xe.push(z));for(P=1;P<oe;++P)me[P]===P&&(z!==-1&&me[z]!==z?me[P]=me[z]:B!==-1&&me[B]!==B&&(me[P]=me[B]));for(P=1;P<oe;++P)if(R[P].type!==0){if(ye=P,ye!=me[ye])do ye=me[ye],V[P]=V[ye]+"/"+V[P];while(ye!==0&&me[ye]!==-1&&ye!=me[ye]);me[P]=-1}for(V[0]+="/",P=1;P<oe;++P)R[P].type!==2&&(V[P]+="/")}function S(R,V,L){for(var P=R.start,B=R.size,z=[],ue=P;L&&B>0&&ue>=0;)z.push(V.slice(ue*te,ue*te+te)),B-=te,ue=as(L,ue*4);return z.length===0?Nn(0):bi(z).slice(0,R.size)}function C(R,V,L,P,B){var z=_e;if(R===_e){if(V!==0)throw new Error("DIFAT chain shorter than expected")}else if(R!==-1){var ue=L[R],ye=(P>>>2)-1;if(!ue)return;for(var oe=0;oe<ye&&(z=as(ue,oe*4))!==_e;++oe)B.push(z);C(as(ue,P-4),V-1,L,P,B)}}function M(R,V,L,P,B){var z=[],ue=[];B||(B=[]);var ye=P-1,oe=0,me=0;for(oe=V;oe>=0;){B[oe]=!0,z[z.length]=oe,ue.push(R[oe]);var xe=L[Math.floor(oe*4/P)];if(me=oe*4&ye,P<4+me)throw new Error("FAT boundary crossed: "+oe+" 4 "+P);if(!R[xe])break;oe=as(R[xe],me)}return{nodes:z,data:ry([ue])}}function k(R,V,L,P){var B=R.length,z=[],ue=[],ye=[],oe=[],me=P-1,xe=0,De=0,Oe=0,Be=0;for(xe=0;xe<B;++xe)if(ye=[],Oe=xe+V,Oe>=B&&(Oe-=B),!ue[Oe]){oe=[];var Fe=[];for(De=Oe;De>=0;){Fe[De]=!0,ue[De]=!0,ye[ye.length]=De,oe.push(R[De]);var K=L[Math.floor(De*4/P)];if(Be=De*4&me,P<4+Be)throw new Error("FAT boundary crossed: "+De+" 4 "+P);if(!R[K]||(De=as(R[K],Be),Fe[De]))break}z[Oe]={nodes:ye,data:ry([oe])}}return z}function b(R,V,L,P,B,z,ue,ye){for(var oe=0,me=P.length?2:0,xe=V[R].data,De=0,Oe=0,Be;De<xe.length;De+=128){var Fe=xe.slice(De,De+128);zn(Fe,64),Oe=Fe.read_shift(2),Be=zh(Fe,0,Oe-me),P.push(Be);var K={name:Be,type:Fe.read_shift(1),color:Fe.read_shift(1),L:Fe.read_shift(4,"i"),R:Fe.read_shift(4,"i"),C:Fe.read_shift(4,"i"),clsid:Fe.read_shift(16),state:Fe.read_shift(4,"i"),start:0,size:0},Se=Fe.read_shift(2)+Fe.read_shift(2)+Fe.read_shift(2)+Fe.read_shift(2);Se!==0&&(K.ct=U(Fe,Fe.l-8));var ke=Fe.read_shift(2)+Fe.read_shift(2)+Fe.read_shift(2)+Fe.read_shift(2);ke!==0&&(K.mt=U(Fe,Fe.l-8)),K.start=Fe.read_shift(4,"i"),K.size=Fe.read_shift(4,"i"),K.size<0&&K.start<0&&(K.size=K.type=0,K.start=_e,K.name=""),K.type===5?(oe=K.start,B>0&&oe!==_e&&(V[oe].name="!StreamData")):K.size>=4096?(K.storage="fat",V[K.start]===void 0&&(V[K.start]=M(L,K.start,V.fat_addrs,V.ssz)),V[K.start].name=K.name,K.content=V[K.start].data.slice(0,K.size)):(K.storage="minifat",K.size<0?K.size=0:oe!==_e&&K.start!==_e&&V[oe]&&(K.content=S(K,V[oe].data,(V[ye]||{}).data))),K.content&&zn(K.content,0),z[Be]=K,ue.push(K)}}function U(R,V){return new Date((kr(R,V+4)/1e7*Math.pow(2,32)+kr(R,V)/1e7-11644473600)*1e3)}function G(R,V){return m(),x(p.readFileSync(R),V)}function J(R,V){var L=V&&V.type;switch(L||St&&Buffer.isBuffer(R)&&(L="buffer"),L||"base64"){case"file":return G(R,V);case"base64":return x(na(Mr(R)),V);case"binary":return x(na(R),V)}return x(R,V)}function F(R,V){var L=V||{},P=L.root||"Root Entry";if(R.FullPaths||(R.FullPaths=[]),R.FileIndex||(R.FileIndex=[]),R.FullPaths.length!==R.FileIndex.length)throw new Error("inconsistent CFB structure");R.FullPaths.length===0&&(R.FullPaths[0]=P+"/",R.FileIndex[0]={name:P,type:5}),L.CLSID&&(R.FileIndex[0].clsid=L.CLSID),W(R)}function W(R){var V="Sh33tJ5";if(!bt.find(R,"/"+V)){var L=Nn(4);L[0]=55,L[1]=L[3]=50,L[2]=54,R.FileIndex.push({name:V,type:2,content:L,size:4,L:69,R:69,C:69}),R.FullPaths.push(R.FullPaths[0]+V),O(R)}}function O(R,V){F(R);for(var L=!1,P=!1,B=R.FullPaths.length-1;B>=0;--B){var z=R.FileIndex[B];switch(z.type){case 0:P?L=!0:(R.FileIndex.pop(),R.FullPaths.pop());break;case 1:case 2:case 5:P=!0,isNaN(z.R*z.L*z.C)&&(L=!0),z.R>-1&&z.L>-1&&z.R==z.L&&(L=!0);break;default:L=!0;break}}if(!(!L&&!V)){var ue=new Date(1987,1,19),ye=0,oe=Object.create?Object.create(null):{},me=[];for(B=0;B<R.FullPaths.length;++B)oe[R.FullPaths[B]]=!0,R.FileIndex[B].type!==0&&me.push([R.FullPaths[B],R.FileIndex[B]]);for(B=0;B<me.length;++B){var xe=r(me[B][0]);P=oe[xe],P||(me.push([xe,{name:a(xe).replace("/",""),type:1,clsid:ae,ct:ue,mt:ue,content:null}]),oe[xe]=!0)}for(me.sort(function(Be,Fe){return n(Be[0],Fe[0])}),R.FullPaths=[],R.FileIndex=[],B=0;B<me.length;++B)R.FullPaths[B]=me[B][0],R.FileIndex[B]=me[B][1];for(B=0;B<me.length;++B){var De=R.FileIndex[B],Oe=R.FullPaths[B];if(De.name=a(Oe).replace("/",""),De.L=De.R=De.C=-(De.color=1),De.size=De.content?De.content.length:0,De.start=0,De.clsid=De.clsid||ae,B===0)De.C=me.length>1?1:-1,De.size=0,De.type=5;else if(Oe.slice(-1)=="/"){for(ye=B+1;ye<me.length&&r(R.FullPaths[ye])!=Oe;++ye);for(De.C=ye>=me.length?-1:ye,ye=B+1;ye<me.length&&r(R.FullPaths[ye])!=r(Oe);++ye);De.R=ye>=me.length?-1:ye,De.type=1}else r(R.FullPaths[B+1]||"")==r(Oe)&&(De.R=B+1),De.type=2}}}function ee(R,V){var L=V||{};if(L.fileType=="mad")return Vn(R,L);switch(O(R),L.fileType){case"zip":return Pe(R,L)}var P=function(Be){for(var Fe=0,K=0,Se=0;Se<Be.FileIndex.length;++Se){var ke=Be.FileIndex[Se];if(ke.content){var Ue=ke.content.length;Ue>0&&(Ue<4096?Fe+=Ue+63>>6:K+=Ue+511>>9)}}for(var ze=Be.FullPaths.length+3>>2,ot=Fe+7>>3,Dt=Fe+127>>7,Et=ot+K+ze+Dt,It=Et+127>>7,un=It<=109?0:Math.ceil((It-109)/127);Et+It+un+127>>7>It;)un=++It<=109?0:Math.ceil((It-109)/127);var Ft=[1,un,It,Dt,ze,K,Fe,0];return Be.FileIndex[0].size=Fe<<6,Ft[7]=(Be.FileIndex[0].start=Ft[0]+Ft[1]+Ft[2]+Ft[3]+Ft[4]+Ft[5])+(Ft[6]+7>>3),Ft}(R),B=Nn(P[7]<<9),z=0,ue=0;{for(z=0;z<8;++z)B.write_shift(1,Ee[z]);for(z=0;z<8;++z)B.write_shift(2,0);for(B.write_shift(2,62),B.write_shift(2,3),B.write_shift(2,65534),B.write_shift(2,9),B.write_shift(2,6),z=0;z<3;++z)B.write_shift(2,0);for(B.write_shift(4,0),B.write_shift(4,P[2]),B.write_shift(4,P[0]+P[1]+P[2]+P[3]-1),B.write_shift(4,0),B.write_shift(4,4096),B.write_shift(4,P[3]?P[0]+P[1]+P[2]-1:_e),B.write_shift(4,P[3]),B.write_shift(-4,P[1]?P[0]-1:_e),B.write_shift(4,P[1]),z=0;z<109;++z)B.write_shift(-4,z<P[2]?P[1]+z:-1)}if(P[1])for(ue=0;ue<P[1];++ue){for(;z<236+ue*127;++z)B.write_shift(-4,z<P[2]?P[1]+z:-1);B.write_shift(-4,ue===P[1]-1?_e:ue+1)}var ye=function(Be){for(ue+=Be;z<ue-1;++z)B.write_shift(-4,z+1);Be&&(++z,B.write_shift(-4,_e))};for(ue=z=0,ue+=P[1];z<ue;++z)B.write_shift(-4,de.DIFSECT);for(ue+=P[2];z<ue;++z)B.write_shift(-4,de.FATSECT);ye(P[3]),ye(P[4]);for(var oe=0,me=0,xe=R.FileIndex[0];oe<R.FileIndex.length;++oe)xe=R.FileIndex[oe],xe.content&&(me=xe.content.length,!(me<4096)&&(xe.start=ue,ye(me+511>>9)));for(ye(P[6]+7>>3);B.l&511;)B.write_shift(-4,de.ENDOFCHAIN);for(ue=z=0,oe=0;oe<R.FileIndex.length;++oe)xe=R.FileIndex[oe],xe.content&&(me=xe.content.length,!(!me||me>=4096)&&(xe.start=ue,ye(me+63>>6)));for(;B.l&511;)B.write_shift(-4,de.ENDOFCHAIN);for(z=0;z<P[4]<<2;++z){var De=R.FullPaths[z];if(!De||De.length===0){for(oe=0;oe<17;++oe)B.write_shift(4,0);for(oe=0;oe<3;++oe)B.write_shift(4,-1);for(oe=0;oe<12;++oe)B.write_shift(4,0);continue}xe=R.FileIndex[z],z===0&&(xe.start=xe.size?xe.start-1:_e);var Oe=z===0&&L.root||xe.name;if(me=2*(Oe.length+1),B.write_shift(64,Oe,"utf16le"),B.write_shift(2,me),B.write_shift(1,xe.type),B.write_shift(1,xe.color),B.write_shift(-4,xe.L),B.write_shift(-4,xe.R),B.write_shift(-4,xe.C),xe.clsid)B.write_shift(16,xe.clsid,"hex");else for(oe=0;oe<4;++oe)B.write_shift(4,0);B.write_shift(4,xe.state||0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,xe.start),B.write_shift(4,xe.size),B.write_shift(4,0)}for(z=1;z<R.FileIndex.length;++z)if(xe=R.FileIndex[z],xe.size>=4096)if(B.l=xe.start+1<<9,St&&Buffer.isBuffer(xe.content))xe.content.copy(B,B.l,0,xe.size),B.l+=xe.size+511&-512;else{for(oe=0;oe<xe.size;++oe)B.write_shift(1,xe.content[oe]);for(;oe&511;++oe)B.write_shift(1,0)}for(z=1;z<R.FileIndex.length;++z)if(xe=R.FileIndex[z],xe.size>0&&xe.size<4096)if(St&&Buffer.isBuffer(xe.content))xe.content.copy(B,B.l,0,xe.size),B.l+=xe.size+63&-64;else{for(oe=0;oe<xe.size;++oe)B.write_shift(1,xe.content[oe]);for(;oe&63;++oe)B.write_shift(1,0)}if(St)B.l=B.length;else for(;B.l<B.length;)B.write_shift(1,0);return B}function ne(R,V){var L=R.FullPaths.map(function(oe){return oe.toUpperCase()}),P=L.map(function(oe){var me=oe.split("/");return me[me.length-(oe.slice(-1)=="/"?2:1)]}),B=!1;V.charCodeAt(0)===47?(B=!0,V=L[0].slice(0,-1)+V):B=V.indexOf("/")!==-1;var z=V.toUpperCase(),ue=B===!0?L.indexOf(z):P.indexOf(z);if(ue!==-1)return R.FileIndex[ue];var ye=!z.match(Do);for(z=z.replace(cr,""),ye&&(z=z.replace(Do,"!")),ue=0;ue<L.length;++ue)if((ye?L[ue].replace(Do,"!"):L[ue]).replace(cr,"")==z||(ye?P[ue].replace(Do,"!"):P[ue]).replace(cr,"")==z)return R.FileIndex[ue];return null}var te=64,_e=-2,Ie="d0cf11e0a1b11ae1",Ee=[208,207,17,224,161,177,26,225],ae="00000000000000000000000000000000",de={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:_e,FREESECT:-1,HEADER_SIGNATURE:Ie,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ae,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function re(R,V,L){m();var P=ee(R,L);p.writeFileSync(V,P)}function Y(R){for(var V=new Array(R.length),L=0;L<R.length;++L)V[L]=String.fromCharCode(R[L]);return V.join("")}function N(R,V){var L=ee(R,V);switch(V&&V.type||"buffer"){case"file":return m(),p.writeFileSync(V.filename,L),L;case"binary":return typeof L=="string"?L:Y(L);case"base64":return Bv(typeof L=="string"?L:Y(L));case"buffer":if(St)return Buffer.isBuffer(L)?L:vs(L);case"array":return typeof L=="string"?na(L):L}return L}var Z;function D(R){try{var V=R.InflateRaw,L=new V;if(L._processChunk(new Uint8Array([3,0]),L._finishFlushFlag),L.bytesRead)Z=R;else throw new Error("zlib does not expose bytesRead")}catch(P){console.error("cannot use native zlib: "+(P.message||P))}}function H(R,V){if(!Z)return ti(R,V);var L=Z.InflateRaw,P=new L,B=P._processChunk(R.slice(R.l),P._finishFlushFlag);return R.l+=P.bytesRead,B}function q(R){return Z?Z.deflateRawSync(R):Ve(R)}var j=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],se=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Te=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ae(R){var V=(R<<1|R<<11)&139536|(R<<5|R<<15)&558144;return(V>>16|V>>8|V)&255}for(var Re=typeof Uint8Array<"u",Ce=Re?new Uint8Array(256):[],Xe=0;Xe<256;++Xe)Ce[Xe]=Ae(Xe);function X(R,V){var L=Ce[R&255];return V<=8?L>>>8-V:(L=L<<8|Ce[R>>8&255],V<=16?L>>>16-V:(L=L<<8|Ce[R>>16&255],L>>>24-V))}function ut(R,V){var L=V&7,P=V>>>3;return(R[P]|(L<=6?0:R[P+1]<<8))>>>L&3}function Ke(R,V){var L=V&7,P=V>>>3;return(R[P]|(L<=5?0:R[P+1]<<8))>>>L&7}function pt(R,V){var L=V&7,P=V>>>3;return(R[P]|(L<=4?0:R[P+1]<<8))>>>L&15}function Me(R,V){var L=V&7,P=V>>>3;return(R[P]|(L<=3?0:R[P+1]<<8))>>>L&31}function ve(R,V){var L=V&7,P=V>>>3;return(R[P]|(L<=1?0:R[P+1]<<8))>>>L&127}function Ge(R,V,L){var P=V&7,B=V>>>3,z=(1<<L)-1,ue=R[B]>>>P;return L<8-P||(ue|=R[B+1]<<8-P,L<16-P)||(ue|=R[B+2]<<16-P,L<24-P)||(ue|=R[B+3]<<24-P),ue&z}function je(R,V,L){var P=V&7,B=V>>>3;return P<=5?R[B]|=(L&7)<<P:(R[B]|=L<<P&255,R[B+1]=(L&7)>>8-P),V+3}function Pt(R,V,L){var P=V&7,B=V>>>3;return L=(L&1)<<P,R[B]|=L,V+1}function Ct(R,V,L){var P=V&7,B=V>>>3;return L<<=P,R[B]|=L&255,L>>>=8,R[B+1]=L,V+8}function en(R,V,L){var P=V&7,B=V>>>3;return L<<=P,R[B]|=L&255,L>>>=8,R[B+1]=L&255,R[B+2]=L>>>8,V+16}function dt(R,V){var L=R.length,P=2*L>V?2*L:V+5,B=0;if(L>=V)return R;if(St){var z=Vv(P);if(R.copy)R.copy(z);else for(;B<R.length;++B)z[B]=R[B];return z}else if(Re){var ue=new Uint8Array(P);if(ue.set)ue.set(R);else for(;B<L;++B)ue[B]=R[B];return ue}return R.length=P,R}function on(R){for(var V=new Array(R),L=0;L<R;++L)V[L]=0;return V}function Bn(R,V,L){var P=1,B=0,z=0,ue=0,ye=0,oe=R.length,me=Re?new Uint16Array(32):on(32);for(z=0;z<32;++z)me[z]=0;for(z=oe;z<L;++z)R[z]=0;oe=R.length;var xe=Re?new Uint16Array(oe):on(oe);for(z=0;z<oe;++z)me[B=R[z]]++,P<B&&(P=B),xe[z]=0;for(me[0]=0,z=1;z<=P;++z)me[z+16]=ye=ye+me[z-1]<<1;for(z=0;z<oe;++z)ye=R[z],ye!=0&&(xe[z]=me[ye+16]++);var De=0;for(z=0;z<oe;++z)if(De=R[z],De!=0)for(ye=X(xe[z],P)>>P-De,ue=(1<<P+4-De)-1;ue>=0;--ue)V[ye|ue<<De]=De&15|z<<4;return P}var Jt=Re?new Uint16Array(512):on(512),Xt=Re?new Uint16Array(32):on(32);if(!Re){for(var Ut=0;Ut<512;++Ut)Jt[Ut]=0;for(Ut=0;Ut<32;++Ut)Xt[Ut]=0}(function(){for(var R=[],V=0;V<32;V++)R.push(5);Bn(R,Xt,32);var L=[];for(V=0;V<=143;V++)L.push(8);for(;V<=255;V++)L.push(9);for(;V<=279;V++)L.push(7);for(;V<=287;V++)L.push(8);Bn(L,Jt,288)})();var at=function(){for(var V=Re?new Uint8Array(32768):[],L=0,P=0;L<Te.length-1;++L)for(;P<Te[L+1];++P)V[P]=L;for(;P<32768;++P)V[P]=29;var B=Re?new Uint8Array(259):[];for(L=0,P=0;L<se.length-1;++L)for(;P<se[L+1];++P)B[P]=L;function z(ye,oe){for(var me=0;me<ye.length;){var xe=Math.min(65535,ye.length-me),De=me+xe==ye.length;for(oe.write_shift(1,+De),oe.write_shift(2,xe),oe.write_shift(2,~xe&65535);xe-- >0;)oe[oe.l++]=ye[me++]}return oe.l}function ue(ye,oe){for(var me=0,xe=0,De=Re?new Uint16Array(32768):[];xe<ye.length;){var Oe=Math.min(65535,ye.length-xe);if(Oe<10){for(me=je(oe,me,+(xe+Oe==ye.length)),me&7&&(me+=8-(me&7)),oe.l=me/8|0,oe.write_shift(2,Oe),oe.write_shift(2,~Oe&65535);Oe-- >0;)oe[oe.l++]=ye[xe++];me=oe.l*8;continue}me=je(oe,me,+(xe+Oe==ye.length)+2);for(var Be=0;Oe-- >0;){var Fe=ye[xe];Be=(Be<<5^Fe)&32767;var K=-1,Se=0;if((K=De[Be])&&(K|=xe&-32768,K>xe&&(K-=32768),K<xe))for(;ye[K+Se]==ye[xe+Se]&&Se<250;)++Se;if(Se>2){Fe=B[Se],Fe<=22?me=Ct(oe,me,Ce[Fe+1]>>1)-1:(Ct(oe,me,3),me+=5,Ct(oe,me,Ce[Fe-23]>>5),me+=3);var ke=Fe<8?0:Fe-4>>2;ke>0&&(en(oe,me,Se-se[Fe]),me+=ke),Fe=V[xe-K],me=Ct(oe,me,Ce[Fe]>>3),me-=3;var Ue=Fe<4?0:Fe-2>>1;Ue>0&&(en(oe,me,xe-K-Te[Fe]),me+=Ue);for(var ze=0;ze<Se;++ze)De[Be]=xe&32767,Be=(Be<<5^ye[xe])&32767,++xe;Oe-=Se-1}else Fe<=143?Fe=Fe+48:me=Pt(oe,me,1),me=Ct(oe,me,Ce[Fe]),De[Be]=xe&32767,++xe}me=Ct(oe,me,0)-1}return oe.l=(me+7)/8|0,oe.l}return function(oe,me){return oe.length<8?z(oe,me):ue(oe,me)}}();function Ve(R){var V=Nn(50+Math.floor(R.length*1.1)),L=at(R,V);return V.slice(0,L)}var ht=Re?new Uint16Array(32768):on(32768),Yt=Re?new Uint16Array(32768):on(32768),_t=Re?new Uint16Array(128):on(128),Dn=1,Yn=1;function Jr(R,V){var L=Me(R,V)+257;V+=5;var P=Me(R,V)+1;V+=5;var B=pt(R,V)+4;V+=4;for(var z=0,ue=Re?new Uint8Array(19):on(19),ye=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],oe=1,me=Re?new Uint8Array(8):on(8),xe=Re?new Uint8Array(8):on(8),De=ue.length,Oe=0;Oe<B;++Oe)ue[j[Oe]]=z=Ke(R,V),oe<z&&(oe=z),me[z]++,V+=3;var Be=0;for(me[0]=0,Oe=1;Oe<=oe;++Oe)xe[Oe]=Be=Be+me[Oe-1]<<1;for(Oe=0;Oe<De;++Oe)(Be=ue[Oe])!=0&&(ye[Oe]=xe[Be]++);var Fe=0;for(Oe=0;Oe<De;++Oe)if(Fe=ue[Oe],Fe!=0){Be=Ce[ye[Oe]]>>8-Fe;for(var K=(1<<7-Fe)-1;K>=0;--K)_t[Be|K<<Fe]=Fe&7|Oe<<3}var Se=[];for(oe=1;Se.length<L+P;)switch(Be=_t[ve(R,V)],V+=Be&7,Be>>>=3){case 16:for(z=3+ut(R,V),V+=2,Be=Se[Se.length-1];z-- >0;)Se.push(Be);break;case 17:for(z=3+Ke(R,V),V+=3;z-- >0;)Se.push(0);break;case 18:for(z=11+ve(R,V),V+=7;z-- >0;)Se.push(0);break;default:Se.push(Be),oe<Be&&(oe=Be);break}var ke=Se.slice(0,L),Ue=Se.slice(L);for(Oe=L;Oe<286;++Oe)ke[Oe]=0;for(Oe=P;Oe<30;++Oe)Ue[Oe]=0;return Dn=Bn(ke,ht,286),Yn=Bn(Ue,Yt,30),V}function Rr(R,V){if(R[0]==3&&!(R[1]&3))return[Oi(V),2];for(var L=0,P=0,B=Vv(V||1<<18),z=0,ue=B.length>>>0,ye=0,oe=0;(P&1)==0;){if(P=Ke(R,L),L+=3,P>>>1)P>>1==1?(ye=9,oe=5):(L=Jr(R,L),ye=Dn,oe=Yn);else{L&7&&(L+=8-(L&7));var me=R[L>>>3]|R[(L>>>3)+1]<<8;if(L+=32,me>0)for(!V&&ue<z+me&&(B=dt(B,z+me),ue=B.length);me-- >0;)B[z++]=R[L>>>3],L+=8;continue}for(;;){!V&&ue<z+32767&&(B=dt(B,z+32767),ue=B.length);var xe=Ge(R,L,ye),De=P>>>1==1?Jt[xe]:ht[xe];if(L+=De&15,De>>>=4,(De>>>8&255)===0)B[z++]=De;else{if(De==256)break;De-=257;var Oe=De<8?0:De-4>>2;Oe>5&&(Oe=0);var Be=z+se[De];Oe>0&&(Be+=Ge(R,L,Oe),L+=Oe),xe=Ge(R,L,oe),De=P>>>1==1?Xt[xe]:Yt[xe],L+=De&15,De>>>=4;var Fe=De<4?0:De-2>>1,K=Te[De];for(Fe>0&&(K+=Ge(R,L,Fe),L+=Fe),!V&&ue<Be&&(B=dt(B,Be+100),ue=B.length);z<Be;)B[z]=B[z-K],++z}}}return V?[B,L+7>>>3]:[B.slice(0,z),L+7>>>3]}function ti(R,V){var L=R.slice(R.l||0),P=Rr(L,V);return R.l+=P[1],P[0]}function Aa(R,V){if(R)typeof console<"u"&&console.error(V);else throw new Error(V)}function ba(R,V){var L=R;zn(L,0);var P=[],B=[],z={FileIndex:P,FullPaths:B};F(z,{root:V.root});for(var ue=L.length-4;(L[ue]!=80||L[ue+1]!=75||L[ue+2]!=5||L[ue+3]!=6)&&ue>=0;)--ue;L.l=ue+4,L.l+=4;var ye=L.read_shift(2);L.l+=6;var oe=L.read_shift(4);for(L.l=oe,ue=0;ue<ye;++ue){L.l+=20;var me=L.read_shift(4),xe=L.read_shift(4),De=L.read_shift(2),Oe=L.read_shift(2),Be=L.read_shift(2);L.l+=8;var Fe=L.read_shift(4),K=u(L.slice(L.l+De,L.l+De+Oe));L.l+=De+Oe+Be;var Se=L.l;L.l=Fe+4,ka(L,me,xe,z,K),L.l=Se}return z}function ka(R,V,L,P,B){R.l+=2;var z=R.read_shift(2),ue=R.read_shift(2),ye=c(R);if(z&8257)throw new Error("Unsupported ZIP encryption");for(var oe=R.read_shift(4),me=R.read_shift(4),xe=R.read_shift(4),De=R.read_shift(2),Oe=R.read_shift(2),Be="",Fe=0;Fe<De;++Fe)Be+=String.fromCharCode(R[R.l++]);if(Oe){var K=u(R.slice(R.l,R.l+Oe));(K[21589]||{}).mt&&(ye=K[21589].mt),((B||{})[21589]||{}).mt&&(ye=B[21589].mt)}R.l+=Oe;var Se=R.slice(R.l,R.l+me);switch(ue){case 8:Se=H(R,xe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ue)}var ke=!1;z&8&&(oe=R.read_shift(4),oe==134695760&&(oe=R.read_shift(4),ke=!0),me=R.read_shift(4),xe=R.read_shift(4)),me!=V&&Aa(ke,"Bad compressed size: "+V+" != "+me),xe!=L&&Aa(ke,"Bad uncompressed size: "+L+" != "+xe),nn(P,Be,Se,{unsafe:!0,mt:ye})}function Pe(R,V){var L=V||{},P=[],B=[],z=Nn(1),ue=L.compression?8:0,ye=0,oe=0,me=0,xe=0,De=0,Oe=R.FullPaths[0],Be=Oe,Fe=R.FileIndex[0],K=[],Se=0;for(oe=1;oe<R.FullPaths.length;++oe)if(Be=R.FullPaths[oe].slice(Oe.length),Fe=R.FileIndex[oe],!(!Fe.size||!Fe.content||Be=="Sh33tJ5")){var ke=xe,Ue=Nn(Be.length);for(me=0;me<Be.length;++me)Ue.write_shift(1,Be.charCodeAt(me)&127);Ue=Ue.slice(0,Ue.l),K[De]=PD.buf(Fe.content,0);var ze=Fe.content;ue==8&&(ze=q(ze)),z=Nn(30),z.write_shift(4,67324752),z.write_shift(2,20),z.write_shift(2,ye),z.write_shift(2,ue),Fe.mt?l(z,Fe.mt):z.write_shift(4,0),z.write_shift(-4,K[De]),z.write_shift(4,ze.length),z.write_shift(4,Fe.content.length),z.write_shift(2,Ue.length),z.write_shift(2,0),xe+=z.length,P.push(z),xe+=Ue.length,P.push(Ue),xe+=ze.length,P.push(ze),z=Nn(46),z.write_shift(4,33639248),z.write_shift(2,0),z.write_shift(2,20),z.write_shift(2,ye),z.write_shift(2,ue),z.write_shift(4,0),z.write_shift(-4,K[De]),z.write_shift(4,ze.length),z.write_shift(4,Fe.content.length),z.write_shift(2,Ue.length),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(4,0),z.write_shift(4,ke),Se+=z.l,B.push(z),Se+=Ue.length,B.push(Ue),++De}return z=Nn(22),z.write_shift(4,101010256),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,De),z.write_shift(2,De),z.write_shift(4,Se),z.write_shift(4,xe),z.write_shift(2,0),bi([bi(P),bi(B),z])}var st={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function gt(R,V){if(R.ctype)return R.ctype;var L=R.name||"",P=L.match(/\.([^\.]+)$/);return P&&st[P[1]]||V&&(P=(L=V).match(/[\.\\]([^\.\\])+$/),P&&st[P[1]])?st[P[1]]:"application/octet-stream"}function cn(R){for(var V=Bv(R),L=[],P=0;P<V.length;P+=76)L.push(V.slice(P,P+76));return L.join(`\r
`)+`\r
`}function In(R){var V=R.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(me){var xe=me.charCodeAt(0).toString(16).toUpperCase();return"="+(xe.length==1?"0"+xe:xe)});V=V.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),V.charAt(0)==`
`&&(V="=0D"+V.slice(1)),V=V.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var L=[],P=V.split(`\r
`),B=0;B<P.length;++B){var z=P[B];if(z.length==0){L.push("");continue}for(var ue=0;ue<z.length;){var ye=76,oe=z.slice(ue,ue+ye);oe.charAt(ye-1)=="="?ye--:oe.charAt(ye-2)=="="?ye-=2:oe.charAt(ye-3)=="="&&(ye-=3),oe=z.slice(ue,ue+ye),ue+=ye,ue<z.length&&(oe+="="),L.push(oe)}}return L.join(`\r
`)}function Cn(R){for(var V=[],L=0;L<R.length;++L){for(var P=R[L];L<=R.length&&P.charAt(P.length-1)=="=";)P=P.slice(0,P.length-1)+R[++L];V.push(P)}for(var B=0;B<V.length;++B)V[B]=V[B].replace(/[=][0-9A-Fa-f]{2}/g,function(z){return String.fromCharCode(parseInt(z.slice(1),16))});return na(V.join(`\r
`))}function Dr(R,V,L){for(var P="",B="",z="",ue,ye=0;ye<10;++ye){var oe=V[ye];if(!oe||oe.match(/^\s*$/))break;var me=oe.match(/^(.*?):\s*([^\s].*)$/);if(me)switch(me[1].toLowerCase()){case"content-location":P=me[2].trim();break;case"content-type":z=me[2].trim();break;case"content-transfer-encoding":B=me[2].trim();break}}switch(++ye,B.toLowerCase()){case"base64":ue=na(Mr(V.slice(ye).join("")));break;case"quoted-printable":ue=Cn(V.slice(ye));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+B)}var xe=nn(R,P.slice(L.length),ue,{unsafe:!0});z&&(xe.ctype=z)}function Na(R,V){if(Y(R.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var L=V&&V.root||"",P=(St&&Buffer.isBuffer(R)?R.toString("binary"):Y(R)).split(`\r
`),B=0,z="";for(B=0;B<P.length;++B)if(z=P[B],!!/^Content-Location:/i.test(z)&&(z=z.slice(z.indexOf("file")),L||(L=z.slice(0,z.lastIndexOf("/")+1)),z.slice(0,L.length)!=L))for(;L.length>0&&(L=L.slice(0,L.length-1),L=L.slice(0,L.lastIndexOf("/")+1),z.slice(0,L.length)!=L););var ue=(P[1]||"").match(/boundary="(.*?)"/);if(!ue)throw new Error("MAD cannot find boundary");var ye="--"+(ue[1]||""),oe=[],me=[],xe={FileIndex:oe,FullPaths:me};F(xe);var De,Oe=0;for(B=0;B<P.length;++B){var Be=P[B];Be!==ye&&Be!==ye+"--"||(Oe++&&Dr(xe,P.slice(De,B),L),De=B)}return xe}function Vn(R,V){var L=V||{},P=L.boundary||"SheetJS";P="------="+P;for(var B=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+P.slice(2)+'"',"","",""],z=R.FullPaths[0],ue=z,ye=R.FileIndex[0],oe=1;oe<R.FullPaths.length;++oe)if(ue=R.FullPaths[oe].slice(z.length),ye=R.FileIndex[oe],!(!ye.size||!ye.content||ue=="Sh33tJ5")){ue=ue.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Se){return"_x"+Se.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Se){return"_u"+Se.charCodeAt(0).toString(16)+"_"});for(var me=ye.content,xe=St&&Buffer.isBuffer(me)?me.toString("binary"):Y(me),De=0,Oe=Math.min(1024,xe.length),Be=0,Fe=0;Fe<=Oe;++Fe)(Be=xe.charCodeAt(Fe))>=32&&Be<128&&++De;var K=De>=Oe*4/5;B.push(P),B.push("Content-Location: "+(L.root||"file:///C:/SheetJS/")+ue),B.push("Content-Transfer-Encoding: "+(K?"quoted-printable":"base64")),B.push("Content-Type: "+gt(ye,ue)),B.push(""),B.push(K?In(xe):cn(xe))}return B.push(P+`--\r
`),B.join(`\r
`)}function tn(R){var V={};return F(V,R),V}function nn(R,V,L,P){var B=P&&P.unsafe;B||F(R);var z=!B&&bt.find(R,V);if(!z){var ue=R.FullPaths[0];V.slice(0,ue.length)==ue?ue=V:(ue.slice(-1)!="/"&&(ue+="/"),ue=(ue+V).replace("//","/")),z={name:a(V),type:2},R.FileIndex.push(z),R.FullPaths.push(ue),B||bt.utils.cfb_gc(R)}return z.content=L,z.size=L?L.length:0,P&&(P.CLSID&&(z.clsid=P.CLSID),P.mt&&(z.mt=P.mt),P.ct&&(z.ct=P.ct)),z}function dr(R,V){F(R);var L=bt.find(R,V);if(L){for(var P=0;P<R.FileIndex.length;++P)if(R.FileIndex[P]==L)return R.FileIndex.splice(P,1),R.FullPaths.splice(P,1),!0}return!1}function Mt(R,V,L){F(R);var P=bt.find(R,V);if(P){for(var B=0;B<R.FileIndex.length;++B)if(R.FileIndex[B]==P)return R.FileIndex[B].name=a(L),R.FullPaths[B]=L,!0}return!1}function Ma(R){O(R,!0)}return t.find=ne,t.read=J,t.parse=x,t.write=N,t.writeFile=re,t.utils={cfb_new:tn,cfb_add:nn,cfb_del:dr,cfb_mov:Mt,cfb_gc:Ma,ReadShift:Po,CheckField:AT,prep_blob:zn,bconcat:bi,use_zlib:D,_deflateRaw:Ve,_inflateRaw:ti,consts:de},t}();function UD(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var n=t.read();return t.close(),n}catch(r){if(!r.message||!r.message.match(/onstruct/))throw r}throw new Error("Cannot access file "+e)}function Ea(e){for(var t=Object.keys(e),n=[],r=0;r<t.length;++r)Object.prototype.hasOwnProperty.call(e,t[r])&&n.push(t[r]);return n}function Vh(e){for(var t=[],n=Ea(e),r=0;r!==n.length;++r)t[e[n[r]]]=n[r];return t}var Qu=new Date(1899,11,30,0,0,0);function fr(e,t){var n=e.getTime(),r=Qu.getTime()+(e.getTimezoneOffset()-Qu.getTimezoneOffset())*6e4;return(n-r)/(24*60*60*1e3)}var iT=new Date,BD=Qu.getTime()+(iT.getTimezoneOffset()-Qu.getTimezoneOffset())*6e4,Wv=iT.getTimezoneOffset();function vf(e){var t=new Date;return t.setTime(e*24*60*60*1e3+BD),t.getTimezoneOffset()!==Wv&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Wv)*6e4),t}function VD(e){var t=0,n=0,r=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var l=1;l!=a.length;++l)if(a[l]){switch(n=1,l>3&&(r=!0),a[l].slice(a[l].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[l].slice(a[l].length-1));case"D":n*=24;case"H":n*=60;case"M":if(r)n*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=n*parseInt(a[l],10)}return t}var Jv=new Date("2017-02-19T19:06:09.000Z"),sT=isNaN(Jv.getFullYear())?new Date("2/19/17"):Jv,HD=sT.getFullYear()==2017;function Un(e,t){var n=new Date(e);if(HD)return t>0?n.setTime(n.getTime()+n.getTimezoneOffset()*60*1e3):t<0&&n.setTime(n.getTime()-n.getTimezoneOffset()*60*1e3),n;if(e instanceof Date)return e;if(sT.getFullYear()==1917&&!isNaN(n.getFullYear())){var r=n.getFullYear();return e.indexOf(""+r)>-1||n.setFullYear(n.getFullYear()+100),n}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],l=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(l=new Date(l.getTime()-l.getTimezoneOffset()*60*1e3)),l}function ms(e,t){if(St&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Fo(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Fo($2(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Fo(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Fo(new TextDecoder("utf-16be").decode(e.slice(2)))}var n={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(l){return n[l]||l})}catch{}for(var r=[],a=0;a!=e.length;++a)r.push(String.fromCharCode(e[a]));return r.join("")}function qn(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=qn(e[n]));return t}function mn(e,t){for(var n="";n.length<t;)n+=e;return n}function sa(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var n=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return n*=100,""});return!isNaN(t=Number(r))||(r=r.replace(/[(](.*)[)]/,function(a,l){return n=-n,l}),!isNaN(t=Number(r)))?t/n:t}var GD=["january","february","march","april","may","june","july","august","september","october","november","december"];function El(e){var t=new Date(e),n=new Date(NaN),r=t.getYear(),a=t.getMonth(),l=t.getDate();if(isNaN(l))return n;var c=e.toLowerCase();if(c.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(c=c.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),c.length>3&&GD.indexOf(c)==-1)return n}else if(c.match(/[a-z]/))return n;return r<0||r>8099?n:(a>0||l>1)&&r!=101?t:e.match(/[^-0-9:,\/\\]/)?n:t}var jD=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(n,r,a){if(e||typeof r=="string")return n.split(r);for(var l=n.split(r),c=[l[0]],u=1;u<l.length;++u)c.push(a),c.push(l[u]);return c}}();function lT(e){return e?e.content&&e.type?ms(e.content,!0):e.data?Ro(e.data):e.asNodeBuffer&&St?Ro(e.asNodeBuffer().toString("binary")):e.asBinary?Ro(e.asBinary()):e._data&&e._data.getContent?Ro(ms(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function oT(e){if(!e)return null;if(e.data)return Pv(e.data);if(e.asNodeBuffer&&St)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Pv(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function zD(e){return e&&e.name.slice(-4)===".bin"?oT(e):lT(e)}function zr(e,t){for(var n=e.FullPaths||Ea(e.files),r=t.toLowerCase().replace(/[\/]/g,"\\"),a=r.replace(/\\/g,"/"),l=0;l<n.length;++l){var c=n[l].replace(/^Root Entry[\/]/,"").toLowerCase();if(r==c||a==c)return e.files?e.files[n[l]]:e.FileIndex[l]}return null}function Hh(e,t){var n=zr(e,t);if(n==null)throw new Error("Cannot find file "+t+" in zip");return n}function En(e,t,n){if(!n)return zD(Hh(e,t));if(!t)return null;try{return En(e,t)}catch{return null}}function Nr(e,t,n){if(!n)return lT(Hh(e,t));if(!t)return null;try{return Nr(e,t)}catch{return null}}function qD(e,t,n){return oT(Hh(e,t))}function Xv(e){for(var t=e.FullPaths||Ea(e.files),n=[],r=0;r<t.length;++r)t[r].slice(-1)!="/"&&n.push(t[r].replace(/^Root Entry[\/]/,""));return n.sort()}function $D(e,t,n){if(e.FullPaths){if(typeof n=="string"){var r;return St?r=vs(n):r=fD(n),bt.utils.cfb_add(e,t,r)}bt.utils.cfb_add(e,t,n)}else e.file(t,n)}function cT(e,t){switch(t.type){case"base64":return bt.read(e,{type:"base64"});case"binary":return bt.read(e,{type:"binary"});case"buffer":case"array":return bt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Io(e,t){if(e.charAt(0)=="/")return e.slice(1);var n=t.split("/");t.slice(-1)!="/"&&n.pop();for(var r=e.split("/");r.length!==0;){var a=r.shift();a===".."?n.pop():a!=="."&&n.push(a)}return n.join("/")}var uT=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,YD=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Kv=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,WD=/<[^>]*>/g,rr=uT.match(Kv)?Kv:WD,JD=/<\w*:/,XD=/<(\/?)\w+:/;function tt(e,t,n){for(var r={},a=0,l=0;a!==e.length&&!((l=e.charCodeAt(a))===32||l===10||l===13);++a);if(t||(r[0]=e.slice(0,a)),a===e.length)return r;var c=e.match(YD),u=0,p="",m=0,x="",y="",_=1;if(c)for(m=0;m!=c.length;++m){for(y=c[m],l=0;l!=y.length&&y.charCodeAt(l)!==61;++l);for(x=y.slice(0,l).trim();y.charCodeAt(l+1)==32;)++l;for(_=(a=y.charCodeAt(l+1))==34||a==39?1:0,p=y.slice(l+1+_,y.length-_),u=0;u!=x.length&&x.charCodeAt(u)!==58;++u);if(u===x.length)x.indexOf("_")>0&&(x=x.slice(0,x.indexOf("_"))),r[x]=p,r[x.toLowerCase()]=p;else{var E=(u===5&&x.slice(0,5)==="xmlns"?"xmlns":"")+x.slice(u+1);if(r[E]&&x.slice(u-3,u)=="ext")continue;r[E]=p,r[E.toLowerCase()]=p}}return r}function wa(e){return e.replace(XD,"<$1")}var fT={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},KD=Vh(fT),Rt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function n(r){var a=r+"",l=a.indexOf("<![CDATA[");if(l==-1)return a.replace(e,function(u,p){return fT[u]||String.fromCharCode(parseInt(p,u.indexOf("x")>-1?16:10))||u}).replace(t,function(u,p){return String.fromCharCode(parseInt(p,16))});var c=a.indexOf("]]>");return n(a.slice(0,l))+a.slice(l+9,c)+n(a.slice(c+3))}}(),ZD=/[&<>'"]/g,QD=/[\u0000-\u001f]/g;function Gh(e){var t=e+"";return t.replace(ZD,function(n){return KD[n]}).replace(/\n/g,"<br/>").replace(QD,function(n){return"&#x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+";"})}var Zv=function(){var e=/&#(\d+);/g;function t(n,r){return String.fromCharCode(parseInt(r,10))}return function(r){return r.replace(e,t)}}();function sn(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Ld(e){for(var t="",n=0,r=0,a=0,l=0,c=0,u=0;n<e.length;){if(r=e.charCodeAt(n++),r<128){t+=String.fromCharCode(r);continue}if(a=e.charCodeAt(n++),r>191&&r<224){c=(r&31)<<6,c|=a&63,t+=String.fromCharCode(c);continue}if(l=e.charCodeAt(n++),r<240){t+=String.fromCharCode((r&15)<<12|(a&63)<<6|l&63);continue}c=e.charCodeAt(n++),u=((r&7)<<18|(a&63)<<12|(l&63)<<6|c&63)-65536,t+=String.fromCharCode(55296+(u>>>10&1023)),t+=String.fromCharCode(56320+(u&1023))}return t}function Qv(e){var t=Oi(2*e.length),n,r,a=1,l=0,c=0,u;for(r=0;r<e.length;r+=a)a=1,(u=e.charCodeAt(r))<128?n=u:u<224?(n=(u&31)*64+(e.charCodeAt(r+1)&63),a=2):u<240?(n=(u&15)*4096+(e.charCodeAt(r+1)&63)*64+(e.charCodeAt(r+2)&63),a=3):(a=4,n=(u&7)*262144+(e.charCodeAt(r+1)&63)*4096+(e.charCodeAt(r+2)&63)*64+(e.charCodeAt(r+3)&63),n-=65536,c=55296+(n>>>10&1023),n=56320+(n&1023)),c!==0&&(t[l++]=c&255,t[l++]=c>>>8,c=0),t[l++]=n%256,t[l++]=n>>>8;return t.slice(0,l).toString("ucs2")}function ey(e){return vs(e,"binary").toString("utf8")}var ku="foo bar baz",Zt=St&&(ey(ku)==Ld(ku)&&ey||Qv(ku)==Ld(ku)&&Qv)||Ld,Fo=St?function(e){return vs(e,"utf8").toString("binary")}:function(e){for(var t=[],n=0,r=0,a=0;n<e.length;)switch(r=e.charCodeAt(n++),!0){case r<128:t.push(String.fromCharCode(r));break;case r<2048:t.push(String.fromCharCode(192+(r>>6))),t.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,a=e.charCodeAt(n++)-56320+(r<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(r>>12))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(r&63)))}return t.join("")},Qo=function(){var e={};return function(n,r){var a=n+"|"+(r||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+n+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+n+">",r||"")}}(),dT=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(n){for(var r=n.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)r=r.replace(e[a][0],e[a][1]);return r}}(),e6=function(){var e={};return function(n){return e[n]!==void 0?e[n]:e[n]=new RegExp("<(?:vt:)?"+n+">([\\s\\S]*?)</(?:vt:)?"+n+">","g")}}(),t6=/<\/?(?:vt:)?variant>/g,n6=/<(?:vt:)([^>]*)>([\s\S]*)</;function ty(e,t){var n=tt(e),r=e.match(e6(n.baseType))||[],a=[];if(r.length!=n.size){if(t.WTF)throw new Error("unexpected vector length "+r.length+" != "+n.size);return a}return r.forEach(function(l){var c=l.replace(t6,"").match(n6);c&&a.push({v:Zt(c[2]),t:c[1]})}),a}var r6=/(^\s|\s$|\n)/;function a6(e){return Ea(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function i6(e,t,n){return"<"+e+(n!=null?a6(n):"")+(t!=null?(t.match(r6)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function jh(e){if(St&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Zt(ys(Ph(e)));throw new Error("Bad input format: expected Buffer or string")}var ec=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,s6={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},l6=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function o6(e,t){for(var n=1-2*(e[t+7]>>>7),r=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,l=5;l>=0;--l)a=a*256+e[t+l];return r==2047?a==0?n*(1/0):NaN:(r==0?r=-1022:(r-=1023,a+=Math.pow(2,52)),n*Math.pow(2,r-52)*a)}function c6(e,t,n){var r=(t<0||1/t==-1/0?1:0)<<7,a=0,l=0,c=r?-t:t;isFinite(c)?c==0?a=l=0:(a=Math.floor(Math.log(c)/Math.LN2),l=c*Math.pow(2,52-a),a<=-1023&&(!isFinite(l)||l<Math.pow(2,52))?a=-1022:(l-=Math.pow(2,52),a+=1023)):(a=2047,l=isNaN(t)?26985:0);for(var u=0;u<=5;++u,l/=256)e[n+u]=l&255;e[n+6]=(a&15)<<4|l&15,e[n+7]=a>>4|r}var ny=function(e){for(var t=[],n=10240,r=0;r<e[0].length;++r)if(e[0][r])for(var a=0,l=e[0][r].length;a<l;a+=n)t.push.apply(t,e[0][r].slice(a,a+n));return t},ry=St?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:vs(t)})):ny(e)}:ny,ay=function(e,t,n){for(var r=[],a=t;a<n;a+=2)r.push(String.fromCharCode(qa(e,a)));return r.join("").replace(cr,"")},zh=St?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf16le",t,n).replace(cr,""):ay(e,t,n)}:ay,iy=function(e,t,n){for(var r=[],a=t;a<t+n;++a)r.push(("0"+e[a].toString(16)).slice(-2));return r.join("")},hT=St?function(e,t,n){return Buffer.isBuffer(e)?e.toString("hex",t,t+n):iy(e,t,n)}:iy,sy=function(e,t,n){for(var r=[],a=t;a<n;a++)r.push(String.fromCharCode(cl(e,a)));return r.join("")},fc=St?function(t,n,r){return Buffer.isBuffer(t)?t.toString("utf8",n,r):sy(t,n,r)}:sy,mT=function(e,t){var n=kr(e,t);return n>0?fc(e,t+4,t+4+n-1):""},pT=mT,xT=function(e,t){var n=kr(e,t);return n>0?fc(e,t+4,t+4+n-1):""},gT=xT,vT=function(e,t){var n=2*kr(e,t);return n>0?fc(e,t+4,t+4+n-1):""},yT=vT,TT=function(t,n){var r=kr(t,n);return r>0?zh(t,n+4,n+4+r):""},_T=TT,ET=function(e,t){var n=kr(e,t);return n>0?fc(e,t+4,t+4+n):""},ST=ET,wT=function(e,t){return o6(e,t)},ef=wT,CT=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};St&&(pT=function(t,n){if(!Buffer.isBuffer(t))return mT(t,n);var r=t.readUInt32LE(n);return r>0?t.toString("utf8",n+4,n+4+r-1):""},gT=function(t,n){if(!Buffer.isBuffer(t))return xT(t,n);var r=t.readUInt32LE(n);return r>0?t.toString("utf8",n+4,n+4+r-1):""},yT=function(t,n){if(!Buffer.isBuffer(t))return vT(t,n);var r=2*t.readUInt32LE(n);return t.toString("utf16le",n+4,n+4+r-1)},_T=function(t,n){if(!Buffer.isBuffer(t))return TT(t,n);var r=t.readUInt32LE(n);return t.toString("utf16le",n+4,n+4+r)},ST=function(t,n){if(!Buffer.isBuffer(t))return ET(t,n);var r=t.readUInt32LE(n);return t.toString("utf8",n+4,n+4+r)},ef=function(t,n){return Buffer.isBuffer(t)?t.readDoubleLE(n):wT(t,n)},CT=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var cl=function(e,t){return e[t]},qa=function(e,t){return e[t+1]*256+e[t]},u6=function(e,t){var n=e[t+1]*256+e[t];return n<32768?n:(65535-n+1)*-1},kr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},as=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},f6=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Po(e,t){var n="",r,a,l=[],c,u,p,m;switch(t){case"dbcs":if(m=this.l,St&&Buffer.isBuffer(this))n=this.slice(this.l,this.l+2*e).toString("utf16le");else for(p=0;p<e;++p)n+=String.fromCharCode(qa(this,m)),m+=2;e*=2;break;case"utf8":n=fc(this,this.l,this.l+e);break;case"utf16le":e*=2,n=zh(this,this.l,this.l+e);break;case"wstr":return Po.call(this,e,"dbcs");case"lpstr-ansi":n=pT(this,this.l),e=4+kr(this,this.l);break;case"lpstr-cp":n=gT(this,this.l),e=4+kr(this,this.l);break;case"lpwstr":n=yT(this,this.l),e=4+2*kr(this,this.l);break;case"lpp4":e=4+kr(this,this.l),n=_T(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+kr(this,this.l),n=ST(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,n="";(c=cl(this,this.l+e++))!==0;)l.push(bu(c));n=l.join("");break;case"_wstr":for(e=0,n="";(c=qa(this,this.l+e))!==0;)l.push(bu(c)),e+=2;e+=2,n=l.join("");break;case"dbcs-cont":for(n="",m=this.l,p=0;p<e;++p){if(this.lens&&this.lens.indexOf(m)!==-1)return c=cl(this,m),this.l=m+1,u=Po.call(this,e-p,c?"dbcs-cont":"sbcs-cont"),l.join("")+u;l.push(bu(qa(this,m))),m+=2}n=l.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(n="",m=this.l,p=0;p!=e;++p){if(this.lens&&this.lens.indexOf(m)!==-1)return c=cl(this,m),this.l=m+1,u=Po.call(this,e-p,c?"dbcs-cont":"sbcs-cont"),l.join("")+u;l.push(bu(cl(this,m))),m+=1}n=l.join("");break;default:switch(e){case 1:return r=cl(this,this.l),this.l++,r;case 2:return r=(t==="i"?u6:qa)(this,this.l),this.l+=2,r;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(r=(e>0?as:f6)(this,this.l),this.l+=4,r):(a=kr(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=ef(this,this.l):a=ef([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:n=hT(this,this.l,e);break}}return this.l+=e,n}var d6=function(e,t,n){e[n]=t&255,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24&255},h6=function(e,t,n){e[n]=t&255,e[n+1]=t>>8&255,e[n+2]=t>>16&255,e[n+3]=t>>24&255},m6=function(e,t,n){e[n]=t&255,e[n+1]=t>>>8&255};function p6(e,t,n){var r=0,a=0;if(n==="dbcs"){for(a=0;a!=t.length;++a)m6(this,t.charCodeAt(a),this.l+2*a);r=2*t.length}else if(n==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;r=t.length}else if(n==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(n==="utf16le"){var l=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var c=t.charCodeAt(a);this[this.l++]=c&255,this[this.l++]=c>>8}for(;this.l<l;)this[this.l++]=0;return this}else switch(e){case 1:r=1,this[this.l]=t&255;break;case 2:r=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:r=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:r=4,d6(this,t,this.l);break;case 8:if(r=8,n==="f"){c6(this,t,this.l);break}case 16:break;case-4:r=4,h6(this,t,this.l);break}return this.l+=r,this}function AT(e,t){var n=hT(this,this.l,e.length>>1);if(n!==e)throw new Error(t+"Expected "+e+" saw "+n);this.l+=e.length>>1}function zn(e,t){e.l=t,e.read_shift=Po,e.chk=AT,e.write_shift=p6}function nr(e,t){e.l+=t}function Nn(e){var t=Oi(e);return zn(t,0),t}function ei(e,t,n){if(e){var r,a,l;zn(e,e.l||0);for(var c=e.length,u=0,p=0;e.l<c;){u=e.read_shift(1),u&128&&(u=(u&127)+((e.read_shift(1)&127)<<7));var m=lf[u]||lf[65535];for(r=e.read_shift(1),l=r&127,a=1;a<4&&r&128;++a)l+=((r=e.read_shift(1))&127)<<7*a;p=e.l+l;var x=m.f&&m.f(e,l,n);if(e.l=p,t(x,m,u))return}}}function fh(){var e=[],t=St?256:2048,n=function(m){var x=Nn(m);return zn(x,0),x},r=n(t),a=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&e.push(r),r=null)},l=function(m){return r&&m<r.length-r.l?r:(a(),r=n(Math.max(m+1,t)))},c=function(){return a(),bi(e)},u=function(m){a(),r=m,r.l==null&&(r.l=r.length),l(t)};return{next:l,push:u,end:c,_bufs:e}}function Uo(e,t,n){var r=qn(e);if(t.s?(r.cRel&&(r.c+=t.s.c),r.rRel&&(r.r+=t.s.r)):(r.cRel&&(r.c+=t.c),r.rRel&&(r.r+=t.r)),!n||n.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function ly(e,t,n){var r=qn(e);return r.s=Uo(r.s,t.s,n),r.e=Uo(r.e,t.s,n),r}function Bo(e,t){if(e.cRel&&e.c<0)for(e=qn(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=qn(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var n=it(e);return!e.cRel&&e.cRel!=null&&(n=v6(n)),!e.rRel&&e.rRel!=null&&(n=x6(n)),n}function Od(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Mn(e.s.c)+":"+(e.e.cRel?"":"$")+Mn(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+$n(e.s.r)+":"+(e.e.rRel?"":"$")+$n(e.e.r):Bo(e.s,t.biff)+":"+Bo(e.e,t.biff)}function qh(e){return parseInt(g6(e),10)-1}function $n(e){return""+(e+1)}function x6(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function g6(e){return e.replace(/\$(\d+)$/,"$1")}function $h(e){for(var t=y6(e),n=0,r=0;r!==t.length;++r)n=26*n+t.charCodeAt(r)-64;return n-1}function Mn(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function v6(e){return e.replace(/^([A-Z])/,"$$$1")}function y6(e){return e.replace(/^\$([A-Z])/,"$1")}function T6(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function or(e){for(var t=0,n=0,r=0;r<e.length;++r){var a=e.charCodeAt(r);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(n=26*n+(a-64))}return{c:n-1,r:t-1}}function it(e){for(var t=e.c+1,n="";t;t=(t-1)/26|0)n=String.fromCharCode((t-1)%26+65)+n;return n+(e.r+1)}function Nl(e){var t=e.indexOf(":");return t==-1?{s:or(e),e:or(e)}:{s:or(e.slice(0,t)),e:or(e.slice(t+1))}}function Nt(e,t){return typeof t>"u"||typeof t=="number"?Nt(e.s,e.e):(typeof e!="string"&&(e=it(e)),typeof t!="string"&&(t=it(t)),e==t?e:e+":"+t)}function pn(e){var t={s:{c:0,r:0},e:{c:0,r:0}},n=0,r=0,a=0,l=e.length;for(n=0;r<l&&!((a=e.charCodeAt(r)-64)<1||a>26);++r)n=26*n+a;for(t.s.c=--n,n=0;r<l&&!((a=e.charCodeAt(r)-48)<0||a>9);++r)n=10*n+a;if(t.s.r=--n,r===l||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++r,n=0;r!=l&&!((a=e.charCodeAt(r)-64)<1||a>26);++r)n=26*n+a;for(t.e.c=--n,n=0;r!=l&&!((a=e.charCodeAt(r)-48)<0||a>9);++r)n=10*n+a;return t.e.r=--n,t}function oy(e,t){var n=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=$r(e.z,n?fr(t):t)}catch{}try{return e.w=$r((e.XF||{}).numFmtId||(n?14:0),n?fr(t):t)}catch{return""+t}}function Ka(e,t,n){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&n&&n.dateNF&&(e.z=n.dateNF),e.t=="e"?Es[e.v]||e.v:t==null?oy(e,e.v):oy(e,t))}function Ui(e,t){var n=t&&t.sheet?t.sheet:"Sheet1",r={};return r[n]=e,{SheetNames:[n],Sheets:r}}function bT(e,t,n){var r=n||{},a=e?Array.isArray(e):r.dense,l=e||(a?[]:{}),c=0,u=0;if(l&&r.origin!=null){if(typeof r.origin=="number")c=r.origin;else{var p=typeof r.origin=="string"?or(r.origin):r.origin;c=p.r,u=p.c}l["!ref"]||(l["!ref"]="A1:A1")}var m={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(l["!ref"]){var x=pn(l["!ref"]);m.s.c=x.s.c,m.s.r=x.s.r,m.e.c=Math.max(m.e.c,x.e.c),m.e.r=Math.max(m.e.r,x.e.r),c==-1&&(m.e.r=c=x.e.r+1)}for(var y=0;y!=t.length;++y)if(t[y]){if(!Array.isArray(t[y]))throw new Error("aoa_to_sheet expects an array of arrays");for(var _=0;_!=t[y].length;++_)if(!(typeof t[y][_]>"u")){var E={v:t[y][_]},w=c+y,S=u+_;if(m.s.r>w&&(m.s.r=w),m.s.c>S&&(m.s.c=S),m.e.r<w&&(m.e.r=w),m.e.c<S&&(m.e.c=S),t[y][_]&&typeof t[y][_]=="object"&&!Array.isArray(t[y][_])&&!(t[y][_]instanceof Date))E=t[y][_];else if(Array.isArray(E.v)&&(E.f=t[y][_][1],E.v=E.v[0]),E.v===null)if(E.f)E.t="n";else if(r.nullError)E.t="e",E.v=0;else if(r.sheetStubs)E.t="z";else continue;else typeof E.v=="number"?E.t="n":typeof E.v=="boolean"?E.t="b":E.v instanceof Date?(E.z=r.dateNF||lt[14],r.cellDates?(E.t="d",E.w=$r(E.z,fr(E.v))):(E.t="n",E.v=fr(E.v),E.w=$r(E.z,E.v))):E.t="s";if(a)l[w]||(l[w]=[]),l[w][S]&&l[w][S].z&&(E.z=l[w][S].z),l[w][S]=E;else{var C=it({c:S,r:w});l[C]&&l[C].z&&(E.z=l[C].z),l[C]=E}}}return m.s.c<1e7&&(l["!ref"]=Nt(m)),l}function Ml(e,t){return bT(null,e,t)}function _6(e){return e.read_shift(4,"i")}function tr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function E6(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Yh(e,t){var n=e.l,r=e.read_shift(1),a=tr(e),l=[],c={t:a,h:a};if((r&1)!==0){for(var u=e.read_shift(4),p=0;p!=u;++p)l.push(E6(e));c.r=l}else c.r=[{ich:0,ifnt:0}];return e.l=n+t,c}var S6=Yh;function Wr(e){var t=e.read_shift(4),n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:n}}function Ts(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var w6=tr;function Wh(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var C6=tr,dh=Wh;function Jh(e){var t=e.slice(e.l,e.l+4),n=t[0]&1,r=t[0]&2;e.l+=4;var a=r===0?ef([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):as(t,0)>>2;return n?a/100:a}function kT(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var _s=kT;function Zn(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function A6(e){var t={},n=e.read_shift(1),r=n>>>1,a=e.read_shift(1),l=e.read_shift(2,"i"),c=e.read_shift(1),u=e.read_shift(1),p=e.read_shift(1);switch(e.l++,r){case 0:t.auto=1;break;case 1:t.index=a;var m=ls[a];m&&(t.rgb=nc(m));break;case 2:t.rgb=nc([c,u,p]);break;case 3:t.theme=a;break}return l!=0&&(t.tint=l>0?l/32767:l/32768),t}function b6(e){var t=e.read_shift(1);e.l++;var n={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return n}function NT(e,t){var n={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},r=e.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return n[e.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function k6(e){return NT(e,1)}function N6(e){return NT(e,2)}var Xh=2,gr=3,Nu=11,cy=12,tf=19,Mu=64,M6=65,R6=71,D6=4108,I6=4126,Pn=80,MT=81,F6=[Pn,MT],L6={1:{n:"CodePage",t:Xh},2:{n:"Category",t:Pn},3:{n:"PresentationFormat",t:Pn},4:{n:"ByteCount",t:gr},5:{n:"LineCount",t:gr},6:{n:"ParagraphCount",t:gr},7:{n:"SlideCount",t:gr},8:{n:"NoteCount",t:gr},9:{n:"HiddenCount",t:gr},10:{n:"MultimediaClipCount",t:gr},11:{n:"ScaleCrop",t:Nu},12:{n:"HeadingPairs",t:D6},13:{n:"TitlesOfParts",t:I6},14:{n:"Manager",t:Pn},15:{n:"Company",t:Pn},16:{n:"LinksUpToDate",t:Nu},17:{n:"CharacterCount",t:gr},19:{n:"SharedDoc",t:Nu},22:{n:"HyperlinksChanged",t:Nu},23:{n:"AppVersion",t:gr,p:"version"},24:{n:"DigSig",t:M6},26:{n:"ContentType",t:Pn},27:{n:"ContentStatus",t:Pn},28:{n:"Language",t:Pn},29:{n:"Version",t:Pn},255:{},2147483648:{n:"Locale",t:tf},2147483651:{n:"Behavior",t:tf},1919054434:{}},O6={1:{n:"CodePage",t:Xh},2:{n:"Title",t:Pn},3:{n:"Subject",t:Pn},4:{n:"Author",t:Pn},5:{n:"Keywords",t:Pn},6:{n:"Comments",t:Pn},7:{n:"Template",t:Pn},8:{n:"LastAuthor",t:Pn},9:{n:"RevNumber",t:Pn},10:{n:"EditTime",t:Mu},11:{n:"LastPrinted",t:Mu},12:{n:"CreatedDate",t:Mu},13:{n:"ModifiedDate",t:Mu},14:{n:"PageCount",t:gr},15:{n:"WordCount",t:gr},16:{n:"CharCount",t:gr},17:{n:"Thumbnail",t:R6},18:{n:"Application",t:Pn},19:{n:"DocSecurity",t:gr},255:{},2147483648:{n:"Locale",t:tf},2147483651:{n:"Behavior",t:tf},1919054434:{}},uy={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},P6=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function U6(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var B6=U6([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ls=qn(B6),Es={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},RT={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},fy={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function V6(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function H6(e){var t=V6();if(!e||!e.match)return t;var n={};if((e.match(rr)||[]).forEach(function(r){var a=tt(r);switch(a[0].replace(JD,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":n[a.Extension]=a.ContentType;break;case"<Override":t[fy[a.ContentType]]!==void 0&&t[fy[a.ContentType]].push(a.PartName);break}}),t.xmlns!==s6.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=n,delete t.calcchains,t}var fl={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function hh(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Vo(e,t){var n={"!id":{}};if(!e)return n;t.charAt(0)!=="/"&&(t="/"+t);var r={};return(e.match(rr)||[]).forEach(function(a){var l=tt(a);if(l[0]==="<Relationship"){var c={};c.Type=l.Type,c.Target=l.Target,c.Id=l.Id,l.TargetMode&&(c.TargetMode=l.TargetMode);var u=l.TargetMode==="External"?l.Target:Io(l.Target,t);n[u]=c,r[l.Id]=c}}),n["!id"]=r,n}var G6="application/vnd.oasis.opendocument.spreadsheet";function j6(e,t){for(var n=jh(e),r,a;r=ec.exec(n);)switch(r[3]){case"manifest":break;case"file-entry":if(a=tt(r[0],!1),a.path=="/"&&a.type!==G6)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw r}}var Ho=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],z6=function(){for(var e=new Array(Ho.length),t=0;t<Ho.length;++t){var n=Ho[t],r="(?:"+n[0].slice(0,n[0].indexOf(":"))+":)"+n[0].slice(n[0].indexOf(":")+1);e[t]=new RegExp("<"+r+"[^>]*>([\\s\\S]*?)</"+r+">")}return e}();function DT(e){var t={};e=Zt(e);for(var n=0;n<Ho.length;++n){var r=Ho[n],a=e.match(z6[n]);a!=null&&a.length>0&&(t[r[1]]=Rt(a[1])),r[2]==="date"&&t[r[1]]&&(t[r[1]]=Un(t[r[1]]))}return t}var q6=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function IT(e,t,n,r){var a=[];if(typeof e=="string")a=ty(e,r);else for(var l=0;l<e.length;++l)a=a.concat(e[l].map(function(x){return{v:x}}));var c=typeof t=="string"?ty(t,r).map(function(x){return x.v}):t,u=0,p=0;if(c.length>0)for(var m=0;m!==a.length;m+=2){switch(p=+a[m+1].v,a[m].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":n.Worksheets=p,n.SheetNames=c.slice(u,u+p);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":n.NamedRanges=p,n.DefinedNames=c.slice(u,u+p);break;case"Charts":case"Diagramme":n.Chartsheets=p,n.ChartNames=c.slice(u,u+p);break}u+=p}}function $6(e,t,n){var r={};return t||(t={}),e=Zt(e),q6.forEach(function(a){var l=(e.match(Qo(a[0]))||[])[1];switch(a[2]){case"string":l&&(t[a[1]]=Rt(l));break;case"bool":t[a[1]]=l==="true";break;case"raw":var c=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));c&&c.length>0&&(r[a[1]]=c[1]);break}}),r.HeadingPairs&&r.TitlesOfParts&&IT(r.HeadingPairs,r.TitlesOfParts,t,n),t}var Y6=/<[^>]+>[^<]*/g;function W6(e,t){var n={},r="",a=e.match(Y6);if(a)for(var l=0;l!=a.length;++l){var c=a[l],u=tt(c);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":r=Rt(u.name);break;case"</property>":r=null;break;default:if(c.indexOf("<vt:")===0){var p=c.split(">"),m=p[0].slice(4),x=p[1];switch(m){case"lpstr":case"bstr":case"lpwstr":n[r]=Rt(x);break;case"bool":n[r]=sn(x);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":n[r]=parseInt(x,10);break;case"r4":case"r8":case"decimal":n[r]=parseFloat(x);break;case"filetime":case"date":n[r]=Un(x);break;case"cy":case"error":n[r]=Rt(x);break;default:if(m.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",c,m,p)}}else if(c.slice(0,2)!=="</"){if(t.WTF)throw new Error(c)}}}return n}var J6={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Pd;function X6(e,t,n){Pd||(Pd=Vh(J6)),t=Pd[t]||t,e[t]=n}function Kh(e){var t=e.read_shift(4),n=e.read_shift(4);return new Date((n/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function FT(e,t,n){var r=e.l,a=e.read_shift(0,"lpstr-cp");if(n)for(;e.l-r&3;)++e.l;return a}function LT(e,t,n){var r=e.read_shift(0,"lpwstr");return r}function OT(e,t,n){return t===31?LT(e):FT(e,t,n)}function mh(e,t,n){return OT(e,t,n===!1?0:4)}function K6(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return OT(e,t,0)}function Z6(e){for(var t=e.read_shift(4),n=[],r=0;r!=t;++r){var a=e.l;n[r]=e.read_shift(0,"lpwstr").replace(cr,""),e.l-a&2&&(e.l+=2)}return n}function Q6(e){for(var t=e.read_shift(4),n=[],r=0;r!=t;++r)n[r]=e.read_shift(0,"lpstr-cp").replace(cr,"");return n}function eI(e){var t=e.l,n=nf(e,MT);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var r=nf(e,gr);return[n,r]}function tI(e){for(var t=e.read_shift(4),n=[],r=0;r<t/2;++r)n.push(eI(e));return n}function dy(e,t){for(var n=e.read_shift(4),r={},a=0;a!=n;++a){var l=e.read_shift(4),c=e.read_shift(4);r[l]=e.read_shift(c,t===1200?"utf16le":"utf8").replace(cr,"").replace(Do,"!"),t===1200&&c%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),r}function PT(e){var t=e.read_shift(4),n=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),n}function nI(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function nf(e,t,n){var r=e.read_shift(2),a,l=n||{};if(e.l+=2,t!==cy&&r!==t&&F6.indexOf(t)===-1&&!((t&65534)==4126&&(r&65534)==4126))throw new Error("Expected type "+t+" saw "+r);switch(t===cy?r:t){case 2:return a=e.read_shift(2,"i"),l.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return FT(e,r,4).replace(cr,"");case 31:return LT(e);case 64:return Kh(e);case 65:return PT(e);case 71:return nI(e);case 80:return mh(e,r,!l.raw).replace(cr,"");case 81:return K6(e,r).replace(cr,"");case 4108:return tI(e);case 4126:case 4127:return r==4127?Z6(e):Q6(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+r)}}function hy(e,t){var n=e.l,r=e.read_shift(4),a=e.read_shift(4),l=[],c=0,u=0,p=-1,m={};for(c=0;c!=a;++c){var x=e.read_shift(4),y=e.read_shift(4);l[c]=[x,y+n]}l.sort(function(k,b){return k[1]-b[1]});var _={};for(c=0;c!=a;++c){if(e.l!==l[c][1]){var E=!0;if(c>0&&t)switch(t[l[c-1][0]].t){case 2:e.l+2===l[c][1]&&(e.l+=2,E=!1);break;case 80:e.l<=l[c][1]&&(e.l=l[c][1],E=!1);break;case 4108:e.l<=l[c][1]&&(e.l=l[c][1],E=!1);break}if((!t||c==0)&&e.l<=l[c][1]&&(E=!1,e.l=l[c][1]),E)throw new Error("Read Error: Expected address "+l[c][1]+" at "+e.l+" :"+c)}if(t){var w=t[l[c][0]];if(_[w.n]=nf(e,w.t,{raw:!0}),w.p==="version"&&(_[w.n]=String(_[w.n]>>16)+"."+("0000"+String(_[w.n]&65535)).slice(-4)),w.n=="CodePage")switch(_[w.n]){case 0:_[w.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ra(u=_[w.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+_[w.n])}}else if(l[c][0]===1){if(u=_.CodePage=nf(e,Xh),ra(u),p!==-1){var S=e.l;e.l=l[p][1],m=dy(e,u),e.l=S}}else if(l[c][0]===0){if(u===0){p=c,e.l=l[c+1][1];continue}m=dy(e,u)}else{var C=m[l[c][0]],M;switch(e[e.l]){case 65:e.l+=4,M=PT(e);break;case 30:e.l+=4,M=mh(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,M=mh(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,M=e.read_shift(4,"i");break;case 19:e.l+=4,M=e.read_shift(4);break;case 5:e.l+=4,M=e.read_shift(8,"f");break;case 11:e.l+=4,M=vn(e,4);break;case 64:e.l+=4,M=Un(Kh(e));break;default:throw new Error("unparsed value: "+e[e.l])}_[C]=M}}return e.l=n+r,_}function my(e,t,n){var r=e.content;if(!r)return{};zn(r,0);var a,l,c,u,p=0;r.chk("feff","Byte Order: "),r.read_shift(2);var m=r.read_shift(4),x=r.read_shift(16);if(x!==bt.utils.consts.HEADER_CLSID&&x!==n)throw new Error("Bad PropertySet CLSID "+x);if(a=r.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(l=r.read_shift(16),u=r.read_shift(4),a===1&&u!==r.l)throw new Error("Length mismatch: "+u+" !== "+r.l);a===2&&(c=r.read_shift(16),p=r.read_shift(4));var y=hy(r,t),_={SystemIdentifier:m};for(var E in y)_[E]=y[E];if(_.FMTID=l,a===1)return _;if(p-r.l==2&&(r.l+=2),r.l!==p)throw new Error("Length mismatch 2: "+r.l+" !== "+p);var w;try{w=hy(r,null)}catch{}for(E in w)_[E]=w[E];return _.FMTID=[l,c],_}function Ci(e,t){return e.read_shift(t),null}function rI(e,t,n){for(var r=[],a=e.l+t;e.l<a;)r.push(n(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return r}function vn(e,t){return e.read_shift(t)===1}function Sn(e){return e.read_shift(2,"u")}function UT(e,t){return rI(e,t,Sn)}function aI(e){var t=e.read_shift(1),n=e.read_shift(1);return n===1?t:t===1}function dc(e,t,n){var r=e.read_shift(n&&n.biff>=12?2:1),a="sbcs-cont";if(n&&n.biff>=8,!n||n.biff==8){var l=e.read_shift(1);l&&(a="dbcs-cont")}else n.biff==12&&(a="wstr");n.biff>=2&&n.biff<=5&&(a="cpstr");var c=r?e.read_shift(r,a):"";return c}function iI(e){var t=e.read_shift(2),n=e.read_shift(1),r=n&4,a=n&8,l=1+(n&1),c=0,u,p={};a&&(c=e.read_shift(2)),r&&(u=e.read_shift(4));var m=l==2?"dbcs-cont":"sbcs-cont",x=t===0?"":e.read_shift(t,m);return a&&(e.l+=4*c),r&&(e.l+=u),p.t=x,a||(p.raw="<t>"+p.t+"</t>",p.r=p.t),p}function ps(e,t,n){var r;if(n){if(n.biff>=2&&n.biff<=5)return e.read_shift(t,"cpstr");if(n.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?r=e.read_shift(t,"sbcs-cont"):r=e.read_shift(t,"dbcs-cont"),r}function hc(e,t,n){var r=e.read_shift(n&&n.biff==2?1:2);return r===0?(e.l++,""):ps(e,r,n)}function Ss(e,t,n){if(n.biff>5)return hc(e,t,n);var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,n.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function sI(e){var t=e.read_shift(1);e.l++;var n=e.read_shift(2);return e.l+=2,[t,n]}function lI(e){var t=e.read_shift(4),n=e.l,r=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(r=!0),e.l=n);var a=e.read_shift((r?t-24:t)>>1,"utf16le").replace(cr,"");return r&&(e.l+=24),a}function oI(e){for(var t=e.read_shift(2),n="";t-- >0;)n+="../";var r=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return n+r.replace(/\\/g,"/");var l=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var c=e.read_shift(l>>1,"utf16le").replace(cr,"");return n+c}function cI(e,t){var n=e.read_shift(16);switch(n){case"e0c9ea79f9bace118c8200aa004ba90b":return lI(e);case"0303000000000000c000000000000046":return oI(e);default:throw new Error("Unsupported Moniker "+n)}}function Ru(e){var t=e.read_shift(4),n=t>0?e.read_shift(t,"utf16le").replace(cr,""):"";return n}function uI(e,t){var n=e.l+t,r=e.read_shift(4);if(r!==2)throw new Error("Unrecognized streamVersion: "+r);var a=e.read_shift(2);e.l+=2;var l,c,u,p,m="",x,y;a&16&&(l=Ru(e,n-e.l)),a&128&&(c=Ru(e,n-e.l)),(a&257)===257&&(u=Ru(e,n-e.l)),(a&257)===1&&(p=cI(e,n-e.l)),a&8&&(m=Ru(e,n-e.l)),a&32&&(x=e.read_shift(16)),a&64&&(y=Kh(e)),e.l=n;var _=c||u||p||"";_&&m&&(_+="#"+m),_||(_="#"+m),a&2&&_.charAt(0)=="/"&&_.charAt(1)!="/"&&(_="file://"+_);var E={Target:_};return x&&(E.guid=x),y&&(E.time=y),l&&(E.Tooltip=l),E}function BT(e){var t=e.read_shift(1),n=e.read_shift(1),r=e.read_shift(1),a=e.read_shift(1);return[t,n,r,a]}function VT(e,t){var n=BT(e);return n[3]=0,n}function Ca(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(2);return{r:t,c:n,ixfe:r}}function fI(e){var t=e.read_shift(2),n=e.read_shift(2);return e.l+=8,{type:t,flags:n}}function dI(e,t,n){return t===0?"":Ss(e,t,n)}function hI(e,t,n){var r=n.biff>8?4:2,a=e.read_shift(r),l=e.read_shift(r,"i"),c=e.read_shift(r,"i");return[a,l,c]}function HT(e){var t=e.read_shift(2),n=Jh(e);return[t,n]}function mI(e,t,n){e.l+=4,t-=4;var r=e.l+t,a=dc(e,t,n),l=e.read_shift(2);if(r-=e.l,l!==r)throw new Error("Malformed AddinUdf: padding = "+r+" != "+l);return e.l+=l,a}function yf(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return{s:{c:r,r:t},e:{c:a,r:n}}}function GT(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(1),a=e.read_shift(1);return{s:{c:r,r:t},e:{c:a,r:n}}}var pI=GT;function jT(e){e.l+=4;var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(2);return e.l+=12,[n,t,r]}function xI(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function gI(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Xn(e){e.l+=2,e.l+=e.read_shift(2)}var vI={0:Xn,4:Xn,5:Xn,6:Xn,7:gI,8:Xn,9:Xn,10:Xn,11:Xn,12:Xn,13:xI,14:Xn,15:Xn,16:Xn,17:Xn,18:Xn,19:Xn,20:Xn,21:jT};function yI(e,t){for(var n=e.l+t,r=[];e.l<n;){var a=e.read_shift(2);e.l-=2;try{r.push(vI[a](e,n-e.l))}catch{return e.l=n,r}}return e.l!=n&&(e.l=n),r}function Du(e,t){var n={BIFFVer:0,dt:0};switch(n.BIFFVer=e.read_shift(2),t-=2,t>=2&&(n.dt=e.read_shift(2),e.l-=2),n.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+n.BIFFVer)}return e.read_shift(t),n}function TI(e,t){return t===0||e.read_shift(2),1200}function _I(e,t,n){if(n.enc)return e.l+=t,"";var r=e.l,a=Ss(e,0,n);return e.read_shift(t+r-e.l),a}function EI(e,t,n){var r=n&&n.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:r&16,fBelow:r&64,fRight:r&128}}function SI(e,t,n){var r=e.read_shift(4),a=e.read_shift(1)&3,l=e.read_shift(1);switch(l){case 0:l="Worksheet";break;case 1:l="Macrosheet";break;case 2:l="Chartsheet";break;case 6:l="VBAModule";break}var c=dc(e,0,n);return c.length===0&&(c="Sheet1"),{pos:r,hs:a,dt:l,name:c}}function wI(e,t){for(var n=e.l+t,r=e.read_shift(4),a=e.read_shift(4),l=[],c=0;c!=a&&e.l<n;++c)l.push(iI(e));return l.Count=r,l.Unique=a,l}function CI(e,t){var n={};return n.dsst=e.read_shift(2),e.l+=t-2,n}function AI(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var n=e.read_shift(2);e.l+=4;var r=e.read_shift(1);return e.l+=3,r&7&&(t.level=r&7),r&32&&(t.hidden=!0),r&64&&(t.hpt=n/20),t}function bI(e){var t=fI(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var n=e.read_shift(4);return n!==0}function kI(e){return e.read_shift(2),e.read_shift(4)}function py(e,t,n){var r=0;n&&n.biff==2||(r=e.read_shift(2));var a=e.read_shift(2);n&&n.biff==2&&(r=1-(a>>15),a&=32767);var l={Unsynced:r&1,DyZero:(r&2)>>1,ExAsc:(r&4)>>2,ExDsc:(r&8)>>3};return[l,a]}function NI(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2),p=e.read_shift(2),m=e.read_shift(2);return{Pos:[t,n],Dim:[r,a],Flags:l,CurTab:c,FirstTab:u,Selected:p,TabRatio:m}}function MI(e,t,n){if(n&&n.biff>=2&&n.biff<5)return{};var r=e.read_shift(2);return{RTL:r&64}}function RI(){}function DI(e,t,n){var r={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(n&&n.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return r.name=dc(e,0,n),r}function II(e){var t=Ca(e);return t.isst=e.read_shift(4),t}function FI(e,t,n){n.biffguess&&n.biff==2&&(n.biff=5);var r=e.l+t,a=Ca(e);n.biff==2&&e.l++;var l=hc(e,r-e.l,n);return a.val=l,a}function LI(e,t,n){var r=e.read_shift(2),a=Ss(e,0,n);return[r,a]}var OI=Ss;function xy(e,t,n){var r=e.l+t,a=n.biff==8||!n.biff?4:2,l=e.read_shift(a),c=e.read_shift(a),u=e.read_shift(2),p=e.read_shift(2);return e.l=r,{s:{r:l,c:u},e:{r:c,c:p}}}function PI(e){var t=e.read_shift(2),n=e.read_shift(2),r=HT(e);return{r:t,c:n,ixfe:r[0],rknum:r[1]}}function UI(e,t){for(var n=e.l+t-2,r=e.read_shift(2),a=e.read_shift(2),l=[];e.l<n;)l.push(HT(e));if(e.l!==n)throw new Error("MulRK read error");var c=e.read_shift(2);if(l.length!=c-a+1)throw new Error("MulRK length mismatch");return{r,c:a,C:c,rkrec:l}}function BI(e,t){for(var n=e.l+t-2,r=e.read_shift(2),a=e.read_shift(2),l=[];e.l<n;)l.push(e.read_shift(2));if(e.l!==n)throw new Error("MulBlank read error");var c=e.read_shift(2);if(l.length!=c-a+1)throw new Error("MulBlank length mismatch");return{r,c:a,C:c,ixfe:l}}function VI(e,t,n,r){var a={},l=e.read_shift(4),c=e.read_shift(4),u=e.read_shift(4),p=e.read_shift(2);return a.patternType=P6[u>>26],r.cellStyles&&(a.alc=l&7,a.fWrap=l>>3&1,a.alcV=l>>4&7,a.fJustLast=l>>7&1,a.trot=l>>8&255,a.cIndent=l>>16&15,a.fShrinkToFit=l>>20&1,a.iReadOrder=l>>22&2,a.fAtrNum=l>>26&1,a.fAtrFnt=l>>27&1,a.fAtrAlc=l>>28&1,a.fAtrBdr=l>>29&1,a.fAtrPat=l>>30&1,a.fAtrProt=l>>31&1,a.dgLeft=c&15,a.dgRight=c>>4&15,a.dgTop=c>>8&15,a.dgBottom=c>>12&15,a.icvLeft=c>>16&127,a.icvRight=c>>23&127,a.grbitDiag=c>>30&3,a.icvTop=u&127,a.icvBottom=u>>7&127,a.icvDiag=u>>14&127,a.dgDiag=u>>21&15,a.icvFore=p&127,a.icvBack=p>>7&127,a.fsxButton=p>>14&1),a}function HI(e,t,n){var r={};return r.ifnt=e.read_shift(2),r.numFmtId=e.read_shift(2),r.flags=e.read_shift(2),r.fStyle=r.flags>>2&1,t-=6,r.data=VI(e,t,r.fStyle,n),r}function GI(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function gy(e,t,n){var r=Ca(e);(n.biff==2||t==9)&&++e.l;var a=aI(e);return r.val=a,r.t=a===!0||a===!1?"b":"e",r}function jI(e,t,n){n.biffguess&&n.biff==2&&(n.biff=5);var r=Ca(e),a=Zn(e);return r.val=a,r}var vy=dI;function zI(e,t,n){var r=e.l+t,a=e.read_shift(2),l=e.read_shift(2);if(n.sbcch=l,l==1025||l==14849)return[l,a];if(l<1||l>255)throw new Error("Unexpected SupBook type: "+l);for(var c=ps(e,l),u=[];r>e.l;)u.push(hc(e));return[l,a,c,u]}function yy(e,t,n){var r=e.read_shift(2),a,l={fBuiltIn:r&1,fWantAdvise:r>>>1&1,fWantPict:r>>>2&1,fOle:r>>>3&1,fOleLink:r>>>4&1,cf:r>>>5&1023,fIcon:r>>>15&1};return n.sbcch===14849&&(a=mI(e,t-2,n)),l.body=a||e.read_shift(t-2),typeof a=="string"&&(l.Name=a),l}var qI=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Ty(e,t,n){var r=e.l+t,a=e.read_shift(2),l=e.read_shift(1),c=e.read_shift(1),u=e.read_shift(n&&n.biff==2?1:2),p=0;(!n||n.biff>=5)&&(n.biff!=5&&(e.l+=2),p=e.read_shift(2),n.biff==5&&(e.l+=2),e.l+=4);var m=ps(e,c,n);a&32&&(m=qI[m.charCodeAt(0)]);var x=r-e.l;n&&n.biff==2&&--x;var y=r==e.l||u===0||!(x>0)?[]:AO(e,x,n,u);return{chKey:l,Name:m,itab:p,rgce:y}}function zT(e,t,n){if(n.biff<8)return $I(e,t,n);for(var r=[],a=e.l+t,l=e.read_shift(n.biff>8?4:2);l--!==0;)r.push(hI(e,n.biff>8?12:6,n));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return r}function $I(e,t,n){e[e.l+1]==3&&e[e.l]++;var r=dc(e,t,n);return r.charCodeAt(0)==3?r.slice(1):r}function YI(e,t,n){if(n.biff<8){e.l+=t;return}var r=e.read_shift(2),a=e.read_shift(2),l=ps(e,r,n),c=ps(e,a,n);return[l,c]}function WI(e,t,n){var r=GT(e);e.l++;var a=e.read_shift(1);return t-=8,[bO(e,t,n),a,r]}function _y(e,t,n){var r=pI(e);switch(n.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[r,wO(e,t,n)]}function JI(e){var t=e.read_shift(4)!==0,n=e.read_shift(4)!==0,r=e.read_shift(4);return[t,n,r]}function XI(e,t,n){if(!(n.biff<8)){var r=e.read_shift(2),a=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),u=Ss(e,0,n);return n.biff<8&&e.read_shift(1),[{r,c:a},u,c,l]}}function KI(e,t,n){return XI(e,t,n)}function ZI(e,t){for(var n=[],r=e.read_shift(2);r--;)n.push(yf(e));return n}function QI(e,t,n){if(n&&n.biff<8)return t8(e,t,n);var r=jT(e),a=yI(e,t-22,r[1]);return{cmo:r,ft:a}}var e8={8:function(e,t){var n=e.l+t;e.l+=10;var r=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=n,{fmt:r}}};function t8(e,t,n){e.l+=4;var r=e.read_shift(2),a=e.read_shift(2),l=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var c=[];return c.push((e8[r]||nr)(e,t,n)),{cmo:[a,r,l],ft:c}}function n8(e,t,n){var r=e.l,a="";try{e.l+=4;var l=(n.lastobj||{cmo:[0,0]}).cmo[1],c;[0,5,7,11,12,14].indexOf(l)==-1?e.l+=6:c=sI(e,6,n);var u=e.read_shift(2);e.read_shift(2),Sn(e,2);var p=e.read_shift(2);e.l+=p;for(var m=1;m<e.lens.length-1;++m){if(e.l-r!=e.lens[m])throw new Error("TxO: bad continue record");var x=e[e.l],y=ps(e,e.lens[m+1]-e.lens[m]-1);if(a+=y,a.length>=(x?u:2*u))break}if(a.length!==u&&a.length!==u*2)throw new Error("cchText: "+u+" != "+a.length);return e.l=r+t,{t:a}}catch{return e.l=r+t,{t:a}}}function r8(e,t){var n=yf(e);e.l+=16;var r=uI(e,t-24);return[n,r]}function a8(e,t){e.read_shift(2);var n=yf(e),r=e.read_shift((t-10)/2,"dbcs-cont");return r=r.replace(cr,""),[n,r]}function i8(e){var t=[0,0],n;return n=e.read_shift(2),t[0]=uy[n]||n,n=e.read_shift(2),t[1]=uy[n]||n,t}function s8(e){for(var t=e.read_shift(2),n=[];t-- >0;)n.push(VT(e));return n}function l8(e){for(var t=e.read_shift(2),n=[];t-- >0;)n.push(VT(e));return n}function o8(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function qT(e,t,n){if(!n.cellStyles)return nr(e,t);var r=n&&n.biff>=12?4:2,a=e.read_shift(r),l=e.read_shift(r),c=e.read_shift(r),u=e.read_shift(r),p=e.read_shift(2);r==2&&(e.l+=2);var m={s:a,e:l,w:c,ixfe:u,flags:p};return(n.biff>=5||!n.biff)&&(m.level=p>>8&7),m}function c8(e,t){var n={};return t<32||(e.l+=16,n.header=Zn(e),n.footer=Zn(e),e.l+=2),n}function u8(e,t,n){var r={area:!1};if(n.biff!=5)return e.l+=t,r;var a=e.read_shift(1);return e.l+=3,a&16&&(r.area=!0),r}var f8=Ca,d8=UT,h8=hc;function m8(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(4),a={fmt:t,env:n,len:r,data:e.slice(e.l,e.l+r)};return e.l+=r,a}function p8(e,t,n){n.biffguess&&n.biff==5&&(n.biff=2);var r=Ca(e);++e.l;var a=Ss(e,t-7,n);return r.t="str",r.val=a,r}function x8(e){var t=Ca(e);++e.l;var n=Zn(e);return t.t="n",t.val=n,t}function g8(e){var t=Ca(e);++e.l;var n=e.read_shift(2);return t.t="n",t.val=n,t}function v8(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function y8(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function T8(e,t,n){var r=e.l+t,a=Ca(e),l=e.read_shift(2),c=ps(e,l,n);return e.l=r,a.t="str",a.val=c,a}var _8=[2,3,48,49,131,139,140,245],Ey=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Vh({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function n(u,p){var m=[],x=Oi(1);switch(p.type){case"base64":x=na(Mr(u));break;case"binary":x=na(u);break;case"buffer":case"array":x=u;break}zn(x,0);var y=x.read_shift(1),_=!!(y&136),E=!1,w=!1;switch(y){case 2:break;case 3:break;case 48:E=!0,_=!0;break;case 49:E=!0,_=!0;break;case 131:break;case 139:break;case 140:w=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+y.toString(16))}var S=0,C=521;y==2&&(S=x.read_shift(2)),x.l+=3,y!=2&&(S=x.read_shift(4)),S>1048576&&(S=1e6),y!=2&&(C=x.read_shift(2));var M=x.read_shift(2),k=p.codepage||1252;y!=2&&(x.l+=16,x.read_shift(1),x[x.l]!==0&&(k=e[x[x.l]]),x.l+=1,x.l+=2),w&&(x.l+=36);for(var b=[],U={},G=Math.min(x.length,y==2?521:C-10-(E?264:0)),J=w?32:11;x.l<G&&x[x.l]!=13;)switch(U={},U.name=Ko.utils.decode(k,x.slice(x.l,x.l+J)).replace(/[\u0000\r\n].*$/g,""),x.l+=J,U.type=String.fromCharCode(x.read_shift(1)),y!=2&&!w&&(U.offset=x.read_shift(4)),U.len=x.read_shift(1),y==2&&(U.offset=x.read_shift(2)),U.dec=x.read_shift(1),U.name.length&&b.push(U),y!=2&&(x.l+=w?13:14),U.type){case"B":(!E||U.len!=8)&&p.WTF&&console.log("Skipping "+U.name+":"+U.type);break;case"G":case"P":p.WTF&&console.log("Skipping "+U.name+":"+U.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+U.type)}if(x[x.l]!==13&&(x.l=C-1),x.read_shift(1)!==13)throw new Error("DBF Terminator not found "+x.l+" "+x[x.l]);x.l=C;var F=0,W=0;for(m[0]=[],W=0;W!=b.length;++W)m[0][W]=b[W].name;for(;S-- >0;){if(x[x.l]===42){x.l+=M;continue}for(++x.l,m[++F]=[],W=0,W=0;W!=b.length;++W){var O=x.slice(x.l,x.l+b[W].len);x.l+=b[W].len,zn(O,0);var ee=Ko.utils.decode(k,O);switch(b[W].type){case"C":ee.trim().length&&(m[F][W]=ee.replace(/\s+$/,""));break;case"D":ee.length===8?m[F][W]=new Date(+ee.slice(0,4),+ee.slice(4,6)-1,+ee.slice(6,8)):m[F][W]=ee;break;case"F":m[F][W]=parseFloat(ee.trim());break;case"+":case"I":m[F][W]=w?O.read_shift(-4,"i")^2147483648:O.read_shift(4,"i");break;case"L":switch(ee.trim().toUpperCase()){case"Y":case"T":m[F][W]=!0;break;case"N":case"F":m[F][W]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+ee+"|")}break;case"M":if(!_)throw new Error("DBF Unexpected MEMO for type "+y.toString(16));m[F][W]="##MEMO##"+(w?parseInt(ee.trim(),10):O.read_shift(4));break;case"N":ee=ee.replace(/\u0000/g,"").trim(),ee&&ee!="."&&(m[F][W]=+ee||0);break;case"@":m[F][W]=new Date(O.read_shift(-8,"f")-621356832e5);break;case"T":m[F][W]=new Date((O.read_shift(4)-2440588)*864e5+O.read_shift(4));break;case"Y":m[F][W]=O.read_shift(4,"i")/1e4+O.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":m[F][W]=-O.read_shift(-8,"f");break;case"B":if(E&&b[W].len==8){m[F][W]=O.read_shift(8,"f");break}case"G":case"P":O.l+=b[W].len;break;case"0":if(b[W].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+b[W].type)}}}if(y!=2&&x.l<x.length&&x[x.l++]!=26)throw new Error("DBF EOF Marker missing "+(x.l-1)+" of "+x.length+" "+x[x.l-1].toString(16));return p&&p.sheetRows&&(m=m.slice(0,p.sheetRows)),p.DBF=b,m}function r(u,p){var m=p||{};m.dateNF||(m.dateNF="yyyymmdd");var x=Ml(n(u,m),m);return x["!cols"]=m.DBF.map(function(y){return{wch:y.len,DBF:y}}),delete m.DBF,x}function a(u,p){try{return Ui(r(u,p),p)}catch(m){if(p&&p.WTF)throw m}return{SheetNames:[],Sheets:{}}}var l={B:8,C:250,L:1,D:8,"?":0,"":0};function c(u,p){var m=p||{};if(+m.codepage>=0&&ra(+m.codepage),m.type=="string")throw new Error("Cannot write DBF to JS string");var x=fh(),y=_h(u,{header:1,raw:!0,cellDates:!0}),_=y[0],E=y.slice(1),w=u["!cols"]||[],S=0,C=0,M=0,k=1;for(S=0;S<_.length;++S){if(((w[S]||{}).DBF||{}).name){_[S]=w[S].DBF.name,++M;continue}if(_[S]!=null){if(++M,typeof _[S]=="number"&&(_[S]=_[S].toString(10)),typeof _[S]!="string")throw new Error("DBF Invalid column name "+_[S]+" |"+typeof _[S]+"|");if(_.indexOf(_[S])!==S){for(C=0;C<1024;++C)if(_.indexOf(_[S]+"_"+C)==-1){_[S]+="_"+C;break}}}}var b=pn(u["!ref"]),U=[],G=[],J=[];for(S=0;S<=b.e.c-b.s.c;++S){var F="",W="",O=0,ee=[];for(C=0;C<E.length;++C)E[C][S]!=null&&ee.push(E[C][S]);if(ee.length==0||_[S]==null){U[S]="?";continue}for(C=0;C<ee.length;++C){switch(typeof ee[C]){case"number":W="B";break;case"string":W="C";break;case"boolean":W="L";break;case"object":W=ee[C]instanceof Date?"D":"C";break;default:W="C"}O=Math.max(O,String(ee[C]).length),F=F&&F!=W?"C":W}O>250&&(O=250),W=((w[S]||{}).DBF||{}).type,W=="C"&&w[S].DBF.len>O&&(O=w[S].DBF.len),F=="B"&&W=="N"&&(F="N",J[S]=w[S].DBF.dec,O=w[S].DBF.len),G[S]=F=="C"||W=="N"?O:l[F]||0,k+=G[S],U[S]=F}var ne=x.next(32);for(ne.write_shift(4,318902576),ne.write_shift(4,E.length),ne.write_shift(2,296+32*M),ne.write_shift(2,k),S=0;S<4;++S)ne.write_shift(4,0);for(ne.write_shift(4,0|(+t[z2]||3)<<8),S=0,C=0;S<_.length;++S)if(_[S]!=null){var te=x.next(32),_e=(_[S].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);te.write_shift(1,_e,"sbcs"),te.write_shift(1,U[S]=="?"?"C":U[S],"sbcs"),te.write_shift(4,C),te.write_shift(1,G[S]||l[U[S]]||0),te.write_shift(1,J[S]||0),te.write_shift(1,2),te.write_shift(4,0),te.write_shift(1,0),te.write_shift(4,0),te.write_shift(4,0),C+=G[S]||l[U[S]]||0}var Ie=x.next(264);for(Ie.write_shift(4,13),S=0;S<65;++S)Ie.write_shift(4,0);for(S=0;S<E.length;++S){var Ee=x.next(k);for(Ee.write_shift(1,0),C=0;C<_.length;++C)if(_[C]!=null)switch(U[C]){case"L":Ee.write_shift(1,E[S][C]==null?63:E[S][C]?84:70);break;case"B":Ee.write_shift(8,E[S][C]||0,"f");break;case"N":var ae="0";for(typeof E[S][C]=="number"&&(ae=E[S][C].toFixed(J[C]||0)),M=0;M<G[C]-ae.length;++M)Ee.write_shift(1,32);Ee.write_shift(1,ae,"sbcs");break;case"D":E[S][C]?(Ee.write_shift(4,("0000"+E[S][C].getFullYear()).slice(-4),"sbcs"),Ee.write_shift(2,("00"+(E[S][C].getMonth()+1)).slice(-2),"sbcs"),Ee.write_shift(2,("00"+E[S][C].getDate()).slice(-2),"sbcs")):Ee.write_shift(8,"00000000","sbcs");break;case"C":var de=String(E[S][C]!=null?E[S][C]:"").slice(0,G[C]);for(Ee.write_shift(1,de,"sbcs"),M=0;M<G[C]-de.length;++M)Ee.write_shift(1,32);break}}return x.next(1).write_shift(1,26),x.end()}return{to_workbook:a,to_sheet:r,from_sheet:c}}(),E8=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Ea(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),n=function(_,E){var w=e[E];return typeof w=="number"?Uv(w):w},r=function(_,E,w){var S=E.charCodeAt(0)-32<<4|w.charCodeAt(0)-48;return S==59?_:Uv(S)};e["|"]=254;function a(_,E){switch(E.type){case"base64":return l(Mr(_),E);case"binary":return l(_,E);case"buffer":return l(St&&Buffer.isBuffer(_)?_.toString("binary"):ys(_),E);case"array":return l(ms(_),E)}throw new Error("Unrecognized type "+E.type)}function l(_,E){var w=_.split(/[\n\r]+/),S=-1,C=-1,M=0,k=0,b=[],U=[],G=null,J={},F=[],W=[],O=[],ee=0,ne;for(+E.codepage>=0&&ra(+E.codepage);M!==w.length;++M){ee=0;var te=w[M].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(t,n),_e=te.replace(/;;/g,"\0").split(";").map(function(j){return j.replace(/\u0000/g,";")}),Ie=_e[0],Ee;if(te.length>0)switch(Ie){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":_e[1].charAt(0)=="P"&&U.push(te.slice(3).replace(/;;/g,";"));break;case"C":var ae=!1,de=!1,re=!1,Y=!1,N=-1,Z=-1;for(k=1;k<_e.length;++k)switch(_e[k].charAt(0)){case"A":break;case"X":C=parseInt(_e[k].slice(1))-1,de=!0;break;case"Y":for(S=parseInt(_e[k].slice(1))-1,de||(C=0),ne=b.length;ne<=S;++ne)b[ne]=[];break;case"K":Ee=_e[k].slice(1),Ee.charAt(0)==='"'?Ee=Ee.slice(1,Ee.length-1):Ee==="TRUE"?Ee=!0:Ee==="FALSE"?Ee=!1:isNaN(sa(Ee))?isNaN(El(Ee).getDate())||(Ee=Un(Ee)):(Ee=sa(Ee),G!==null&&kl(G)&&(Ee=vf(Ee))),ae=!0;break;case"E":Y=!0;var D=pl(_e[k].slice(1),{r:S,c:C});b[S][C]=[b[S][C],D];break;case"S":re=!0,b[S][C]=[b[S][C],"S5S"];break;case"G":break;case"R":N=parseInt(_e[k].slice(1))-1;break;case"C":Z=parseInt(_e[k].slice(1))-1;break;default:if(E&&E.WTF)throw new Error("SYLK bad record "+te)}if(ae&&(b[S][C]&&b[S][C].length==2?b[S][C][0]=Ee:b[S][C]=Ee,G=null),re){if(Y)throw new Error("SYLK shared formula cannot have own formula");var H=N>-1&&b[N][Z];if(!H||!H[1])throw new Error("SYLK shared formula cannot find base");b[S][C][1]=t_(H[1],{r:S-N,c:C-Z})}break;case"F":var q=0;for(k=1;k<_e.length;++k)switch(_e[k].charAt(0)){case"X":C=parseInt(_e[k].slice(1))-1,++q;break;case"Y":for(S=parseInt(_e[k].slice(1))-1,ne=b.length;ne<=S;++ne)b[ne]=[];break;case"M":ee=parseInt(_e[k].slice(1))/20;break;case"F":break;case"G":break;case"P":G=U[parseInt(_e[k].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(O=_e[k].slice(1).split(" "),ne=parseInt(O[0],10);ne<=parseInt(O[1],10);++ne)ee=parseInt(O[2],10),W[ne-1]=ee===0?{hidden:!0}:{wch:ee},Sl(W[ne-1]);break;case"C":C=parseInt(_e[k].slice(1))-1,W[C]||(W[C]={});break;case"R":S=parseInt(_e[k].slice(1))-1,F[S]||(F[S]={}),ee>0?(F[S].hpt=ee,F[S].hpx=rc(ee)):ee===0&&(F[S].hidden=!0);break;default:if(E&&E.WTF)throw new Error("SYLK bad record "+te)}q<1&&(G=null);break;default:if(E&&E.WTF)throw new Error("SYLK bad record "+te)}}return F.length>0&&(J["!rows"]=F),W.length>0&&(J["!cols"]=W),E&&E.sheetRows&&(b=b.slice(0,E.sheetRows)),[b,J]}function c(_,E){var w=a(_,E),S=w[0],C=w[1],M=Ml(S,E);return Ea(C).forEach(function(k){M[k]=C[k]}),M}function u(_,E){return Ui(c(_,E),E)}function p(_,E,w,S){var C="C;Y"+(w+1)+";X"+(S+1)+";K";switch(_.t){case"n":C+=_.v||0,_.f&&!_.F&&(C+=";E"+oL(_.f,{r:w,c:S}));break;case"b":C+=_.v?"TRUE":"FALSE";break;case"e":C+=_.w||_.v;break;case"d":C+='"'+(_.w||_.v)+'"';break;case"s":C+='"'+_.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return C}function m(_,E){E.forEach(function(w,S){var C="F;W"+(S+1)+" "+(S+1)+" ";w.hidden?C+="0":(typeof w.width=="number"&&!w.wpx&&(w.wpx=af(w.width)),typeof w.wpx=="number"&&!w.wch&&(w.wch=sf(w.wpx)),typeof w.wch=="number"&&(C+=Math.round(w.wch))),C.charAt(C.length-1)!=" "&&_.push(C)})}function x(_,E){E.forEach(function(w,S){var C="F;";w.hidden?C+="M0;":w.hpt?C+="M"+20*w.hpt+";":w.hpx&&(C+="M"+20*ZT(w.hpx)+";"),C.length>2&&_.push(C+"R"+(S+1))})}function y(_,E){var w=["ID;PWXL;N;E"],S=[],C=pn(_["!ref"]),M,k=Array.isArray(_),b=`\r
`;w.push("P;PGeneral"),w.push("F;P0;DG0G8;M255"),_["!cols"]&&m(w,_["!cols"]),_["!rows"]&&x(w,_["!rows"]),w.push("B;Y"+(C.e.r-C.s.r+1)+";X"+(C.e.c-C.s.c+1)+";D"+[C.s.c,C.s.r,C.e.c,C.e.r].join(" "));for(var U=C.s.r;U<=C.e.r;++U)for(var G=C.s.c;G<=C.e.c;++G){var J=it({r:U,c:G});M=k?(_[U]||[])[G]:_[J],!(!M||M.v==null&&(!M.f||M.F))&&S.push(p(M,_,U,G))}return w.join(b)+b+S.join(b)+b+"E"+b}return{to_workbook:u,to_sheet:c,from_sheet:y}}(),S8=function(){function e(l,c){switch(c.type){case"base64":return t(Mr(l),c);case"binary":return t(l,c);case"buffer":return t(St&&Buffer.isBuffer(l)?l.toString("binary"):ys(l),c);case"array":return t(ms(l),c)}throw new Error("Unrecognized type "+c.type)}function t(l,c){for(var u=l.split(`
`),p=-1,m=-1,x=0,y=[];x!==u.length;++x){if(u[x].trim()==="BOT"){y[++p]=[],m=0;continue}if(!(p<0)){var _=u[x].trim().split(","),E=_[0],w=_[1];++x;for(var S=u[x]||"";(S.match(/["]/g)||[]).length&1&&x<u.length-1;)S+=`
`+u[++x];switch(S=S.trim(),+E){case-1:if(S==="BOT"){y[++p]=[],m=0;continue}else if(S!=="EOD")throw new Error("Unrecognized DIF special command "+S);break;case 0:S==="TRUE"?y[p][m]=!0:S==="FALSE"?y[p][m]=!1:isNaN(sa(w))?isNaN(El(w).getDate())?y[p][m]=w:y[p][m]=Un(w):y[p][m]=sa(w),++m;break;case 1:S=S.slice(1,S.length-1),S=S.replace(/""/g,'"'),S&&S.match(/^=".*"$/)&&(S=S.slice(2,-1)),y[p][m++]=S!==""?S:null;break}if(S==="EOD")break}}return c&&c.sheetRows&&(y=y.slice(0,c.sheetRows)),y}function n(l,c){return Ml(e(l,c),c)}function r(l,c){return Ui(n(l,c),c)}var a=function(){var l=function(p,m,x,y,_){p.push(m),p.push(x+","+y),p.push('"'+_.replace(/"/g,'""')+'"')},c=function(p,m,x,y){p.push(m+","+x),p.push(m==1?'"'+y.replace(/"/g,'""')+'"':y)};return function(p){var m=[],x=pn(p["!ref"]),y,_=Array.isArray(p);l(m,"TABLE",0,1,"sheetjs"),l(m,"VECTORS",0,x.e.r-x.s.r+1,""),l(m,"TUPLES",0,x.e.c-x.s.c+1,""),l(m,"DATA",0,0,"");for(var E=x.s.r;E<=x.e.r;++E){c(m,-1,0,"BOT");for(var w=x.s.c;w<=x.e.c;++w){var S=it({r:E,c:w});if(y=_?(p[E]||[])[w]:p[S],!y){c(m,1,0,"");continue}switch(y.t){case"n":var C=y.w;!C&&y.v!=null&&(C=y.v),C==null?y.f&&!y.F?c(m,1,0,"="+y.f):c(m,1,0,""):c(m,0,C,"V");break;case"b":c(m,0,y.v?1:0,y.v?"TRUE":"FALSE");break;case"s":c(m,1,0,isNaN(y.v)?y.v:'="'+y.v+'"');break;case"d":y.w||(y.w=$r(y.z||lt[14],fr(Un(y.v)))),c(m,0,y.w,"V");break;default:c(m,1,0,"")}}}c(m,-1,0,"EOD");var M=`\r
`,k=m.join(M);return k}}();return{to_workbook:r,to_sheet:n,from_sheet:a}}(),w8=function(){function e(y){return y.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(y){return y.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function n(y,_){for(var E=y.split(`
`),w=-1,S=-1,C=0,M=[];C!==E.length;++C){var k=E[C].trim().split(":");if(k[0]==="cell"){var b=or(k[1]);if(M.length<=b.r)for(w=M.length;w<=b.r;++w)M[w]||(M[w]=[]);switch(w=b.r,S=b.c,k[2]){case"t":M[w][S]=e(k[3]);break;case"v":M[w][S]=+k[3];break;case"vtf":var U=k[k.length-1];case"vtc":switch(k[3]){case"nl":M[w][S]=!!+k[4];break;default:M[w][S]=+k[4];break}k[2]=="vtf"&&(M[w][S]=[M[w][S],U])}}}return _&&_.sheetRows&&(M=M.slice(0,_.sheetRows)),M}function r(y,_){return Ml(n(y,_),_)}function a(y,_){return Ui(r(y,_),_)}var l=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),c=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),p="--SocialCalcSpreadsheetControlSave--";function m(y){if(!y||!y["!ref"])return"";for(var _=[],E=[],w,S="",C=Nl(y["!ref"]),M=Array.isArray(y),k=C.s.r;k<=C.e.r;++k)for(var b=C.s.c;b<=C.e.c;++b)if(S=it({r:k,c:b}),w=M?(y[k]||[])[b]:y[S],!(!w||w.v==null||w.t==="z")){switch(E=["cell",S,"t"],w.t){case"s":case"str":E.push(t(w.v));break;case"n":w.f?(E[2]="vtf",E[3]="n",E[4]=w.v,E[5]=t(w.f)):(E[2]="v",E[3]=w.v);break;case"b":E[2]="vt"+(w.f?"f":"c"),E[3]="nl",E[4]=w.v?"1":"0",E[5]=t(w.f||(w.v?"TRUE":"FALSE"));break;case"d":var U=fr(Un(w.v));E[2]="vtc",E[3]="nd",E[4]=""+U,E[5]=w.w||$r(w.z||lt[14],U);break;case"e":continue}_.push(E.join(":"))}return _.push("sheet:c:"+(C.e.c-C.s.c+1)+":r:"+(C.e.r-C.s.r+1)+":tvf:1"),_.push("valueformat:1:text-wiki"),_.join(`
`)}function x(y){return[l,c,u,c,m(y),p].join(`
`)}return{to_workbook:a,to_sheet:r,from_sheet:x}}(),tc=function(){function e(x,y,_,E,w){w.raw?y[_][E]=x:x===""||(x==="TRUE"?y[_][E]=!0:x==="FALSE"?y[_][E]=!1:isNaN(sa(x))?isNaN(El(x).getDate())?y[_][E]=x:y[_][E]=Un(x):y[_][E]=sa(x))}function t(x,y){var _=y||{},E=[];if(!x||x.length===0)return E;for(var w=x.split(/[\r\n]/),S=w.length-1;S>=0&&w[S].length===0;)--S;for(var C=10,M=0,k=0;k<=S;++k)M=w[k].indexOf(" "),M==-1?M=w[k].length:M++,C=Math.max(C,M);for(k=0;k<=S;++k){E[k]=[];var b=0;for(e(w[k].slice(0,C).trim(),E,k,b,_),b=1;b<=(w[k].length-C)/10+1;++b)e(w[k].slice(C+(b-1)*10,C+b*10).trim(),E,k,b,_)}return _.sheetRows&&(E=E.slice(0,_.sheetRows)),E}var n={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function a(x){for(var y={},_=!1,E=0,w=0;E<x.length;++E)(w=x.charCodeAt(E))==34?_=!_:!_&&w in n&&(y[w]=(y[w]||0)+1);w=[];for(E in y)Object.prototype.hasOwnProperty.call(y,E)&&w.push([y[E],E]);if(!w.length){y=r;for(E in y)Object.prototype.hasOwnProperty.call(y,E)&&w.push([y[E],E])}return w.sort(function(S,C){return S[0]-C[0]||r[S[1]]-r[C[1]]}),n[w.pop()[1]]||44}function l(x,y){var _=y||{},E="",w=_.dense?[]:{},S={s:{c:0,r:0},e:{c:0,r:0}};x.slice(0,4)=="sep="?x.charCodeAt(5)==13&&x.charCodeAt(6)==10?(E=x.charAt(4),x=x.slice(7)):x.charCodeAt(5)==13||x.charCodeAt(5)==10?(E=x.charAt(4),x=x.slice(6)):E=a(x.slice(0,1024)):_&&_.FS?E=_.FS:E=a(x.slice(0,1024));var C=0,M=0,k=0,b=0,U=0,G=E.charCodeAt(0),J=!1,F=0,W=x.charCodeAt(0);x=x.replace(/\r\n/mg,`
`);var O=_.dateNF!=null?LD(_.dateNF):null;function ee(){var ne=x.slice(b,U),te={};if(ne.charAt(0)=='"'&&ne.charAt(ne.length-1)=='"'&&(ne=ne.slice(1,-1).replace(/""/g,'"')),ne.length===0)te.t="z";else if(_.raw)te.t="s",te.v=ne;else if(ne.trim().length===0)te.t="s",te.v=ne;else if(ne.charCodeAt(0)==61)ne.charCodeAt(1)==34&&ne.charCodeAt(ne.length-1)==34?(te.t="s",te.v=ne.slice(2,-1).replace(/""/g,'"')):uL(ne)?(te.t="n",te.f=ne.slice(1)):(te.t="s",te.v=ne);else if(ne=="TRUE")te.t="b",te.v=!0;else if(ne=="FALSE")te.t="b",te.v=!1;else if(!isNaN(k=sa(ne)))te.t="n",_.cellText!==!1&&(te.w=ne),te.v=k;else if(!isNaN(El(ne).getDate())||O&&ne.match(O)){te.z=_.dateNF||lt[14];var _e=0;O&&ne.match(O)&&(ne=OD(ne,_.dateNF,ne.match(O)||[]),_e=1),_.cellDates?(te.t="d",te.v=Un(ne,_e)):(te.t="n",te.v=fr(Un(ne,_e))),_.cellText!==!1&&(te.w=$r(te.z,te.v instanceof Date?fr(te.v):te.v)),_.cellNF||delete te.z}else te.t="s",te.v=ne;if(te.t=="z"||(_.dense?(w[C]||(w[C]=[]),w[C][M]=te):w[it({c:M,r:C})]=te),b=U+1,W=x.charCodeAt(b),S.e.c<M&&(S.e.c=M),S.e.r<C&&(S.e.r=C),F==G)++M;else if(M=0,++C,_.sheetRows&&_.sheetRows<=C)return!0}e:for(;U<x.length;++U)switch(F=x.charCodeAt(U)){case 34:W===34&&(J=!J);break;case G:case 10:case 13:if(!J&&ee())break e;break}return U-b>0&&ee(),w["!ref"]=Nt(S),w}function c(x,y){return!(y&&y.PRN)||y.FS||x.slice(0,4)=="sep="||x.indexOf("	")>=0||x.indexOf(",")>=0||x.indexOf(";")>=0?l(x,y):Ml(t(x,y),y)}function u(x,y){var _="",E=y.type=="string"?[0,0,0,0]:im(x,y);switch(y.type){case"base64":_=Mr(x);break;case"binary":_=x;break;case"buffer":y.codepage==65001?_=x.toString("utf8"):y.codepage&&typeof Ko<"u"||(_=St&&Buffer.isBuffer(x)?x.toString("binary"):ys(x));break;case"array":_=ms(x);break;case"string":_=x;break;default:throw new Error("Unrecognized type "+y.type)}return E[0]==239&&E[1]==187&&E[2]==191?_=Zt(_.slice(3)):y.type!="string"&&y.type!="buffer"&&y.codepage==65001?_=Zt(_):y.type=="binary"&&typeof Ko<"u",_.slice(0,19)=="socialcalc:version:"?w8.to_sheet(y.type=="string"?_:Zt(_),y):c(_,y)}function p(x,y){return Ui(u(x,y),y)}function m(x){for(var y=[],_=pn(x["!ref"]),E,w=Array.isArray(x),S=_.s.r;S<=_.e.r;++S){for(var C=[],M=_.s.c;M<=_.e.c;++M){var k=it({r:S,c:M});if(E=w?(x[S]||[])[M]:x[k],!E||E.v==null){C.push("          ");continue}for(var b=(E.w||(Ka(E),E.w)||"").slice(0,10);b.length<10;)b+=" ";C.push(b+(M===0?" ":""))}y.push(C.join(""))}return y.join(`
`)}return{to_workbook:p,to_sheet:u,from_sheet:m}}();function C8(e,t){var n=t||{},r=!!n.WTF;n.WTF=!0;try{var a=E8.to_workbook(e,n);return n.WTF=r,a}catch(l){if(n.WTF=r,!l.message.match(/SYLK bad record ID/)&&r)throw l;return tc.to_workbook(e,t)}}var Go=function(){function e(D,H,q){if(D){zn(D,D.l||0);for(var j=q.Enum||N;D.l<D.length;){var se=D.read_shift(2),Te=j[se]||j[65535],Ae=D.read_shift(2),Re=D.l+Ae,Ce=Te.f&&Te.f(D,Ae,q);if(D.l=Re,H(Ce,Te,se))return}}}function t(D,H){switch(H.type){case"base64":return n(na(Mr(D)),H);case"binary":return n(na(D),H);case"buffer":case"array":return n(D,H)}throw"Unsupported type "+H.type}function n(D,H){if(!D)return D;var q=H||{},j=q.dense?[]:{},se="Sheet1",Te="",Ae=0,Re={},Ce=[],Xe=[],X={s:{r:0,c:0},e:{r:0,c:0}},ut=q.sheetRows||0;if(D[2]==0&&(D[3]==8||D[3]==9)&&D.length>=16&&D[14]==5&&D[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(D[2]==2)q.Enum=N,e(D,function(ve,Ge,je){switch(je){case 0:q.vers=ve,ve>=4096&&(q.qpro=!0);break;case 6:X=ve;break;case 204:ve&&(Te=ve);break;case 222:Te=ve;break;case 15:case 51:q.qpro||(ve[1].v=ve[1].v.slice(1));case 13:case 14:case 16:je==14&&(ve[2]&112)==112&&(ve[2]&15)>1&&(ve[2]&15)<15&&(ve[1].z=q.dateNF||lt[14],q.cellDates&&(ve[1].t="d",ve[1].v=vf(ve[1].v))),q.qpro&&ve[3]>Ae&&(j["!ref"]=Nt(X),Re[se]=j,Ce.push(se),j=q.dense?[]:{},X={s:{r:0,c:0},e:{r:0,c:0}},Ae=ve[3],se=Te||"Sheet"+(Ae+1),Te="");var Pt=q.dense?(j[ve[0].r]||[])[ve[0].c]:j[it(ve[0])];if(Pt){Pt.t=ve[1].t,Pt.v=ve[1].v,ve[1].z!=null&&(Pt.z=ve[1].z),ve[1].f!=null&&(Pt.f=ve[1].f);break}q.dense?(j[ve[0].r]||(j[ve[0].r]=[]),j[ve[0].r][ve[0].c]=ve[1]):j[it(ve[0])]=ve[1];break}},q);else if(D[2]==26||D[2]==14)q.Enum=Z,D[2]==14&&(q.qpro=!0,D.l=0),e(D,function(ve,Ge,je){switch(je){case 204:se=ve;break;case 22:ve[1].v=ve[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ve[3]>Ae&&(j["!ref"]=Nt(X),Re[se]=j,Ce.push(se),j=q.dense?[]:{},X={s:{r:0,c:0},e:{r:0,c:0}},Ae=ve[3],se="Sheet"+(Ae+1)),ut>0&&ve[0].r>=ut)break;q.dense?(j[ve[0].r]||(j[ve[0].r]=[]),j[ve[0].r][ve[0].c]=ve[1]):j[it(ve[0])]=ve[1],X.e.c<ve[0].c&&(X.e.c=ve[0].c),X.e.r<ve[0].r&&(X.e.r=ve[0].r);break;case 27:ve[14e3]&&(Xe[ve[14e3][0]]=ve[14e3][1]);break;case 1537:Xe[ve[0]]=ve[1],ve[0]==Ae&&(se=ve[1]);break}},q);else throw new Error("Unrecognized LOTUS BOF "+D[2]);if(j["!ref"]=Nt(X),Re[Te||se]=j,Ce.push(Te||se),!Xe.length)return{SheetNames:Ce,Sheets:Re};for(var Ke={},pt=[],Me=0;Me<Xe.length;++Me)Re[Ce[Me]]?(pt.push(Xe[Me]||Ce[Me]),Ke[Xe[Me]]=Re[Xe[Me]]||Re[Ce[Me]]):(pt.push(Xe[Me]),Ke[Xe[Me]]={"!ref":"A1"});return{SheetNames:pt,Sheets:Ke}}function r(D,H){var q=H||{};if(+q.codepage>=0&&ra(+q.codepage),q.type=="string")throw new Error("Cannot write WK1 to JS string");var j=fh(),se=pn(D["!ref"]),Te=Array.isArray(D),Ae=[];ta(j,0,l(1030)),ta(j,6,p(se));for(var Re=Math.min(se.e.r,8191),Ce=se.s.r;Ce<=Re;++Ce)for(var Xe=$n(Ce),X=se.s.c;X<=se.e.c;++X){Ce===se.s.r&&(Ae[X]=Mn(X));var ut=Ae[X]+Xe,Ke=Te?(D[Ce]||[])[X]:D[ut];if(!(!Ke||Ke.t=="z"))if(Ke.t=="n")(Ke.v|0)==Ke.v&&Ke.v>=-32768&&Ke.v<=32767?ta(j,13,E(Ce,X,Ke.v)):ta(j,14,S(Ce,X,Ke.v));else{var pt=Ka(Ke);ta(j,15,y(Ce,X,pt.slice(0,239)))}}return ta(j,1),j.end()}function a(D,H){var q=H||{};if(+q.codepage>=0&&ra(+q.codepage),q.type=="string")throw new Error("Cannot write WK3 to JS string");var j=fh();ta(j,0,c(D));for(var se=0,Te=0;se<D.SheetNames.length;++se)(D.Sheets[D.SheetNames[se]]||{})["!ref"]&&ta(j,27,Y(D.SheetNames[se],Te++));var Ae=0;for(se=0;se<D.SheetNames.length;++se){var Re=D.Sheets[D.SheetNames[se]];if(!(!Re||!Re["!ref"])){for(var Ce=pn(Re["!ref"]),Xe=Array.isArray(Re),X=[],ut=Math.min(Ce.e.r,8191),Ke=Ce.s.r;Ke<=ut;++Ke)for(var pt=$n(Ke),Me=Ce.s.c;Me<=Ce.e.c;++Me){Ke===Ce.s.r&&(X[Me]=Mn(Me));var ve=X[Me]+pt,Ge=Xe?(Re[Ke]||[])[Me]:Re[ve];if(!(!Ge||Ge.t=="z"))if(Ge.t=="n")ta(j,23,ee(Ke,Me,Ae,Ge.v));else{var je=Ka(Ge);ta(j,22,F(Ke,Me,Ae,je.slice(0,239)))}}++Ae}}return ta(j,1),j.end()}function l(D){var H=Nn(2);return H.write_shift(2,D),H}function c(D){var H=Nn(26);H.write_shift(2,4096),H.write_shift(2,4),H.write_shift(4,0);for(var q=0,j=0,se=0,Te=0;Te<D.SheetNames.length;++Te){var Ae=D.SheetNames[Te],Re=D.Sheets[Ae];if(!(!Re||!Re["!ref"])){++se;var Ce=Nl(Re["!ref"]);q<Ce.e.r&&(q=Ce.e.r),j<Ce.e.c&&(j=Ce.e.c)}}return q>8191&&(q=8191),H.write_shift(2,q),H.write_shift(1,se),H.write_shift(1,j),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(1,1),H.write_shift(1,2),H.write_shift(4,0),H.write_shift(4,0),H}function u(D,H,q){var j={s:{c:0,r:0},e:{c:0,r:0}};return H==8&&q.qpro?(j.s.c=D.read_shift(1),D.l++,j.s.r=D.read_shift(2),j.e.c=D.read_shift(1),D.l++,j.e.r=D.read_shift(2),j):(j.s.c=D.read_shift(2),j.s.r=D.read_shift(2),H==12&&q.qpro&&(D.l+=2),j.e.c=D.read_shift(2),j.e.r=D.read_shift(2),H==12&&q.qpro&&(D.l+=2),j.s.c==65535&&(j.s.c=j.e.c=j.s.r=j.e.r=0),j)}function p(D){var H=Nn(8);return H.write_shift(2,D.s.c),H.write_shift(2,D.s.r),H.write_shift(2,D.e.c),H.write_shift(2,D.e.r),H}function m(D,H,q){var j=[{c:0,r:0},{t:"n",v:0},0,0];return q.qpro&&q.vers!=20768?(j[0].c=D.read_shift(1),j[3]=D.read_shift(1),j[0].r=D.read_shift(2),D.l+=2):(j[2]=D.read_shift(1),j[0].c=D.read_shift(2),j[0].r=D.read_shift(2)),j}function x(D,H,q){var j=D.l+H,se=m(D,H,q);if(se[1].t="s",q.vers==20768){D.l++;var Te=D.read_shift(1);return se[1].v=D.read_shift(Te,"utf8"),se}return q.qpro&&D.l++,se[1].v=D.read_shift(j-D.l,"cstr"),se}function y(D,H,q){var j=Nn(7+q.length);j.write_shift(1,255),j.write_shift(2,H),j.write_shift(2,D),j.write_shift(1,39);for(var se=0;se<j.length;++se){var Te=q.charCodeAt(se);j.write_shift(1,Te>=128?95:Te)}return j.write_shift(1,0),j}function _(D,H,q){var j=m(D,H,q);return j[1].v=D.read_shift(2,"i"),j}function E(D,H,q){var j=Nn(7);return j.write_shift(1,255),j.write_shift(2,H),j.write_shift(2,D),j.write_shift(2,q,"i"),j}function w(D,H,q){var j=m(D,H,q);return j[1].v=D.read_shift(8,"f"),j}function S(D,H,q){var j=Nn(13);return j.write_shift(1,255),j.write_shift(2,H),j.write_shift(2,D),j.write_shift(8,q,"f"),j}function C(D,H,q){var j=D.l+H,se=m(D,H,q);if(se[1].v=D.read_shift(8,"f"),q.qpro)D.l=j;else{var Te=D.read_shift(2);U(D.slice(D.l,D.l+Te),se),D.l+=Te}return se}function M(D,H,q){var j=H&32768;return H&=-32769,H=(j?D:0)+(H>=8192?H-16384:H),(j?"":"$")+(q?Mn(H):$n(H))}var k={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},b=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function U(D,H){zn(D,0);for(var q=[],j=0,se="",Te="",Ae="",Re="";D.l<D.length;){var Ce=D[D.l++];switch(Ce){case 0:q.push(D.read_shift(8,"f"));break;case 1:Te=M(H[0].c,D.read_shift(2),!0),se=M(H[0].r,D.read_shift(2),!1),q.push(Te+se);break;case 2:{var Xe=M(H[0].c,D.read_shift(2),!0),X=M(H[0].r,D.read_shift(2),!1);Te=M(H[0].c,D.read_shift(2),!0),se=M(H[0].r,D.read_shift(2),!1),q.push(Xe+X+":"+Te+se)}break;case 3:if(D.l<D.length){console.error("WK1 premature formula end");return}break;case 4:q.push("("+q.pop()+")");break;case 5:q.push(D.read_shift(2));break;case 6:{for(var ut="";Ce=D[D.l++];)ut+=String.fromCharCode(Ce);q.push('"'+ut.replace(/"/g,'""')+'"')}break;case 8:q.push("-"+q.pop());break;case 23:q.push("+"+q.pop());break;case 22:q.push("NOT("+q.pop()+")");break;case 20:case 21:Re=q.pop(),Ae=q.pop(),q.push(["AND","OR"][Ce-20]+"("+Ae+","+Re+")");break;default:if(Ce<32&&b[Ce])Re=q.pop(),Ae=q.pop(),q.push(Ae+b[Ce]+Re);else if(k[Ce]){if(j=k[Ce][1],j==69&&(j=D[D.l++]),j>q.length){console.error("WK1 bad formula parse 0x"+Ce.toString(16)+":|"+q.join("|")+"|");return}var Ke=q.slice(-j);q.length-=j,q.push(k[Ce][0]+"("+Ke.join(",")+")")}else return Ce<=7?console.error("WK1 invalid opcode "+Ce.toString(16)):Ce<=24?console.error("WK1 unsupported op "+Ce.toString(16)):Ce<=30?console.error("WK1 invalid opcode "+Ce.toString(16)):Ce<=115?console.error("WK1 unsupported function opcode "+Ce.toString(16)):console.error("WK1 unrecognized opcode "+Ce.toString(16))}}q.length==1?H[1].f=""+q[0]:console.error("WK1 bad formula parse |"+q.join("|")+"|")}function G(D){var H=[{c:0,r:0},{t:"n",v:0},0];return H[0].r=D.read_shift(2),H[3]=D[D.l++],H[0].c=D[D.l++],H}function J(D,H){var q=G(D);return q[1].t="s",q[1].v=D.read_shift(H-4,"cstr"),q}function F(D,H,q,j){var se=Nn(6+j.length);se.write_shift(2,D),se.write_shift(1,q),se.write_shift(1,H),se.write_shift(1,39);for(var Te=0;Te<j.length;++Te){var Ae=j.charCodeAt(Te);se.write_shift(1,Ae>=128?95:Ae)}return se.write_shift(1,0),se}function W(D,H){var q=G(D);q[1].v=D.read_shift(2);var j=q[1].v>>1;if(q[1].v&1)switch(j&7){case 0:j=(j>>3)*5e3;break;case 1:j=(j>>3)*500;break;case 2:j=(j>>3)/20;break;case 3:j=(j>>3)/200;break;case 4:j=(j>>3)/2e3;break;case 5:j=(j>>3)/2e4;break;case 6:j=(j>>3)/16;break;case 7:j=(j>>3)/64;break}return q[1].v=j,q}function O(D,H){var q=G(D),j=D.read_shift(4),se=D.read_shift(4),Te=D.read_shift(2);if(Te==65535)return j===0&&se===3221225472?(q[1].t="e",q[1].v=15):j===0&&se===3489660928?(q[1].t="e",q[1].v=42):q[1].v=0,q;var Ae=Te&32768;return Te=(Te&32767)-16446,q[1].v=(1-Ae*2)*(se*Math.pow(2,Te+32)+j*Math.pow(2,Te)),q}function ee(D,H,q,j){var se=Nn(14);if(se.write_shift(2,D),se.write_shift(1,q),se.write_shift(1,H),j==0)return se.write_shift(4,0),se.write_shift(4,0),se.write_shift(2,65535),se;var Te=0,Ae=0,Re=0,Ce=0;return j<0&&(Te=1,j=-j),Ae=Math.log2(j)|0,j/=Math.pow(2,Ae-31),Ce=j>>>0,(Ce&2147483648)==0&&(j/=2,++Ae,Ce=j>>>0),j-=Ce,Ce|=2147483648,Ce>>>=0,j*=Math.pow(2,32),Re=j>>>0,se.write_shift(4,Re),se.write_shift(4,Ce),Ae+=16383+(Te?32768:0),se.write_shift(2,Ae),se}function ne(D,H){var q=O(D);return D.l+=H-14,q}function te(D,H){var q=G(D),j=D.read_shift(4);return q[1].v=j>>6,q}function _e(D,H){var q=G(D),j=D.read_shift(8,"f");return q[1].v=j,q}function Ie(D,H){var q=_e(D);return D.l+=H-10,q}function Ee(D,H){return D[D.l+H-1]==0?D.read_shift(H,"cstr"):""}function ae(D,H){var q=D[D.l++];q>H-1&&(q=H-1);for(var j="";j.length<q;)j+=String.fromCharCode(D[D.l++]);return j}function de(D,H,q){if(!(!q.qpro||H<21)){var j=D.read_shift(1);D.l+=17,D.l+=1,D.l+=2;var se=D.read_shift(H-21,"cstr");return[j,se]}}function re(D,H){for(var q={},j=D.l+H;D.l<j;){var se=D.read_shift(2);if(se==14e3){for(q[se]=[0,""],q[se][0]=D.read_shift(2);D[D.l];)q[se][1]+=String.fromCharCode(D[D.l]),D.l++;D.l++}}return q}function Y(D,H){var q=Nn(5+D.length);q.write_shift(2,14e3),q.write_shift(2,H);for(var j=0;j<D.length;++j){var se=D.charCodeAt(j);q[q.l++]=se>127?95:se}return q[q.l++]=0,q}var N={0:{n:"BOF",f:Sn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:_},14:{n:"NUMBER",f:w},15:{n:"LABEL",f:x},16:{n:"FORMULA",f:C},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:x},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Ee},222:{n:"SHEETNAMELP",f:ae},65535:{n:""}},Z={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:J},23:{n:"NUMBER17",f:O},24:{n:"NUMBER18",f:W},25:{n:"FORMULA19",f:ne},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:re},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:te},38:{n:"??"},39:{n:"NUMBER27",f:_e},40:{n:"FORMULA28",f:Ie},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Ee},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:de},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:a,to_workbook:t}}();function A8(e){var t={},n=e.match(rr),r=0,a=!1;if(n)for(;r!=n.length;++r){var l=tt(n[r]);switch(l[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!l.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(l.val=="1")break;t.cp=Lh[parseInt(l.val,10)];break;case"<outline":if(!l.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=l.val;break;case"<sz":t.sz=l.val;break;case"<strike":if(!l.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!l.val)break;switch(l.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(l.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(l.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":l.rgb&&(t.color=l.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=l.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=l.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(l[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+l[0])}}return t}var b8=function(){var e=Qo("t"),t=Qo("rPr");function n(l){var c=l.match(e);if(!c)return{t:"s",v:""};var u={t:"s",v:Rt(c[1])},p=l.match(t);return p&&(u.s=A8(p[1])),u}var r=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(c){return c.replace(r,"").split(a).map(n).filter(function(u){return u.v})}}(),k8=function(){var t=/(\r\n|\n)/g;function n(a,l,c){var u=[];a.u&&u.push("text-decoration: underline;"),a.uval&&u.push("text-underline-style:"+a.uval+";"),a.sz&&u.push("font-size:"+a.sz+"pt;"),a.outline&&u.push("text-effect: outline;"),a.shadow&&u.push("text-shadow: auto;"),l.push('<span style="'+u.join("")+'">'),a.b&&(l.push("<b>"),c.push("</b>")),a.i&&(l.push("<i>"),c.push("</i>")),a.strike&&(l.push("<s>"),c.push("</s>"));var p=a.valign||"";return p=="superscript"||p=="super"?p="sup":p=="subscript"&&(p="sub"),p!=""&&(l.push("<"+p+">"),c.push("</"+p+">")),c.push("</span>"),a}function r(a){var l=[[],a.v,[]];return a.v?(a.s&&n(a.s,l[0],l[2]),l[0].join("")+l[1].replace(t,"<br/>")+l[2].join("")):""}return function(l){return l.map(r).join("")}}(),N8=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,M8=/<(?:\w+:)?r>/,R8=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Zh(e,t){var n=t?t.cellHTML:!0,r={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=Rt(Zt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),r.r=Zt(e),n&&(r.h=Gh(r.t))):e.match(M8)&&(r.r=Zt(e),r.t=Rt(Zt((e.replace(R8,"").match(N8)||[]).join("").replace(rr,""))),n&&(r.h=k8(b8(r.r)))),r):{t:""}}var D8=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,I8=/<(?:\w+:)?(?:si|sstItem)>/g,F8=/<\/(?:\w+:)?(?:si|sstItem)>/;function L8(e,t){var n=[],r="";if(!e)return n;var a=e.match(D8);if(a){r=a[2].replace(I8,"").split(F8);for(var l=0;l!=r.length;++l){var c=Zh(r[l].trim(),t);c!=null&&(n[n.length]=c)}a=tt(a[1]),n.Count=a.count,n.Unique=a.uniqueCount}return n}function O8(e){return[e.read_shift(4),e.read_shift(4)]}function P8(e,t){var n=[],r=!1;return ei(e,function(l,c,u){switch(u){case 159:n.Count=l[0],n.Unique=l[1];break;case 19:n.push(l);break;case 160:return!0;case 35:r=!0;break;case 36:r=!1;break;default:if(c.T,!r||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function $T(e){for(var t=[],n=e.split(""),r=0;r<n.length;++r)t[r]=n[r].charCodeAt(0);return t}function Ya(e,t){var n={};return n.Major=e.read_shift(2),n.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),n}function U8(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Ya(e,4),t.U=Ya(e,4),t.W=Ya(e,4),t}function B8(e){for(var t=e.read_shift(4),n=e.l+t-4,r={},a=e.read_shift(4),l=[];a-- >0;)l.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(r.name=e.read_shift(0,"lpp4"),r.comps=l,e.l!=n)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+n);return r}function V8(e){var t=[];e.l+=4;for(var n=e.read_shift(4);n-- >0;)t.push(B8(e));return t}function H8(e){var t=[];e.l+=4;for(var n=e.read_shift(4);n-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function G8(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Ya(e,4),t.U=Ya(e,4),t.W=Ya(e,4),t}function j8(e){var t=G8(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function YT(e,t){var n=e.l+t,r={};r.Flags=e.read_shift(4)&63,e.l+=4,r.AlgID=e.read_shift(4);var a=!1;switch(r.AlgID){case 26126:case 26127:case 26128:a=r.Flags==36;break;case 26625:a=r.Flags==4;break;case 0:a=r.Flags==16||r.Flags==4||r.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return r.AlgIDHash=e.read_shift(4),r.KeySize=e.read_shift(4),r.ProviderType=e.read_shift(4),e.l+=8,r.CSPName=e.read_shift(n-e.l>>1,"utf16le"),e.l=n,r}function WT(e,t){var n={},r=e.l+t;return e.l+=4,n.Salt=e.slice(e.l,e.l+16),e.l+=16,n.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),n.VerifierHash=e.slice(e.l,r),e.l=r,n}function z8(e){var t=Ya(e);switch(t.Minor){case 2:return[t.Minor,q8(e)];case 3:return[t.Minor,$8()];case 4:return[t.Minor,Y8(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function q8(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var n=e.read_shift(4),r=YT(e,n),a=WT(e,e.length-e.l);return{t:"Std",h:r,v:a}}function $8(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Y8(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var n=e.read_shift(e.length-e.l,"utf8"),r={};return n.replace(rr,function(l){var c=tt(l);switch(wa(c[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(u){r[u]=c[u]});break;case"<dataIntegrity":r.encryptedHmacKey=c.encryptedHmacKey,r.encryptedHmacValue=c.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":r.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":r.uri=c.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":r.encs.push(c);break;default:throw c[0]}}),r}function W8(e,t){var n={},r=n.EncryptionVersionInfo=Ya(e,4);if(t-=4,r.Minor!=2)throw new Error("unrecognized minor version code: "+r.Minor);if(r.Major>4||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);n.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,n.EncryptionHeader=YT(e,a),t-=a,n.EncryptionVerifier=WT(e,t),n}function J8(e){var t={},n=t.EncryptionVersionInfo=Ya(e,4);if(n.Major!=1||n.Minor!=1)throw"unrecognized version code "+n.Major+" : "+n.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function X8(e){var t=0,n,r=$T(e),a=r.length+1,l,c,u,p,m;for(n=Oi(a),n[0]=r.length,l=1;l!=a;++l)n[l]=r[l-1];for(l=a-1;l>=0;--l)c=n[l],u=(t&16384)===0?0:1,p=t<<1&32767,m=u|p,t=m^c;return t^52811}var JT=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],n=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],r=function(c){return(c/2|c*128)&255},a=function(c,u){return r(c^u)},l=function(c){for(var u=t[c.length-1],p=104,m=c.length-1;m>=0;--m)for(var x=c[m],y=0;y!=7;++y)x&64&&(u^=n[p]),x*=2,--p;return u};return function(c){for(var u=$T(c),p=l(u),m=u.length,x=Oi(16),y=0;y!=16;++y)x[y]=0;var _,E,w;for((m&1)===1&&(_=p>>8,x[m]=a(e[0],_),--m,_=p&255,E=u[u.length-1],x[m]=a(E,_));m>0;)--m,_=p>>8,x[m]=a(u[m],_),--m,_=p&255,x[m]=a(u[m],_);for(m=15,w=15-u.length;w>0;)_=p>>8,x[m]=a(e[w],_),--m,--w,_=p&255,x[m]=a(u[m],_),--m,--w;return x}}(),K8=function(e,t,n,r,a){a||(a=t),r||(r=JT(e));var l,c;for(l=0;l!=t.length;++l)c=t[l],c^=r[n],c=(c>>5|c<<3)&255,a[l]=c,++n;return[a,n,r]},Z8=function(e){var t=0,n=JT(e);return function(r){var a=K8("",r,t,n);return t=a[1],a[0]}};function Q8(e,t,n,r){var a={key:Sn(e),verificationBytes:Sn(e)};return n.password&&(a.verifier=X8(n.password)),r.valid=a.verificationBytes===a.verifier,r.valid&&(r.insitu=Z8(n.password)),a}function eF(e,t,n){var r=n||{};return r.Info=e.read_shift(2),e.l-=2,r.Info===1?r.Data=J8(e):r.Data=W8(e,t),r}function tF(e,t,n){var r={Type:n.biff>=8?e.read_shift(2):0};return r.Type?eF(e,t-2,r):Q8(e,n.biff>=8?t:t-2,n,r),r}var nF=function(){function e(a,l){switch(l.type){case"base64":return t(Mr(a),l);case"binary":return t(a,l);case"buffer":return t(St&&Buffer.isBuffer(a)?a.toString("binary"):ys(a),l);case"array":return t(ms(a),l)}throw new Error("Unrecognized type "+l.type)}function t(a,l){var c=l||{},u=c.dense?[]:{},p=a.match(/\\trowd.*?\\row\b/g);if(!p.length)throw new Error("RTF missing table");var m={s:{c:0,r:0},e:{c:0,r:p.length-1}};return p.forEach(function(x,y){Array.isArray(u)&&(u[y]=[]);for(var _=/\\\w+\b/g,E=0,w,S=-1;w=_.exec(x);){switch(w[0]){case"\\cell":var C=x.slice(E,_.lastIndex-w[0].length);if(C[0]==" "&&(C=C.slice(1)),++S,C.length){var M={v:C,t:"s"};Array.isArray(u)?u[y][S]=M:u[it({r:y,c:S})]=M}break}E=_.lastIndex}S>m.e.c&&(m.e.c=S)}),u["!ref"]=Nt(m),u}function n(a,l){return Ui(e(a,l),l)}function r(a){for(var l=["{\\rtf1\\ansi"],c=pn(a["!ref"]),u,p=Array.isArray(a),m=c.s.r;m<=c.e.r;++m){l.push("\\trowd\\trautofit1");for(var x=c.s.c;x<=c.e.c;++x)l.push("\\cellx"+(x+1));for(l.push("\\pard\\intbl"),x=c.s.c;x<=c.e.c;++x){var y=it({r:m,c:x});u=p?(a[m]||[])[x]:a[y],!(!u||u.v==null&&(!u.f||u.F))&&(l.push(" "+(u.w||(Ka(u),u.w))),l.push("\\cell"))}l.push("\\pard\\intbl\\row")}return l.join("")+"}"}return{to_workbook:n,to_sheet:e,from_sheet:r}}();function rF(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function nc(e){for(var t=0,n=1;t!=3;++t)n=n*256+(e[t]>255?255:e[t]<0?0:e[t]);return n.toString(16).toUpperCase().slice(1)}function aF(e){var t=e[0]/255,n=e[1]/255,r=e[2]/255,a=Math.max(t,n,r),l=Math.min(t,n,r),c=a-l;if(c===0)return[0,0,t];var u=0,p=0,m=a+l;switch(p=c/(m>1?2-m:m),a){case t:u=((n-r)/c+6)%6;break;case n:u=(r-t)/c+2;break;case r:u=(t-n)/c+4;break}return[u/6,p,m/2]}function iF(e){var t=e[0],n=e[1],r=e[2],a=n*2*(r<.5?r:1-r),l=r-a/2,c=[l,l,l],u=6*t,p;if(n!==0)switch(u|0){case 0:case 6:p=a*u,c[0]+=a,c[1]+=p;break;case 1:p=a*(2-u),c[0]+=p,c[1]+=a;break;case 2:p=a*(u-2),c[1]+=a,c[2]+=p;break;case 3:p=a*(4-u),c[1]+=p,c[2]+=a;break;case 4:p=a*(u-4),c[2]+=a,c[0]+=p;break;case 5:p=a*(6-u),c[2]+=p,c[0]+=a;break}for(var m=0;m!=3;++m)c[m]=Math.round(c[m]*255);return c}function rf(e,t){if(t===0)return e;var n=aF(rF(e));return t<0?n[2]=n[2]*(1+t):n[2]=1-(1-n[2])*(1-t),nc(iF(n))}var XT=6,sF=15,lF=1,lr=XT;function af(e){return Math.floor((e+Math.round(128/lr)/256)*lr)}function sf(e){return Math.floor((e-5)/lr*100+.5)/100}function ph(e){return Math.round((e*lr+5)/lr*256)/256}function Ud(e){return ph(sf(af(e)))}function Qh(e){var t=Math.abs(e-Ud(e)),n=lr;if(t>.005)for(lr=lF;lr<sF;++lr)Math.abs(e-Ud(e))<=t&&(t=Math.abs(e-Ud(e)),n=lr);lr=n}function Sl(e){e.width?(e.wpx=af(e.width),e.wch=sf(e.wpx),e.MDW=lr):e.wpx?(e.wch=sf(e.wpx),e.width=ph(e.wch),e.MDW=lr):typeof e.wch=="number"&&(e.width=ph(e.wch),e.wpx=af(e.width),e.MDW=lr),e.customWidth&&delete e.customWidth}var oF=96,KT=oF;function ZT(e){return e*96/KT}function rc(e){return e*KT/96}var cF={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function uF(e,t,n,r){t.Borders=[];var a={},l=!1;(e[0].match(rr)||[]).forEach(function(c){var u=tt(c);switch(wa(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},u.diagonalUp&&(a.diagonalUp=sn(u.diagonalUp)),u.diagonalDown&&(a.diagonalDown=sn(u.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(r&&r.WTF&&!l)throw new Error("unrecognized "+u[0]+" in borders")}})}function fF(e,t,n,r){t.Fills=[];var a={},l=!1;(e[0].match(rr)||[]).forEach(function(c){var u=tt(c);switch(wa(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":u.patternType&&(a.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),u.indexed&&(a.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(a.bgColor.theme=parseInt(u.theme,10)),u.tint&&(a.bgColor.tint=parseFloat(u.tint)),u.rgb&&(a.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),u.theme&&(a.fgColor.theme=parseInt(u.theme,10)),u.tint&&(a.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(a.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(r&&r.WTF&&!l)throw new Error("unrecognized "+u[0]+" in fills")}})}function dF(e,t,n,r){t.Fonts=[];var a={},l=!1;(e[0].match(rr)||[]).forEach(function(c){var u=tt(c);switch(wa(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":u.val&&(a.name=Zt(u.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=u.val?sn(u.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=u.val?sn(u.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(u.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=u.val?sn(u.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=u.val?sn(u.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=u.val?sn(u.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=u.val?sn(u.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=u.val?sn(u.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":u.val&&(a.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(a.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(a.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(a.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=Lh[parseInt(u.val,10)];break;case"<color":if(a.color||(a.color={}),u.auto&&(a.color.auto=sn(u.auto)),u.rgb)a.color.rgb=u.rgb.slice(-6);else if(u.indexed){a.color.index=parseInt(u.indexed,10);var p=ls[a.color.index];a.color.index==81&&(p=ls[1]),p||(p=ls[1]),a.color.rgb=p[0].toString(16)+p[1].toString(16)+p[2].toString(16)}else u.theme&&(a.color.theme=parseInt(u.theme,10),u.tint&&(a.color.tint=parseFloat(u.tint)),u.theme&&n.themeElements&&n.themeElements.clrScheme&&(a.color.rgb=rf(n.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":l=!0;break;case"</AlternateContent>":l=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(r&&r.WTF&&!l)throw new Error("unrecognized "+u[0]+" in fonts")}})}function hF(e,t,n){t.NumberFmt=[];for(var r=Ea(lt),a=0;a<r.length;++a)t.NumberFmt[r[a]]=lt[r[a]];var l=e[0].match(rr);if(l)for(a=0;a<l.length;++a){var c=tt(l[a]);switch(wa(c[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=Rt(Zt(c.formatCode)),p=parseInt(c.numFmtId,10);if(t.NumberFmt[p]=u,p>0){if(p>392){for(p=392;p>60&&t.NumberFmt[p]!=null;--p);t.NumberFmt[p]=u}ss(u,p)}}break;case"</numFmt>":break;default:if(n.WTF)throw new Error("unrecognized "+c[0]+" in numFmts")}}}var Iu=["numFmtId","fillId","fontId","borderId","xfId"],Fu=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function mF(e,t,n){t.CellXf=[];var r,a=!1;(e[0].match(rr)||[]).forEach(function(l){var c=tt(l),u=0;switch(wa(c[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(r=c,delete r[0],u=0;u<Iu.length;++u)r[Iu[u]]&&(r[Iu[u]]=parseInt(r[Iu[u]],10));for(u=0;u<Fu.length;++u)r[Fu[u]]&&(r[Fu[u]]=sn(r[Fu[u]]));if(t.NumberFmt&&r.numFmtId>392){for(u=392;u>60;--u)if(t.NumberFmt[r.numFmtId]==t.NumberFmt[u]){r.numFmtId=u;break}}t.CellXf.push(r);break;case"</xf>":break;case"<alignment":case"<alignment/>":var p={};c.vertical&&(p.vertical=c.vertical),c.horizontal&&(p.horizontal=c.horizontal),c.textRotation!=null&&(p.textRotation=c.textRotation),c.indent&&(p.indent=c.indent),c.wrapText&&(p.wrapText=sn(c.wrapText)),r.alignment=p;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+c[0]+" in cellXfs")}})}var pF=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,n=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,l=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,p,m){var x={};if(!u)return x;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var y;return(y=u.match(t))&&hF(y,x,m),(y=u.match(a))&&dF(y,x,p,m),(y=u.match(r))&&fF(y,x,p,m),(y=u.match(l))&&uF(y,x,p,m),(y=u.match(n))&&mF(y,x,m),x}}();function xF(e,t){var n=e.read_shift(2),r=tr(e);return[n,r]}function gF(e,t,n){var r={};r.sz=e.read_shift(2)/20;var a=b6(e);a.fItalic&&(r.italic=1),a.fCondense&&(r.condense=1),a.fExtend&&(r.extend=1),a.fShadow&&(r.shadow=1),a.fOutline&&(r.outline=1),a.fStrikeout&&(r.strike=1);var l=e.read_shift(2);switch(l===700&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var c=e.read_shift(1);c!=0&&(r.underline=c);var u=e.read_shift(1);u>0&&(r.family=u);var p=e.read_shift(1);switch(p>0&&(r.charset=p),e.l++,r.color=A6(e),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=tr(e),r}var vF=nr;function yF(e,t){var n=e.l+t,r=e.read_shift(2),a=e.read_shift(2);return e.l=n,{ixfe:r,numFmtId:a}}var TF=nr;function _F(e,t,n){var r={};r.NumberFmt=[];for(var a in lt)r.NumberFmt[a]=lt[a];r.CellXf=[],r.Fonts=[];var l=[],c=!1;return ei(e,function(p,m,x){switch(x){case 44:r.NumberFmt[p[0]]=p[1],ss(p[1],p[0]);break;case 43:r.Fonts.push(p),p.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(p.color.rgb=rf(t.themeElements.clrScheme[p.color.theme].rgb,p.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:l[l.length-1]==617&&r.CellXf.push(p);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:l.push(x),c=!0;break;case 38:l.pop(),c=!1;break;default:if(m.T>0)l.push(x);else if(m.T<0)l.pop();else if(!c||n.WTF&&l[l.length-1]!=37)throw new Error("Unexpected record 0x"+x.toString(16))}}),r}var EF=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function SF(e,t,n){t.themeElements.clrScheme=[];var r={};(e[0].match(rr)||[]).forEach(function(a){var l=tt(a);switch(l[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":r.rgb=l.val;break;case"<a:sysClr":r.rgb=l.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":l[0].charAt(1)==="/"?(t.themeElements.clrScheme[EF.indexOf(l[0])]=r,r={}):r.name=l[0].slice(3,l[0].length-1);break;default:if(n&&n.WTF)throw new Error("Unrecognized "+l[0]+" in clrScheme")}})}function wF(){}function CF(){}var AF=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,bF=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,kF=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function NF(e,t,n){t.themeElements={};var r;[["clrScheme",AF,SF],["fontScheme",bF,wF],["fmtScheme",kF,CF]].forEach(function(a){if(!(r=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](r,t,n)})}var MF=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function QT(e,t){(!e||e.length===0)&&(e=RF());var n,r={};if(!(n=e.match(MF)))throw new Error("themeElements not found in theme");return NF(n[0],r,t),r.raw=e,r}function RF(e,t){var n=[uT];return n[n.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',n[n.length]="<a:themeElements>",n[n.length]='<a:clrScheme name="Office">',n[n.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',n[n.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',n[n.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',n[n.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',n[n.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',n[n.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',n[n.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',n[n.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',n[n.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',n[n.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',n[n.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',n[n.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',n[n.length]="</a:clrScheme>",n[n.length]='<a:fontScheme name="Office">',n[n.length]="<a:majorFont>",n[n.length]='<a:latin typeface="Cambria"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface=" "/>',n[n.length]='<a:font script="Hang" typeface=" "/>',n[n.length]='<a:font script="Hans" typeface=""/>',n[n.length]='<a:font script="Hant" typeface=""/>',n[n.length]='<a:font script="Arab" typeface="Times New Roman"/>',n[n.length]='<a:font script="Hebr" typeface="Times New Roman"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="MoolBoran"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Times New Roman"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:majorFont>",n[n.length]="<a:minorFont>",n[n.length]='<a:latin typeface="Calibri"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface=" "/>',n[n.length]='<a:font script="Hang" typeface=" "/>',n[n.length]='<a:font script="Hans" typeface=""/>',n[n.length]='<a:font script="Hant" typeface=""/>',n[n.length]='<a:font script="Arab" typeface="Arial"/>',n[n.length]='<a:font script="Hebr" typeface="Arial"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="DaunPenh"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Arial"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:minorFont>",n[n.length]="</a:fontScheme>",n[n.length]='<a:fmtScheme name="Office">',n[n.length]="<a:fillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="1"/>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="0"/>',n[n.length]="</a:gradFill>",n[n.length]="</a:fillStyleLst>",n[n.length]="<a:lnStyleLst>",n[n.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]="</a:lnStyleLst>",n[n.length]="<a:effectStyleLst>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',n[n.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',n[n.length]="</a:effectStyle>",n[n.length]="</a:effectStyleLst>",n[n.length]="<a:bgFillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]="</a:bgFillStyleLst>",n[n.length]="</a:fmtScheme>",n[n.length]="</a:themeElements>",n[n.length]="<a:objectDefaults>",n[n.length]="<a:spDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',n[n.length]="</a:spDef>",n[n.length]="<a:lnDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',n[n.length]="</a:lnDef>",n[n.length]="</a:objectDefaults>",n[n.length]="<a:extraClrSchemeLst/>",n[n.length]="</a:theme>",n.join("")}function DF(e,t,n){var r=e.l+t,a=e.read_shift(4);if(a!==124226){if(!n.cellStyles){e.l=r;return}var l=e.slice(e.l);e.l=r;var c;try{c=cT(l,{type:"array"})}catch{return}var u=Nr(c,"theme/theme/theme1.xml",!0);if(u)return QT(u,n)}}function IF(e){return e.read_shift(4)}function FF(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=LF(e,4);break;case 2:t.xclrValue=BT(e);break;case 3:t.xclrValue=IF(e);break;case 4:e.l+=4;break}return e.l+=8,t}function LF(e,t){return nr(e,t)}function OF(e,t){return nr(e,t)}function PF(e){var t=e.read_shift(2),n=e.read_shift(2)-4,r=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=FF(e);break;case 6:r[1]=OF(e,n);break;case 14:case 15:r[1]=e.read_shift(n===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+n)}return r}function UF(e,t){var n=e.l+t;e.l+=2;var r=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),l=[];a-- >0;)l.push(PF(e,n-e.l));return{ixfe:r,ext:l}}function BF(e,t){t.forEach(function(n){n[0]})}function VF(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:tr(e)}}function HF(e){for(var t=[],n=e.read_shift(4);n-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function GF(e){return e.l+=4,e.read_shift(4)!=0}function jF(e,t,n){var r={Types:[],Cell:[],Value:[]},a=n||{},l=[],c=!1,u=2;return ei(e,function(p,m,x){switch(x){case 335:r.Types.push({name:p.name});break;case 51:p.forEach(function(y){u==1?r.Cell.push({type:r.Types[y[0]-1].name,index:y[1]}):u==0&&r.Value.push({type:r.Types[y[0]-1].name,index:y[1]})});break;case 337:u=p?1:0;break;case 338:u=2;break;case 35:l.push(x),c=!0;break;case 36:l.pop(),c=!1;break;default:if(!m.T){if(!c||a.WTF&&l[l.length-1]!=35)throw new Error("Unexpected record 0x"+x.toString(16))}}}),r}function zF(e,t,n){var r={Types:[],Cell:[],Value:[]};if(!e)return r;var a=!1,l=2,c;return e.replace(rr,function(u){var p=tt(u);switch(wa(p[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":r.Types.push({name:p.name});break;case"</metadataType>":break;case"<futureMetadata":for(var m=0;m<r.Types.length;++m)r.Types[m].name==p.name&&(c=r.Types[m]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":l==1?r.Cell.push({type:r.Types[p.t-1].name,index:+p.v}):l==0&&r.Value.push({type:r.Types[p.t-1].name,index:+p.v});break;case"</rc>":break;case"<cellMetadata":l=1;break;case"</cellMetadata>":l=2;break;case"<valueMetadata":l=0;break;case"</valueMetadata>":l=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!c)break;c.offsets||(c.offsets=[]),c.offsets.push(+p.i);break;default:if(!a&&n.WTF)throw new Error("unrecognized "+p[0]+" in metadata")}return u}),r}function qF(e){var t=[];if(!e)return t;var n=1;return(e.match(rr)||[]).forEach(function(r){var a=tt(r);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?n=a.i:a.i=n,t.push(a);break}}),t}function $F(e){var t={};t.i=e.read_shift(4);var n={};n.r=e.read_shift(4),n.c=e.read_shift(4),t.r=it(n);var r=e.read_shift(1);return r&2&&(t.l="1"),r&8&&(t.a="1"),t}function YF(e,t,n){var r=[];return ei(e,function(l,c,u){switch(u){case 63:r.push(l);break;default:if(!c.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}function WF(e,t,n,r){if(!e)return e;var a=r||{},l=!1;ei(e,function(u,p,m){switch(m){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:l=!0;break;case 36:l=!1;break;default:if(!p.T){if(!l||a.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}},a)}function JF(e,t){if(!e)return"??";var n=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][n].Target}function Sy(e,t,n,r){var a=Array.isArray(e),l;t.forEach(function(c){var u=or(c.ref);if(a?(e[u.r]||(e[u.r]=[]),l=e[u.r][u.c]):l=e[c.ref],!l){l={t:"z"},a?e[u.r][u.c]=l:e[c.ref]=l;var p=pn(e["!ref"]||"BDWGO1000001:A1");p.s.r>u.r&&(p.s.r=u.r),p.e.r<u.r&&(p.e.r=u.r),p.s.c>u.c&&(p.s.c=u.c),p.e.c<u.c&&(p.e.c=u.c);var m=Nt(p);m!==e["!ref"]&&(e["!ref"]=m)}l.c||(l.c=[]);var x={a:c.author,t:c.t,r:c.r,T:n};c.h&&(x.h=c.h);for(var y=l.c.length-1;y>=0;--y){if(!n&&l.c[y].T)return;n&&!l.c[y].T&&l.c.splice(y,1)}if(n&&r){for(y=0;y<r.length;++y)if(x.a==r[y].id){x.a=r[y].name||x.a;break}}l.c.push(x)})}function XF(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var n=[],r=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(c){if(!(c===""||c.trim()==="")){var u=c.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&n.push(u[1])}});var l=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return l&&l[1]&&l[1].split(/<\/\w*:?comment>/).forEach(function(c){if(!(c===""||c.trim()==="")){var u=c.match(/<(?:\w+:)?comment[^>]*>/);if(u){var p=tt(u[0]),m={author:p.authorId&&n[p.authorId]||"sheetjsghost",ref:p.ref,guid:p.guid},x=or(p.ref);if(!(t.sheetRows&&t.sheetRows<=x.r)){var y=c.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),_=!!y&&!!y[1]&&Zh(y[1])||{r:"",t:"",h:""};m.r=_.r,_.r=="<t></t>"&&(_.t=_.h=""),m.t=(_.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(m.h=_.h),r.push(m)}}}}),r}function KF(e,t){var n=[],r=!1,a={},l=0;return e.replace(rr,function(u,p){var m=tt(u);switch(wa(m[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:m.personId,guid:m.id,ref:m.ref,T:1};break;case"</threadedComment>":a.t!=null&&n.push(a);break;case"<text>":case"<text":l=p+u.length;break;case"</text>":a.t=e.slice(l,p).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":r=!0;break;case"</mentions>":r=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&t.WTF)throw new Error("unrecognized "+m[0]+" in threaded comments")}return u}),n}function ZF(e,t){var n=[],r=!1;return e.replace(rr,function(l){var c=tt(l);switch(wa(c[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":n.push({name:c.displayname,id:c.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return l}),n}function QF(e){var t={};t.iauthor=e.read_shift(4);var n=_s(e);return t.rfx=n.s,t.ref=it(n.s),e.l+=16,t}var eL=tr;function tL(e,t){var n=[],r=[],a={},l=!1;return ei(e,function(u,p,m){switch(m){case 632:r.push(u);break;case 635:a=u;break;case 637:a.t=u.t,a.h=u.h,a.r=u.r;break;case 636:if(a.author=r[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,n.push(a);break;case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!p.T){if(!l||t.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}),n}var nL="application/vnd.ms-office.vbaProject";function rL(e){var t=bt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(n,r){if(!(n.slice(-1)==="/"||!n.match(/_VBA_PROJECT_CUR/))){var a=n.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");bt.utils.cfb_add(t,a,e.FileIndex[r].content)}}),bt.write(t)}function aL(){return{"!type":"dialog"}}function iL(){return{"!type":"dialog"}}function sL(){return{"!type":"macro"}}function lL(){return{"!type":"macro"}}var pl=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function n(r,a,l,c){var u=!1,p=!1;l.length==0?p=!0:l.charAt(0)=="["&&(p=!0,l=l.slice(1,-1)),c.length==0?u=!0:c.charAt(0)=="["&&(u=!0,c=c.slice(1,-1));var m=l.length>0?parseInt(l,10)|0:0,x=c.length>0?parseInt(c,10)|0:0;return u?x+=t.c:--x,p?m+=t.r:--m,a+(u?"":"$")+Mn(x)+(p?"":"$")+$n(m)}return function(a,l){return t=l,a.replace(e,n)}}(),e_=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,oL=function(){return function(t,n){return t.replace(e_,function(r,a,l,c,u,p){var m=$h(c)-(l?0:n.c),x=qh(p)-(u?0:n.r),y=x==0?"":u?x+1:"["+x+"]",_=m==0?"":l?m+1:"["+m+"]";return a+"R"+y+"C"+_})}}();function t_(e,t){return e.replace(e_,function(n,r,a,l,c,u){return r+(a=="$"?a+l:Mn($h(l)+t.c))+(c=="$"?c+u:$n(qh(u)+t.r))})}function cL(e,t,n){var r=Nl(t),a=r.s,l=or(n),c={r:l.r-a.r,c:l.c-a.c};return t_(e,c)}function uL(e){return e.length!=1}function wy(e){return e.replace(/_xlfn\./g,"")}function _n(e){e.l+=1}function Pi(e,t){var n=e.read_shift(2);return[n&16383,n>>14&1,n>>15&1]}function n_(e,t,n){var r=2;if(n){if(n.biff>=2&&n.biff<=5)return r_(e);n.biff==12&&(r=4)}var a=e.read_shift(r),l=e.read_shift(r),c=Pi(e),u=Pi(e);return{s:{r:a,c:c[0],cRel:c[1],rRel:c[2]},e:{r:l,c:u[0],cRel:u[1],rRel:u[2]}}}function r_(e){var t=Pi(e),n=Pi(e),r=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:r,cRel:t[1],rRel:t[2]},e:{r:n[0],c:a,cRel:n[1],rRel:n[2]}}}function fL(e,t,n){if(n.biff<8)return r_(e);var r=e.read_shift(n.biff==12?4:2),a=e.read_shift(n.biff==12?4:2),l=Pi(e),c=Pi(e);return{s:{r,c:l[0],cRel:l[1],rRel:l[2]},e:{r:a,c:c[0],cRel:c[1],rRel:c[2]}}}function a_(e,t,n){if(n&&n.biff>=2&&n.biff<=5)return dL(e);var r=e.read_shift(n&&n.biff==12?4:2),a=Pi(e);return{r,c:a[0],cRel:a[1],rRel:a[2]}}function dL(e){var t=Pi(e),n=e.read_shift(1);return{r:t[0],c:n,cRel:t[1],rRel:t[2]}}function hL(e){var t=e.read_shift(2),n=e.read_shift(2);return{r:t,c:n&255,fQuoted:!!(n&16384),cRel:n>>15,rRel:n>>15}}function mL(e,t,n){var r=n&&n.biff?n.biff:8;if(r>=2&&r<=5)return pL(e);var a=e.read_shift(r>=12?4:2),l=e.read_shift(2),c=(l&16384)>>14,u=(l&32768)>>15;if(l&=16383,u==1)for(;a>524287;)a-=1048576;if(c==1)for(;l>8191;)l=l-16384;return{r:a,c:l,cRel:c,rRel:u}}function pL(e){var t=e.read_shift(2),n=e.read_shift(1),r=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,r==1&&t>=8192&&(t=t-16384),a==1&&n>=128&&(n=n-256),{r:t,c:n,cRel:a,rRel:r}}function xL(e,t,n){var r=(e[e.l++]&96)>>5,a=n_(e,n.biff>=2&&n.biff<=5?6:8,n);return[r,a]}function gL(e,t,n){var r=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),l=8;if(n)switch(n.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}var c=n_(e,l,n);return[r,a,c]}function vL(e,t,n){var r=(e[e.l++]&96)>>5;return e.l+=n&&n.biff>8?12:n.biff<8?6:8,[r]}function yL(e,t,n){var r=(e[e.l++]&96)>>5,a=e.read_shift(2),l=8;if(n)switch(n.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}return e.l+=l,[r,a]}function TL(e,t,n){var r=(e[e.l++]&96)>>5,a=fL(e,t-1,n);return[r,a]}function _L(e,t,n){var r=(e[e.l++]&96)>>5;return e.l+=n.biff==2?6:n.biff==12?14:7,[r]}function Cy(e){var t=e[e.l+1]&1,n=1;return e.l+=4,[t,n]}function EL(e,t,n){e.l+=2;for(var r=e.read_shift(n&&n.biff==2?1:2),a=[],l=0;l<=r;++l)a.push(e.read_shift(n&&n.biff==2?1:2));return a}function SL(e,t,n){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(n&&n.biff==2?1:2)]}function wL(e,t,n){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(n&&n.biff==2?1:2)]}function CL(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function AL(e,t,n){var r=e[e.l+1]&255?1:0;return e.l+=n&&n.biff==2?3:4,[r]}function i_(e){var t=e.read_shift(1),n=e.read_shift(1);return[t,n]}function bL(e){return e.read_shift(2),i_(e)}function kL(e){return e.read_shift(2),i_(e)}function NL(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var a=a_(e,0,n);return[r,a]}function ML(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var a=mL(e,0,n);return[r,a]}function RL(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);n&&n.biff==5&&(e.l+=12);var l=a_(e,0,n);return[r,a,l]}function DL(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(n&&n.biff<=3?1:2);return[IO[a],o_[a],r]}function IL(e,t,n){var r=e[e.l++],a=e.read_shift(1),l=n&&n.biff<=3?[r==88?-1:0,e.read_shift(1)]:FL(e);return[a,(l[0]===0?o_:DO)[l[1]]]}function FL(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function LL(e,t,n){e.l+=n&&n.biff==2?3:4}function OL(e,t,n){if(e.l++,n&&n.biff==12)return[e.read_shift(4,"i"),0];var r=e.read_shift(2),a=e.read_shift(n&&n.biff==2?1:2);return[r,a]}function PL(e){return e.l++,Es[e.read_shift(1)]}function UL(e){return e.l++,e.read_shift(2)}function BL(e){return e.l++,e.read_shift(1)!==0}function VL(e){return e.l++,Zn(e)}function HL(e,t,n){return e.l++,dc(e,t-1,n)}function GL(e,t){var n=[e.read_shift(1)];if(t==12)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2;break}switch(n[0]){case 4:n[1]=vn(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:n[1]=Es[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:n[1]=Zn(e);break;case 2:n[1]=Ss(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+n[0])}return n}function jL(e,t,n){for(var r=e.read_shift(n.biff==12?4:2),a=[],l=0;l!=r;++l)a.push((n.biff==12?_s:yf)(e));return a}function zL(e,t,n){var r=0,a=0;n.biff==12?(r=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),r=1+e.read_shift(2)),n.biff>=2&&n.biff<8&&(--r,--a==0&&(a=256));for(var l=0,c=[];l!=r&&(c[l]=[]);++l)for(var u=0;u!=a;++u)c[l][u]=GL(e,n.biff);return c}function qL(e,t,n){var r=e.read_shift(1)>>>5&3,a=!n||n.biff>=8?4:2,l=e.read_shift(a);switch(n.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[r,0,l]}function $L(e,t,n){if(n.biff==5)return YL(e);var r=e.read_shift(1)>>>5&3,a=e.read_shift(2),l=e.read_shift(4);return[r,a,l]}function YL(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[t,n,r]}function WL(e,t,n){var r=e.read_shift(1)>>>5&3;e.l+=n&&n.biff==2?3:4;var a=e.read_shift(n&&n.biff==2?1:2);return[r,a]}function JL(e,t,n){var r=e.read_shift(1)>>>5&3,a=e.read_shift(n&&n.biff==2?1:2);return[r,a]}function XL(e,t,n){var r=e.read_shift(1)>>>5&3;return e.l+=4,n.biff<8&&e.l--,n.biff==12&&(e.l+=2),[r]}function KL(e,t,n){var r=(e[e.l++]&96)>>5,a=e.read_shift(2),l=4;if(n)switch(n.biff){case 5:l=15;break;case 12:l=6;break}return e.l+=l,[r,a]}var ZL=nr,QL=nr,eO=nr;function mc(e,t,n){return e.l+=2,[hL(e)]}function em(e){return e.l+=6,[]}var tO=mc,nO=em,rO=em,aO=mc;function s_(e){return e.l+=2,[Sn(e),e.read_shift(2)&1]}var iO=mc,sO=s_,lO=em,oO=mc,cO=mc,uO=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function fO(e){e.l+=2;var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(4),a=e.read_shift(2),l=e.read_shift(2),c=uO[n>>2&31];return{ixti:t,coltype:n&3,rt:c,idx:r,c:a,C:l}}function dO(e){return e.l+=2,[e.read_shift(4)]}function hO(e,t,n){return e.l+=5,e.l+=2,e.l+=n.biff==2?1:4,["PTGSHEET"]}function mO(e,t,n){return e.l+=n.biff==2?4:5,["PTGENDSHEET"]}function pO(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2);return[t,n]}function xO(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2);return[t,n]}function gO(e){return e.l+=4,[0,0]}var Ay={1:{n:"PtgExp",f:OL},2:{n:"PtgTbl",f:eO},3:{n:"PtgAdd",f:_n},4:{n:"PtgSub",f:_n},5:{n:"PtgMul",f:_n},6:{n:"PtgDiv",f:_n},7:{n:"PtgPower",f:_n},8:{n:"PtgConcat",f:_n},9:{n:"PtgLt",f:_n},10:{n:"PtgLe",f:_n},11:{n:"PtgEq",f:_n},12:{n:"PtgGe",f:_n},13:{n:"PtgGt",f:_n},14:{n:"PtgNe",f:_n},15:{n:"PtgIsect",f:_n},16:{n:"PtgUnion",f:_n},17:{n:"PtgRange",f:_n},18:{n:"PtgUplus",f:_n},19:{n:"PtgUminus",f:_n},20:{n:"PtgPercent",f:_n},21:{n:"PtgParen",f:_n},22:{n:"PtgMissArg",f:_n},23:{n:"PtgStr",f:HL},26:{n:"PtgSheet",f:hO},27:{n:"PtgEndSheet",f:mO},28:{n:"PtgErr",f:PL},29:{n:"PtgBool",f:BL},30:{n:"PtgInt",f:UL},31:{n:"PtgNum",f:VL},32:{n:"PtgArray",f:_L},33:{n:"PtgFunc",f:DL},34:{n:"PtgFuncVar",f:IL},35:{n:"PtgName",f:qL},36:{n:"PtgRef",f:NL},37:{n:"PtgArea",f:xL},38:{n:"PtgMemArea",f:WL},39:{n:"PtgMemErr",f:ZL},40:{n:"PtgMemNoMem",f:QL},41:{n:"PtgMemFunc",f:JL},42:{n:"PtgRefErr",f:XL},43:{n:"PtgAreaErr",f:vL},44:{n:"PtgRefN",f:ML},45:{n:"PtgAreaN",f:TL},46:{n:"PtgMemAreaN",f:pO},47:{n:"PtgMemNoMemN",f:xO},57:{n:"PtgNameX",f:$L},58:{n:"PtgRef3d",f:RL},59:{n:"PtgArea3d",f:gL},60:{n:"PtgRefErr3d",f:KL},61:{n:"PtgAreaErr3d",f:yL},255:{}},vO={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},yO={1:{n:"PtgElfLel",f:s_},2:{n:"PtgElfRw",f:oO},3:{n:"PtgElfCol",f:tO},6:{n:"PtgElfRwV",f:cO},7:{n:"PtgElfColV",f:aO},10:{n:"PtgElfRadical",f:iO},11:{n:"PtgElfRadicalS",f:lO},13:{n:"PtgElfColS",f:nO},15:{n:"PtgElfColSV",f:rO},16:{n:"PtgElfRadicalLel",f:sO},25:{n:"PtgList",f:fO},29:{n:"PtgSxName",f:dO},255:{}},TO={0:{n:"PtgAttrNoop",f:gO},1:{n:"PtgAttrSemi",f:AL},2:{n:"PtgAttrIf",f:wL},4:{n:"PtgAttrChoose",f:EL},8:{n:"PtgAttrGoto",f:SL},16:{n:"PtgAttrSum",f:LL},32:{n:"PtgAttrBaxcel",f:Cy},33:{n:"PtgAttrBaxcel",f:Cy},64:{n:"PtgAttrSpace",f:bL},65:{n:"PtgAttrSpaceSemi",f:kL},128:{n:"PtgAttrIfError",f:CL},255:{}};function pc(e,t,n,r){if(r.biff<8)return nr(e,t);for(var a=e.l+t,l=[],c=0;c!==n.length;++c)switch(n[c][0]){case"PtgArray":n[c][1]=zL(e,0,r),l.push(n[c][1]);break;case"PtgMemArea":n[c][2]=jL(e,n[c][1],r),l.push(n[c][2]);break;case"PtgExp":r&&r.biff==12&&(n[c][1][1]=e.read_shift(4),l.push(n[c][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[c][0]}return t=a-e.l,t!==0&&l.push(nr(e,t)),l}function xc(e,t,n){for(var r=e.l+t,a,l,c=[];r!=e.l;)t=r-e.l,l=e[e.l],a=Ay[l]||Ay[vO[l]],(l===24||l===25)&&(a=(l===24?yO:TO)[e[e.l+1]]),!a||!a.f?nr(e,t):c.push([a.n,a.f(e,t,n)]);return c}function _O(e){for(var t=[],n=0;n<e.length;++n){for(var r=e[n],a=[],l=0;l<r.length;++l){var c=r[l];if(c)switch(c[0]){case 2:a.push('"'+c[1].replace(/"/g,'""')+'"');break;default:a.push(c[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var EO={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function SO(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function l_(e,t,n){if(!e)return"SH33TJSERR0";if(n.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[t];if(n.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!r)return"SH33TJSERR1";var a="";if(n.biff>8)switch(e[r[0]][0]){case 357:return a=r[1]==-1?"#REF":e.SheetNames[r[1]],r[1]==r[2]?a:a+":"+e.SheetNames[r[2]];case 358:return n.SID!=null?e.SheetNames[n.SID]:"SH33TJSSAME"+e[r[0]][0];case 355:default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return a=r[1]==-1?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?a:a+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map(function(l){return l.Name}).join(";;");default:return e[r[0]][0][3]?(a=r[1]==-1?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?a:a+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function by(e,t,n){var r=l_(e,t,n);return r=="#REF"?r:SO(r,n)}function Kn(e,t,n,r,a){var l=a&&a.biff||8,c={s:{c:0,r:0}},u=[],p,m,x,y=0,_=0,E,w="";if(!e[0]||!e[0][0])return"";for(var S=-1,C="",M=0,k=e[0].length;M<k;++M){var b=e[0][M];switch(b[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(p=u.pop(),m=u.pop(),S>=0){switch(e[0][S][1][0]){case 0:C=mn(" ",e[0][S][1][1]);break;case 1:C=mn("\r",e[0][S][1][1]);break;default:if(C="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][S][1][0])}m=m+C,S=-1}u.push(m+EO[b[0]]+p);break;case"PtgIsect":p=u.pop(),m=u.pop(),u.push(m+" "+p);break;case"PtgUnion":p=u.pop(),m=u.pop(),u.push(m+","+p);break;case"PtgRange":p=u.pop(),m=u.pop(),u.push(m+":"+p);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":x=Uo(b[1][1],c,a),u.push(Bo(x,l));break;case"PtgRefN":x=n?Uo(b[1][1],n,a):b[1][1],u.push(Bo(x,l));break;case"PtgRef3d":y=b[1][1],x=Uo(b[1][2],c,a),w=by(r,y,a),u.push(w+"!"+Bo(x,l));break;case"PtgFunc":case"PtgFuncVar":var U=b[1][0],G=b[1][1];U||(U=0),U&=127;var J=U==0?[]:u.slice(-U);u.length-=U,G==="User"&&(G=J.shift()),u.push(G+"("+J.join(",")+")");break;case"PtgBool":u.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(b[1]);break;case"PtgNum":u.push(String(b[1]));break;case"PtgStr":u.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(b[1]);break;case"PtgAreaN":E=ly(b[1][1],n?{s:n}:c,a),u.push(Od(E,a));break;case"PtgArea":E=ly(b[1][1],c,a),u.push(Od(E,a));break;case"PtgArea3d":y=b[1][1],E=b[1][2],w=by(r,y,a),u.push(w+"!"+Od(E,a));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":_=b[1][2];var F=(r.names||[])[_-1]||(r[0]||[])[_],W=F?F.Name:"SH33TJSNAME"+String(_);W&&W.slice(0,6)=="_xlfn."&&!a.xlfn&&(W=W.slice(6)),u.push(W);break;case"PtgNameX":var O=b[1][1];_=b[1][2];var ee;if(a.biff<=5)O<0&&(O=-O),r[O]&&(ee=r[O][_]);else{var ne="";if(((r[O]||[])[0]||[])[0]==14849||(((r[O]||[])[0]||[])[0]==1025?r[O][_]&&r[O][_].itab>0&&(ne=r.SheetNames[r[O][_].itab-1]+"!"):ne=r.SheetNames[_-1]+"!"),r[O]&&r[O][_])ne+=r[O][_].Name;else if(r[0]&&r[0][_])ne+=r[0][_].Name;else{var te=(l_(r,O,a)||"").split(";;");te[_-1]?ne=te[_-1]:ne+="SH33TJSERRX"}u.push(ne);break}ee||(ee={Name:"SH33TJSERRY"}),u.push(ee.Name);break;case"PtgParen":var _e="(",Ie=")";if(S>=0){switch(C="",e[0][S][1][0]){case 2:_e=mn(" ",e[0][S][1][1])+_e;break;case 3:_e=mn("\r",e[0][S][1][1])+_e;break;case 4:Ie=mn(" ",e[0][S][1][1])+Ie;break;case 5:Ie=mn("\r",e[0][S][1][1])+Ie;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][S][1][0])}S=-1}u.push(_e+u.pop()+Ie);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":x={c:b[1][1],r:b[1][0]};var Ee={c:n.c,r:n.r};if(r.sharedf[it(x)]){var ae=r.sharedf[it(x)];u.push(Kn(ae,c,Ee,r,a))}else{var de=!1;for(p=0;p!=r.arrayf.length;++p)if(m=r.arrayf[p],!(x.c<m[0].s.c||x.c>m[0].e.c)&&!(x.r<m[0].s.r||x.r>m[0].e.r)){u.push(Kn(m[1],c,Ee,r,a)),de=!0;break}de||u.push(b[1])}break;case"PtgArray":u.push("{"+_O(b[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":S=M;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(b));default:throw new Error("Unrecognized Formula Token: "+String(b))}var re=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&S>=0&&re.indexOf(e[0][M][0])==-1){b=e[0][S];var Y=!0;switch(b[1][0]){case 4:Y=!1;case 0:C=mn(" ",b[1][1]);break;case 5:Y=!1;case 1:C=mn("\r",b[1][1]);break;default:if(C="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}u.push((Y?C:"")+u.pop()+(Y?"":C)),S=-1}}if(u.length>1&&a.WTF)throw new Error("bad formula stack");return u[0]}function wO(e,t,n){var r=e.l+t,a=n.biff==2?1:2,l,c=e.read_shift(a);if(c==65535)return[[],nr(e,t-2)];var u=xc(e,c,n);return t!==c+a&&(l=pc(e,t-c-a,u,n)),e.l=r,[u,l]}function CO(e,t,n){var r=e.l+t,a=n.biff==2?1:2,l,c=e.read_shift(a);if(c==65535)return[[],nr(e,t-2)];var u=xc(e,c,n);return t!==c+a&&(l=pc(e,t-c-a,u,n)),e.l=r,[u,l]}function AO(e,t,n,r){var a=e.l+t,l=xc(e,r,n),c;return a!==e.l&&(c=pc(e,a-e.l,l,n)),[l,c]}function bO(e,t,n){var r=e.l+t,a,l=e.read_shift(2),c=xc(e,l,n);return l==65535?[[],nr(e,t-2)]:(t!==l+2&&(a=pc(e,r-l-2,c,n)),[c,a])}function kO(e){var t;if(qa(e,e.l+6)!==65535)return[Zn(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Bd(e,t,n){var r=e.l+t,a=Ca(e);n.biff==2&&++e.l;var l=kO(e),c=e.read_shift(1);n.biff!=2&&(e.read_shift(1),n.biff>=5&&e.read_shift(4));var u=CO(e,r-e.l,n);return{cell:a,val:l[0],formula:u,shared:c>>3&1,tt:l[1]}}function Tf(e,t,n){var r=e.read_shift(4),a=xc(e,r,n),l=e.read_shift(4),c=l>0?pc(e,l,a,n):null;return[a,c]}var NO=Tf,_f=Tf,MO=Tf,RO=Tf,DO={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},o_={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},IO={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function ky(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,n){return n.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Vd(e){var t=e.split(":"),n=t[0].split(".")[0];return[n,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var jo={},xl={};function zo(e,t){if(e){var n=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(n=[1,1,1,1,.5,.5]),e.left==null&&(e.left=n[0]),e.right==null&&(e.right=n[1]),e.top==null&&(e.top=n[2]),e.bottom==null&&(e.bottom=n[3]),e.header==null&&(e.header=n[4]),e.footer==null&&(e.footer=n[5])}}function c_(e,t,n,r,a,l){try{r.cellNF&&(e.z=lt[t])}catch(u){if(r.WTF)throw u}if(!(e.t==="z"&&!r.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Un(e.v)),(!r||r.cellText!==!1)&&e.t!=="z")try{if(lt[t]==null&&ss(FD[t]||"General",t),e.t==="e")e.w=e.w||Es[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Zo(e.v);else if(e.t==="d"){var c=fr(e.v);(c|0)===c?e.w=c.toString(10):e.w=Zo(c)}else{if(e.v===void 0)return"";e.w=hs(e.v,xl)}else e.t==="d"?e.w=$r(t,fr(e.v),xl):e.w=$r(t,e.v,xl)}catch(u){if(r.WTF)throw u}if(r.cellStyles&&n!=null)try{e.s=l.Fills[n],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=rf(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),r.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=rf(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),r.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(u){if(r.WTF&&l.Fills)throw u}}}function FO(e,t){var n=pn(t);n.s.r<=n.e.r&&n.s.c<=n.e.c&&n.s.r>=0&&n.s.c>=0&&(e["!ref"]=Nt(n))}var LO=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,OO=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,PO=/<(?:\w:)?hyperlink [^>]*>/mg,UO=/"(\w*:\w*)"/,BO=/<(?:\w:)?col\b[^>]*[\/]?>/g,VO=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,HO=/<(?:\w:)?pageMargins[^>]*\/>/g,u_=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,GO=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,jO=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function zO(e,t,n,r,a,l,c){if(!e)return e;r||(r={"!id":{}});var u=t.dense?[]:{},p={s:{r:2e6,c:2e6},e:{r:0,c:0}},m="",x="",y=e.match(OO);y?(m=e.slice(0,y.index),x=e.slice(y.index+y[0].length)):m=x=e;var _=m.match(u_);_?tm(_[0],u,a,n):(_=m.match(GO))&&qO(_[0],_[1]||"",u,a,n);var E=(m.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(E>0){var w=m.slice(E,E+50).match(UO);w&&FO(u,w[1])}var S=m.match(jO);S&&S[1]&&KO(S[1],a);var C=[];if(t.cellStyles){var M=m.match(BO);M&&WO(C,M)}y&&ZO(y[1],u,t,p,l,c);var k=x.match(VO);k&&(u["!autofilter"]=JO(k[0]));var b=[],U=x.match(LO);if(U)for(E=0;E!=U.length;++E)b[E]=pn(U[E].slice(U[E].indexOf('"')+1));var G=x.match(PO);G&&$O(u,G,r);var J=x.match(HO);if(J&&(u["!margins"]=YO(tt(J[0]))),!u["!ref"]&&p.e.c>=p.s.c&&p.e.r>=p.s.r&&(u["!ref"]=Nt(p)),t.sheetRows>0&&u["!ref"]){var F=pn(u["!ref"]);t.sheetRows<=+F.e.r&&(F.e.r=t.sheetRows-1,F.e.r>p.e.r&&(F.e.r=p.e.r),F.e.r<F.s.r&&(F.s.r=F.e.r),F.e.c>p.e.c&&(F.e.c=p.e.c),F.e.c<F.s.c&&(F.s.c=F.e.c),u["!fullref"]=u["!ref"],u["!ref"]=Nt(F))}return C.length>0&&(u["!cols"]=C),b.length>0&&(u["!merges"]=b),u}function tm(e,t,n,r){var a=tt(e);n.Sheets[r]||(n.Sheets[r]={}),a.codeName&&(n.Sheets[r].CodeName=Rt(Zt(a.codeName)))}function qO(e,t,n,r,a){tm(e.slice(0,e.indexOf(">")),n,r,a)}function $O(e,t,n){for(var r=Array.isArray(e),a=0;a!=t.length;++a){var l=tt(Zt(t[a]),!0);if(!l.ref)return;var c=((n||{})["!id"]||[])[l.id];c?(l.Target=c.Target,l.location&&(l.Target+="#"+Rt(l.location))):(l.Target="#"+Rt(l.location),c={Target:l.Target,TargetMode:"Internal"}),l.Rel=c,l.tooltip&&(l.Tooltip=l.tooltip,delete l.tooltip);for(var u=pn(l.ref),p=u.s.r;p<=u.e.r;++p)for(var m=u.s.c;m<=u.e.c;++m){var x=it({c:m,r:p});r?(e[p]||(e[p]=[]),e[p][m]||(e[p][m]={t:"z",v:void 0}),e[p][m].l=l):(e[x]||(e[x]={t:"z",v:void 0}),e[x].l=l)}}}function YO(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(n){e[n]&&(t[n]=parseFloat(e[n]))}),t}function WO(e,t){for(var n=!1,r=0;r!=t.length;++r){var a=tt(t[r],!0);a.hidden&&(a.hidden=sn(a.hidden));var l=parseInt(a.min,10)-1,c=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!n&&a.width&&(n=!0,Qh(a.width)),Sl(a);l<=c;)e[l++]=qn(a)}}function JO(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var XO=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function KO(e,t){t.Views||(t.Views=[{}]),(e.match(XO)||[]).forEach(function(n,r){var a=tt(n);t.Views[r]||(t.Views[r]={}),+a.zoomScale&&(t.Views[r].zoom=+a.zoomScale),sn(a.rightToLeft)&&(t.Views[r].RTL=!0)})}var ZO=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,n=/r=["']([^"']*)["']/,r=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,l=Qo("v"),c=Qo("f");return function(p,m,x,y,_,E){for(var w=0,S="",C=[],M=[],k=0,b=0,U=0,G="",J,F,W=0,O=0,ee,ne,te=0,_e=0,Ie=Array.isArray(E.CellXf),Ee,ae=[],de=[],re=Array.isArray(m),Y=[],N={},Z=!1,D=!!x.sheetStubs,H=p.split(t),q=0,j=H.length;q!=j;++q){S=H[q].trim();var se=S.length;if(se!==0){var Te=0;e:for(w=0;w<se;++w)switch(S[w]){case">":if(S[w-1]!="/"){++w;break e}if(x&&x.cellStyles){if(F=tt(S.slice(Te,w),!0),W=F.r!=null?parseInt(F.r,10):W+1,O=-1,x.sheetRows&&x.sheetRows<W)continue;N={},Z=!1,F.ht&&(Z=!0,N.hpt=parseFloat(F.ht),N.hpx=rc(N.hpt)),F.hidden=="1"&&(Z=!0,N.hidden=!0),F.outlineLevel!=null&&(Z=!0,N.level=+F.outlineLevel),Z&&(Y[W-1]=N)}break;case"<":Te=w;break}if(Te>=w)break;if(F=tt(S.slice(Te,w),!0),W=F.r!=null?parseInt(F.r,10):W+1,O=-1,!(x.sheetRows&&x.sheetRows<W)){y.s.r>W-1&&(y.s.r=W-1),y.e.r<W-1&&(y.e.r=W-1),x&&x.cellStyles&&(N={},Z=!1,F.ht&&(Z=!0,N.hpt=parseFloat(F.ht),N.hpx=rc(N.hpt)),F.hidden=="1"&&(Z=!0,N.hidden=!0),F.outlineLevel!=null&&(Z=!0,N.level=+F.outlineLevel),Z&&(Y[W-1]=N)),C=S.slice(w).split(e);for(var Ae=0;Ae!=C.length&&C[Ae].trim().charAt(0)=="<";++Ae);for(C=C.slice(Ae),w=0;w!=C.length;++w)if(S=C[w].trim(),S.length!==0){if(M=S.match(n),k=w,b=0,U=0,S="<c "+(S.slice(0,1)=="<"?">":"")+S,M!=null&&M.length===2){for(k=0,G=M[1],b=0;b!=G.length&&!((U=G.charCodeAt(b)-64)<1||U>26);++b)k=26*k+U;--k,O=k}else++O;for(b=0;b!=S.length&&S.charCodeAt(b)!==62;++b);if(++b,F=tt(S.slice(0,b),!0),F.r||(F.r=it({r:W-1,c:O})),G=S.slice(b),J={t:""},(M=G.match(l))!=null&&M[1]!==""&&(J.v=Rt(M[1])),x.cellFormula){if((M=G.match(c))!=null&&M[1]!==""){if(J.f=Rt(Zt(M[1])).replace(/\r\n/g,`
`),x.xlfn||(J.f=wy(J.f)),M[0].indexOf('t="array"')>-1)J.F=(G.match(a)||[])[1],J.F.indexOf(":")>-1&&ae.push([pn(J.F),J.F]);else if(M[0].indexOf('t="shared"')>-1){ne=tt(M[0]);var Re=Rt(Zt(M[1]));x.xlfn||(Re=wy(Re)),de[parseInt(ne.si,10)]=[ne,Re,F.r]}}else(M=G.match(/<f[^>]*\/>/))&&(ne=tt(M[0]),de[ne.si]&&(J.f=cL(de[ne.si][1],de[ne.si][2],F.r)));var Ce=or(F.r);for(b=0;b<ae.length;++b)Ce.r>=ae[b][0].s.r&&Ce.r<=ae[b][0].e.r&&Ce.c>=ae[b][0].s.c&&Ce.c<=ae[b][0].e.c&&(J.F=ae[b][1])}if(F.t==null&&J.v===void 0)if(J.f||J.F)J.v=0,J.t="n";else if(D)J.t="z";else continue;else J.t=F.t||"n";switch(y.s.c>O&&(y.s.c=O),y.e.c<O&&(y.e.c=O),J.t){case"n":if(J.v==""||J.v==null){if(!D)continue;J.t="z"}else J.v=parseFloat(J.v);break;case"s":if(typeof J.v>"u"){if(!D)continue;J.t="z"}else ee=jo[parseInt(J.v,10)],J.v=ee.t,J.r=ee.r,x.cellHTML&&(J.h=ee.h);break;case"str":J.t="s",J.v=J.v!=null?Zt(J.v):"",x.cellHTML&&(J.h=Gh(J.v));break;case"inlineStr":M=G.match(r),J.t="s",M!=null&&(ee=Zh(M[1]))?(J.v=ee.t,x.cellHTML&&(J.h=ee.h)):J.v="";break;case"b":J.v=sn(J.v);break;case"d":x.cellDates?J.v=Un(J.v,1):(J.v=fr(Un(J.v,1)),J.t="n");break;case"e":(!x||x.cellText!==!1)&&(J.w=J.v),J.v=RT[J.v];break}if(te=_e=0,Ee=null,Ie&&F.s!==void 0&&(Ee=E.CellXf[F.s],Ee!=null&&(Ee.numFmtId!=null&&(te=Ee.numFmtId),x.cellStyles&&Ee.fillId!=null&&(_e=Ee.fillId))),c_(J,te,_e,x,_,E),x.cellDates&&Ie&&J.t=="n"&&kl(lt[te])&&(J.t="d",J.v=vf(J.v)),F.cm&&x.xlmeta){var Xe=(x.xlmeta.Cell||[])[+F.cm-1];Xe&&Xe.type=="XLDAPR"&&(J.D=!0)}if(re){var X=or(F.r);m[X.r]||(m[X.r]=[]),m[X.r][X.c]=J}else m[F.r]=J}}}}Y.length>0&&(m["!rows"]=Y)}}();function QO(e,t){var n={},r=e.l+t;n.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var l=e.read_shift(1);return e.l=r,l&7&&(n.level=l&7),l&16&&(n.hidden=!0),l&32&&(n.hpt=a/20),n}var e7=_s;function t7(){}function n7(e,t){var n={},r=e[e.l];return++e.l,n.above=!(r&64),n.left=!(r&128),e.l+=18,n.name=w6(e),n}function r7(e){var t=Wr(e);return[t]}function a7(e){var t=Ts(e);return[t]}function i7(e){var t=Wr(e),n=e.read_shift(1);return[t,n,"b"]}function s7(e){var t=Ts(e),n=e.read_shift(1);return[t,n,"b"]}function l7(e){var t=Wr(e),n=e.read_shift(1);return[t,n,"e"]}function o7(e){var t=Ts(e),n=e.read_shift(1);return[t,n,"e"]}function c7(e){var t=Wr(e),n=e.read_shift(4);return[t,n,"s"]}function u7(e){var t=Ts(e),n=e.read_shift(4);return[t,n,"s"]}function f7(e){var t=Wr(e),n=Zn(e);return[t,n,"n"]}function f_(e){var t=Ts(e),n=Zn(e);return[t,n,"n"]}function d7(e){var t=Wr(e),n=Jh(e);return[t,n,"n"]}function h7(e){var t=Ts(e),n=Jh(e);return[t,n,"n"]}function m7(e){var t=Wr(e),n=Yh(e);return[t,n,"is"]}function p7(e){var t=Wr(e),n=tr(e);return[t,n,"str"]}function x7(e){var t=Ts(e),n=tr(e);return[t,n,"str"]}function g7(e,t,n){var r=e.l+t,a=Wr(e);a.r=n["!row"];var l=e.read_shift(1),c=[a,l,"b"];if(n.cellFormula){e.l+=2;var u=_f(e,r-e.l,n);c[3]=Kn(u,null,a,n.supbooks,n)}else e.l=r;return c}function v7(e,t,n){var r=e.l+t,a=Wr(e);a.r=n["!row"];var l=e.read_shift(1),c=[a,l,"e"];if(n.cellFormula){e.l+=2;var u=_f(e,r-e.l,n);c[3]=Kn(u,null,a,n.supbooks,n)}else e.l=r;return c}function y7(e,t,n){var r=e.l+t,a=Wr(e);a.r=n["!row"];var l=Zn(e),c=[a,l,"n"];if(n.cellFormula){e.l+=2;var u=_f(e,r-e.l,n);c[3]=Kn(u,null,a,n.supbooks,n)}else e.l=r;return c}function T7(e,t,n){var r=e.l+t,a=Wr(e);a.r=n["!row"];var l=tr(e),c=[a,l,"str"];if(n.cellFormula){e.l+=2;var u=_f(e,r-e.l,n);c[3]=Kn(u,null,a,n.supbooks,n)}else e.l=r;return c}var _7=_s;function E7(e,t){var n=e.l+t,r=_s(e),a=Wh(e),l=tr(e),c=tr(e),u=tr(e);e.l=n;var p={rfx:r,relId:a,loc:l,display:u};return c&&(p.Tooltip=c),p}function S7(){}function w7(e,t,n){var r=e.l+t,a=kT(e),l=e.read_shift(1),c=[a];if(c[2]=l,n.cellFormula){var u=NO(e,r-e.l,n);c[1]=u}else e.l=r;return c}function C7(e,t,n){var r=e.l+t,a=_s(e),l=[a];if(n.cellFormula){var c=RO(e,r-e.l,n);l[1]=c,e.l=r}else e.l=r;return l}var A7=["left","right","top","bottom","header","footer"];function b7(e){var t={};return A7.forEach(function(n){t[n]=Zn(e)}),t}function k7(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function N7(){}function M7(){}function R7(e,t,n,r,a,l,c){if(!e)return e;var u=t||{};r||(r={"!id":{}});var p=u.dense?[]:{},m,x={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=!1,_=!1,E,w,S,C,M,k,b,U,G,J=[];u.biff=12,u["!row"]=0;var F=0,W=!1,O=[],ee={},ne=u.supbooks||a.supbooks||[[]];if(ne.sharedf=ee,ne.arrayf=O,ne.SheetNames=a.SheetNames||a.Sheets.map(function(re){return re.name}),!u.supbooks&&(u.supbooks=ne,a.Names))for(var te=0;te<a.Names.length;++te)ne[0][te+1]=a.Names[te];var _e=[],Ie=[],Ee=!1;lf[16]={n:"BrtShortReal",f:f_};var ae;if(ei(e,function(Y,N,Z){if(!_)switch(Z){case 148:m=Y;break;case 0:E=Y,u.sheetRows&&u.sheetRows<=E.r&&(_=!0),U=$n(C=E.r),u["!row"]=E.r,(Y.hidden||Y.hpt||Y.level!=null)&&(Y.hpt&&(Y.hpx=rc(Y.hpt)),Ie[Y.r]=Y);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(w={t:Y[2]},Y[2]){case"n":w.v=Y[1];break;case"s":b=jo[Y[1]],w.v=b.t,w.r=b.r;break;case"b":w.v=!!Y[1];break;case"e":w.v=Y[1],u.cellText!==!1&&(w.w=Es[w.v]);break;case"str":w.t="s",w.v=Y[1];break;case"is":w.t="s",w.v=Y[1].t;break}if((S=c.CellXf[Y[0].iStyleRef])&&c_(w,S.numFmtId,null,u,l,c),M=Y[0].c==-1?M+1:Y[0].c,u.dense?(p[C]||(p[C]=[]),p[C][M]=w):p[Mn(M)+U]=w,u.cellFormula){for(W=!1,F=0;F<O.length;++F){var D=O[F];E.r>=D[0].s.r&&E.r<=D[0].e.r&&M>=D[0].s.c&&M<=D[0].e.c&&(w.F=Nt(D[0]),W=!0)}!W&&Y.length>3&&(w.f=Y[3])}if(x.s.r>E.r&&(x.s.r=E.r),x.s.c>M&&(x.s.c=M),x.e.r<E.r&&(x.e.r=E.r),x.e.c<M&&(x.e.c=M),u.cellDates&&S&&w.t=="n"&&kl(lt[S.numFmtId])){var H=is(w.v);H&&(w.t="d",w.v=new Date(H.y,H.m-1,H.d,H.H,H.M,H.S,H.u))}ae&&(ae.type=="XLDAPR"&&(w.D=!0),ae=void 0);break;case 1:case 12:if(!u.sheetStubs||y)break;w={t:"z",v:void 0},M=Y[0].c==-1?M+1:Y[0].c,u.dense?(p[C]||(p[C]=[]),p[C][M]=w):p[Mn(M)+U]=w,x.s.r>E.r&&(x.s.r=E.r),x.s.c>M&&(x.s.c=M),x.e.r<E.r&&(x.e.r=E.r),x.e.c<M&&(x.e.c=M),ae&&(ae.type=="XLDAPR"&&(w.D=!0),ae=void 0);break;case 176:J.push(Y);break;case 49:ae=((u.xlmeta||{}).Cell||[])[Y-1];break;case 494:var q=r["!id"][Y.relId];for(q?(Y.Target=q.Target,Y.loc&&(Y.Target+="#"+Y.loc),Y.Rel=q):Y.relId==""&&(Y.Target="#"+Y.loc),C=Y.rfx.s.r;C<=Y.rfx.e.r;++C)for(M=Y.rfx.s.c;M<=Y.rfx.e.c;++M)u.dense?(p[C]||(p[C]=[]),p[C][M]||(p[C][M]={t:"z",v:void 0}),p[C][M].l=Y):(k=it({c:M,r:C}),p[k]||(p[k]={t:"z",v:void 0}),p[k].l=Y);break;case 426:if(!u.cellFormula)break;O.push(Y),G=u.dense?p[C][M]:p[Mn(M)+U],G.f=Kn(Y[1],x,{r:E.r,c:M},ne,u),G.F=Nt(Y[0]);break;case 427:if(!u.cellFormula)break;ee[it(Y[0].s)]=Y[1],G=u.dense?p[C][M]:p[Mn(M)+U],G.f=Kn(Y[1],x,{r:E.r,c:M},ne,u);break;case 60:if(!u.cellStyles)break;for(;Y.e>=Y.s;)_e[Y.e--]={width:Y.w/256,hidden:!!(Y.flags&1),level:Y.level},Ee||(Ee=!0,Qh(Y.w/256)),Sl(_e[Y.e+1]);break;case 161:p["!autofilter"]={ref:Nt(Y)};break;case 476:p["!margins"]=Y;break;case 147:a.Sheets[n]||(a.Sheets[n]={}),Y.name&&(a.Sheets[n].CodeName=Y.name),(Y.above||Y.left)&&(p["!outline"]={above:Y.above,left:Y.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),Y.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:y=!0;break;case 36:y=!1;break;case 37:y=!0;break;case 38:y=!1;break;default:if(!N.T){if(!y||u.WTF)throw new Error("Unexpected record 0x"+Z.toString(16))}}},u),delete u.supbooks,delete u["!row"],!p["!ref"]&&(x.s.r<2e6||m&&(m.e.r>0||m.e.c>0||m.s.r>0||m.s.c>0))&&(p["!ref"]=Nt(m||x)),u.sheetRows&&p["!ref"]){var de=pn(p["!ref"]);u.sheetRows<=+de.e.r&&(de.e.r=u.sheetRows-1,de.e.r>x.e.r&&(de.e.r=x.e.r),de.e.r<de.s.r&&(de.s.r=de.e.r),de.e.c>x.e.c&&(de.e.c=x.e.c),de.e.c<de.s.c&&(de.s.c=de.e.c),p["!fullref"]=p["!ref"],p["!ref"]=Nt(de))}return J.length>0&&(p["!merges"]=J),_e.length>0&&(p["!cols"]=_e),Ie.length>0&&(p["!rows"]=Ie),p}function D7(e){var t=[],n=e.match(/^<c:numCache>/),r;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(l){var c=l.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);c&&(t[+c[1]]=n?+c[2]:c[2])});var a=Rt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(l){r=l.replace(/<.*?>/g,"")}),[t,a,r]}function I7(e,t,n,r,a,l){var c=l||{"!type":"chart"};if(!e)return l;var u=0,p=0,m="A",x={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(y){var _=D7(y);x.s.r=x.s.c=0,x.e.c=u,m=Mn(u),_[0].forEach(function(E,w){c[m+$n(w)]={t:"n",v:E,z:_[1]},p=w}),x.e.r<p&&(x.e.r=p),++u}),u>0&&(c["!ref"]=Nt(x)),c}function F7(e,t,n,r,a){if(!e)return e;r||(r={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},c,u=e.match(u_);return u&&tm(u[0],l,a,n),(c=e.match(/drawing r:id="(.*?)"/))&&(l["!rel"]=c[1]),r["!id"][l["!rel"]]&&(l["!drawel"]=r["!id"][l["!rel"]]),l}function L7(e,t){e.l+=10;var n=tr(e);return{name:n}}function O7(e,t,n,r,a){if(!e)return e;r||(r={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},c=!1;return ei(e,function(p,m,x){switch(x){case 550:l["!rel"]=p;break;case 651:a.Sheets[n]||(a.Sheets[n]={}),p.name&&(a.Sheets[n].CodeName=p.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:break;case 38:break;default:if(!(m.T>0)){if(!(m.T<0)){if(!c||t.WTF)throw new Error("Unexpected record 0x"+x.toString(16))}}}},t),r["!id"][l["!rel"]]&&(l["!drawel"]=r["!id"][l["!rel"]]),l}var d_=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],P7=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],U7=[],B7=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Ny(e,t){for(var n=0;n!=e.length;++n)for(var r=e[n],a=0;a!=t.length;++a){var l=t[a];if(r[l[0]]==null)r[l[0]]=l[1];else switch(l[2]){case"bool":typeof r[l[0]]=="string"&&(r[l[0]]=sn(r[l[0]]));break;case"int":typeof r[l[0]]=="string"&&(r[l[0]]=parseInt(r[l[0]],10));break}}}function My(e,t){for(var n=0;n!=t.length;++n){var r=t[n];if(e[r[0]]==null)e[r[0]]=r[1];else switch(r[2]){case"bool":typeof e[r[0]]=="string"&&(e[r[0]]=sn(e[r[0]]));break;case"int":typeof e[r[0]]=="string"&&(e[r[0]]=parseInt(e[r[0]],10));break}}}function h_(e){My(e.WBProps,d_),My(e.CalcPr,B7),Ny(e.WBView,P7),Ny(e.Sheets,U7),xl.date1904=sn(e.WBProps.date1904)}var V7="][*?/\\".split("");function H7(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var n=!0;return V7.forEach(function(r){if(e.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),n}var G7=/<\w+:workbook/;function j7(e,t){if(!e)throw new Error("Could not find file");var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},r=!1,a="xmlns",l={},c=0;if(e.replace(rr,function(p,m){var x=tt(p);switch(wa(x[0])){case"<?xml":break;case"<workbook":p.match(G7)&&(a="xmlns"+p.match(/<(\w+):/)[1]),n.xmlns=x[a];break;case"</workbook>":break;case"<fileVersion":delete x[0],n.AppVersion=x;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":d_.forEach(function(y){if(x[y[0]]!=null)switch(y[2]){case"bool":n.WBProps[y[0]]=sn(x[y[0]]);break;case"int":n.WBProps[y[0]]=parseInt(x[y[0]],10);break;default:n.WBProps[y[0]]=x[y[0]]}}),x.codeName&&(n.WBProps.CodeName=Zt(x.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete x[0],n.WBView.push(x);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(x.state){case"hidden":x.Hidden=1;break;case"veryHidden":x.Hidden=2;break;default:x.Hidden=0}delete x.state,x.name=Rt(Zt(x.name)),delete x[0],n.Sheets.push(x);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":r=!0;break;case"</definedNames>":r=!1;break;case"<definedName":l={},l.Name=Zt(x.name),x.comment&&(l.Comment=x.comment),x.localSheetId&&(l.Sheet=+x.localSheetId),sn(x.hidden||"0")&&(l.Hidden=!0),c=m+p.length;break;case"</definedName>":l.Ref=Rt(Zt(e.slice(c,m))),n.Names.push(l);break;case"<definedName/>":break;case"<calcPr":delete x[0],n.CalcPr=x;break;case"<calcPr/>":delete x[0],n.CalcPr=x;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":r=!0;break;case"</AlternateContent>":r=!1;break;case"<revisionPtr":break;default:if(!r&&t.WTF)throw new Error("unrecognized "+x[0]+" in workbook")}return p}),l6.indexOf(n.xmlns)===-1)throw new Error("Unknown Namespace: "+n.xmlns);return h_(n),n}function z7(e,t){var n={};return n.Hidden=e.read_shift(4),n.iTabID=e.read_shift(4),n.strRelID=dh(e),n.name=tr(e),n}function q7(e,t){var n={},r=e.read_shift(4);n.defaultThemeVersion=e.read_shift(4);var a=t>8?tr(e):"";return a.length>0&&(n.CodeName=a),n.autoCompressPictures=!!(r&65536),n.backupFile=!!(r&64),n.checkCompatibility=!!(r&4096),n.date1904=!!(r&1),n.filterPrivacy=!!(r&8),n.hidePivotFieldList=!!(r&1024),n.promptedSolutions=!!(r&16),n.publishItems=!!(r&2048),n.refreshAllConnections=!!(r&262144),n.saveExternalLinkValues=!!(r&128),n.showBorderUnselectedTables=!!(r&4),n.showInkAnnotation=!!(r&32),n.showObjects=["all","placeholders","none"][r>>13&3],n.showPivotChartFilter=!!(r&32768),n.updateLinks=["userSet","never","always"][r>>8&3],n}function $7(e,t){var n={};return e.read_shift(4),n.ArchID=e.read_shift(4),e.l+=t-8,n}function Y7(e,t,n){var r=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),l=C6(e),c=MO(e,0,n),u=Wh(e);e.l=r;var p={Name:l,Ptg:c};return a<268435455&&(p.Sheet=a),u&&(p.Comment=u),p}function W7(e,t){var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},r=[],a=!1;t||(t={}),t.biff=12;var l=[],c=[[]];return c.SheetNames=[],c.XTI=[],lf[16]={n:"BrtFRTArchID$",f:$7},ei(e,function(p,m,x){switch(x){case 156:c.SheetNames.push(p.name),n.Sheets.push(p);break;case 153:n.WBProps=p;break;case 39:p.Sheet!=null&&(t.SID=p.Sheet),p.Ref=Kn(p.Ptg,null,null,c,t),delete t.SID,delete p.Ptg,l.push(p);break;case 1036:break;case 357:case 358:case 355:case 667:c[0].length?c.push([x,p]):c[0]=[x,p],c[c.length-1].XTI=[];break;case 362:c.length===0&&(c[0]=[],c[0].XTI=[]),c[c.length-1].XTI=c[c.length-1].XTI.concat(p),c.XTI=c.XTI.concat(p);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:r.push(x),a=!0;break;case 36:r.pop(),a=!1;break;case 37:r.push(x),a=!0;break;case 38:r.pop(),a=!1;break;case 16:break;default:if(!m.T){if(!a||t.WTF&&r[r.length-1]!=37&&r[r.length-1]!=35)throw new Error("Unexpected record 0x"+x.toString(16))}}},t),h_(n),n.Names=l,n.supbooks=c,n}function J7(e,t,n){return t.slice(-4)===".bin"?W7(e,n):j7(e,n)}function X7(e,t,n,r,a,l,c,u){return t.slice(-4)===".bin"?R7(e,r,n,a,l,c,u):zO(e,r,n,a,l,c,u)}function K7(e,t,n,r,a,l,c,u){return t.slice(-4)===".bin"?O7(e,r,n,a,l):F7(e,r,n,a,l)}function Z7(e,t,n,r,a,l,c,u){return t.slice(-4)===".bin"?sL():lL()}function Q7(e,t,n,r,a,l,c,u){return t.slice(-4)===".bin"?aL():iL()}function eP(e,t,n,r){return t.slice(-4)===".bin"?_F(e,n,r):pF(e,n,r)}function tP(e,t,n){return QT(e,n)}function nP(e,t,n){return t.slice(-4)===".bin"?P8(e,n):L8(e,n)}function rP(e,t,n){return t.slice(-4)===".bin"?tL(e,n):XF(e,n)}function aP(e,t,n){return t.slice(-4)===".bin"?YF(e):qF(e)}function iP(e,t,n,r){return n.slice(-4)===".bin"?WF(e,t,n,r):void 0}function sP(e,t,n){return t.slice(-4)===".bin"?jF(e,t,n):zF(e,t,n)}var m_=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,p_=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ea(e,t){var n=e.split(/\s+/),r=[];if(r[0]=n[0],n.length===1)return r;var a=e.match(m_),l,c,u,p;if(a)for(p=0;p!=a.length;++p)l=a[p].match(p_),(c=l[1].indexOf(":"))===-1?r[l[1]]=l[2].slice(1,l[2].length-1):(l[1].slice(0,6)==="xmlns:"?u="xmlns"+l[1].slice(6):u=l[1].slice(c+1),r[u]=l[2].slice(1,l[2].length-1));return r}function lP(e){var t=e.split(/\s+/),n={};if(t.length===1)return n;var r=e.match(m_),a,l,c,u;if(r)for(u=0;u!=r.length;++u)a=r[u].match(p_),(l=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?c="xmlns"+a[1].slice(6):c=a[1].slice(l+1),n[c]=a[2].slice(1,a[2].length-1));return n}var qo;function oP(e,t){var n=qo[e]||Rt(e);return n==="General"?hs(t):$r(n,t)}function cP(e,t,n,r){var a=r;switch((n[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=sn(r);break;case"i2":case"int":a=parseInt(r,10);break;case"r4":case"float":a=parseFloat(r);break;case"date":case"dateTime.tz":a=Un(r);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+n[0])}e[Rt(t)]=a}function uP(e,t,n){if(e.t!=="z"){if(!n||n.cellText!==!1)try{e.t==="e"?e.w=e.w||Es[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Zo(e.v):e.w=hs(e.v):e.w=oP(t||"General",e.v)}catch(l){if(n.WTF)throw l}try{var r=qo[t]||t||"General";if(n.cellNF&&(e.z=r),n.cellDates&&e.t=="n"&&kl(r)){var a=is(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(l){if(n.WTF)throw l}}}function fP(e,t,n){if(n.cellStyles&&t.Interior){var r=t.Interior;r.Pattern&&(r.patternType=cF[r.Pattern]||r.Pattern)}e[t.ID]=t}function dP(e,t,n,r,a,l,c,u,p,m){var x="General",y=r.StyleID,_={};m=m||{};var E=[],w=0;for(y===void 0&&u&&(y=u.StyleID),y===void 0&&c&&(y=c.StyleID);l[y]!==void 0&&(l[y].nf&&(x=l[y].nf),l[y].Interior&&E.push(l[y].Interior),!!l[y].Parent);)y=l[y].Parent;switch(n.Type){case"Boolean":r.t="b",r.v=sn(e);break;case"String":r.t="s",r.r=Zv(Rt(e)),r.v=e.indexOf("<")>-1?Rt(t||e).replace(/<.*?>/g,""):r.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),r.v=(Un(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),r.v!==r.v?r.v=Rt(e):r.v<60&&(r.v=r.v-1),(!x||x=="General")&&(x="yyyy-mm-dd");case"Number":r.v===void 0&&(r.v=+e),r.t||(r.t="n");break;case"Error":r.t="e",r.v=RT[e],m.cellText!==!1&&(r.w=e);break;default:e==""&&t==""?r.t="z":(r.t="s",r.v=Zv(t||e));break}if(uP(r,x,m),m.cellFormula!==!1)if(r.Formula){var S=Rt(r.Formula);S.charCodeAt(0)==61&&(S=S.slice(1)),r.f=pl(S,a),delete r.Formula,r.ArrayRange=="RC"?r.F=pl("RC:RC",a):r.ArrayRange&&(r.F=pl(r.ArrayRange,a),p.push([pn(r.F),r.F]))}else for(w=0;w<p.length;++w)a.r>=p[w][0].s.r&&a.r<=p[w][0].e.r&&a.c>=p[w][0].s.c&&a.c<=p[w][0].e.c&&(r.F=p[w][1]);m.cellStyles&&(E.forEach(function(C){!_.patternType&&C.patternType&&(_.patternType=C.patternType)}),r.s=_),r.StyleID!==void 0&&(r.ixfe=r.StyleID)}function hP(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Hd(e,t){var n=t||{};rT();var r=Ro(jh(e));(n.type=="binary"||n.type=="array"||n.type=="base64")&&(r=Zt(r));var a=r.slice(0,1024).toLowerCase(),l=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var c=qn(n);return c.type="string",tc.to_workbook(r,c)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ge){a.indexOf("<"+Ge)>=0&&(l=!0)}),l)return EP(r,n);qo={"General Number":"General","General Date":lt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":lt[15],"Short Date":lt[14],"Long Time":lt[19],"Medium Time":lt[18],"Short Time":lt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:lt[2],Standard:lt[4],Percent:lt[10],Scientific:lt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,p=[],m,x={},y=[],_=n.dense?[]:{},E="",w={},S={},C=ea('<Data ss:Type="String">'),M=0,k=0,b=0,U={s:{r:2e6,c:2e6},e:{r:0,c:0}},G={},J={},F="",W=0,O=[],ee={},ne={},te=0,_e=[],Ie=[],Ee={},ae=[],de,re=!1,Y=[],N=[],Z={},D=0,H=0,q={Sheets:[],WBProps:{date1904:!1}},j={};ec.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"");for(var se="";u=ec.exec(r);)switch(u[3]=(se=u[3]).toLowerCase()){case"data":if(se=="data"){if(u[1]==="/"){if((m=p.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&p.push([u[3],!0]);break}if(p[p.length-1][1])break;u[1]==="/"?dP(r.slice(M,u.index),F,C,p[p.length-1][0]=="comment"?Ee:w,{c:k,r:b},G,ae[k],S,Y,n):(F="",C=ea(u[0]),M=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(Ie.length>0&&(w.c=Ie),(!n.sheetRows||n.sheetRows>b)&&w.v!==void 0&&(n.dense?(_[b]||(_[b]=[]),_[b][k]=w):_[Mn(k)+$n(b)]=w),w.HRef&&(w.l={Target:Rt(w.HRef)},w.HRefScreenTip&&(w.l.Tooltip=w.HRefScreenTip),delete w.HRef,delete w.HRefScreenTip),(w.MergeAcross||w.MergeDown)&&(D=k+(parseInt(w.MergeAcross,10)|0),H=b+(parseInt(w.MergeDown,10)|0),O.push({s:{c:k,r:b},e:{c:D,r:H}})),!n.sheetStubs)w.MergeAcross?k=D+1:++k;else if(w.MergeAcross||w.MergeDown){for(var Te=k;Te<=D;++Te)for(var Ae=b;Ae<=H;++Ae)(Te>k||Ae>b)&&(n.dense?(_[Ae]||(_[Ae]=[]),_[Ae][Te]={t:"z"}):_[Mn(Te)+$n(Ae)]={t:"z"});k=D+1}else++k;else w=lP(u[0]),w.Index&&(k=+w.Index-1),k<U.s.c&&(U.s.c=k),k>U.e.c&&(U.e.c=k),u[0].slice(-2)==="/>"&&++k,Ie=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(b<U.s.r&&(U.s.r=b),b>U.e.r&&(U.e.r=b),u[0].slice(-2)==="/>"&&(S=ea(u[0]),S.Index&&(b=+S.Index-1)),k=0,++b):(S=ea(u[0]),S.Index&&(b=+S.Index-1),Z={},(S.AutoFitHeight=="0"||S.Height)&&(Z.hpx=parseInt(S.Height,10),Z.hpt=ZT(Z.hpx),N[b]=Z),S.Hidden=="1"&&(Z.hidden=!0,N[b]=Z));break;case"worksheet":if(u[1]==="/"){if((m=p.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"));y.push(E),U.s.r<=U.e.r&&U.s.c<=U.e.c&&(_["!ref"]=Nt(U),n.sheetRows&&n.sheetRows<=U.e.r&&(_["!fullref"]=_["!ref"],U.e.r=n.sheetRows-1,_["!ref"]=Nt(U))),O.length&&(_["!merges"]=O),ae.length>0&&(_["!cols"]=ae),N.length>0&&(_["!rows"]=N),x[E]=_}else U={s:{r:2e6,c:2e6},e:{r:0,c:0}},b=k=0,p.push([u[3],!1]),m=ea(u[0]),E=Rt(m.Name),_=n.dense?[]:{},O=[],Y=[],N=[],j={name:E,Hidden:0},q.Sheets.push(j);break;case"table":if(u[1]==="/"){if((m=p.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"))}else{if(u[0].slice(-2)=="/>")break;p.push([u[3],!1]),ae=[],re=!1}break;case"style":u[1]==="/"?fP(G,J,n):J=ea(u[0]);break;case"numberformat":J.nf=Rt(ea(u[0]).Format||"General"),qo[J.nf]&&(J.nf=qo[J.nf]);for(var Re=0;Re!=392&&lt[Re]!=J.nf;++Re);if(Re==392){for(Re=57;Re!=392;++Re)if(lt[Re]==null){ss(J.nf,Re);break}}break;case"column":if(p[p.length-1][0]!=="table")break;if(de=ea(u[0]),de.Hidden&&(de.hidden=!0,delete de.Hidden),de.Width&&(de.wpx=parseInt(de.Width,10)),!re&&de.wpx>10){re=!0,lr=XT;for(var Ce=0;Ce<ae.length;++Ce)ae[Ce]&&Sl(ae[Ce])}re&&Sl(de),ae[de.Index-1||ae.length]=de;for(var Xe=0;Xe<+de.Span;++Xe)ae[ae.length]=qn(de);break;case"namedrange":if(u[1]==="/")break;q.Names||(q.Names=[]);var X=tt(u[0]),ut={Name:X.Name,Ref:pl(X.RefersTo.slice(1),{r:0,c:0})};q.Sheets.length>0&&(ut.Sheet=q.Sheets.length-1),q.Names.push(ut);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?F+=r.slice(W,u.index):W=u.index+u[0].length;break;case"interior":if(!n.cellStyles)break;J.Interior=ea(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?X6(ee,se,r.slice(te,u.index)):te=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((m=p.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"))}else p.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((m=p.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"));hP(Ee),Ie.push(Ee)}else p.push([u[3],!1]),m=ea(u[0]),Ee={a:m.Author};break;case"autofilter":if(u[1]==="/"){if((m=p.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var Ke=ea(u[0]);_["!autofilter"]={ref:pl(Ke.Range).replace(/\$/g,"")},p.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((m=p.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&p.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((m=p.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&p.push([u[3],!0]);break;case"null":break;default:if(p.length==0&&u[3]=="document"||p.length==0&&u[3]=="uof")return Oy(r,n);var pt=!0;switch(p[p.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:pt=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:pt=!1}break;case"excelworkbook":switch(u[3]){case"date1904":q.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:pt=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:pt=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(r.slice(te,u.index)){case"SheetHidden":j.Hidden=1;break;case"SheetVeryHidden":j.Hidden=2;break}else te=u.index+u[0].length;break;case"header":_["!margins"]||zo(_["!margins"]={},"xlml"),isNaN(+tt(u[0]).Margin)||(_["!margins"].header=+tt(u[0]).Margin);break;case"footer":_["!margins"]||zo(_["!margins"]={},"xlml"),isNaN(+tt(u[0]).Margin)||(_["!margins"].footer=+tt(u[0]).Margin);break;case"pagemargins":var Me=tt(u[0]);_["!margins"]||zo(_["!margins"]={},"xlml"),isNaN(+Me.Top)||(_["!margins"].top=+Me.Top),isNaN(+Me.Left)||(_["!margins"].left=+Me.Left),isNaN(+Me.Right)||(_["!margins"].right=+Me.Right),isNaN(+Me.Bottom)||(_["!margins"].bottom=+Me.Bottom);break;case"displayrighttoleft":q.Views||(q.Views=[]),q.Views[0]||(q.Views[0]={}),q.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:pt=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:pt=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:pt=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:pt=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:pt=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:pt=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:pt=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:pt=!1}break;case"smarttags":break;default:pt=!1;break}if(pt||u[3].match(/!\[CDATA/))break;if(!p[p.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+p.join("|");if(p[p.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?cP(ne,se,_e,r.slice(te,u.index)):(_e=u,te=u.index+u[0].length);break}if(n.WTF)throw"Unrecognized tag: "+u[3]+"|"+p.join("|")}var ve={};return!n.bookSheets&&!n.bookProps&&(ve.Sheets=x),ve.SheetNames=y,ve.Workbook=q,ve.SSF=qn(lt),ve.Props=ee,ve.Custprops=ne,ve}function xh(e,t){switch(am(t=t||{}),t.type||"base64"){case"base64":return Hd(Mr(e),t);case"binary":case"buffer":case"file":return Hd(e,t);case"array":return Hd(ys(e),t)}}function mP(e){var t={},n=e.content;if(n.l=28,t.AnsiUserType=n.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=k6(n),n.length-n.l<=4)return t;var r=n.read_shift(4);if(r==0||r>40||(n.l-=4,t.Reserved1=n.read_shift(0,"lpstr-ansi"),n.length-n.l<=4)||(r=n.read_shift(4),r!==1907505652)||(t.UnicodeClipboardFormat=N6(n),r=n.read_shift(4),r==0||r>40))return t;n.l-=4,t.Reserved2=n.read_shift(0,"lpwstr")}var pP=[60,1084,2066,2165,2175];function xP(e,t,n,r,a){var l=r,c=[],u=n.slice(n.l,n.l+l);if(a&&a.enc&&a.enc.insitu&&u.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(u)}c.push(u),n.l+=l;for(var p=qa(n,n.l),m=gh[p],x=0;m!=null&&pP.indexOf(p)>-1;)l=qa(n,n.l+2),x=n.l+4,p==2066?x+=4:(p==2165||p==2175)&&(x+=12),u=n.slice(x,n.l+4+l),c.push(u),n.l+=4+l,m=gh[p=qa(n,n.l)];var y=bi(c);zn(y,0);var _=0;y.lens=[];for(var E=0;E<c.length;++E)y.lens.push(_),_+=c[E].length;if(y.length<r)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+y.length+" < "+r;return t.f(y,y.length,a)}function pa(e,t,n){if(e.t!=="z"&&e.XF){var r=0;try{r=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=lt[r])}catch(l){if(t.WTF)throw l}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Es[e.v]:r===0||r=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Zo(e.v):e.w=hs(e.v):e.w=$r(r,e.v,{date1904:!!n,dateNF:t&&t.dateNF})}catch(l){if(t.WTF)throw l}if(t.cellDates&&r&&e.t=="n"&&kl(lt[r]||String(r))){var a=is(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function Lu(e,t,n){return{v:e,ixfe:t,t:n}}function gP(e,t){var n={opts:{}},r={},a=t.dense?[]:{},l={},c={},u=null,p=[],m="",x={},y,_="",E,w,S,C,M={},k=[],b,U,G=[],J=[],F={Sheets:[],WBProps:{date1904:!1},Views:[{}]},W={},O=function(Ve){return Ve<8?ls[Ve]:Ve<64&&J[Ve-8]||ls[Ve]},ee=function(Ve,ht,Yt){var _t=ht.XF.data;if(!(!_t||!_t.patternType||!Yt||!Yt.cellStyles)){ht.s={},ht.s.patternType=_t.patternType;var Dn;(Dn=nc(O(_t.icvFore)))&&(ht.s.fgColor={rgb:Dn}),(Dn=nc(O(_t.icvBack)))&&(ht.s.bgColor={rgb:Dn})}},ne=function(Ve,ht,Yt){if(!(Z>1)&&!(Yt.sheetRows&&Ve.r>=Yt.sheetRows)){if(Yt.cellStyles&&ht.XF&&ht.XF.data&&ee(Ve,ht,Yt),delete ht.ixfe,delete ht.XF,y=Ve,_=it(Ve),(!c||!c.s||!c.e)&&(c={s:{r:0,c:0},e:{r:0,c:0}}),Ve.r<c.s.r&&(c.s.r=Ve.r),Ve.c<c.s.c&&(c.s.c=Ve.c),Ve.r+1>c.e.r&&(c.e.r=Ve.r+1),Ve.c+1>c.e.c&&(c.e.c=Ve.c+1),Yt.cellFormula&&ht.f){for(var _t=0;_t<k.length;++_t)if(!(k[_t][0].s.c>Ve.c||k[_t][0].s.r>Ve.r)&&!(k[_t][0].e.c<Ve.c||k[_t][0].e.r<Ve.r)){ht.F=Nt(k[_t][0]),(k[_t][0].s.c!=Ve.c||k[_t][0].s.r!=Ve.r)&&delete ht.f,ht.f&&(ht.f=""+Kn(k[_t][1],c,Ve,Y,te));break}}Yt.dense?(a[Ve.r]||(a[Ve.r]=[]),a[Ve.r][Ve.c]=ht):a[_]=ht}},te={enc:!1,sbcch:0,snames:[],sharedf:M,arrayf:k,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(te.password=t.password);var _e,Ie=[],Ee=[],ae=[],de=[],re=!1,Y=[];Y.SheetNames=te.snames,Y.sharedf=te.sharedf,Y.arrayf=te.arrayf,Y.names=[],Y.XTI=[];var N=0,Z=0,D=0,H=[],q=[],j;te.codepage=1200,ra(1200);for(var se=!1;e.l<e.length-1;){var Te=e.l,Ae=e.read_shift(2);if(Ae===0&&N===10)break;var Re=e.l===e.length?0:e.read_shift(2),Ce=gh[Ae];if(Ce&&Ce.f){if(t.bookSheets&&N===133&&Ae!==133)break;if(N=Ae,Ce.r===2||Ce.r==12){var Xe=e.read_shift(2);if(Re-=2,!te.enc&&Xe!==Ae&&((Xe&255)<<8|Xe>>8)!==Ae)throw new Error("rt mismatch: "+Xe+"!="+Ae);Ce.r==12&&(e.l+=10,Re-=10)}var X={};if(Ae===10?X=Ce.f(e,Re,te):X=xP(Ae,Ce,e,Re,te),Z==0&&[9,521,1033,2057].indexOf(N)===-1)continue;switch(Ae){case 34:n.opts.Date1904=F.WBProps.date1904=X;break;case 134:n.opts.WriteProtect=!0;break;case 47:if(te.enc||(e.l=0),te.enc=X,!t.password)throw new Error("File is password-protected");if(X.valid==null)throw new Error("Encryption scheme unsupported");if(!X.valid)throw new Error("Password is incorrect");break;case 92:te.lastuser=X;break;case 66:var ut=Number(X);switch(ut){case 21010:ut=1200;break;case 32768:ut=1e4;break;case 32769:ut=1252;break}ra(te.codepage=ut),se=!0;break;case 317:te.rrtabid=X;break;case 25:te.winlocked=X;break;case 439:n.opts.RefreshAll=X;break;case 12:n.opts.CalcCount=X;break;case 16:n.opts.CalcDelta=X;break;case 17:n.opts.CalcIter=X;break;case 13:n.opts.CalcMode=X;break;case 14:n.opts.CalcPrecision=X;break;case 95:n.opts.CalcSaveRecalc=X;break;case 15:te.CalcRefMode=X;break;case 2211:n.opts.FullCalc=X;break;case 129:X.fDialog&&(a["!type"]="dialog"),X.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),X.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:G.push(X);break;case 430:Y.push([X]),Y[Y.length-1].XTI=[];break;case 35:case 547:Y[Y.length-1].push(X);break;case 24:case 536:j={Name:X.Name,Ref:Kn(X.rgce,c,null,Y,te)},X.itab>0&&(j.Sheet=X.itab-1),Y.names.push(j),Y[0]||(Y[0]=[],Y[0].XTI=[]),Y[Y.length-1].push(X),X.Name=="_xlnm._FilterDatabase"&&X.itab>0&&X.rgce&&X.rgce[0]&&X.rgce[0][0]&&X.rgce[0][0][0]=="PtgArea3d"&&(q[X.itab-1]={ref:Nt(X.rgce[0][0][1][2])});break;case 22:te.ExternCount=X;break;case 23:Y.length==0&&(Y[0]=[],Y[0].XTI=[]),Y[Y.length-1].XTI=Y[Y.length-1].XTI.concat(X),Y.XTI=Y.XTI.concat(X);break;case 2196:if(te.biff<8)break;j!=null&&(j.Comment=X[1]);break;case 18:a["!protect"]=X;break;case 19:X!==0&&te.WTF&&console.error("Password verifier: "+X);break;case 133:l[X.pos]=X,te.snames.push(X.name);break;case 10:{if(--Z)break;if(c.e){if(c.e.r>0&&c.e.c>0){if(c.e.r--,c.e.c--,a["!ref"]=Nt(c),t.sheetRows&&t.sheetRows<=c.e.r){var Ke=c.e.r;c.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Nt(c),c.e.r=Ke}c.e.r++,c.e.c++}Ie.length>0&&(a["!merges"]=Ie),Ee.length>0&&(a["!objects"]=Ee),ae.length>0&&(a["!cols"]=ae),de.length>0&&(a["!rows"]=de),F.Sheets.push(W)}m===""?x=a:r[m]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(te.biff===8&&(te.biff={9:2,521:3,1033:4}[Ae]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[X.BIFFVer]||8),te.biffguess=X.BIFFVer==0,X.BIFFVer==0&&X.dt==4096&&(te.biff=5,se=!0,ra(te.codepage=28591)),te.biff==8&&X.BIFFVer==0&&X.dt==16&&(te.biff=2),Z++)break;if(a=t.dense?[]:{},te.biff<8&&!se&&(se=!0,ra(te.codepage=t.codepage||1252)),te.biff<5||X.BIFFVer==0&&X.dt==4096){m===""&&(m="Sheet1"),c={s:{r:0,c:0},e:{r:0,c:0}};var pt={pos:e.l-Re,name:m};l[pt.pos]=pt,te.snames.push(m)}else m=(l[Te]||{name:""}).name;X.dt==32&&(a["!type"]="chart"),X.dt==64&&(a["!type"]="macro"),Ie=[],Ee=[],te.arrayf=k=[],ae=[],de=[],re=!1,W={Hidden:(l[Te]||{hs:0}).hs,name:m}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[X.r]||[])[X.c]:a[it({c:X.c,r:X.r})])&&++X.c,b={ixfe:X.ixfe,XF:G[X.ixfe]||{},v:X.val,t:"n"},D>0&&(b.z=H[b.ixfe>>8&63]),pa(b,t,n.opts.Date1904),ne({c:X.c,r:X.r},b,t);break;case 5:case 517:b={ixfe:X.ixfe,XF:G[X.ixfe],v:X.val,t:X.t},D>0&&(b.z=H[b.ixfe>>8&63]),pa(b,t,n.opts.Date1904),ne({c:X.c,r:X.r},b,t);break;case 638:b={ixfe:X.ixfe,XF:G[X.ixfe],v:X.rknum,t:"n"},D>0&&(b.z=H[b.ixfe>>8&63]),pa(b,t,n.opts.Date1904),ne({c:X.c,r:X.r},b,t);break;case 189:for(var Me=X.c;Me<=X.C;++Me){var ve=X.rkrec[Me-X.c][0];b={ixfe:ve,XF:G[ve],v:X.rkrec[Me-X.c][1],t:"n"},D>0&&(b.z=H[b.ixfe>>8&63]),pa(b,t,n.opts.Date1904),ne({c:Me,r:X.r},b,t)}break;case 6:case 518:case 1030:{if(X.val=="String"){u=X;break}if(b=Lu(X.val,X.cell.ixfe,X.tt),b.XF=G[b.ixfe],t.cellFormula){var Ge=X.formula;if(Ge&&Ge[0]&&Ge[0][0]&&Ge[0][0][0]=="PtgExp"){var je=Ge[0][0][1][0],Pt=Ge[0][0][1][1],Ct=it({r:je,c:Pt});M[Ct]?b.f=""+Kn(X.formula,c,X.cell,Y,te):b.F=((t.dense?(a[je]||[])[Pt]:a[Ct])||{}).F}else b.f=""+Kn(X.formula,c,X.cell,Y,te)}D>0&&(b.z=H[b.ixfe>>8&63]),pa(b,t,n.opts.Date1904),ne(X.cell,b,t),u=X}break;case 7:case 519:if(u)u.val=X,b=Lu(X,u.cell.ixfe,"s"),b.XF=G[b.ixfe],t.cellFormula&&(b.f=""+Kn(u.formula,c,u.cell,Y,te)),D>0&&(b.z=H[b.ixfe>>8&63]),pa(b,t,n.opts.Date1904),ne(u.cell,b,t),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{k.push(X);var en=it(X[0].s);if(E=t.dense?(a[X[0].s.r]||[])[X[0].s.c]:a[en],t.cellFormula&&E){if(!u||!en||!E)break;E.f=""+Kn(X[1],c,X[0],Y,te),E.F=Nt(X[0])}}break;case 1212:{if(!t.cellFormula)break;if(_){if(!u)break;M[it(u.cell)]=X[0],E=t.dense?(a[u.cell.r]||[])[u.cell.c]:a[it(u.cell)],(E||{}).f=""+Kn(X[0],c,y,Y,te)}}break;case 253:b=Lu(p[X.isst].t,X.ixfe,"s"),p[X.isst].h&&(b.h=p[X.isst].h),b.XF=G[b.ixfe],D>0&&(b.z=H[b.ixfe>>8&63]),pa(b,t,n.opts.Date1904),ne({c:X.c,r:X.r},b,t);break;case 513:t.sheetStubs&&(b={ixfe:X.ixfe,XF:G[X.ixfe],t:"z"},D>0&&(b.z=H[b.ixfe>>8&63]),pa(b,t,n.opts.Date1904),ne({c:X.c,r:X.r},b,t));break;case 190:if(t.sheetStubs)for(var dt=X.c;dt<=X.C;++dt){var on=X.ixfe[dt-X.c];b={ixfe:on,XF:G[on],t:"z"},D>0&&(b.z=H[b.ixfe>>8&63]),pa(b,t,n.opts.Date1904),ne({c:dt,r:X.r},b,t)}break;case 214:case 516:case 4:b=Lu(X.val,X.ixfe,"s"),b.XF=G[b.ixfe],D>0&&(b.z=H[b.ixfe>>8&63]),pa(b,t,n.opts.Date1904),ne({c:X.c,r:X.r},b,t);break;case 0:case 512:Z===1&&(c=X);break;case 252:p=X;break;case 1054:if(te.biff==4){H[D++]=X[1];for(var Bn=0;Bn<D+163&&lt[Bn]!=X[1];++Bn);Bn>=163&&ss(X[1],D+163)}else ss(X[1],X[0]);break;case 30:{H[D++]=X;for(var Jt=0;Jt<D+163&&lt[Jt]!=X;++Jt);Jt>=163&&ss(X,D+163)}break;case 229:Ie=Ie.concat(X);break;case 93:Ee[X.cmo[0]]=te.lastobj=X;break;case 438:te.lastobj.TxO=X;break;case 127:te.lastobj.ImData=X;break;case 440:for(C=X[0].s.r;C<=X[0].e.r;++C)for(S=X[0].s.c;S<=X[0].e.c;++S)E=t.dense?(a[C]||[])[S]:a[it({c:S,r:C})],E&&(E.l=X[1]);break;case 2048:for(C=X[0].s.r;C<=X[0].e.r;++C)for(S=X[0].s.c;S<=X[0].e.c;++S)E=t.dense?(a[C]||[])[S]:a[it({c:S,r:C})],E&&E.l&&(E.l.Tooltip=X[1]);break;case 28:{if(te.biff<=5&&te.biff>=2)break;E=t.dense?(a[X[0].r]||[])[X[0].c]:a[it(X[0])];var Xt=Ee[X[2]];E||(t.dense?(a[X[0].r]||(a[X[0].r]=[]),E=a[X[0].r][X[0].c]={t:"z"}):E=a[it(X[0])]={t:"z"},c.e.r=Math.max(c.e.r,X[0].r),c.s.r=Math.min(c.s.r,X[0].r),c.e.c=Math.max(c.e.c,X[0].c),c.s.c=Math.min(c.s.c,X[0].c)),E.c||(E.c=[]),w={a:X[1],t:Xt.TxO.t},E.c.push(w)}break;case 2173:BF(G[X.ixfe],X.ext);break;case 125:{if(!te.cellStyles)break;for(;X.e>=X.s;)ae[X.e--]={width:X.w/256,level:X.level||0,hidden:!!(X.flags&1)},re||(re=!0,Qh(X.w/256)),Sl(ae[X.e+1])}break;case 520:{var Ut={};X.level!=null&&(de[X.r]=Ut,Ut.level=X.level),X.hidden&&(de[X.r]=Ut,Ut.hidden=!0),X.hpt&&(de[X.r]=Ut,Ut.hpt=X.hpt,Ut.hpx=rc(X.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||zo(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Ae]]=X;break;case 161:a["!margins"]||zo(a["!margins"]={}),a["!margins"].header=X.header,a["!margins"].footer=X.footer;break;case 574:X.RTL&&(F.Views[0].RTL=!0);break;case 146:J=X;break;case 2198:_e=X;break;case 140:U=X;break;case 442:m?W.CodeName=X||W.name:F.WBProps.CodeName=X||"ThisWorkbook";break}}else Ce||console.error("Missing Info for XLS Record 0x"+Ae.toString(16)),e.l+=Re}return n.SheetNames=Ea(l).sort(function(at,Ve){return Number(at)-Number(Ve)}).map(function(at){return l[at].name}),t.bookSheets||(n.Sheets=r),!n.SheetNames.length&&x["!ref"]?(n.SheetNames.push("Sheet1"),n.Sheets&&(n.Sheets.Sheet1=x)):n.Preamble=x,n.Sheets&&q.forEach(function(at,Ve){n.Sheets[n.SheetNames[Ve]]["!autofilter"]=at}),n.Strings=p,n.SSF=qn(lt),te.enc&&(n.Encryption=te.enc),_e&&(n.Themes=_e),n.Metadata={},U!==void 0&&(n.Metadata.Country=U),Y.names.length>0&&(F.Names=Y.names),n.Workbook=F,n}var Ry={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function vP(e,t,n){var r=bt.find(e,"/!DocumentSummaryInformation");if(r&&r.size>0)try{var a=my(r,L6,Ry.DSI);for(var l in a)t[l]=a[l]}catch(m){if(n.WTF)throw m}var c=bt.find(e,"/!SummaryInformation");if(c&&c.size>0)try{var u=my(c,O6,Ry.SI);for(var p in u)t[p]==null&&(t[p]=u[p])}catch(m){if(n.WTF)throw m}t.HeadingPairs&&t.TitlesOfParts&&(IT(t.HeadingPairs,t.TitlesOfParts,t,n),delete t.HeadingPairs,delete t.TitlesOfParts)}function x_(e,t){t||(t={}),am(t),q2(),t.codepage&&Oh(t.codepage);var n,r;if(e.FullPaths){if(bt.find(e,"/encryption"))throw new Error("File is password-protected");n=bt.find(e,"!CompObj"),r=bt.find(e,"/Workbook")||bt.find(e,"/Book")}else{switch(t.type){case"base64":e=na(Mr(e));break;case"binary":e=na(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}zn(e,0),r={content:e}}var a,l;if(n&&mP(n),t.bookProps&&!t.bookSheets)a={};else{var c=St?"buffer":"array";if(r&&r.content)a=gP(r.content,t);else if((l=bt.find(e,"PerfectOffice_MAIN"))&&l.content)a=Go.to_workbook(l.content,(t.type=c,t));else if((l=bt.find(e,"NativeContent_MAIN"))&&l.content)a=Go.to_workbook(l.content,(t.type=c,t));else throw(l=bt.find(e,"MN0"))&&l.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&bt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=rL(e))}var u={};return e.FullPaths&&vP(e,u,t),a.Props=a.Custprops=u,t.bookFiles&&(a.cfb=e),a}var lf={0:{f:QO},1:{f:r7},2:{f:d7},3:{f:l7},4:{f:i7},5:{f:f7},6:{f:p7},7:{f:c7},8:{f:T7},9:{f:y7},10:{f:g7},11:{f:v7},12:{f:a7},13:{f:h7},14:{f:o7},15:{f:s7},16:{f:f_},17:{f:x7},18:{f:u7},19:{f:Yh},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Y7},40:{},42:{},43:{f:gF},44:{f:xF},45:{f:vF},46:{f:TF},47:{f:yF},48:{},49:{f:_6},50:{},51:{f:HF},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:qT},62:{f:m7},63:{f:$F},64:{f:N7},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:nr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:k7},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:n7},148:{f:e7,p:16},151:{f:S7},152:{},153:{f:q7},154:{},155:{},156:{f:z7},157:{},158:{},159:{T:1,f:O8},160:{T:-1},161:{T:1,f:_s},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:_7},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:VF},336:{T:-1},337:{f:GF,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:dh},357:{},358:{},359:{},360:{T:1},361:{},362:{f:zT},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:w7},427:{f:C7},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:b7},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:t7},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:E7},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:dh},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:eL},633:{T:1},634:{T:-1},635:{T:1,f:QF},636:{T:-1},637:{f:S6},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:L7},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:M7},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},gh={6:{f:Bd},10:{f:Ci},12:{f:Sn},13:{f:Sn},14:{f:vn},15:{f:vn},16:{f:Zn},17:{f:vn},18:{f:vn},19:{f:Sn},20:{f:vy},21:{f:vy},23:{f:zT},24:{f:Ty},25:{f:vn},26:{},27:{},28:{f:KI},29:{},34:{f:vn},35:{f:yy},38:{f:Zn},39:{f:Zn},40:{f:Zn},41:{f:Zn},42:{f:vn},43:{f:vn},47:{f:tF},49:{f:DI},51:{f:Sn},60:{},61:{f:NI},64:{f:vn},65:{f:RI},66:{f:Sn},77:{},80:{},81:{},82:{},85:{f:Sn},89:{},90:{},91:{},92:{f:_I},93:{f:QI},94:{},95:{f:vn},96:{},97:{},99:{f:vn},125:{f:qT},128:{f:GI},129:{f:EI},130:{f:Sn},131:{f:vn},132:{f:vn},133:{f:SI},134:{},140:{f:i8},141:{f:Sn},144:{},146:{f:l8},151:{},152:{},153:{},154:{},155:{},156:{f:Sn},157:{},158:{},160:{f:d8},161:{f:c8},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:UI},190:{f:BI},193:{f:Ci},197:{},198:{},199:{},200:{},201:{},202:{f:vn},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Sn},220:{},221:{f:vn},222:{},224:{f:HI},225:{f:TI},226:{f:Ci},227:{},229:{f:ZI},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:wI},253:{f:II},255:{f:CI},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:UT},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:vn},353:{f:Ci},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:zI},431:{f:vn},432:{},433:{},434:{},437:{},438:{f:n8},439:{f:vn},440:{f:r8},441:{},442:{f:hc},443:{},444:{f:Sn},445:{},446:{},448:{f:Ci},449:{f:kI,r:2},450:{f:Ci},512:{f:xy},513:{f:f8},515:{f:jI},516:{f:FI},517:{f:gy},519:{f:h8},520:{f:AI},523:{},545:{f:_y},549:{f:py},566:{},574:{f:MI},638:{f:PI},659:{},1048:{},1054:{f:LI},1084:{},1212:{f:WI},2048:{f:a8},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Du},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ci},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:o8,r:12},2173:{f:UF,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:vn,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:YI,r:12},2197:{},2198:{f:DF,r:12},2199:{},2200:{},2201:{},2202:{f:JI,r:12},2203:{f:Ci},2204:{},2205:{},2206:{},2207:{},2211:{f:bI},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Sn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:u8},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:s8},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:xy},1:{},2:{f:g8},3:{f:x8},4:{f:p8},5:{f:gy},7:{f:v8},8:{},9:{f:Du},11:{},22:{f:Sn},30:{f:OI},31:{},32:{},33:{f:_y},36:{},37:{f:py},50:{f:y8},62:{},52:{},67:{},68:{f:Sn},69:{},86:{},126:{},127:{f:m8},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:T8},223:{},234:{},354:{},421:{},518:{f:Bd},521:{f:Du},536:{f:Ty},547:{f:yy},561:{},579:{},1030:{f:Bd},1033:{f:Du},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ta(e,t,n,r){var a=t;if(!isNaN(a)){var l=(n||[]).length||0,c=e.next(4);c.write_shift(2,a),c.write_shift(2,l),l>0&&CT(n)&&e.push(n)}}function Dy(e,t){var n=t||{},r=n.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var l=e.match(/<\/table/i),c=a.index,u=l&&l.index||e.length,p=jD(e.slice(c,u),/(:?<tr[^>]*>)/i,"<tr>"),m=-1,x=0,y=0,_=0,E={s:{r:1e7,c:1e7},e:{r:0,c:0}},w=[];for(c=0;c<p.length;++c){var S=p[c].trim(),C=S.slice(0,3).toLowerCase();if(C=="<tr"){if(++m,n.sheetRows&&n.sheetRows<=m){--m;break}x=0;continue}if(!(C!="<td"&&C!="<th")){var M=S.split(/<\/t[dh]>/i);for(u=0;u<M.length;++u){var k=M[u].trim();if(k.match(/<t[dh]/i)){for(var b=k,U=0;b.charAt(0)=="<"&&(U=b.indexOf(">"))>-1;)b=b.slice(U+1);for(var G=0;G<w.length;++G){var J=w[G];J.s.c==x&&J.s.r<m&&m<=J.e.r&&(x=J.e.c+1,G=-1)}var F=tt(k.slice(0,k.indexOf(">")));_=F.colspan?+F.colspan:1,((y=+F.rowspan)>1||_>1)&&w.push({s:{r:m,c:x},e:{r:m+(y||1)-1,c:x+_-1}});var W=F.t||F["data-t"]||"";if(!b.length){x+=_;continue}if(b=dT(b),E.s.r>m&&(E.s.r=m),E.e.r<m&&(E.e.r=m),E.s.c>x&&(E.s.c=x),E.e.c<x&&(E.e.c=x),!b.length){x+=_;continue}var O={t:"s",v:b};n.raw||!b.trim().length||W=="s"||(b==="TRUE"?O={t:"b",v:!0}:b==="FALSE"?O={t:"b",v:!1}:isNaN(sa(b))?isNaN(El(b).getDate())||(O={t:"d",v:Un(b)},n.cellDates||(O={t:"n",v:fr(O.v)}),O.z=n.dateNF||lt[14]):O={t:"n",v:sa(b)}),n.dense?(r[m]||(r[m]=[]),r[m][x]=O):r[it({r:m,c:x})]=O,x+=_}}}}return r["!ref"]=Nt(E),w.length&&(r["!merges"]=w),r}function yP(e,t,n,r){for(var a=e["!merges"]||[],l=[],c=t.s.c;c<=t.e.c;++c){for(var u=0,p=0,m=0;m<a.length;++m)if(!(a[m].s.r>n||a[m].s.c>c)&&!(a[m].e.r<n||a[m].e.c<c)){if(a[m].s.r<n||a[m].s.c<c){u=-1;break}u=a[m].e.r-a[m].s.r+1,p=a[m].e.c-a[m].s.c+1;break}if(!(u<0)){var x=it({r:n,c}),y=r.dense?(e[n]||[])[c]:e[x],_=y&&y.v!=null&&(y.h||Gh(y.w||(Ka(y),y.w)||""))||"",E={};u>1&&(E.rowspan=u),p>1&&(E.colspan=p),r.editable?_='<span contenteditable="true">'+_+"</span>":y&&(E["data-t"]=y&&y.t||"z",y.v!=null&&(E["data-v"]=y.v),y.z!=null&&(E["data-z"]=y.z),y.l&&(y.l.Target||"#").charAt(0)!="#"&&(_='<a href="'+y.l.Target+'">'+_+"</a>")),E.id=(r.id||"sjs")+"-"+x,l.push(i6("td",_,E))}}var w="<tr>";return w+l.join("")+"</tr>"}var TP='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',_P="</body></html>";function EP(e,t){var n=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!n||n.length==0)throw new Error("Invalid HTML: could not find <table>");if(n.length==1)return Ui(Dy(n[0],t),t);var r=sm();return n.forEach(function(a,l){lm(r,Dy(a,t),"Sheet"+(l+1))}),r}function SP(e,t,n){var r=[];return r.join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}function wP(e,t){var n=t||{},r=n.header!=null?n.header:TP,a=n.footer!=null?n.footer:_P,l=[r],c=Nl(e["!ref"]);n.dense=Array.isArray(e),l.push(SP(e,c,n));for(var u=c.s.r;u<=c.e.r;++u)l.push(yP(e,c,u,n));return l.push("</table>"+a),l.join("")}function g_(e,t,n){var r=n||{},a=0,l=0;if(r.origin!=null)if(typeof r.origin=="number")a=r.origin;else{var c=typeof r.origin=="string"?or(r.origin):r.origin;a=c.r,l=c.c}var u=t.getElementsByTagName("tr"),p=Math.min(r.sheetRows||1e7,u.length),m={s:{r:0,c:0},e:{r:a,c:l}};if(e["!ref"]){var x=Nl(e["!ref"]);m.s.r=Math.min(m.s.r,x.s.r),m.s.c=Math.min(m.s.c,x.s.c),m.e.r=Math.max(m.e.r,x.e.r),m.e.c=Math.max(m.e.c,x.e.c),a==-1&&(m.e.r=a=x.e.r+1)}var y=[],_=0,E=e["!rows"]||(e["!rows"]=[]),w=0,S=0,C=0,M=0,k=0,b=0;for(e["!cols"]||(e["!cols"]=[]);w<u.length&&S<p;++w){var U=u[w];if(Iy(U)){if(r.display)continue;E[S]={hidden:!0}}var G=U.children;for(C=M=0;C<G.length;++C){var J=G[C];if(!(r.display&&Iy(J))){var F=J.hasAttribute("data-v")?J.getAttribute("data-v"):J.hasAttribute("v")?J.getAttribute("v"):dT(J.innerHTML),W=J.getAttribute("data-z")||J.getAttribute("z");for(_=0;_<y.length;++_){var O=y[_];O.s.c==M+l&&O.s.r<S+a&&S+a<=O.e.r&&(M=O.e.c+1-l,_=-1)}b=+J.getAttribute("colspan")||1,((k=+J.getAttribute("rowspan")||1)>1||b>1)&&y.push({s:{r:S+a,c:M+l},e:{r:S+a+(k||1)-1,c:M+l+(b||1)-1}});var ee={t:"s",v:F},ne=J.getAttribute("data-t")||J.getAttribute("t")||"";F!=null&&(F.length==0?ee.t=ne||"z":r.raw||F.trim().length==0||ne=="s"||(F==="TRUE"?ee={t:"b",v:!0}:F==="FALSE"?ee={t:"b",v:!1}:isNaN(sa(F))?isNaN(El(F).getDate())||(ee={t:"d",v:Un(F)},r.cellDates||(ee={t:"n",v:fr(ee.v)}),ee.z=r.dateNF||lt[14]):ee={t:"n",v:sa(F)})),ee.z===void 0&&W!=null&&(ee.z=W);var te="",_e=J.getElementsByTagName("A");if(_e&&_e.length)for(var Ie=0;Ie<_e.length&&!(_e[Ie].hasAttribute("href")&&(te=_e[Ie].getAttribute("href"),te.charAt(0)!="#"));++Ie);te&&te.charAt(0)!="#"&&(ee.l={Target:te}),r.dense?(e[S+a]||(e[S+a]=[]),e[S+a][M+l]=ee):e[it({c:M+l,r:S+a})]=ee,m.e.c<M+l&&(m.e.c=M+l),M+=b}}++S}return y.length&&(e["!merges"]=(e["!merges"]||[]).concat(y)),m.e.r=Math.max(m.e.r,S-1+a),e["!ref"]=Nt(m),S>=p&&(e["!fullref"]=Nt((m.e.r=u.length-w+S-1+a,m))),e}function v_(e,t){var n=t||{},r=n.dense?[]:{};return g_(r,e,t)}function CP(e,t){return Ui(v_(e,t),t)}function Iy(e){var t="",n=AP(e);return n&&(t=n(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function AP(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function bP(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(r,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),n=Rt(t.replace(/<[^>]*>/g,""));return[n]}var Fy={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function y_(e,t){var n=t||{},r=jh(e),a=[],l,c,u={name:""},p="",m=0,x,y,_={},E=[],w=n.dense?[]:{},S,C,M={value:""},k="",b=0,U=[],G=-1,J=-1,F={s:{r:1e6,c:1e7},e:{r:0,c:0}},W=0,O={},ee=[],ne={},te=0,_e=0,Ie=[],Ee=1,ae=1,de=[],re={Names:[]},Y={},N=["",""],Z=[],D={},H="",q=0,j=!1,se=!1,Te=0;for(ec.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");S=ec.exec(r);)switch(S[3]=S[3].replace(/_.*$/,"")){case"table":case"":S[1]==="/"?(F.e.c>=F.s.c&&F.e.r>=F.s.r?w["!ref"]=Nt(F):w["!ref"]="A1:A1",n.sheetRows>0&&n.sheetRows<=F.e.r&&(w["!fullref"]=w["!ref"],F.e.r=n.sheetRows-1,w["!ref"]=Nt(F)),ee.length&&(w["!merges"]=ee),Ie.length&&(w["!rows"]=Ie),x.name=x.||x.name,typeof JSON<"u"&&JSON.stringify(x),E.push(x.name),_[x.name]=w,se=!1):S[0].charAt(S[0].length-2)!=="/"&&(x=tt(S[0],!1),G=J=-1,F.s.r=F.s.c=1e7,F.e.r=F.e.c=0,w=n.dense?[]:{},ee=[],Ie=[],se=!0);break;case"table-row-group":S[1]==="/"?--W:++W;break;case"table-row":case"":if(S[1]==="/"){G+=Ee,Ee=1;break}if(y=tt(S[0],!1),y.?G=y.-1:G==-1&&(G=0),Ee=+y["number-rows-repeated"]||1,Ee<10)for(Te=0;Te<Ee;++Te)W>0&&(Ie[G+Te]={level:W});J=-1;break;case"covered-table-cell":S[1]!=="/"&&++J,n.sheetStubs&&(n.dense?(w[G]||(w[G]=[]),w[G][J]={t:"z"}):w[it({r:G,c:J})]={t:"z"}),k="",U=[];break;case"table-cell":case"":if(S[0].charAt(S[0].length-2)==="/")++J,M=tt(S[0],!1),ae=parseInt(M["number-columns-repeated"]||"1",10),C={t:"z",v:null},M.formula&&n.cellFormula!=!1&&(C.f=ky(Rt(M.formula))),(M.||M["value-type"])=="string"&&(C.t="s",C.v=Rt(M["string-value"]||""),n.dense?(w[G]||(w[G]=[]),w[G][J]=C):w[it({r:G,c:J})]=C),J+=ae-1;else if(S[1]!=="/"){++J,k="",b=0,U=[],ae=1;var Ae=Ee?G+Ee-1:G;if(J>F.e.c&&(F.e.c=J),J<F.s.c&&(F.s.c=J),G<F.s.r&&(F.s.r=G),Ae>F.e.r&&(F.e.r=Ae),M=tt(S[0],!1),Z=[],D={},C={t:M.||M["value-type"],v:null},n.cellFormula)if(M.formula&&(M.formula=Rt(M.formula)),M["number-matrix-columns-spanned"]&&M["number-matrix-rows-spanned"]&&(te=parseInt(M["number-matrix-rows-spanned"],10)||0,_e=parseInt(M["number-matrix-columns-spanned"],10)||0,ne={s:{r:G,c:J},e:{r:G+te-1,c:J+_e-1}},C.F=Nt(ne),de.push([ne,C.F])),M.formula)C.f=ky(M.formula);else for(Te=0;Te<de.length;++Te)G>=de[Te][0].s.r&&G<=de[Te][0].e.r&&J>=de[Te][0].s.c&&J<=de[Te][0].e.c&&(C.F=de[Te][1]);switch((M["number-columns-spanned"]||M["number-rows-spanned"])&&(te=parseInt(M["number-rows-spanned"],10)||0,_e=parseInt(M["number-columns-spanned"],10)||0,ne={s:{r:G,c:J},e:{r:G+te-1,c:J+_e-1}},ee.push(ne)),M["number-columns-repeated"]&&(ae=parseInt(M["number-columns-repeated"],10)),C.t){case"boolean":C.t="b",C.v=sn(M["boolean-value"]);break;case"float":C.t="n",C.v=parseFloat(M.value);break;case"percentage":C.t="n",C.v=parseFloat(M.value);break;case"currency":C.t="n",C.v=parseFloat(M.value);break;case"date":C.t="d",C.v=Un(M["date-value"]),n.cellDates||(C.t="n",C.v=fr(C.v)),C.z="m/d/yy";break;case"time":C.t="n",C.v=VD(M["time-value"])/86400,n.cellDates&&(C.t="d",C.v=vf(C.v)),C.z="HH:MM:SS";break;case"number":C.t="n",C.v=parseFloat(M.);break;default:if(C.t==="string"||C.t==="text"||!C.t)C.t="s",M["string-value"]!=null&&(k=Rt(M["string-value"]),U=[]);else throw new Error("Unsupported value type "+C.t)}}else{if(j=!1,C.t==="s"&&(C.v=k||"",U.length&&(C.R=U),j=b==0),Y.Target&&(C.l=Y),Z.length>0&&(C.c=Z,Z=[]),k&&n.cellText!==!1&&(C.w=k),j&&(C.t="z",delete C.v),(!j||n.sheetStubs)&&!(n.sheetRows&&n.sheetRows<=G))for(var Re=0;Re<Ee;++Re){if(ae=parseInt(M["number-columns-repeated"]||"1",10),n.dense)for(w[G+Re]||(w[G+Re]=[]),w[G+Re][J]=Re==0?C:qn(C);--ae>0;)w[G+Re][J+ae]=qn(C);else for(w[it({r:G+Re,c:J})]=C;--ae>0;)w[it({r:G+Re,c:J+ae})]=qn(C);F.e.c<=J&&(F.e.c=J)}ae=parseInt(M["number-columns-repeated"]||"1",10),J+=ae-1,ae=0,C={},k="",U=[]}Y={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(S[1]==="/"){if((l=a.pop())[0]!==S[3])throw"Bad state: "+l}else S[0].charAt(S[0].length-2)!=="/"&&a.push([S[3],!0]);break;case"annotation":if(S[1]==="/"){if((l=a.pop())[0]!==S[3])throw"Bad state: "+l;D.t=k,U.length&&(D.R=U),D.a=H,Z.push(D)}else S[0].charAt(S[0].length-2)!=="/"&&a.push([S[3],!1]);H="",q=0,k="",b=0,U=[];break;case"creator":S[1]==="/"?H=r.slice(q,S.index):q=S.index+S[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(S[1]==="/"){if((l=a.pop())[0]!==S[3])throw"Bad state: "+l}else S[0].charAt(S[0].length-2)!=="/"&&a.push([S[3],!1]);k="",b=0,U=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(S[1]==="/"){if(O[u.name]=p,(l=a.pop())[0]!==S[3])throw"Bad state: "+l}else S[0].charAt(S[0].length-2)!=="/"&&(p="",u=tt(S[0],!1),a.push([S[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":c=tt(S[0],!1),p+=Fy[S[3]][c.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":c=tt(S[0],!1),p+=Fy[S[3]][c.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(S[0].slice(-2)==="/>")break;if(S[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":p+=r.slice(m,S.index);break}else m=S.index+S[0].length;break;case"named-range":c=tt(S[0],!1),N=Vd(c["cell-range-address"]);var Ce={Name:c.name,Ref:N[0]+"!"+N[1]};se&&(Ce.Sheet=E.length),re.Names.push(Ce);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(S[1]==="/"&&(!M||!M["string-value"])){var Xe=bP(r.slice(b,S.index));k=(k.length>0?k+`
`:"")+Xe[0]}else tt(S[0],!1),b=S.index+S[0].length;break;case"s":break;case"database-range":if(S[1]==="/")break;try{N=Vd(tt(S[0])["target-range-address"]),_[N[0]]["!autofilter"]={ref:N[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(S[1]!=="/"){if(Y=tt(S[0],!1),!Y.href)break;Y.Target=Rt(Y.href),delete Y.href,Y.Target.charAt(0)=="#"&&Y.Target.indexOf(".")>-1?(N=Vd(Y.Target.slice(1)),Y.Target="#"+N[0]+"!"+N[1]):Y.Target.match(/^\.\.[\\\/]/)&&(Y.Target=Y.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(S[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(n.WTF)throw new Error(S)}}var X={Sheets:_,SheetNames:E,Workbook:re};return n.bookSheets&&delete X.Sheets,X}function Ly(e,t){t=t||{},zr(e,"META-INF/manifest.xml")&&j6(En(e,"META-INF/manifest.xml"),t);var n=Nr(e,"content.xml");if(!n)throw new Error("Missing content.xml in ODS / UOF file");var r=y_(Zt(n),t);return zr(e,"meta.xml")&&(r.Props=DT(En(e,"meta.xml"))),r}function Oy(e,t){return y_(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function nm(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function vh(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Zt(ys(e))}function yh(e){var t=e.reduce(function(a,l){return a+l.length},0),n=new Uint8Array(t),r=0;return e.forEach(function(a){n.set(a,r),r+=a.length}),n}function Py(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function kP(e,t){for(var n=(e[t+15]&127)<<7|e[t+14]>>1,r=e[t+14]&1,a=t+13;a>=t;--a)r=r*256+e[a];return(e[t+15]&128?-r:r)*Math.pow(10,n-6176)}function ac(e,t){var n=t?t[0]:0,r=e[n]&127;e:if(e[n++]>=128&&(r|=(e[n]&127)<<7,e[n++]<128||(r|=(e[n]&127)<<14,e[n++]<128)||(r|=(e[n]&127)<<21,e[n++]<128)||(r+=(e[n]&127)*Math.pow(2,28),++n,e[n++]<128)||(r+=(e[n]&127)*Math.pow(2,35),++n,e[n++]<128)||(r+=(e[n]&127)*Math.pow(2,42),++n,e[n++]<128)))break e;return t&&(t[0]=n),r}function Rn(e){var t=0,n=e[t]&127;e:if(e[t++]>=128){if(n|=(e[t]&127)<<7,e[t++]<128||(n|=(e[t]&127)<<14,e[t++]<128)||(n|=(e[t]&127)<<21,e[t++]<128))break e;n|=(e[t]&127)<<28}return n}function er(e){for(var t=[],n=[0];n[0]<e.length;){var r=n[0],a=ac(e,n),l=a&7;a=Math.floor(a/8);var c=0,u;if(a==0)break;switch(l){case 0:{for(var p=n[0];e[n[0]++]>=128;);u=e.slice(p,n[0])}break;case 5:c=4,u=e.slice(n[0],n[0]+c),n[0]+=c;break;case 1:c=8,u=e.slice(n[0],n[0]+c),n[0]+=c;break;case 2:c=ac(e,n),u=e.slice(n[0],n[0]+c),n[0]+=c;break;case 3:case 4:default:throw new Error("PB Type ".concat(l," for Field ").concat(a," at offset ").concat(r))}var m={data:u,type:l};t[a]==null?t[a]=[m]:t[a].push(m)}return t}function rm(e,t){return(e==null?void 0:e.map(function(n){return t(n.data)}))||[]}function NP(e){for(var t,n=[],r=[0];r[0]<e.length;){var a=ac(e,r),l=er(e.slice(r[0],r[0]+a));r[0]+=a;var c={id:Rn(l[1][0].data),messages:[]};l[2].forEach(function(u){var p=er(u.data),m=Rn(p[3][0].data);c.messages.push({meta:p,data:e.slice(r[0],r[0]+m)}),r[0]+=m}),(t=l[3])!=null&&t[0]&&(c.merge=Rn(l[3][0].data)>>>0>0),n.push(c)}return n}function MP(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var n=[0],r=ac(t,n),a=[];n[0]<t.length;){var l=t[n[0]]&3;if(l==0){var c=t[n[0]++]>>2;if(c<60)++c;else{var u=c-59;c=t[n[0]],u>1&&(c|=t[n[0]+1]<<8),u>2&&(c|=t[n[0]+2]<<16),u>3&&(c|=t[n[0]+3]<<24),c>>>=0,c++,n[0]+=u}a.push(t.slice(n[0],n[0]+c)),n[0]+=c;continue}else{var p=0,m=0;if(l==1?(m=(t[n[0]]>>2&7)+4,p=(t[n[0]++]&224)<<3,p|=t[n[0]++]):(m=(t[n[0]++]>>2)+1,l==2?(p=t[n[0]]|t[n[0]+1]<<8,n[0]+=2):(p=(t[n[0]]|t[n[0]+1]<<8|t[n[0]+2]<<16|t[n[0]+3]<<24)>>>0,n[0]+=4)),a=[yh(a)],p==0)throw new Error("Invalid offset 0");if(p>a[0].length)throw new Error("Invalid offset beyond length");if(m>=p)for(a.push(a[0].slice(-p)),m-=p;m>=a[a.length-1].length;)a.push(a[a.length-1]),m-=a[a.length-1].length;a.push(a[0].slice(-p,-p+m))}}var x=yh(a);if(x.length!=r)throw new Error("Unexpected length: ".concat(x.length," != ").concat(r));return x}function RP(e){for(var t=[],n=0;n<e.length;){var r=e[n++],a=e[n]|e[n+1]<<8|e[n+2]<<16;n+=3,t.push(MP(r,e.slice(n,n+a))),n+=a}if(n!==e.length)throw new Error("data is not a valid framed stream!");return yh(t)}function DP(e,t,n,r){var a=nm(e),l=a.getUint32(4,!0),c=(r>1?12:8)+Py(l&(r>1?3470:398))*4,u=-1,p=-1,m=NaN,x=new Date(2001,0,1);l&512&&(u=a.getUint32(c,!0),c+=4),c+=Py(l&(r>1?12288:4096))*4,l&16&&(p=a.getUint32(c,!0),c+=4),l&32&&(m=a.getFloat64(c,!0),c+=8),l&64&&(x.setTime(x.getTime()+a.getFloat64(c,!0)*1e3),c+=8);var y;switch(e[2]){case 0:break;case 2:y={t:"n",v:m};break;case 3:y={t:"s",v:t[p]};break;case 5:y={t:"d",v:x};break;case 6:y={t:"b",v:m>0};break;case 7:y={t:"n",v:m/86400};break;case 8:y={t:"e",v:0};break;case 9:if(u>-1)y={t:"s",v:n[u]};else if(p>-1)y={t:"s",v:t[p]};else if(!isNaN(m))y={t:"n",v:m};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return y}function IP(e,t,n){var r=nm(e),a=r.getUint32(8,!0),l=12,c=-1,u=-1,p=NaN,m=NaN,x=new Date(2001,0,1);a&1&&(p=kP(e,l),l+=16),a&2&&(m=r.getFloat64(l,!0),l+=8),a&4&&(x.setTime(x.getTime()+r.getFloat64(l,!0)*1e3),l+=8),a&8&&(u=r.getUint32(l,!0),l+=4),a&16&&(c=r.getUint32(l,!0),l+=4);var y;switch(e[1]){case 0:break;case 2:y={t:"n",v:p};break;case 3:y={t:"s",v:t[u]};break;case 5:y={t:"d",v:x};break;case 6:y={t:"b",v:m>0};break;case 7:y={t:"n",v:m/86400};break;case 8:y={t:"e",v:0};break;case 9:if(c>-1)y={t:"s",v:n[c]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:y={t:"n",v:p};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return y}function FP(e,t,n){switch(e[0]){case 0:case 1:case 2:case 3:return DP(e,t,n,e[0]);case 5:return IP(e,t,n);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Ii(e){var t=er(e);return ac(t[1][0].data)}function Uy(e,t){var n=er(t.data),r=Rn(n[1][0].data),a=n[3],l=[];return(a||[]).forEach(function(c){var u=er(c.data),p=Rn(u[1][0].data)>>>0;switch(r){case 1:l[p]=vh(u[3][0].data);break;case 8:{var m=e[Ii(u[9][0].data)][0],x=er(m.data),y=e[Ii(x[1][0].data)][0],_=Rn(y.meta[1][0].data);if(_!=2001)throw new Error("2000 unexpected reference to ".concat(_));var E=er(y.data);l[p]=E[3].map(function(w){return vh(w.data)}).join("")}break}}),l}function LP(e,t){var n,r,a,l,c,u,p,m,x,y,_,E,w,S,C=er(e),M=Rn(C[1][0].data)>>>0,k=Rn(C[2][0].data)>>>0,b=((r=(n=C[8])==null?void 0:n[0])==null?void 0:r.data)&&Rn(C[8][0].data)>0||!1,U,G;if((l=(a=C[7])==null?void 0:a[0])!=null&&l.data&&t!=0)U=(u=(c=C[7])==null?void 0:c[0])==null?void 0:u.data,G=(m=(p=C[6])==null?void 0:p[0])==null?void 0:m.data;else if((y=(x=C[4])==null?void 0:x[0])!=null&&y.data&&t!=1)U=(E=(_=C[4])==null?void 0:_[0])==null?void 0:E.data,G=(S=(w=C[3])==null?void 0:w[0])==null?void 0:S.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var J=b?4:1,F=nm(U),W=[],O=0;O<U.length/2;++O){var ee=F.getUint16(O*2,!0);ee<65535&&W.push([O,ee])}if(W.length!=k)throw"Expected ".concat(k," cells, found ").concat(W.length);var ne=[];for(O=0;O<W.length-1;++O)ne[W[O][0]]=G.subarray(W[O][1]*J,W[O+1][1]*J);return W.length>=1&&(ne[W[W.length-1][0]]=G.subarray(W[W.length-1][1]*J)),{R:M,cells:ne}}function OP(e,t){var n,r=er(t.data),a=(n=r==null?void 0:r[7])!=null&&n[0]?Rn(r[7][0].data)>>>0>0?1:0:-1,l=rm(r[5],function(c){return LP(c,a)});return{nrows:Rn(r[4][0].data)>>>0,data:l.reduce(function(c,u){return c[u.R]||(c[u.R]=[]),u.cells.forEach(function(p,m){if(c[u.R][m])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(m));c[u.R][m]=p}),c},[])}}function PP(e,t,n){var r,a=er(t.data),l={s:{r:0,c:0},e:{r:0,c:0}};if(l.e.r=(Rn(a[6][0].data)>>>0)-1,l.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(l.e.c=(Rn(a[7][0].data)>>>0)-1,l.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));n["!ref"]=Nt(l);var c=er(a[4][0].data),u=Uy(e,e[Ii(c[4][0].data)][0]),p=(r=c[17])!=null&&r[0]?Uy(e,e[Ii(c[17][0].data)][0]):[],m=er(c[3][0].data),x=0;m[1].forEach(function(y){var _=er(y.data),E=e[Ii(_[2][0].data)][0],w=Rn(E.meta[1][0].data);if(w!=6002)throw new Error("6001 unexpected reference to ".concat(w));var S=OP(e,E);S.data.forEach(function(C,M){C.forEach(function(k,b){var U=it({r:x+M,c:b}),G=FP(k,u,p);G&&(n[U]=G)})}),x+=S.nrows})}function UP(e,t){var n=er(t.data),r={"!ref":"A1"},a=e[Ii(n[2][0].data)],l=Rn(a[0].meta[1][0].data);if(l!=6001)throw new Error("6000 unexpected reference to ".concat(l));return PP(e,a[0],r),r}function BP(e,t){var n,r=er(t.data),a={name:(n=r[1])!=null&&n[0]?vh(r[1][0].data):"",sheets:[]},l=rm(r[2],Ii);return l.forEach(function(c){e[c].forEach(function(u){var p=Rn(u.meta[1][0].data);p==6e3&&a.sheets.push(UP(e,u))})}),a}function VP(e,t){var n=sm(),r=er(t.data),a=rm(r[1],Ii);if(a.forEach(function(l){e[l].forEach(function(c){var u=Rn(c.meta[1][0].data);if(u==2){var p=BP(e,c);p.sheets.forEach(function(m,x){lm(n,m,x==0?p.name:p.name+"_"+x,!0)})}})}),n.SheetNames.length==0)throw new Error("Empty NUMBERS file");return n}function Gd(e){var t,n,r,a,l={},c=[];if(e.FullPaths.forEach(function(p){if(p.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(p){if(p.name.match(/\.iwa$/)){var m;try{m=RP(p.content)}catch(y){return console.log("?? "+p.content.length+" "+(y.message||y))}var x;try{x=NP(m)}catch(y){return console.log("## "+(y.message||y))}x.forEach(function(y){l[y.id]=y.messages,c.push(y.id)})}}),!c.length)throw new Error("File has no messages");var u=((a=(r=(n=(t=l==null?void 0:l[1])==null?void 0:t[0])==null?void 0:n.meta)==null?void 0:r[1])==null?void 0:a[0].data)&&Rn(l[1][0].meta[1][0].data)==1&&l[1][0];if(u||c.forEach(function(p){l[p].forEach(function(m){var x=Rn(m.meta[1][0].data)>>>0;if(x==1)if(!u)u=m;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return VP(l,u)}function HP(e){return function(n){for(var r=0;r!=e.length;++r){var a=e[r];n[a[0]]===void 0&&(n[a[0]]=a[1]),a[2]==="n"&&(n[a[0]]=Number(n[a[0]]))}}}function am(e){HP([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function GP(e){return fl.WS.indexOf(e)>-1?"sheet":e==fl.CS?"chart":e==fl.DS?"dialog":e==fl.MS?"macro":e&&e.length?e:"sheet"}function jP(e,t){if(!e)return 0;try{e=t.map(function(r){return r.id||(r.id=r.strRelID),[r.name,e["!id"][r.id].Target,GP(e["!id"][r.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function zP(e,t,n,r,a,l,c,u,p,m,x,y){try{l[r]=Vo(Nr(e,n,!0),t);var _=En(e,t),E;switch(u){case"sheet":E=X7(_,t,a,p,l[r],m,x,y);break;case"chart":if(E=K7(_,t,a,p,l[r],m,x,y),!E||!E["!drawel"])break;var w=Io(E["!drawel"].Target,t),S=hh(w),C=JF(Nr(e,w,!0),Vo(Nr(e,S,!0),w)),M=Io(C,w),k=hh(M);E=I7(Nr(e,M,!0),M,p,Vo(Nr(e,k,!0),M),m,E);break;case"macro":E=Z7(_,t,a,p,l[r],m,x,y);break;case"dialog":E=Q7(_,t,a,p,l[r],m,x,y);break;default:throw new Error("Unrecognized sheet type "+u)}c[r]=E;var b=[];l&&l[r]&&Ea(l[r]).forEach(function(U){var G="";if(l[r][U].Type==fl.CMNT){G=Io(l[r][U].Target,t);var J=rP(En(e,G,!0),G,p);if(!J||!J.length)return;Sy(E,J,!1)}l[r][U].Type==fl.TCMNT&&(G=Io(l[r][U].Target,t),b=b.concat(KF(En(e,G,!0),p)))}),b&&b.length&&Sy(E,b,!0,p.people||[])}catch(U){if(p.WTF)throw U}}function Hr(e){return e.charAt(0)=="/"?e.slice(1):e}function qP(e,t){if(rT(),t=t||{},am(t),zr(e,"META-INF/manifest.xml")||zr(e,"objectdata.xml"))return Ly(e,t);if(zr(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Gd<"u"){if(e.FileIndex)return Gd(e);var n=bt.utils.cfb_new();return Xv(e).forEach(function(Ie){$D(n,Ie,qD(e,Ie))}),Gd(n)}throw new Error("Unsupported NUMBERS file")}if(!zr(e,"[Content_Types].xml"))throw zr(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):zr(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var r=Xv(e),a=H6(Nr(e,"[Content_Types].xml")),l=!1,c,u;if(a.workbooks.length===0&&(u="xl/workbook.xml",En(e,u,!0)&&a.workbooks.push(u)),a.workbooks.length===0){if(u="xl/workbook.bin",!En(e,u,!0))throw new Error("Could not find workbook");a.workbooks.push(u),l=!0}a.workbooks[0].slice(-3)=="bin"&&(l=!0);var p={},m={};if(!t.bookSheets&&!t.bookProps){if(jo=[],a.sst)try{jo=nP(En(e,Hr(a.sst)),a.sst,t)}catch(Ie){if(t.WTF)throw Ie}t.cellStyles&&a.themes.length&&(p=tP(Nr(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(m=eP(En(e,Hr(a.style)),a.style,p,t))}a.links.map(function(Ie){try{var Ee=Vo(Nr(e,hh(Hr(Ie))),Ie);return iP(En(e,Hr(Ie)),Ee,Ie,t)}catch{}});var x=J7(En(e,Hr(a.workbooks[0])),a.workbooks[0],t),y={},_="";a.coreprops.length&&(_=En(e,Hr(a.coreprops[0]),!0),_&&(y=DT(_)),a.extprops.length!==0&&(_=En(e,Hr(a.extprops[0]),!0),_&&$6(_,y,t)));var E={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(_=Nr(e,Hr(a.custprops[0]),!0),_&&(E=W6(_,t)));var w={};if((t.bookSheets||t.bookProps)&&(x.Sheets?c=x.Sheets.map(function(Ee){return Ee.name}):y.Worksheets&&y.SheetNames.length>0&&(c=y.SheetNames),t.bookProps&&(w.Props=y,w.Custprops=E),t.bookSheets&&typeof c<"u"&&(w.SheetNames=c),t.bookSheets?w.SheetNames:t.bookProps))return w;c={};var S={};t.bookDeps&&a.calcchain&&(S=aP(En(e,Hr(a.calcchain)),a.calcchain));var C=0,M={},k,b;{var U=x.Sheets;y.Worksheets=U.length,y.SheetNames=[];for(var G=0;G!=U.length;++G)y.SheetNames[G]=U[G].name}var J=l?"bin":"xml",F=a.workbooks[0].lastIndexOf("/"),W=(a.workbooks[0].slice(0,F+1)+"_rels/"+a.workbooks[0].slice(F+1)+".rels").replace(/^\//,"");zr(e,W)||(W="xl/_rels/workbook."+J+".rels");var O=Vo(Nr(e,W,!0),W.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=sP(En(e,Hr(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=ZF(En(e,Hr(a.people[0])),t)),O&&(O=jP(O,x.Sheets));var ee=En(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(C=0;C!=y.Worksheets;++C){var ne="sheet";if(O&&O[C]?(k="xl/"+O[C][1].replace(/[\/]?xl\//,""),zr(e,k)||(k=O[C][1]),zr(e,k)||(k=W.replace(/_rels\/.*$/,"")+O[C][1]),ne=O[C][2]):(k="xl/worksheets/sheet"+(C+1-ee)+"."+J,k=k.replace(/sheet0\./,"sheet.")),b=k.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(C!=t.sheets)continue e;break;case"string":if(y.SheetNames[C].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var te=!1,_e=0;_e!=t.sheets.length;++_e)typeof t.sheets[_e]=="number"&&t.sheets[_e]==C&&(te=1),typeof t.sheets[_e]=="string"&&t.sheets[_e].toLowerCase()==y.SheetNames[C].toLowerCase()&&(te=1);if(!te)continue e}}zP(e,k,b,y.SheetNames[C],C,M,c,ne,t,x,p,m)}return w={Directory:a,Workbook:x,Props:y,Custprops:E,Deps:S,Sheets:c,SheetNames:y.SheetNames,Strings:jo,Styles:m,Themes:p,SSF:qn(lt)},t&&t.bookFiles&&(e.files?(w.keys=r,w.files=e.files):(w.keys=[],w.files={},e.FullPaths.forEach(function(Ie,Ee){Ie=Ie.replace(/^Root Entry[\/]/,""),w.keys.push(Ie),w.files[Ie]=e.FileIndex[Ee]}))),t&&t.bookVBA&&(a.vba.length>0?w.vbaraw=En(e,Hr(a.vba[0]),!0):a.defaults&&a.defaults.bin===nL&&(w.vbaraw=En(e,"xl/vbaProject.bin",!0))),w}function $P(e,t){var n=t||{},r="Workbook",a=bt.find(e,r);try{if(r="/!DataSpaces/Version",a=bt.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(U8(a.content),r="/!DataSpaces/DataSpaceMap",a=bt.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var l=V8(a.content);if(l.length!==1||l[0].comps.length!==1||l[0].comps[0].t!==0||l[0].name!=="StrongEncryptionDataSpace"||l[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=bt.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var c=H8(a.content);if(c.length!=1||c[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=bt.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);j8(a.content)}catch{}if(r="/EncryptionInfo",a=bt.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var u=z8(a.content);if(r="/EncryptedPackage",a=bt.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],a.content,n.password||"",n);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],a.content,n.password||"",n);throw new Error("File is password-protected")}function im(e,t){var n="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":n=Mr(e.slice(0,12));break;case"binary":n=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3),n.charCodeAt(4),n.charCodeAt(5),n.charCodeAt(6),n.charCodeAt(7)]}function YP(e,t){return bt.find(e,"EncryptedPackage")?$P(e,t):x_(e,t)}function WP(e,t){var n,r=e,a=t||{};return a.type||(a.type=St&&Buffer.isBuffer(e)?"buffer":"base64"),n=cT(r,a),qP(n,a)}function T_(e,t){var n=0;e:for(;n<e.length;)switch(e.charCodeAt(n)){case 10:case 13:case 32:++n;break;case 60:return xh(e.slice(n),t);default:break e}return tc.to_workbook(e,t)}function JP(e,t){var n="",r=im(e,t);switch(t.type){case"base64":n=Mr(e);break;case"binary":n=e;break;case"buffer":n=e.toString("binary");break;case"array":n=ms(e);break;default:throw new Error("Unrecognized type "+t.type)}return r[0]==239&&r[1]==187&&r[2]==191&&(n=Zt(n)),t.type="binary",T_(n,t)}function XP(e,t){var n=e;return t.type=="base64"&&(n=Mr(n)),n=Ko.utils.decode(1200,n.slice(2),"str"),t.type="binary",T_(n,t)}function KP(e){return e.match(/[^\x00-\x7F]/)?Fo(e):e}function jd(e,t,n,r){return r?(n.type="string",tc.to_workbook(e,n)):tc.to_workbook(t,n)}function Th(e,t){q2();var n=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Th(new Uint8Array(e),(n=qn(n),n.type="array",n));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!n.type&&(n.type=typeof Deno<"u"?"buffer":"array");var r=e,a=[0,0,0,0],l=!1;if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),xl={},n.dateNF&&(xl.dateNF=n.dateNF),n.type||(n.type=St&&Buffer.isBuffer(e)?"buffer":"base64"),n.type=="file"&&(n.type=St?"buffer":"binary",r=UD(e),typeof Uint8Array<"u"&&!St&&(n.type="array")),n.type=="string"&&(l=!0,n.type="binary",n.codepage=65001,r=KP(e)),n.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var c=new ArrayBuffer(3),u=new Uint8Array(c);if(u.foo="bar",!u.foo)return n=qn(n),n.type="array",Th(Ph(r),n)}switch((a=im(r,n))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return YP(bt.read(r,n),n);break;case 9:if(a[1]<=8)return x_(r,n);break;case 60:return xh(r,n);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return C8(r,n);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return S8.to_workbook(r,n);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?WP(r,n):jd(e,r,n,l);case 239:return a[3]===60?xh(r,n):jd(e,r,n,l);case 255:if(a[1]===254)return XP(r,n);if(a[1]===0&&a[2]===2&&a[3]===0)return Go.to_workbook(r,n);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return Go.to_workbook(r,n);break;case 3:case 131:case 139:case 140:return Ey.to_workbook(r,n);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return nF.to_workbook(r,n);break;case 10:case 13:case 32:return JP(r,n);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return _8.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?Ey.to_workbook(r,n):jd(e,r,n,l)}function ZP(e,t,n,r,a,l,c,u){var p=$n(n),m=u.defval,x=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),y=!0,_=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(_,"__rowNum__",{value:n,enumerable:!1})}catch{_.__rowNum__=n}else _.__rowNum__=n;if(!c||e[n])for(var E=t.s.c;E<=t.e.c;++E){var w=c?e[n][E]:e[r[E]+p];if(w===void 0||w.t===void 0){if(m===void 0)continue;l[E]!=null&&(_[l[E]]=m);continue}var S=w.v;switch(w.t){case"z":if(S==null)break;continue;case"e":S=S==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+w.t)}if(l[E]!=null){if(S==null)if(w.t=="e"&&S===null)_[l[E]]=null;else if(m!==void 0)_[l[E]]=m;else if(x&&S===null)_[l[E]]=null;else continue;else _[l[E]]=x&&(w.t!=="n"||w.t==="n"&&u.rawNumbers!==!1)?S:Ka(w,S,u);S!=null&&(y=!1)}}return{row:_,isempty:y}}function _h(e,t){if(e==null||e["!ref"]==null)return[];var n={t:"n",v:0},r=0,a=1,l=[],c=0,u="",p={s:{r:0,c:0},e:{r:0,c:0}},m=t||{},x=m.range!=null?m.range:e["!ref"];switch(m.header===1?r=1:m.header==="A"?r=2:Array.isArray(m.header)?r=3:m.header==null&&(r=0),typeof x){case"string":p=pn(x);break;case"number":p=pn(e["!ref"]),p.s.r=x;break;default:p=x}r>0&&(a=0);var y=$n(p.s.r),_=[],E=[],w=0,S=0,C=Array.isArray(e),M=p.s.r,k=0,b={};C&&!e[M]&&(e[M]=[]);var U=m.skipHidden&&e["!cols"]||[],G=m.skipHidden&&e["!rows"]||[];for(k=p.s.c;k<=p.e.c;++k)if(!(U[k]||{}).hidden)switch(_[k]=Mn(k),n=C?e[M][k]:e[_[k]+y],r){case 1:l[k]=k-p.s.c;break;case 2:l[k]=_[k];break;case 3:l[k]=m.header[k-p.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),u=c=Ka(n,null,m),S=b[c]||0,!S)b[c]=1;else{do u=c+"_"+S++;while(b[u]);b[c]=S,b[u]=1}l[k]=u}for(M=p.s.r+a;M<=p.e.r;++M)if(!(G[M]||{}).hidden){var J=ZP(e,p,M,_,r,l,C,m);(J.isempty===!1||(r===1?m.blankrows!==!1:m.blankrows))&&(E[w++]=J.row)}return E.length=w,E}var By=/"/g;function QP(e,t,n,r,a,l,c,u){for(var p=!0,m=[],x="",y=$n(n),_=t.s.c;_<=t.e.c;++_)if(r[_]){var E=u.dense?(e[n]||[])[_]:e[r[_]+y];if(E==null)x="";else if(E.v!=null){p=!1,x=""+(u.rawNumbers&&E.t=="n"?E.v:Ka(E,null,u));for(var w=0,S=0;w!==x.length;++w)if((S=x.charCodeAt(w))===a||S===l||S===34||u.forceQuotes){x='"'+x.replace(By,'""')+'"';break}x=="ID"&&(x='"ID"')}else E.f!=null&&!E.F?(p=!1,x="="+E.f,x.indexOf(",")>=0&&(x='"'+x.replace(By,'""')+'"')):x="";m.push(x)}return u.blankrows===!1&&p?null:m.join(c)}function __(e,t){var n=[],r=t??{};if(e==null||e["!ref"]==null)return"";var a=pn(e["!ref"]),l=r.FS!==void 0?r.FS:",",c=l.charCodeAt(0),u=r.RS!==void 0?r.RS:`
`,p=u.charCodeAt(0),m=new RegExp((l=="|"?"\\|":l)+"+$"),x="",y=[];r.dense=Array.isArray(e);for(var _=r.skipHidden&&e["!cols"]||[],E=r.skipHidden&&e["!rows"]||[],w=a.s.c;w<=a.e.c;++w)(_[w]||{}).hidden||(y[w]=Mn(w));for(var S=0,C=a.s.r;C<=a.e.r;++C)(E[C]||{}).hidden||(x=QP(e,a,C,y,c,p,l,r),x!=null&&(r.strip&&(x=x.replace(m,"")),(x||r.blankrows!==!1)&&n.push((S++?u:"")+x)));return delete r.dense,n.join("")}function e9(e,t){t||(t={}),t.FS="	",t.RS=`
`;var n=__(e,t);return n}function t9(e){var t="",n,r="";if(e==null||e["!ref"]==null)return[];var a=pn(e["!ref"]),l="",c=[],u,p=[],m=Array.isArray(e);for(u=a.s.c;u<=a.e.c;++u)c[u]=Mn(u);for(var x=a.s.r;x<=a.e.r;++x)for(l=$n(x),u=a.s.c;u<=a.e.c;++u)if(t=c[u]+l,n=m?(e[x]||[])[u]:e[t],r="",n!==void 0){if(n.F!=null){if(t=n.F,!n.f)continue;r=n.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(n.f!=null)r=n.f;else{if(n.t=="z")continue;if(n.t=="n"&&n.v!=null)r=""+n.v;else if(n.t=="b")r=n.v?"TRUE":"FALSE";else if(n.w!==void 0)r="'"+n.w;else{if(n.v===void 0)continue;n.t=="s"?r="'"+n.v:r=""+n.v}}p[p.length]=t+"="+r}return p}function E_(e,t,n){var r=n||{},a=+!r.skipHeader,l=e||{},c=0,u=0;if(l&&r.origin!=null)if(typeof r.origin=="number")c=r.origin;else{var p=typeof r.origin=="string"?or(r.origin):r.origin;c=p.r,u=p.c}var m,x={s:{c:0,r:0},e:{c:u,r:c+t.length-1+a}};if(l["!ref"]){var y=pn(l["!ref"]);x.e.c=Math.max(x.e.c,y.e.c),x.e.r=Math.max(x.e.r,y.e.r),c==-1&&(c=y.e.r+1,x.e.r=c+t.length-1+a)}else c==-1&&(c=0,x.e.r=t.length-1+a);var _=r.header||[],E=0;t.forEach(function(S,C){Ea(S).forEach(function(M){(E=_.indexOf(M))==-1&&(_[E=_.length]=M);var k=S[M],b="z",U="",G=it({c:u+E,r:c+C+a});m=ic(l,G),k&&typeof k=="object"&&!(k instanceof Date)?l[G]=k:(typeof k=="number"?b="n":typeof k=="boolean"?b="b":typeof k=="string"?b="s":k instanceof Date?(b="d",r.cellDates||(b="n",k=fr(k)),U=r.dateNF||lt[14]):k===null&&r.nullError&&(b="e",k=0),m?(m.t=b,m.v=k,delete m.w,delete m.R,U&&(m.z=U)):l[G]=m={t:b,v:k},U&&(m.z=U))})}),x.e.c=Math.max(x.e.c,u+_.length-1);var w=$n(c);if(a)for(E=0;E<_.length;++E)l[Mn(E+u)+w]={t:"s",v:_[E]};return l["!ref"]=Nt(x),l}function n9(e,t){return E_(null,e,t)}function ic(e,t,n){if(typeof t=="string"){if(Array.isArray(e)){var r=or(t);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?ic(e,it(t)):ic(e,it({r:t,c:n||0}))}function r9(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var n=e.SheetNames.indexOf(t);if(n>-1)return n;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function sm(){return{SheetNames:[],Sheets:{}}}function lm(e,t,n,r){var a=1;if(!n)for(;a<=65535&&e.SheetNames.indexOf(n="Sheet"+a)!=-1;++a,n=void 0);if(!n||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(n)>=0){var l=n.match(/(^.*?)(\d+)$/);a=l&&+l[2]||0;var c=l&&l[1]||n;for(++a;a<=65535&&e.SheetNames.indexOf(n=c+a)!=-1;++a);}if(H7(n),e.SheetNames.indexOf(n)>=0)throw new Error("Worksheet with name |"+n+"| already exists!");return e.SheetNames.push(n),e.Sheets[n]=t,n}function a9(e,t,n){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=r9(e,t);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}e.Workbook.Sheets[r].Hidden=n}function i9(e,t){return e.z=t,e}function S_(e,t,n){return t?(e.l={Target:t},n&&(e.l.Tooltip=n)):delete e.l,e}function s9(e,t,n){return S_(e,"#"+t,n)}function l9(e,t,n){e.c||(e.c=[]),e.c.push({t,a:n||"SheetJS"})}function o9(e,t,n,r){for(var a=typeof t!="string"?t:pn(t),l=typeof t=="string"?t:Nt(t),c=a.s.r;c<=a.e.r;++c)for(var u=a.s.c;u<=a.e.c;++u){var p=ic(e,c,u);p.t="n",p.F=l,delete p.v,c==a.s.r&&u==a.s.c&&(p.f=n,r&&(p.D=!0))}return e}var c9={encode_col:Mn,encode_row:$n,encode_cell:it,encode_range:Nt,decode_col:$h,decode_row:qh,split_cell:T6,decode_cell:or,decode_range:Nl,format_cell:Ka,sheet_add_aoa:bT,sheet_add_json:E_,sheet_add_dom:g_,aoa_to_sheet:Ml,json_to_sheet:n9,table_to_sheet:v_,table_to_book:CP,sheet_to_csv:__,sheet_to_txt:e9,sheet_to_json:_h,sheet_to_html:wP,sheet_to_formulae:t9,sheet_to_row_object_array:_h,sheet_get_cell:ic,book_new:sm,book_append_sheet:lm,book_set_sheet_visibility:a9,cell_set_number_format:i9,cell_set_hyperlink:S_,cell_set_internal_link:s9,cell_add_comment:l9,sheet_set_array_formula:o9,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const w_=({matrixData:e,onUpdate:t})=>{const n=(p,m)=>t({...e,headers:e.headers.map((x,y)=>y===p?m:x)}),r=(p,m,x)=>t({...e,rows:e.rows.map((y,_)=>_===p?y.map((E,w)=>w===m?x:E):y)}),a=()=>t({...e,rows:[...e.rows,Array(e.headers.length).fill("")]}),l=p=>t({...e,rows:e.rows.filter((m,x)=>x!==p)}),c=()=>{const p=` ${e.headers.length+1}`;t({headers:[...e.headers,p],rows:e.rows.map(m=>[...m,""])})},u=p=>{e.headers.length<=1||t({headers:e.headers.filter((m,x)=>x!==p),rows:e.rows.map(m=>m.filter((x,y)=>y!==p))})};return g.jsxs("div",{className:"overflow-x-auto p-1 bg-slate-50 rounded-md border",children:[g.jsxs("table",{className:"w-full text-xs border-collapse",children:[g.jsx("thead",{children:g.jsxs("tr",{className:"bg-slate-200",children:[e.headers.map((p,m)=>g.jsx("th",{className:"border border-slate-300 p-0 font-semibold text-slate-700",children:g.jsxs("div",{className:"flex items-center justify-between gap-1 px-1",children:[g.jsx("input",{type:"text",value:p,onChange:x=>n(m,x.target.value),className:"w-full bg-transparent outline-none text-center font-semibold text-slate-800"}),g.jsx("button",{onClick:()=>u(m),className:"text-red-500 hover:text-red-700 opacity-30 hover:opacity-100",title:"",children:g.jsx(Xa,{className:"w-3 h-3"})})]})},m)),g.jsx("th",{className:"border border-slate-300 p-1 w-10"})]})}),g.jsx("tbody",{children:e.rows.map((p,m)=>g.jsxs("tr",{children:[p.map((x,y)=>g.jsx("td",{className:"border border-slate-300 p-0",children:g.jsx("input",{type:"text",value:x,onChange:_=>r(m,y,_.target.value),className:"w-full bg-white text-slate-900 outline-none p-1 focus:bg-blue-50"})},y)),g.jsx("td",{className:"border border-slate-300 p-1 text-center",children:g.jsx("button",{onClick:()=>l(m),className:"text-red-500 hover:text-red-700",title:"",children:g.jsx(Xa,{className:"w-3 h-3"})})})]},m))})]}),g.jsxs("div",{className:"flex gap-2 mt-2",children:[g.jsxs("button",{onClick:a,className:"text-xs px-2 py-1 bg-slate-200 hover:bg-slate-300 rounded flex items-center gap-1",children:[g.jsx(Yu,{className:"w-3 h-3"}),""]}),g.jsxs("button",{onClick:c,className:"text-xs px-2 py-1 bg-slate-200 hover:bg-slate-300 rounded flex items-center gap-1",children:[g.jsx(Yu,{className:"w-3 h-3"}),""]})]})]})},Vy=e=>{const t=Math.cos(2*Math.PI*e),n=Math.sin(2*Math.PI*e);return[t,n]},u9=({data:e,title:t})=>{const n=e.reduce((c,u)=>c+u.value,0);if(n===0)return g.jsx("div",{className:"flex items-center justify-center h-full text-xs text-slate-500",children:"No data for chart"});let r=0;const a=["#4A90E2","#50E3C2","#F5A623","#F8E71C","#7ED321","#9013FE","#BD10E0","#4A4A4A"],l=e.map((c,u)=>{const p=c.value/n,[m,x]=Vy(r);r+=p;const[y,_]=Vy(r),E=p>.5?1:0;return{path:`M ${m} ${x} A 1 1 0 ${E} 1 ${y} ${_} L 0 0`,color:a[u%a.length],label:c.label,value:c.value}});return g.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center bg-white p-2 border rounded-md",children:[g.jsx("h5",{className:"font-bold text-sm mb-2",children:t}),g.jsx("svg",{viewBox:"-1.2 -1.2 2.4 2.4",className:"w-32 h-32 mb-2",children:l.map((c,u)=>g.jsx("path",{d:c.path,fill:c.color},u))}),g.jsx("div",{className:"text-[10px] space-y-0.5 w-full",children:l.map((c,u)=>g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{className:"flex items-center",children:[g.jsx("span",{className:"w-2 h-2 rounded-full mr-1.5",style:{backgroundColor:c.color}}),g.jsx("span",{children:c.label})]}),g.jsxs("span",{children:[c.value," (",(c.value/n*100).toFixed(1),"%)"]})]},u))})]})},f9=({data:e,title:t})=>{if(e.length<2)return g.jsx("div",{className:"flex items-center justify-center h-full text-xs text-slate-500",children:"Need at least 2 data points for a line chart."});const n=Math.max(...e.map(r=>r.value),0);return g.jsxs("div",{className:"w-full h-full bg-white p-2 border rounded-md",children:[g.jsx("h5",{className:"text-center font-bold text-sm mb-2",children:t}),g.jsxs("svg",{viewBox:"0 0 100 50",className:"w-full h-40",children:[[0,.25,.5,.75,1].map(r=>g.jsx("line",{x1:"0",y1:50-r*45,x2:"100",y2:50-r*45,stroke:"#f0f0f0",strokeWidth:"0.5"},r)),g.jsx("polyline",{fill:"none",stroke:"#4a90e2",strokeWidth:"1",points:e.map((r,a)=>`${a/(e.length-1)*100},${50-r.value/n*45}`).join(" ")}),e.map((r,a)=>g.jsx("circle",{cx:`${a/(e.length-1)*100}`,cy:`${50-r.value/n*45}`,r:"1.5",fill:"#4a90e2"},a))]})]})},d9=({data:e,title:t})=>{const n=Math.max(...e.map(r=>r.value),0);return n===0?g.jsx("div",{className:"flex items-center justify-center h-full text-xs text-slate-500",children:"No data for chart"}):g.jsxs("div",{className:"w-full h-full bg-white p-2 border rounded-md",children:[g.jsx("h5",{className:"text-center font-bold text-sm mb-2",children:t}),g.jsx("div",{className:"space-y-1",children:e.map(r=>g.jsxs("div",{className:"flex items-center text-xs",children:[g.jsx("div",{className:"w-24 truncate pr-2 text-right text-slate-600",children:r.label}),g.jsx("div",{className:"flex-grow bg-slate-200 rounded-full h-4",children:g.jsx("div",{className:"bg-blue-500 h-4 rounded-full text-white text-right pr-1",style:{width:`${r.value/n*100}%`},children:g.jsx("span",{className:"text-[10px]",children:r.value})})})]},r.label))})]})},h9=({actionItem:e,onSave:t,onClose:n,generateUniqueId:r})=>{var M;const[a,l]=he.useState(e.report||{notes:"",attachments:[],matrixData:null}),[c,u]=he.useState("bar"),p=he.useRef(null),m=he.useRef(null),x=k=>{l(b=>({...b,...k}))},y=()=>{t({...e,report:a})},_=k=>{var F;const b=(F=k.target.files)==null?void 0:F[0];if(!b)return;const U=5,G=U*1024*1024;if(b.size>G){alert(`${U}MB`),k.target&&(k.target.value="");return}const J=new FileReader;J.onload=W=>{var O;if(typeof((O=W.target)==null?void 0:O.result)=="string"){const ee={id:r("attach"),name:b.name,type:b.type,dataUrl:W.target.result};x({attachments:[...a.attachments||[],ee]})}else alert("")},J.onerror=()=>{alert("")},J.readAsDataURL(b),k.target&&(k.target.value="")},E=k=>{var b;x({attachments:(b=a.attachments)==null?void 0:b.filter(U=>U.id!==k)})},w=k=>{var G;const b=(G=k.target.files)==null?void 0:G[0];if(!b)return;const U=new FileReader;U.onload=J=>{var F;try{const W=(F=J.target)==null?void 0:F.result,O=Th(W,{type:"array"}),ee=O.SheetNames[0],ne=O.Sheets[ee],te=c9.sheet_to_json(ne,{header:1});if(!Array.isArray(te)||te.length===0){alert("Excel"),k.target&&(k.target.value="");return}const _e=te[0];if(!Array.isArray(_e)){alert("Excel"),k.target&&(k.target.value="");return}const Ie=_e.map(String),Ee=te.slice(1),ae=[];for(const de of Ee)if(Array.isArray(de)){const re=Array(Ie.length).fill("");for(let Y=0;Y<Ie.length;Y++)re[Y]=de[Y]!==null&&de[Y]!==void 0?String(de[Y]):"";ae.push(re)}x({matrixData:{headers:Ie,rows:ae}})}catch(W){console.error("Error parsing Excel file:",W),alert(`Excel: ${W instanceof Error?W.message:"Unknown error"}`)}finally{k.target&&(k.target.value="")}},U.readAsArrayBuffer(b)},S=(((M=a.matrixData)==null?void 0:M.rows)||[]).map(k=>({label:k[0],value:parseFloat(k[1])||0})).filter(k=>k.label&&!isNaN(k.value)),C=()=>{if(!a.matrixData||S.length===0)return null;switch(c){case"line":return g.jsx(f9,{data:S,title:""});case"pie":return g.jsx(u9,{data:S,title:""});case"bar":default:return g.jsx(d9,{data:S,title:""})}};return g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[70]",children:g.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col",children:[g.jsxs("header",{className:"flex items-center justify-between p-5 border-b border-slate-200",children:[g.jsxs("div",{children:[g.jsx("h3",{className:"text-xl font-bold text-slate-800",children:""}),g.jsx("p",{className:"text-sm text-slate-500",children:e.text})]}),g.jsx("button",{onClick:n,className:"p-1 rounded-full hover:bg-slate-100",children:g.jsx(ca,{className:"w-6 h-6 text-slate-500"})})]}),g.jsxs("div",{className:"flex-grow p-5 overflow-y-auto grid grid-cols-1 md:grid-cols-2 gap-6",children:[g.jsxs("div",{className:"space-y-4",children:[g.jsxs("div",{children:[g.jsx("label",{className:"text-sm font-semibold text-slate-700",children:""}),g.jsx("textarea",{value:a.notes,onChange:k=>x({notes:k.target.value}),className:"w-full mt-1 p-2 border rounded-md h-32 bg-slate-50 focus:bg-white text-slate-800",placeholder:"..."})]}),g.jsxs("div",{children:[g.jsxs("h4",{className:"text-sm font-semibold text-slate-700 flex justify-between items-center mb-2",children:["",g.jsx("button",{onClick:()=>{var k;return(k=p.current)==null?void 0:k.click()},className:"p-1 hover:bg-slate-200 rounded-full",children:g.jsx(Ri,{className:"w-5 h-5"})}),g.jsx("input",{type:"file",ref:p,onChange:_,className:"hidden",multiple:!1})]}),g.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 max-h-48 overflow-y-auto border p-2 rounded-md bg-slate-50",children:(a.attachments||[]).map(k=>g.jsxs("div",{className:"relative group border rounded-md overflow-hidden bg-white shadow-sm h-24",children:[g.jsx("a",{href:k.dataUrl,download:k.name,className:"block w-full h-full","aria-label":`Download ${k.name}`,children:k.type.startsWith("image/")?g.jsx("img",{src:k.dataUrl,alt:k.name,className:"w-full h-full object-cover"}):g.jsx("div",{className:"w-full h-full bg-slate-100 flex flex-col items-center justify-center p-2 hover:bg-slate-200",children:g.jsx(Ri,{className:"w-8 h-8 text-slate-500"})})}),g.jsx("div",{className:"absolute bottom-0 w-full bg-black bg-opacity-60 p-1 pointer-events-none",children:g.jsx("p",{className:"text-white text-[10px] truncate",title:k.name,children:k.name})}),g.jsx("button",{onClick:()=>E(k.id),className:"absolute top-1 right-1 bg-black bg-opacity-50 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity z-10",children:g.jsx(Xa,{className:"w-3 h-3"})})]},k.id))})]})]}),g.jsxs("div",{className:"space-y-4",children:[g.jsxs("h4",{className:"text-sm font-semibold text-slate-700 flex justify-between items-center",children:["",g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("button",{onClick:()=>{var k;return(k=m.current)==null?void 0:k.click()},className:"p-1 hover:bg-slate-200 rounded-full",title:"Excel",children:g.jsx(b2,{className:"w-5 h-5 text-green-600"})}),g.jsx("input",{type:"file",ref:m,onChange:w,className:"hidden",accept:".xlsx, .xls, .csv"}),a.matrixData&&S.length>0&&g.jsxs("div",{className:"flex items-center gap-1 rounded-full bg-slate-200 p-0.5",children:[g.jsx("button",{onClick:()=>u("bar"),className:`px-2 py-0.5 rounded-full text-xs ${c==="bar"?"bg-white shadow-sm text-blue-600":"text-slate-600"}`,children:"Bar"}),g.jsx("button",{onClick:()=>u("line"),className:`px-2 py-0.5 rounded-full text-xs ${c==="line"?"bg-white shadow-sm text-blue-600":"text-slate-600"}`,children:"Line"}),g.jsx("button",{onClick:()=>u("pie"),className:`px-2 py-0.5 rounded-full text-xs ${c==="pie"?"bg-white shadow-sm text-blue-600":"text-slate-600"}`,children:"Pie"})]}),g.jsx("button",{onClick:()=>x({matrixData:a.matrixData?null:{headers:["",""],rows:[["",""]]}}),className:"p-1 hover:bg-slate-200 rounded-full",title:a.matrixData?"":"",children:a.matrixData?g.jsx(Xa,{className:"w-5 h-5 text-red-500"}):g.jsx(oc,{className:"w-5 h-5"})})]})]}),a.matrixData?g.jsx(w_,{matrixData:a.matrixData,onUpdate:k=>x({matrixData:k})}):null,g.jsx("div",{className:"mt-4",children:C()})]})]}),g.jsxs("footer",{className:"p-5 bg-slate-100 border-t flex justify-end gap-3",children:[g.jsx("button",{onClick:n,className:"px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md shadow-sm hover:bg-slate-50",children:""}),g.jsx("button",{onClick:y,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700",children:""})]})]})})},zd=({value:e,onChange:t,placeholder:n})=>g.jsx("textarea",{value:e,onChange:r=>t(r.target.value),placeholder:n,rows:3,className:"w-full h-full text-sm bg-transparent outline-none p-2 rounded-sm focus:ring-1 focus:ring-blue-500 focus:bg-blue-50 resize-none text-slate-800 placeholder-slate-400"}),m9=({isOpen:e,onClose:t,onSave:n,task:r,generateUniqueId:a})=>{var F;const[l,c]=he.useState([]),[u,p]=he.useState(!1),[m,x]=he.useState(null),[y,_]=he.useState({key:"status",direction:"ascending"});he.useEffect(()=>{var W;e&&c(((W=r.extendedDetails)==null?void 0:W.decisions)||[])},[e,(F=r.extendedDetails)==null?void 0:F.decisions]);const E=he.useMemo(()=>{let W=[...l];return y!==null&&W.sort((O,ee)=>{let ne="",te="";switch(y.key){case"status":ne=O.status==="undecided"?0:1,te=ee.status==="undecided"?0:1;break;case"date":ne=O.date||"9999-12-31",te=ee.date||"9999-12-31";break;default:ne=(O[y.key]||"").toLowerCase(),te=(ee[y.key]||"").toLowerCase()}return ne<te?y.direction==="ascending"?-1:1:ne>te?y.direction==="ascending"?1:-1:0}),W},[l,y]),w=W=>{let O="ascending";y&&y.key===W&&y.direction==="ascending"&&(O="descending"),_({key:W,direction:O})},S=W=>!y||y.key!==W?g.jsx(ds,{className:"w-3 h-3 ml-1 opacity-30 group-hover:opacity-100"}):y.direction==="ascending"?g.jsx(Jo,{className:"w-3 h-3 ml-1 text-blue-600"}):g.jsx(ds,{className:"w-3 h-3 ml-1 text-blue-600"}),C=({sortKey:W,label:O,className:ee})=>g.jsx("th",{className:`p-0 border border-slate-300 ${ee||""}`,children:g.jsxs("button",{onClick:()=>w(W),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50 transition-colors",children:[g.jsx("span",{children:O}),S(W)]})}),M=async()=>{p(!0),x(null);try{const O=(await DM(r,l)).map(ee=>ee.id==="NEW"?{...ee,id:a("dec_ai")}:ee);c(O)}catch(W){x(W instanceof Error?W.message:"")}finally{p(!1)}},k=(W,O)=>{c(ee=>ee.map(ne=>ne.id===W?{...ne,...O}:ne))},b=(W,O)=>{const ee=l.find(te=>te.id===W);if(!ee)return;const ne={status:O};O==="decided"&&!ee.date?ne.date=new Date().toISOString().split("T")[0]:O==="undecided"&&(ne.date=void 0),k(W,ne)},U=W=>{c(O=>O.filter(ee=>ee.id!==W))},G=()=>{const W={id:a("dec_manual"),question:"",status:"undecided"};c(O=>[W,...O])},J=()=>{n(l)};return e?g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex flex-col p-4 sm:p-6 md:p-8 z-[50]",children:g.jsxs("div",{className:"bg-slate-100 rounded-xl shadow-2xl w-full h-full flex flex-col",children:[g.jsxs("header",{className:"flex-shrink-0 flex items-center justify-between p-4 border-b border-slate-200 bg-white rounded-t-xl",children:[g.jsx("h3",{className:"text-xl font-bold text-slate-800",children:""}),g.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[g.jsxs("button",{onClick:M,disabled:u,className:"flex items-center gap-2 px-3 py-1.5 text-sm font-semibold text-white bg-cyan-600 rounded-md hover:bg-cyan-700 disabled:bg-slate-400",children:[u?g.jsx(ia,{size:"sm",color:"border-white"}):g.jsx(cc,{className:"w-5 h-5"}),g.jsx("span",{children:"AI"})]}),g.jsxs("button",{onClick:G,disabled:u,className:"flex items-center gap-2 px-3 py-1.5 text-sm font-semibold text-slate-700 bg-slate-200 rounded-md hover:bg-slate-300 disabled:bg-slate-400",children:[g.jsx(Nh,{className:"w-5 h-5"}),g.jsx("span",{children:""})]}),g.jsx("button",{onClick:t,className:"p-1.5 rounded-full hover:bg-slate-100",children:g.jsx(ca,{className:"w-6 h-6 text-slate-500"})})]})]}),m&&g.jsx("div",{className:"p-4",children:g.jsx(uc,{message:m})}),g.jsx("main",{className:"flex-grow p-4 overflow-auto",children:g.jsxs("table",{className:"w-full min-w-[1000px] border-collapse text-sm",children:[g.jsx("thead",{className:"sticky top-0 bg-slate-200 z-10",children:g.jsxs("tr",{children:[g.jsx(C,{sortKey:"status",label:"",className:"w-32"}),g.jsx(C,{sortKey:"question",label:" (Question)",className:"w-[25%]"}),g.jsx(C,{sortKey:"decision",label:" (Decision)",className:"w-[25%]"}),g.jsx(C,{sortKey:"reasoning",label:"/",className:"w-[25%]"}),g.jsx(C,{sortKey:"date",label:"",className:"w-36"}),g.jsx("th",{className:"p-2 border border-slate-300 w-16",children:""})]})}),g.jsxs("tbody",{children:[E.map(W=>g.jsxs("tr",{className:"bg-white hover:bg-slate-50 transition-colors",children:[g.jsx("td",{className:"border border-slate-300 align-top p-2",children:g.jsxs("select",{value:W.status,onChange:O=>b(W.id,O.target.value),className:`w-full p-2 rounded-md font-semibold text-xs border ${W.status==="decided"?"bg-green-100 text-green-800 border-green-200":"bg-yellow-100 text-yellow-800 border-yellow-200"}`,children:[g.jsx("option",{value:"undecided",children:""}),g.jsx("option",{value:"decided",children:""})]})}),g.jsx("td",{className:"border border-slate-300",children:g.jsx(zd,{value:W.question||"",onChange:O=>k(W.id,{question:O}),placeholder:""})}),g.jsx("td",{className:"border border-slate-300",children:g.jsx(zd,{value:W.decision||"",onChange:O=>k(W.id,{decision:O}),placeholder:"..."})}),g.jsx("td",{className:"border border-slate-300",children:g.jsx(zd,{value:W.reasoning||"",onChange:O=>k(W.id,{reasoning:O}),placeholder:"..."})}),g.jsx("td",{className:"border border-slate-300 align-top p-2",children:g.jsx("input",{type:"date",value:W.date||"",onChange:O=>k(W.id,{date:O.target.value}),className:"w-full bg-transparent border-b border-dotted border-slate-400 outline-none p-1 text-xs text-slate-600 focus:border-solid focus:border-blue-500 disabled:border-none disabled:bg-slate-100",disabled:W.status==="undecided"})}),g.jsx("td",{className:"border border-slate-300 text-center align-middle",children:g.jsx("button",{onClick:()=>U(W.id),className:"text-red-400 hover:text-red-700 p-1 rounded-full hover:bg-red-100 transition-colors",title:"",children:g.jsx(Xa,{className:"w-5 h-5"})})})]},W.id)),l.length===0&&g.jsx("tr",{children:g.jsx("td",{colSpan:6,className:"text-center py-12 text-slate-500 bg-white border border-slate-300",children:"AI"})})]})]})}),g.jsxs("footer",{className:"flex-shrink-0 p-4 bg-white border-t flex justify-end gap-3 rounded-b-xl",children:[g.jsx("button",{onClick:t,className:"px-5 py-2 text-sm font-medium text-slate-700 bg-slate-100 border border-slate-300 rounded-md shadow-sm hover:bg-slate-200",children:""}),g.jsx("button",{onClick:J,className:"px-5 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700",children:""})]})]})}):null},Hy=({items:e,taskName:t,onClose:n})=>{var x;const[r,a]=he.useState(null),l=he.useMemo(()=>new Set(e.map(y=>y.subStep.id)).size<=1,[e]),c=he.useMemo(()=>{let y=[...e];return r!==null&&y.sort((_,E)=>{let w="",S="";switch(r.key){case"status":w=_.actionItem.completed,S=E.actionItem.completed;break;case"dueDate":w=_.actionItem.dueDate||"9999-12-31",S=E.actionItem.dueDate||"9999-12-31";break;case"completedDate":w=_.actionItem.completedDate||"9999-12-31",S=E.actionItem.completedDate||"9999-12-31";break;case"text":w=(_.actionItem.text||"").toLowerCase(),S=(E.actionItem.text||"").toLowerCase();break;case"subStep":w=(_.subStep.text||"").toLowerCase(),S=(E.subStep.text||"").toLowerCase();break;case"responsible":w=(_.actionItem.responsible||"").toLowerCase(),S=(E.actionItem.responsible||"").toLowerCase();break}return w<S?r.direction==="ascending"?-1:1:w>S?r.direction==="ascending"?1:-1:0}),y},[e,r]),u=y=>{let _="ascending";r&&r.key===y&&r.direction==="ascending"&&(_="descending"),a({key:y,direction:_})},p=y=>!r||r.key!==y?g.jsx(ds,{className:"w-3 h-3 ml-1 opacity-30 group-hover:opacity-100"}):r.direction==="ascending"?g.jsx(Jo,{className:"w-3 h-3 ml-1 text-blue-600"}):g.jsx(ds,{className:"w-3 h-3 ml-1 text-blue-600"}),m=({sortKey:y,label:_,className:E})=>g.jsx("th",{scope:"col",className:`p-0 ${E||""}`,children:g.jsxs("button",{onClick:()=>u(y),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50 transition-colors",children:[g.jsx("span",{children:_}),p(y)]})});return g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[80]",children:g.jsxs("div",{className:"bg-slate-100 rounded-xl shadow-2xl w-full max-w-6xl max-h-[90vh] flex flex-col",children:[g.jsxs("header",{className:"flex-shrink-0 flex items-center justify-between p-4 border-b border-slate-200 bg-white rounded-t-xl",children:[g.jsxs("div",{children:[g.jsx("h3",{className:"text-xl font-bold text-slate-800",children:""}),g.jsx("p",{className:"text-sm text-slate-500",children:l?`: ${t} / : ${((x=e[0])==null?void 0:x.subStep.text)||""}`:`: ${t}`})]}),g.jsx("button",{onClick:n,className:"p-1.5 rounded-full hover:bg-slate-100",children:g.jsx(ca,{className:"w-6 h-6 text-slate-500"})})]}),g.jsx("main",{className:"flex-grow p-4 overflow-auto",children:g.jsxs("table",{className:"w-full border-collapse text-sm",children:[g.jsx("thead",{className:"sticky top-0 bg-slate-200 z-10",children:g.jsxs("tr",{children:[g.jsx(m,{sortKey:"status",label:"",className:"w-28 border border-slate-300"}),g.jsx(m,{sortKey:"text",label:"",className:"w-2/5 border border-slate-300"}),!l&&g.jsx(m,{sortKey:"subStep",label:"",className:"w-1/5 border border-slate-300"}),g.jsx(m,{sortKey:"responsible",label:"",className:"w-40 border border-slate-300"}),g.jsx(m,{sortKey:"dueDate",label:"",className:"w-40 border border-slate-300"}),g.jsx(m,{sortKey:"completedDate",label:"",className:"w-40 border border-slate-300"})]})}),g.jsxs("tbody",{className:"bg-white",children:[c.map(({actionItem:y,subStep:_})=>{var E;return g.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[g.jsx("td",{className:"p-2 border border-slate-300 align-top text-center",children:y.completed?g.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[g.jsx(lc,{className:"w-4 h-4 mr-1"}),""]}):g.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-800",children:[g.jsx(pf,{className:"w-4 h-4 mr-1"}),""]})}),g.jsxs("td",{className:"p-2 border border-slate-300 align-top font-medium text-slate-800",children:[y.text,y.report&&Array.isArray(y.report.attachments)&&y.report.attachments.length>0&&g.jsx("div",{className:"mt-2 pt-2 border-t border-slate-200 space-y-1",children:y.report.attachments.map(w=>g.jsxs("a",{href:w.dataUrl,target:"_blank",rel:"noopener noreferrer",download:w.name,className:"flex items-center gap-1.5 text-xs text-blue-600 hover:underline",children:[g.jsx(Ri,{className:"w-3.5 h-3.5"}),g.jsx("span",{children:w.name})]},w.id))}),((E=y.report)==null?void 0:E.notes)&&g.jsx("p",{className:"text-xs text-slate-500 mt-1 pt-1 border-t border-slate-200 whitespace-pre-wrap",children:y.report.notes})]}),!l&&g.jsx("td",{className:"p-2 border border-slate-300 align-top",children:_.text}),g.jsx("td",{className:"p-2 border border-slate-300 align-top",children:y.responsible||""}),g.jsx("td",{className:"p-2 border border-slate-300 align-top",children:y.dueDate||""}),g.jsx("td",{className:"p-2 border border-slate-300 align-top",children:y.completedDate||""})]},y.id)}),e.length===0&&g.jsx("tr",{children:g.jsx("td",{colSpan:l?5:6,className:"text-center py-10 text-slate-500",children:""})})]})]})}),g.jsx("footer",{className:"flex-shrink-0 p-4 bg-white border-t flex justify-end gap-3 rounded-b-xl",children:g.jsx("button",{onClick:n,className:"px-5 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700",children:""})})]})})},p9=({task:e,isOpen:t,onClose:n,onReportGenerated:r})=>{const[a,l]=he.useState(""),[c,u]=he.useState(new Set),[p,m]=he.useState(!1),[x,y]=he.useState(null),_=he.useMemo(()=>{var b,U,G,J;const k=[];return k.push({id:`task-data-${e.id}`,name:`: ${e.title}`,type:"Task Data",source:{name:`: ${e.title}`,type:"json",content:e}}),(U=(b=e.extendedDetails)==null?void 0:b.attachments)==null||U.forEach(F=>{k.push({id:F.id,name:`: ${F.name}`,type:"Attachment",source:{name:F.name,type:F.type.startsWith("image/")?"image":"text",content:F.dataUrl}})}),(J=(G=e.extendedDetails)==null?void 0:G.subSteps)==null||J.forEach(F=>{var W;(W=F.actionItems)==null||W.forEach(O=>{var ee,ne,te;(ee=O.report)!=null&&ee.matrixData&&k.push({id:`matrix-${O.id}`,name:`: ${O.text} (${F.text})`,type:"Data Matrix",source:{name:`: ${O.text}`,type:"json",content:O.report.matrixData}}),(te=(ne=O.report)==null?void 0:ne.attachments)==null||te.forEach(_e=>{k.push({id:_e.id,name:`: ${_e.name} (${O.text})`,type:"Attachment",source:{name:_e.name,type:_e.type.startsWith("image/")?"image":"text",content:_e.dataUrl}})})})}),k},[e]),E=he.useMemo(()=>_.find(k=>k.type==="Task Data"),[_]),w=he.useMemo(()=>_.filter(k=>k.type!=="Task Data"),[_]);he.useEffect(()=>{if(t){const k=new Set;E&&k.add(E.id),u(k)}},[t,E]);const S=k=>{const b=_.find(U=>U.id===k);(b==null?void 0:b.type)!=="Task Data"&&u(U=>{const G=new Set(U);return G.has(k)?G.delete(k):G.add(k),G})},C=async()=>{if(!a.trim()){y("");return}if(c.size===0){y("1");return}m(!0),y(null);try{const k=_.filter(U=>c.has(U.id)).map(U=>U.source),b=await S2(k,a);r(b)}catch(k){y(k instanceof Error?k.message:"")}finally{m(!1)}};if(!t)return null;const M=k=>{switch(k){case"Task Data":return g.jsx(Wo,{className:"w-5 h-5 text-blue-600"});case"Attachment":return g.jsx(Ri,{className:"w-5 h-5 text-slate-600"});case"Data Matrix":return g.jsx(oc,{className:"w-5 h-5 text-purple-600"});default:return g.jsx(Wo,{className:"w-5 h-5 text-slate-500"})}};return g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[80]",children:g.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-3xl max-h-[90vh] flex flex-col",children:[g.jsxs("header",{className:"flex-shrink-0 flex items-center justify-between p-5 border-b border-slate-200",children:[g.jsx("h3",{className:"text-xl font-bold text-slate-800",children:""}),g.jsx("button",{onClick:n,className:"p-1 rounded-full hover:bg-slate-100",children:g.jsx(ca,{className:"w-6 h-6 text-slate-500"})})]}),g.jsxs("main",{className:"flex-grow p-6 overflow-y-auto grid grid-cols-1 md:grid-cols-2 gap-8",children:[g.jsxs("div",{children:[g.jsx("h4",{className:"font-semibold text-lg text-slate-800 mb-3",children:"1. "}),g.jsxs("div",{className:"mb-4",children:[g.jsx("p",{className:"text-xs text-slate-600 font-semibold mb-1",children:":"}),g.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-md bg-slate-200",children:[g.jsx("input",{type:"checkbox",checked:!0,disabled:!0,className:"w-4 h-4 accent-blue-600"}),E&&M(E.type),g.jsx("span",{className:"text-sm text-slate-800 font-medium truncate",title:E==null?void 0:E.name,children:E==null?void 0:E.name})]})]}),w.length>0&&g.jsxs(g.Fragment,{children:[g.jsx("p",{className:"text-xs text-slate-600 font-semibold mb-1",children:" ():"}),g.jsx("div",{className:"bg-slate-50 border rounded-lg p-3 max-h-80 overflow-y-auto space-y-2",children:w.map(k=>g.jsxs("label",{className:"flex items-center gap-3 p-2 rounded-md hover:bg-slate-100 cursor-pointer",children:[g.jsx("input",{type:"checkbox",checked:c.has(k.id),onChange:()=>S(k.id),className:"w-4 h-4 accent-blue-600"}),M(k.type),g.jsx("span",{className:"text-sm text-slate-700 truncate",title:k.name,children:k.name})]},k.id))})]})]}),g.jsxs("div",{children:[g.jsx("h4",{className:"font-semibold text-lg text-slate-800 mb-3",children:"2. "}),g.jsx("textarea",{value:a,onChange:k=>l(k.target.value),placeholder:"",rows:8,className:"w-full p-3 border border-slate-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition text-sm"}),x&&g.jsx("div",{className:"mt-2",children:g.jsx(uc,{message:x})})]})]}),g.jsxs("footer",{className:"flex-shrink-0 p-5 bg-slate-100 border-t flex justify-end items-center gap-4",children:[g.jsx("button",{onClick:n,className:"px-5 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md shadow-sm hover:bg-slate-50",children:""}),g.jsxs("button",{onClick:C,disabled:p,className:"flex items-center gap-2 px-6 py-2 text-sm font-medium text-white bg-green-600 rounded-md shadow-sm hover:bg-green-700 disabled:bg-slate-400",children:[p?g.jsx(ia,{size:"sm",color:"border-white"}):g.jsx(cc,{className:"w-5 h-5"}),g.jsx("span",{children:p?"...":""})]})]})]})})},xa=({label:e,name:t,value:n,onChange:r,type:a="text",placeholder:l,rows:c,disabled:u=!1,icon:p,required:m=!1})=>g.jsxs("div",{className:"mb-4",children:[g.jsxs("label",{htmlFor:t,className:"block text-sm font-medium text-slate-700 mb-1 flex items-center",children:[p&&g.jsx("span",{className:"mr-1.5 text-slate-500 w-4 h-4",children:p}),e,m&&g.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),a==="textarea"?g.jsx("textarea",{id:t,name:t,value:n,onChange:r,rows:c||3,placeholder:l,disabled:u,className:"w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-sm text-slate-900 bg-white placeholder-slate-400 disabled:bg-slate-100"}):g.jsx("input",{type:a,id:t,name:t,value:n,onChange:r,placeholder:l,disabled:u,className:"w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-sm text-slate-900 bg-white placeholder-slate-400 disabled:bg-slate-100"})]}),x9=Wa.memo(({subStep:e,onRemove:t,onDragStart:n,onClick:r,cardRef:a,isSelected:l,onStartConnection:c,onEndConnection:u})=>{var x,y;const p=_=>{switch(_){case ir.COMPLETED:return"border-l-4 border-green-500";case ir.IN_PROGRESS:return"border-l-4 border-blue-500";default:return"border-l-4 border-slate-300"}},m=_=>{_.stopPropagation(),c(e.id,_)};return g.jsxs("div",{ref:a,draggable:!0,onDragStart:_=>n(_,e.id),onClick:r,onMouseUp:_=>{_.stopPropagation(),u(e.id)},className:`substep-card absolute p-2.5 rounded-lg shadow-sm cursor-grab active:cursor-grabbing bg-white border w-56 h-auto min-h-[100px] text-xs flex flex-col hover:shadow-md transition-all duration-200 ${l?"ring-2 ring-blue-500 shadow-lg":"border-slate-300"} ${p(e.status)}`,style:{left:((x=e.position)==null?void 0:x.x)||0,top:((y=e.position)==null?void 0:y.y)||0,touchAction:"none"},children:[g.jsxs("div",{children:[g.jsxs("div",{className:"flex justify-between items-start text-slate-400 mb-1",children:[g.jsxs("span",{className:"font-mono text-[10px] select-none",children:["ID: ...",e.id.slice(-4)]}),g.jsx("button",{onClick:_=>{_.stopPropagation(),t()},className:"text-red-400 hover:text-red-600 p-0.5",title:"",children:g.jsx(Xa,{className:"w-3.5 h-3.5"})})]}),g.jsx("p",{className:`mb-1 break-words font-semibold text-slate-800 ${e.status===ir.COMPLETED?"line-through text-slate-500":""}`,children:e.text||""})]}),g.jsx("div",{className:"flex-grow my-1 border-t pt-1 min-h-0",children:g.jsx("div",{className:"text-[10px] text-slate-600 space-y-1 h-full max-h-20 overflow-y-auto pr-1",children:(e.actionItems||[]).length>0?(e.actionItems||[]).map(_=>g.jsxs("div",{className:`flex justify-between items-center ${_.completed?"text-slate-400 line-through":""}`,children:[g.jsx("span",{className:"truncate pr-1",title:_.text,children:_.text}),_.dueDate&&g.jsx("span",{className:"flex-shrink-0 text-slate-500",children:new Date(_.dueDate+"T00:00:00Z").toLocaleDateString("ja-JP",{month:"numeric",day:"numeric"})})]},_.id)):g.jsx("div",{className:"text-center text-slate-400 pt-2",children:""})})}),g.jsx("div",{className:"mt-auto",children:e.dueDate&&g.jsxs("div",{className:"text-[11px] text-orange-600 font-medium flex items-center justify-end",children:[g.jsx(Rh,{className:"w-3 h-3 mr-1"}),": ",new Date(e.dueDate+"T00:00:00Z").toLocaleDateString("ja-JP",{year:"2-digit",month:"numeric",day:"numeric"})]})}),g.jsx("div",{onMouseDown:m,className:"absolute right-[-5px] top-1/2 -translate-y-1/2 w-3 h-3 bg-blue-500 rounded-full cursor-crosshair hover:scale-125 transition-transform",title:""})]})}),g9=Wa.memo(({items:e,onToggle:t,onAdd:n,onUpdate:r,onRemove:a,onOpenReport:l,onOpenTable:c})=>g.jsxs("div",{className:"space-y-2 mt-2",children:[g.jsxs("div",{className:"flex justify-between items-center",children:[g.jsx("h6",{className:"text-sm font-semibold text-slate-600",children:""}),g.jsx("button",{onClick:c,className:"p-1 rounded-full hover:bg-slate-200",title:"",children:g.jsx(oc,{className:"w-5 h-5 text-slate-500"})})]}),g.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto pr-2",children:e.map(u=>g.jsxs("div",{className:"group bg-slate-50 p-2 rounded-md transition-all border border-transparent hover:border-slate-200",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("button",{onClick:()=>t(u.id),className:"flex-shrink-0",children:u.completed?g.jsx(lc,{className:"w-5 h-5 text-green-600"}):g.jsx(pf,{className:"w-5 h-5 text-slate-400"})}),g.jsx("div",{className:"flex-grow",onDoubleClick:()=>l(u),children:g.jsx("input",{type:"text",value:u.text,onChange:p=>r(u.id,{text:p.target.value}),placeholder:"",className:`w-full text-sm bg-transparent outline-none p-1 rounded-sm focus:ring-1 focus:ring-blue-500 focus:bg-white ${u.completed?"line-through text-slate-500":"text-slate-800"}`})}),g.jsx("button",{onClick:()=>a(u.id),className:"ml-2 text-red-400 opacity-0 group-hover:opacity-100 transition-opacity",children:g.jsx(Xa,{className:"w-4 h-4"})})]}),g.jsxs("div",{className:"pl-7 pt-1.5 flex justify-end items-center gap-4 text-xs text-slate-500",children:[u.completed&&u.completedDate?g.jsxs("span",{className:"text-xs text-green-600 font-medium flex items-center mr-auto",children:[g.jsx(mf,{className:"w-4 h-4 mr-1"}),": ",new Date(u.completedDate+"T00:00:00Z").toLocaleDateString("ja-JP")]}):g.jsx("div",{className:"mr-auto"}),g.jsxs("div",{className:"flex items-center",children:[g.jsx("label",{htmlFor:`responsible-${u.id}`,className:"mr-1 flex items-center",title:"",children:g.jsx(k2,{className:"w-4 h-4"})}),g.jsx("input",{type:"text",id:`responsible-${u.id}`,value:u.responsible||"",onChange:p=>r(u.id,{responsible:p.target.value}),className:"bg-transparent border-b border-dotted border-slate-400 outline-none p-0.5 w-24 focus:border-solid focus:border-blue-500 disabled:border-none disabled:text-slate-400",placeholder:"",disabled:u.completed})]}),g.jsxs("div",{className:"flex items-center",children:[g.jsx("label",{htmlFor:`due-date-${u.id}`,className:"mr-1",children:":"}),g.jsx("input",{type:"date",id:`due-date-${u.id}`,value:u.dueDate||"",onChange:p=>r(u.id,{dueDate:p.target.value}),className:"bg-transparent border-b border-dotted border-slate-400 outline-none p-0.5 w-28 focus:border-solid focus:border-blue-500 disabled:border-none disabled:text-slate-400",style:{colorScheme:"light"},title:"",disabled:u.completed})]})]})]},u.id))}),g.jsxs("button",{onClick:n,className:"mt-1 text-xs text-blue-600 hover:text-blue-800 font-medium flex items-center gap-1",children:[g.jsx(Nh,{className:"w-4 h-4"}),""]})]})),v9=({task:e,onClose:t,onUpdateTaskCoreInfo:n,onUpdateExtendedDetails:r,generateUniqueId:a,projectGoal:l,targetDate:c})=>{var R,V,L,P,B,z,ue,ye,oe,me,xe,De,Oe,Be,Fe;if(!e)return null;const[u,p]=he.useState(e),[m,x]=he.useState(e),[y,_]=he.useState("none"),[E,w]=he.useState(!1),[S,C]=he.useState(!1),[M,k]=he.useState(!1),[b,U]=he.useState(!1),[G,J]=he.useState(!1),[F,W]=he.useState(null),[O,ee]=he.useState(!1),[ne,te]=he.useState(!1),[_e,Ie]=he.useState([]),[Ee,ae]=he.useState([]),[de,re]=he.useState(!1),[Y,N]=he.useState(null),[Z,D]=he.useState([]),H=he.useRef(null),[q,j]=he.useState(new Map),se=he.useRef(null),Te=he.useRef({x:0,y:0}),[Ae,Re]=he.useState(null),Ce=he.useRef(null),Xe=he.useRef(null),[X,ut]=he.useState(null),[Ke,pt]=he.useState({x:0,y:0}),[Me,ve]=he.useState([]),Ge=he.useMemo(()=>JSON.stringify(m)!==JSON.stringify(u),[m,u]),je=he.useMemo(()=>{var Se;const K=((Se=u.extendedDetails)==null?void 0:Se.decisions)||[];return{decided:K.filter(ke=>ke.status==="decided").length,undecided:K.filter(ke=>ke.status==="undecided").length}},[(R=u.extendedDetails)==null?void 0:R.decisions]);he.useEffect(()=>{p(e),x(e),Ie([]),ae([])},[e]),he.useEffect(()=>{var Se;const K=new Map;(((Se=u.extendedDetails)==null?void 0:Se.subSteps)||[]).forEach(ke=>{ke&&ke.id&&K.set(ke.id,q.get(ke.id)||Wa.createRef())}),j(K)},[(V=u.extendedDetails)==null?void 0:V.subSteps]);const Pt=he.useCallback(()=>{var Se;if(!H.current){ve([]);return}const K=[];(((Se=u.extendedDetails)==null?void 0:Se.subSteps)||[]).forEach(ke=>{var Ue,ze;if((Ue=ke==null?void 0:ke.nextSubStepIds)!=null&&Ue.length){const ot=(ze=q.get(ke.id))==null?void 0:ze.current;if(ot&&ke.position){const Dt={x:ke.position.x+ot.offsetWidth,y:ke.position.y+ot.offsetHeight/2};ke.nextSubStepIds.forEach(Et=>{var Ft,Ir;const It=(Ft=u.extendedDetails)==null?void 0:Ft.subSteps.find(fn=>fn.id===Et),un=(Ir=q.get(Et))==null?void 0:Ir.current;if(It&&un&&It.position){const fn={x:It.position.x,y:It.position.y+un.offsetHeight/2};K.push({id:`subconn-${ke.id}-${Et}`,from:Dt,to:fn,sourceId:ke.id,targetId:Et})}})}}}),ve(K)},[(L=u.extendedDetails)==null?void 0:L.subSteps,q]);he.useEffect(()=>{const K=setTimeout(Pt,100);return()=>clearTimeout(K)},[Pt]);const Ct=he.useCallback(K=>{p(Se=>(Ie(ke=>[...ke,Se]),ae([]),K(Se)))},[]),en=K=>{Ct(Se=>({...Se,...typeof K=="function"?K(Se):K}))},dt=K=>{en(Se=>({extendedDetails:{...Se.extendedDetails,...typeof K=="function"?K(Se.extendedDetails):K}}))},on=()=>{if(_e.length===0)return;const K=_e[_e.length-1];Ie(Se=>Se.slice(0,-1)),ae(Se=>[u,...Se]),p(K)},Bn=()=>{if(Ee.length===0)return;const K=Ee[0];ae(Se=>Se.slice(1)),Ie(Se=>[...Se,u]),p(K)},Jt=async()=>{re(!0),N(null);try{const K=await RM(u);D(K),C(!0)}catch(K){N(K instanceof Error?K.message:"")}finally{re(!1)}},Xt=K=>{dt(Se=>{const ke=Se.subSteps||[],Ue=ke.length,ze=K.newSubSteps.map((Dt,Et)=>({id:a("sub_ai"),text:Dt.title,notes:Dt.description,status:ir.NOT_STARTED,actionItems:[],attachments:[],position:{x:10+(Ue+Et)%4*210,y:Math.floor((Ue+Et)/4)*90+10}}));return{subSteps:[...ke.map(Dt=>{const Et=K.newActionItems.filter(un=>un.targetSubStepId===Dt.id);if(Et.length===0)return Dt;const It=Et.map(un=>({id:a("action_ai"),text:un.title,completed:!1}));return{...Dt,actionItems:[...Dt.actionItems||[],...It]}}),...ze]}}),C(!1)},Ut=()=>{var ke,Ue;const K=((Ue=(ke=u.extendedDetails)==null?void 0:ke.subSteps)==null?void 0:Ue.length)||0,Se={id:a("sub_new"),text:"",status:ir.NOT_STARTED,actionItems:[],attachments:[],position:{x:10+K%4*210,y:Math.floor(K/4)*90+10}};dt(ze=>({subSteps:[...ze.subSteps||[],Se]})),Re(Se.id)},at=he.useCallback((K,Se)=>{dt(ke=>({subSteps:(ke.subSteps||[]).map(Ue=>Ue.id===K?{...Ue,...typeof Se=="function"?Se(Ue):Se}:Ue)}))},[dt]),Ve=he.useCallback(K=>{Re(Se=>Se===K?null:Se),dt(Se=>({subSteps:(Se.subSteps||[]).filter(ke=>ke.id!==K).map(ke=>{var Ue;return{...ke,nextSubStepIds:(Ue=ke.nextSubStepIds)==null?void 0:Ue.filter(ze=>ze!==K)}})}))},[dt]),ht=()=>{var Bi;const K=(Bi=u.extendedDetails)==null?void 0:Bi.subSteps,Se=H.current;if(!K||K.length===0||!Se)return;const ke=new Map;K.forEach(jt=>{var An;const vt=(An=q.get(jt.id))==null?void 0:An.current;ke.set(jt.id,{width:(vt==null?void 0:vt.offsetWidth)||224,height:(vt==null?void 0:vt.offsetHeight)||100})});const Ue=new Map,ze=new Map;K.forEach(jt=>{Ue.set(jt.id,[]),ze.set(jt.id,0)}),K.forEach(jt=>{(jt.nextSubStepIds||[]).forEach(vt=>{Ue.has(vt)&&(Ue.get(jt.id).push(vt),ze.set(vt,ze.get(vt)+1))})});const ot=K.filter(jt=>ze.get(jt.id)===0).map(jt=>jt.id),Dt=[];let Et=0;for(;ot.length>0;){const jt=ot.length,vt=[];for(let An=0;An<jt;An++){const Vi=ot.shift();vt.push(Vi),Et++,(Ue.get(Vi)||[]).forEach(Xr=>{ze.set(Xr,ze.get(Xr)-1),ze.get(Xr)===0&&ot.push(Xr)})}Dt.push(vt)}if(Et<K.length){const jt=new Set(Dt.flat()),vt=K.filter(An=>!jt.has(An.id)).map(An=>An.id);vt.length>0&&Dt.push(vt)}const It=Se.clientWidth,un=60,Ft=20,Ir=new Map;let fn=10,Rl=10,ws=0;Dt.forEach(jt=>{const An=Math.max(...jt.map(yr=>ke.get(yr).width))+un;let Vi=jt.reduce((yr,gc)=>yr+ke.get(gc).height+Ft,0)-(jt.length>0?Ft:0);fn>10&&fn+An>It&&(fn=10,Rl+=ws+Ft*2,ws=0);let Xr=0;jt.forEach(yr=>{Ir.set(yr,{x:fn,y:Rl+Xr}),Xr+=ke.get(yr).height+Ft}),fn+=An,ws=Math.max(ws,Vi)});let ni=0,Cs=0;Ir.forEach((jt,vt)=>{const An=ke.get(vt);ni=Math.max(ni,jt.x+An.width),Cs=Math.max(Cs,jt.y+An.height)}),dt(jt=>({subSteps:(jt.subSteps||[]).map(vt=>({...vt,position:Ir.get(vt.id)||vt.position})),subStepCanvasSize:{width:ni+20,height:Cs+20}}))},Yt=(K,Se)=>{se.current=Se;const ke=K.currentTarget.getBoundingClientRect();Te.current={x:K.clientX-ke.left,y:K.clientY-ke.top},K.dataTransfer.effectAllowed="move"},_t=K=>{K.preventDefault(),K.dataTransfer.dropEffect="move"},Dn=K=>{var It;if(K.preventDefault(),!se.current||!H.current)return;const Se=H.current.getBoundingClientRect(),ke=(It=q.get(se.current))==null?void 0:It.current;if(!ke)return;const Ue=ke.offsetWidth,ze=ke.offsetHeight;let ot=K.clientX-Se.left-Te.current.x+H.current.scrollLeft,Dt=K.clientY-Se.top-Te.current.y+H.current.scrollTop;const Et=H.current.querySelector(".substep-inner-canvas");Et&&(ot=Math.max(0,Math.min(ot,Et.scrollWidth-Ue)),Dt=Math.max(0,Math.min(Dt,Et.scrollHeight-ze))),at(se.current,{position:{x:ot,y:Dt}}),se.current=null},Yn=K=>{W(K),k(!0)},Jr=(K,Se)=>{var Dt;const ke=(Dt=K.target.files)==null?void 0:Dt[0];if(!ke)return;const Ue=5,ze=Ue*1024*1024;if(ke.size>ze){alert(`${Ue}MB`),K.target&&(K.target.value="");return}const ot=new FileReader;ot.onload=Et=>{var It;if(typeof((It=Et.target)==null?void 0:It.result)=="string"){const un={id:a("attach"),name:ke.name,type:ke.type,dataUrl:Et.target.result};Se==="task"?dt(Ft=>({attachments:[...Ft.attachments||[],un]})):Se==="substep"&&Ae&&at(Ae,Ft=>({attachments:[...Ft.attachments||[],un]}))}else alert("")},ot.onerror=()=>{alert("")},ot.readAsDataURL(ke),K.target&&(K.target.value="")},Rr=(K,Se)=>{Se==="task"?dt(ke=>{var Ue;return{attachments:(Ue=ke.attachments)==null?void 0:Ue.filter(ze=>ze.id!==K)}}):Se==="substep"&&Ae&&at(Ae,ke=>{var Ue;return{attachments:(Ue=ke.attachments)==null?void 0:Ue.filter(ze=>ze.id!==K)}})},ti=(K,Se)=>{if(!H.current)return;const ke=H.current.getBoundingClientRect(),Ue={x:Se.clientX-ke.left+H.current.scrollLeft,y:Se.clientY-ke.top+H.current.scrollTop};ut({fromId:K,fromPos:Ue})},Aa=K=>{if(!X)return;const{fromId:Se}=X;if(Se===K){ut(null);return}at(Se,ke=>({...ke,nextSubStepIds:Array.from(new Set([...ke.nextSubStepIds||[],K]))})),ut(null)},ba=(K,Se)=>{at(K,ke=>{var Ue;return{...ke,nextSubStepIds:(Ue=ke.nextSubStepIds)==null?void 0:Ue.filter(ze=>ze!==Se)}})},ka=K=>{if(!X||!H.current)return;const Se=H.current.getBoundingClientRect();pt({x:K.clientX-Se.left+H.current.scrollLeft,y:K.clientY-Se.top+H.current.scrollTop})},Pe=()=>{X&&ut(null)},st=(K,Se)=>{at(K,ke=>{var Ue;return{actionItems:(Ue=ke.actionItems)==null?void 0:Ue.map(ze=>ze.id===Se.id?Se:ze)}}),k(!1),W(null)},gt=(K,Se,ke)=>{at(K,Ue=>{var ze;return{actionItems:(ze=Ue.actionItems)==null?void 0:ze.map(ot=>ot.id===Se?{...ot,...ke}:ot)}})},cn=(K,Se)=>{dt(ke=>({subSteps:(ke.subSteps||[]).map(ze=>{var un;if(ze.id!==K)return ze;const ot=(un=ze.actionItems)==null?void 0:un.map(Ft=>{if(Ft.id!==Se)return Ft;const Ir=!Ft.completed;return{...Ft,completed:Ir,completedDate:Ir?new Date().toISOString().split("T")[0]:void 0}}),Dt=ot==null?void 0:ot.every(Ft=>Ft.completed),Et=ot==null?void 0:ot.some(Ft=>Ft.completed);let It=ze.status;return ot&&ot.length>0?Dt?It=ir.COMPLETED:Et?It=ir.IN_PROGRESS:It=ir.NOT_STARTED:It=ir.NOT_STARTED,{...ze,actionItems:ot,status:It}})}))},In=K=>{at(K,Se=>({actionItems:[...Se.actionItems||[],{id:a("action"),text:"",completed:!1}]}))},Cn=(K,Se)=>{at(K,ke=>{var Ue;return{actionItems:(Ue=ke.actionItems)==null?void 0:Ue.filter(ze=>ze.id!==Se)}})},Dr=()=>{n(u.id,{title:u.title,description:u.description,status:u.status}),r(u.id,u.extendedDetails),t()},Na=K=>{dt({reportDeck:K})},Vn=()=>{J(!0)},tn=K=>{dt({reportDeck:K}),J(!1),w(!0)},nn=()=>{if(!Ge){t();return}window.confirm(`

OK
`)&&t()},dr=K=>{dt({decisions:K}),U(!1)},Mt=((B=(P=u.extendedDetails)==null?void 0:P.subSteps)==null?void 0:B.find(K=>K.id===Ae))||null,Ma=(K,Se)=>g.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 mt-1 max-h-40 overflow-y-auto p-2 border rounded-md bg-slate-50",children:!K||K.length===0?g.jsx("p",{className:"col-span-full text-center text-xs text-slate-400 py-2",children:""}):K.map(ke=>g.jsxs("div",{className:"relative group border rounded-md overflow-hidden bg-white shadow-sm h-20",children:[g.jsx("a",{href:ke.dataUrl,download:ke.name,className:"block w-full h-full","aria-label":`Download ${ke.name}`,children:ke.type.startsWith("image/")?g.jsx("img",{src:ke.dataUrl,alt:ke.name,className:"w-full h-full object-cover"}):g.jsx("div",{className:"w-full h-full bg-slate-100 flex flex-col items-center justify-center p-1 hover:bg-slate-200",children:g.jsx(Ri,{className:"w-8 h-8 text-slate-500"})})}),g.jsx("div",{className:"absolute bottom-0 w-full bg-black bg-opacity-60 p-1 pointer-events-none",children:g.jsx("p",{className:"text-white text-[10px] truncate",title:ke.name,children:ke.name})}),g.jsx("button",{onClick:()=>Se(ke.id),className:"absolute top-1 right-1 bg-black bg-opacity-70 text-white rounded-full p-0.5 opacity-0 group-hover:opacity-100 transition-opacity z-10",children:g.jsx(Xa,{className:"w-3 h-3"})})]},ke.id))});return E&&((z=u.extendedDetails)!=null&&z.reportDeck)?g.jsx(Dh,{tasks:[u],initialDeck:u.extendedDetails.reportDeck,onSave:Na,onClose:()=>w(!1),generateUniqueId:a,projectGoal:l,targetDate:c,reportScope:"task"}):S?g.jsx(lD,{proposals:Z,existingSubSteps:((ue=u.extendedDetails)==null?void 0:ue.subSteps)||[],onConfirm:Xt,onClose:()=>C(!1)}):M&&F&&Mt?g.jsx(h9,{actionItem:F,onSave:K=>st(Mt.id,K),onClose:()=>k(!1),generateUniqueId:a}):g.jsxs(g.Fragment,{children:[g.jsxs("div",{className:"min-h-screen bg-slate-100 flex flex-col",children:[g.jsx("header",{className:"flex-shrink-0 bg-white shadow-md z-10 sticky top-0",children:g.jsxs("div",{className:"flex items-center justify-between p-4 sm:p-5 w-full max-w-screen-2xl mx-auto",children:[g.jsxs("h3",{className:"text-lg sm:text-xl font-bold text-slate-800 truncate pr-2",children:[u.title," - "]}),g.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[g.jsx("button",{onClick:nn,className:"px-3 sm:px-5 py-2 bg-slate-200 text-slate-700 text-sm font-medium rounded-md hover:bg-slate-300",children:""}),g.jsx("button",{onClick:Dr,className:"px-3 sm:px-5 py-2 bg-blue-600 text-white text-sm font-semibold rounded-md hover:bg-blue-700",children:""}),g.jsx("button",{onClick:Vn,className:"px-3 sm:px-5 py-2 bg-purple-600 text-white text-sm font-semibold rounded-md hover:bg-purple-700",children:""})]})]})}),g.jsx("main",{className:"flex-grow p-4 sm:p-6 overflow-hidden w-full max-w-screen-2xl mx-auto",children:g.jsxs("div",{className:"flex gap-6 h-full",children:[g.jsxs("section",{className:`flex flex-col space-y-4 bg-white p-4 rounded-lg shadow-sm border transition-all duration-300 ease-in-out
                  ${y==="info"?"flex-1":y==="none"?"w-[360px] min-w-[360px]":"w-0 p-0 m-0 border-0 overflow-hidden opacity-0"}`,children:[g.jsxs("div",{className:"flex items-center justify-between border-b pb-2",children:[g.jsxs("h4",{className:"text-lg font-semibold text-slate-700 flex items-center",children:[g.jsx(VM,{className:"w-5 h-5 mr-2 text-purple-600"}),""]}),g.jsx("button",{onClick:()=>_(y==="info"?"none":"info"),className:"p-1 text-slate-500 hover:text-blue-600",title:y==="info"?"":"",children:y==="info"?g.jsx(Dd,{className:"w-5 h-5"}):g.jsx(Rd,{className:"w-5 h-5"})})]}),g.jsxs("div",{className:"flex-grow overflow-y-auto pr-2",children:[g.jsx(xa,{label:"",name:"title",value:u.title,onChange:K=>en({title:K.target.value}),required:!0}),g.jsx(xa,{label:"",name:"description",value:u.description,onChange:K=>en({description:K.target.value}),type:"textarea",rows:3,required:!0}),g.jsx(xa,{icon:g.jsx(k2,{}),label:"/",name:"responsible",value:u.extendedDetails.responsible,onChange:K=>dt({responsible:K.target.value})}),g.jsx(xa,{icon:g.jsx(Rh,{}),label:"",name:"dueDate",type:"date",value:u.extendedDetails.dueDate||"",onChange:K=>dt({dueDate:K.target.value})}),g.jsxs("div",{children:[g.jsx(xa,{icon:g.jsx(WM,{}),label:"",name:"resources",value:u.extendedDetails.resources,onChange:K=>dt({resources:K.target.value}),type:"textarea"}),(ye=u.extendedDetails)!=null&&ye.resourceMatrix?g.jsx("div",{className:"mt-2",children:g.jsx(w_,{matrixData:u.extendedDetails.resourceMatrix,onUpdate:K=>dt({resourceMatrix:K})})}):g.jsxs("button",{onClick:()=>dt({resourceMatrix:{headers:["",""],rows:[["",""]]}}),className:"mt-1 text-xs text-blue-600 hover:text-blue-800 font-medium flex items-center gap-1",children:[g.jsx(oc,{className:"w-4 h-4"}),""]})]}),g.jsx(xa,{icon:g.jsx(YM,{}),label:"",name:"notes",value:u.extendedDetails.notes,onChange:K=>dt({notes:K.target.value}),type:"textarea",rows:4}),g.jsx("div",{className:"pt-4 border-t mt-4",children:g.jsxs("button",{onClick:()=>U(!0),className:"w-full text-left p-3 bg-cyan-50 hover:bg-cyan-100 rounded-lg text-cyan-800 font-semibold flex justify-between items-center",children:[g.jsxs("span",{className:"flex items-center gap-2",children:[g.jsx(D2,{className:"w-5 h-5 text-cyan-600"}),""]}),g.jsxs("div",{className:"flex gap-2 text-xs",children:[g.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-green-200 text-green-800",children:[": ",je.decided]}),g.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-yellow-200 text-yellow-800",children:[": ",je.undecided]})]})]})}),g.jsxs("div",{className:"pt-4",children:[g.jsxs("label",{className:"flex items-center justify-between text-sm font-medium text-slate-700 mb-1",children:["",g.jsx("button",{onClick:()=>{var K;return(K=Ce.current)==null?void 0:K.click()},className:"p-1 hover:bg-slate-100 rounded-full",title:"",children:g.jsx(Ri,{className:"w-4 h-4 text-slate-600"})})]}),Ma((oe=u.extendedDetails)==null?void 0:oe.attachments,K=>Rr(K,"task")),g.jsx("input",{type:"file",ref:Ce,onChange:K=>Jr(K,"task"),className:"hidden"})]}),g.jsxs("div",{className:"pt-4",children:[g.jsxs("h4",{className:"text-lg font-semibold text-slate-700 mb-3 border-b pb-2 flex items-center",children:[g.jsx(Mh,{className:"w-5 h-5 mr-2 text-yellow-500"}),"AI"]}),g.jsx("button",{onClick:Jt,disabled:de,className:"w-full px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md shadow-sm hover:bg-indigo-700 disabled:bg-slate-400",children:de?g.jsx(ia,{size:"sm"}):"AI"}),Y&&g.jsx("div",{className:"mt-2",children:g.jsx(uc,{message:Y})})]})]})]}),g.jsxs("section",{className:`flex flex-col space-y-4 min-w-0 transition-all duration-300 ease-in-out
                  ${y==="canvas"||y==="none"?"flex-1":"hidden"}`,children:[g.jsxs("div",{className:"flex items-center justify-between border-b pb-2",children:[g.jsxs("h4",{className:"text-lg font-semibold text-slate-700 flex items-center",children:[g.jsx(jM,{className:"w-5 h-5 mr-2 text-blue-600"}),""]}),g.jsxs("div",{className:"flex gap-2 items-center",children:[g.jsx("button",{onClick:on,disabled:_e.length===0,className:"text-xs px-2 py-1 bg-slate-200 text-slate-700 rounded-md hover:bg-slate-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1",title:"",children:g.jsx(M2,{className:"w-3 h-3"})}),g.jsx("button",{onClick:Bn,disabled:Ee.length===0,className:"text-xs px-2 py-1 bg-slate-200 text-slate-700 rounded-md hover:bg-slate-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1",title:"",children:g.jsx(R2,{className:"w-3 h-3"})}),g.jsxs("button",{onClick:Ut,className:"text-xs px-2 py-1 bg-blue-500 text-white rounded-md hover:bg-blue-600 flex items-center gap-1",children:[g.jsx(Yu,{className:"w-3 h-3"}),""]}),g.jsxs("button",{onClick:ht,className:"text-xs px-2 py-1 bg-slate-200 text-slate-700 rounded-md hover:bg-slate-300 flex items-center gap-1",title:"",children:[g.jsx(xf,{className:"w-3 h-3"}),""]}),g.jsx("button",{onClick:()=>_(y==="canvas"?"none":"canvas"),className:"p-1 text-slate-500 hover:text-blue-600",title:y==="canvas"?"":"",children:y==="canvas"?g.jsx(Dd,{className:"w-5 h-5"}):g.jsx(Rd,{className:"w-5 h-5"})})]})]}),g.jsx("div",{ref:H,onMouseMove:ka,onMouseUp:Pe,onDragOver:_t,onDrop:Dn,className:`substep-canvas relative border rounded-md bg-white p-2 overflow-auto shadow-inner ${y==="canvas"?"":"flex-grow"}`,children:g.jsxs("div",{className:"substep-inner-canvas relative",style:{width:`${((xe=(me=u.extendedDetails)==null?void 0:me.subStepCanvasSize)==null?void 0:xe.width)||1200}px`,height:`${((Oe=(De=u.extendedDetails)==null?void 0:De.subStepCanvasSize)==null?void 0:Oe.height)||800}px`},children:[(((Be=u.extendedDetails)==null?void 0:Be.subSteps)||[]).map(K=>K?g.jsx(x9,{subStep:K,cardRef:q.get(K.id),isSelected:Ae===K.id,onClick:()=>Re(K.id),onRemove:()=>Ve(K.id),onDragStart:Yt,onStartConnection:ti,onEndConnection:Aa},K.id):null),Me.map(K=>g.jsx(Xo,{from:K.from,to:K.to,id:K.id,onDelete:()=>ba(K.sourceId,K.targetId)},K.id)),X&&g.jsx(Xo,{from:X.fromPos,to:Ke,id:"preview-connector"})]})})]}),g.jsxs("section",{className:`flex flex-col space-y-4 bg-white p-4 rounded-lg shadow-sm border transition-all duration-300 ease-in-out
                  ${y==="details"?"flex-1":y==="none"?"w-[360px] min-w-[360px]":"hidden"}`,children:[g.jsx("div",{className:"mb-0",children:g.jsx("button",{onClick:()=>te(!0),className:"w-full text-left p-3 bg-indigo-50 hover:bg-indigo-100 rounded-lg text-indigo-800 font-semibold flex justify-between items-center",children:g.jsxs("span",{className:"flex items-center gap-2",children:[g.jsx(lc,{className:"w-5 h-5 text-indigo-600"}),""]})})}),g.jsxs("div",{className:"flex items-center justify-between border-b pb-2",children:[g.jsx("h5",{className:"text-lg font-semibold text-slate-800",children:""}),g.jsx("button",{onClick:()=>_(y==="details"?"none":"details"),disabled:!Mt,className:"p-1 text-slate-500 hover:text-blue-600 disabled:text-slate-300 disabled:cursor-not-allowed",title:y==="details"?"":"",children:y==="details"?g.jsx(Dd,{className:"w-5 h-5"}):g.jsx(Rd,{className:"w-5 h-5"})})]}),g.jsx("div",{className:"flex-grow overflow-y-auto pr-2",children:Mt?g.jsxs("div",{className:"space-y-4",children:[g.jsx(xa,{label:"",name:"text",value:Mt.text,onChange:K=>at(Mt.id,{text:K.target.value}),type:"textarea"}),g.jsx(xa,{label:"",name:"responsible",value:Mt.responsible||"",onChange:K=>at(Mt.id,{responsible:K.target.value})}),g.jsx(xa,{label:"",name:"dueDate",type:"date",value:Mt.dueDate||"",onChange:K=>at(Mt.id,{dueDate:K.target.value})}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:""}),g.jsx("select",{value:Mt.status||ir.NOT_STARTED,onChange:K=>at(Mt.id,{status:K.target.value}),className:"w-full p-2 border rounded-md text-sm bg-white text-slate-900",children:Object.values(ir).map(K=>g.jsx("option",{value:K,children:K},K))})]}),g.jsx(xa,{label:"",name:"notes",value:Mt.notes||"",onChange:K=>at(Mt.id,{notes:K.target.value}),type:"textarea"}),g.jsx(g9,{items:Mt.actionItems||[],onToggle:K=>cn(Mt.id,K),onAdd:()=>In(Mt.id),onUpdate:(K,Se)=>gt(Mt.id,K,Se),onRemove:K=>Cn(Mt.id,K),onOpenReport:Yn,onOpenTable:()=>ee(!0)}),g.jsxs("div",{children:[g.jsxs("label",{className:"flex items-center justify-between text-sm font-medium text-slate-700 mb-1",children:["",g.jsx("button",{onClick:()=>{var K;return(K=Xe.current)==null?void 0:K.click()},className:"p-1 hover:bg-slate-100 rounded-full",title:"",children:g.jsx(Ri,{className:"w-4 h-4 text-slate-600"})})]}),Ma(Mt.attachments,K=>Rr(K,"substep")),g.jsx("input",{type:"file",ref:Xe,onChange:K=>Jr(K,"substep"),className:"hidden"})]})]}):g.jsx("div",{className:"flex items-center justify-center h-full text-center text-slate-500 text-sm",children:g.jsxs("p",{children:["",g.jsx("br",{}),""]})})})]})]})})]}),b&&g.jsx(m9,{task:u,isOpen:b,onClose:()=>U(!1),onSave:dr,generateUniqueId:a}),ne&&g.jsx(Hy,{items:(((Fe=u.extendedDetails)==null?void 0:Fe.subSteps)||[]).flatMap(K=>(K.actionItems||[]).map(Se=>({actionItem:Se,subStep:K}))),taskName:u.title,onClose:()=>te(!1)}),O&&Mt&&g.jsx(Hy,{items:(Mt.actionItems||[]).map(K=>({actionItem:K,subStep:Mt})),taskName:u.title,onClose:()=>ee(!1)}),G&&g.jsx(p9,{task:u,isOpen:G,onClose:()=>J(!1),onReportGenerated:tn})]})},y9=({onClose:e,onSubmit:t})=>{const[n,r]=he.useState(""),[a,l]=he.useState(""),[c,u]=he.useState(""),p=m=>{if(m.preventDefault(),!n.trim()){u("");return}if(!a.trim()){u("");return}t({title:n,description:a}),u("")};return g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center p-4 z-[60]",children:g.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-lg",children:[g.jsxs("header",{className:"flex items-center justify-between p-6 border-b border-slate-200",children:[g.jsx("h3",{className:"text-xl font-bold text-slate-800",children:""}),g.jsx("button",{onClick:e,className:"text-slate-500 hover:text-slate-700 transition-colors p-1 rounded-full hover:bg-slate-100",title:"","aria-label":"",children:g.jsx(ca,{className:"w-6 h-6"})})]}),g.jsxs("form",{onSubmit:p,children:[g.jsxs("div",{className:"p-6 space-y-4",children:[g.jsxs("div",{children:[g.jsx("label",{htmlFor:"taskTitle",className:"block text-sm font-medium text-slate-700 mb-1",children:""}),g.jsx("input",{type:"text",id:"taskTitle",value:n,onChange:m=>r(m.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-base text-slate-800 placeholder-slate-500",placeholder:": "})]}),g.jsxs("div",{children:[g.jsx("label",{htmlFor:"taskDescription",className:"block text-sm font-medium text-slate-700 mb-1",children:""}),g.jsx("textarea",{id:"taskDescription",value:a,onChange:m=>l(m.target.value),rows:3,className:"w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-base text-slate-800 placeholder-slate-500",placeholder:": "})]}),c&&g.jsx("p",{className:"text-sm text-red-600",children:c})]}),g.jsxs("footer",{className:"p-6 bg-slate-50 border-t border-slate-200 flex justify-end space-x-3 rounded-b-xl",children:[g.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md shadow-sm hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:""}),g.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:""})]})]})]})})},T9=({onSetApiKey:e,error:t,isLoading:n})=>{const[r,a]=he.useState(""),l=c=>{c.preventDefault(),e(r)};return g.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-slate-900 to-slate-700 p-4",children:[g.jsxs("div",{className:"w-full max-w-md bg-white shadow-2xl rounded-xl p-8",children:[g.jsxs("div",{className:"text-center mb-8",children:[g.jsx(cc,{className:"w-12 h-12 mx-auto text-blue-600 mb-4"}),g.jsx("h1",{className:"text-3xl font-bold text-slate-800",children:"AI Project Planner"}),g.jsx("p",{className:"text-slate-600 mt-2",children:"Google Gemini API"})]}),g.jsxs("form",{onSubmit:l,className:"space-y-6",children:[g.jsxs("div",{children:[g.jsxs("label",{htmlFor:"apiKey",className:"block text-sm font-semibold text-slate-700 mb-2 flex items-center",children:[g.jsx(F2,{className:"w-5 h-5 mr-2 text-slate-500"}),"Gemini API Key"]}),g.jsx("input",{id:"apiKey",type:"password",value:r,onChange:c=>a(c.target.value),placeholder:"API",className:"w-full px-4 py-3 bg-slate-100 border border-slate-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150 ease-in-out text-base text-slate-800 placeholder-slate-400"})]}),t&&g.jsx("p",{className:"text-sm text-red-600 bg-red-100 p-3 rounded-md",children:t}),g.jsx("button",{type:"submit",disabled:n||!r,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-slate-400 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition duration-150 ease-in-out flex items-center justify-center",children:n?g.jsx(ia,{size:"sm"}):""})]}),g.jsxs("div",{className:"text-center mt-6",children:[g.jsx("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:underline",children:"API"}),g.jsx("p",{className:"text-xs text-slate-400 mt-2",children:"API"})]})]}),g.jsx("footer",{className:"mt-8 text-center",children:g.jsx("p",{className:"text-slate-400 text-sm",children:"Powered by Gemini API"})})]})},Fi={subSteps:[],resources:"",responsible:"",notes:"",numericalTarget:void 0,dueDate:"",reportDeck:void 0,resourceMatrix:null,attachments:[],decisions:[],subStepCanvasSize:{width:1200,height:800}},_9=()=>[{id:"apqp_1",title:"1: ",description:"/",status:kt.NOT_STARTED,nextTaskIds:["apqp_2"]},{id:"apqp_2",title:"2: ",description:"DFMEA",status:kt.NOT_STARTED,nextTaskIds:["apqp_3"]},{id:"apqp_3",title:"3: ",description:"PFMEA(MSA)",status:kt.NOT_STARTED,nextTaskIds:["apqp_4"]},{id:"apqp_4",title:"4: ",description:"MSA(SPC)(PPAP)",status:kt.NOT_STARTED,nextTaskIds:["apqp_5"]},{id:"apqp_5",title:"5: ",description:"",status:kt.NOT_STARTED,nextTaskIds:[]}].map(t=>({...t,extendedDetails:{...Fi,...t.extendedDetails||{}}})),E9=()=>[{id:"change_1",title:"1. ",description:"",status:kt.NOT_STARTED,nextTaskIds:["change_2"]},{id:"change_2",title:"2. ",description:"(CCB)",status:kt.NOT_STARTED,nextTaskIds:["change_3"]},{id:"change_3",title:"3. ",description:"",status:kt.NOT_STARTED,nextTaskIds:["change_4"]},{id:"change_4",title:"4. ",description:"FMEA",status:kt.NOT_STARTED,nextTaskIds:["change_5"]},{id:"change_5",title:"5. ",description:"",status:kt.NOT_STARTED,nextTaskIds:[]}].map(t=>({...t,extendedDetails:{...Fi,...t.extendedDetails||{}}})),S9=()=>[{id:"eval_1",title:"1. ",description:"",status:kt.NOT_STARTED,nextTaskIds:["eval_2"]},{id:"eval_2",title:"2.  ()",description:"",status:kt.NOT_STARTED,nextTaskIds:["eval_3"]},{id:"eval_3",title:"3. ",description:"",status:kt.NOT_STARTED,nextTaskIds:["eval_4"]},{id:"eval_4",title:"4. ",description:"",status:kt.NOT_STARTED,nextTaskIds:["eval_5"]},{id:"eval_5",title:"5. ",description:"",status:kt.NOT_STARTED,nextTaskIds:[]}].map(t=>({...t,extendedDetails:{...Fi,...t.extendedDetails||{}}})),w9=()=>[{id:"dmaic_1",title:"1:  (Define)",description:"",status:kt.NOT_STARTED,nextTaskIds:["dmaic_2"]},{id:"dmaic_2",title:"2:  (Measure)",description:"KPI",status:kt.NOT_STARTED,nextTaskIds:["dmaic_3"]},{id:"dmaic_3",title:"3:  (Analyze)",description:"",status:kt.NOT_STARTED,nextTaskIds:["dmaic_4"]},{id:"dmaic_4",title:"4:  (Improve)",description:"",status:kt.NOT_STARTED,nextTaskIds:["dmaic_5"]},{id:"dmaic_5",title:"5:  (Control)",description:"",status:kt.NOT_STARTED,nextTaskIds:[]}].map(t=>({...t,extendedDetails:{...Fi,...t.extendedDetails||{}}})),C9=()=>[{id:"mod_1",title:"1. ",description:"",status:kt.NOT_STARTED,nextTaskIds:["mod_2"]},{id:"mod_2",title:"2. ",description:"",status:kt.NOT_STARTED,nextTaskIds:["mod_3"]},{id:"mod_3",title:"3. ",description:"",status:kt.NOT_STARTED,nextTaskIds:["mod_4"]},{id:"mod_4",title:"4. ",description:"",status:kt.NOT_STARTED,nextTaskIds:["mod_5"]},{id:"mod_5",title:"5. ",description:"",status:kt.NOT_STARTED,nextTaskIds:[]}].map(t=>({...t,extendedDetails:{...Fi,...t.extendedDetails||{}}})),A9=()=>{const[e,t]=he.useState(null),[n,r]=he.useState(""),[a,l]=he.useState(""),[c,u]=he.useState([]),[p,m]=he.useState(null),[x,y]=he.useState(null),[_,E]=he.useState(!1),[w,S]=he.useState(null),[C,M]=he.useState(Gr.INPUT_FORM),[k,b]=he.useState(!1),[U,G]=he.useState([]),[J,F]=he.useState([]),[W,O]=he.useState(null);he.useEffect(()=>{const Me=sessionStorage.getItem("gemini-api-key");Me&&re(Me)},[]);const ee=Me=>{G(ve=>[...ve.slice(-10),Me]),F([])},ne=he.useCallback((Me="id")=>`${Me}-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,[]),te=(Me,ve)=>{const Ge=JSON.stringify(Me,null,2),je=new Blob([Ge],{type:"application/json"}),Pt=URL.createObjectURL(je),Ct=document.createElement("a");Ct.href=Pt,Ct.download=ve,document.body.appendChild(Ct),Ct.click(),document.body.removeChild(Ct),URL.revokeObjectURL(Pt)},_e=Me=>new Promise((ve,Ge)=>{const je=new FileReader;je.onload=Pt=>{var Ct;try{typeof((Ct=Pt.target)==null?void 0:Ct.result)=="string"?ve(JSON.parse(Pt.target.result)):Ge(new Error("Failed to read file."))}catch(en){Ge(new Error(`Invalid JSON: ${en.message}`))}},je.onerror=()=>Ge(new Error("File read error.")),je.readAsText(Me)}),Ie=he.useCallback(Me=>{if(Me.length===0)return Me;const ve=new Map(Me.map(Ve=>[Ve.id,Ve])),Ge=new Map(Me.map(Ve=>[Ve.id,0])),je=new Map;Me.forEach(Ve=>{je.set(Ve.id,[]),(Ve.nextTaskIds||[]).forEach(ht=>{var Yt;ve.has(ht)&&(Ge.set(ht,(Ge.get(ht)||0)+1),(Yt=je.get(Ve.id))==null||Yt.push(ht))})});const Pt=Me.filter(Ve=>(Ge.get(Ve.id)||0)===0).map(Ve=>Ve.id),Ct=[];let en=0;const dt=new Set;for(;Pt.length>0;){const Ve=Pt.length;Ct[en]=[];for(let ht=0;ht<Ve;ht++){const Yt=Pt.shift();dt.add(Yt),Ct[en].push(Yt),(je.get(Yt)||[]).forEach(_t=>{Ge.set(_t,(Ge.get(_t)||0)-1),(Ge.get(_t)||0)===0&&Pt.push(_t)})}en++}const on=Me.filter(Ve=>!dt.has(Ve.id));on.length>0&&Ct.push(on.map(Ve=>Ve.id));const Bn=380,Jt=60,Xt=50,Ut=280,at=new Map;return Ct.forEach((Ve,ht)=>{const Yt=Ve.length*Ut+(Ve.length-1)*Xt,_t=Math.max(20,(500-Yt)/2);Ve.forEach((Dn,Yn)=>{at.set(Dn,{x:ht*(Bn+Jt)+20,y:_t+Yn*(Ut+Xt)})})}),Me.map((Ve,ht)=>({...Ve,position:at.get(Ve.id)||Ve.position||{x:20,y:20+ht*100}}))},[]),Ee=Me=>{ee(c),u(Me)},ae=()=>{if(U.length>0){const Me=U[U.length-1];G(ve=>ve.slice(0,-1)),F(ve=>[c,...ve]),u(Me)}},de=()=>{if(J.length>0){const Me=J[0];F(ve=>ve.slice(1)),G(ve=>[...ve,c]),u(Me)}},re=Me=>{Me.trim()&&(Sv(Me),sessionStorage.setItem("gemini-api-key",Me),t(Me),S(null))},Y=()=>{sessionStorage.removeItem("gemini-api-key"),t(null),Sv("")},N=()=>{r(""),l(""),u([]),y(null),O(null),M(Gr.INPUT_FORM),S(null),G([]),F([])},Z=()=>{te({projectGoal:n,targetDate:a,tasks:c,ganttData:x},"project-plan.json")},D=async Me=>{try{const ve=await _e(Me);if(ve.projectGoal&&ve.targetDate&&Array.isArray(ve.tasks))r(ve.projectGoal),l(ve.targetDate),u(ve.tasks.map(Ge=>({...Ge,extendedDetails:{...Fi,...Ge.extendedDetails||{}}}))),y(ve.ganttData||null),O(null),M(Gr.PROJECT_FLOW),G([]),F([]);else throw new Error("Invalid project file format.")}catch(ve){const Ge=ve.message;S(Ge),Ge.toLowerCase().includes("api key")&&Y()}},H=({title:Me,description:ve})=>{const Ge={id:ne("task"),title:Me,description:ve,extendedDetails:Fi,status:kt.NOT_STARTED,position:{x:20,y:20}};Ee(je=>Ie([...je,Ge])),b(!1)},q=Me=>{Ee(ve=>ve.filter(Ge=>Ge.id!==Me).map(Ge=>({...Ge,nextTaskIds:(Ge.nextTaskIds||[]).filter(je=>je!==Me)})))},j=(Me,ve)=>{Ee(Ge=>Ge.map(je=>je.id===Me?{...je,status:ve}:je))},se=(Me,ve)=>{Ee(Ge=>Ge.map(je=>je.id===Me?{...je,nextTaskIds:ve}:je))},Te=(Me,ve)=>{u(Ge=>Ge.map(je=>je.id===Me?{...je,position:ve}:je))},Ae=(Me,ve)=>{Ee(Ge=>Ge.map(je=>je.id===Me?{...je,...ve}:je))},Re=(Me,ve)=>{Ee(Ge=>Ge.map(je=>je.id===Me?{...je,extendedDetails:ve}:je))},Ce=(Me,ve,Ge)=>{let je=[];switch(Me){case"process-design":je=_9();break;case"process-change":je=E9();break;case"new-product-eval":je=S9();break;case"improvement-project":je=w9();break;case"equipment-modification":je=C9();break}r(ve),l(Ge),u(Ie(je)),y(null),O(null),M(Gr.PROJECT_FLOW),G([]),F([]),S(null)},Xe=async(Me,ve)=>{E(!0),S(null);try{r(Me),l(ve);const Ge=await MM(Me,ve),je=Ie(Ge.map(Pt=>({...Pt,extendedDetails:Fi,status:kt.NOT_STARTED})));u(je),y(null),O(null),M(Gr.PROJECT_FLOW),G([]),F([])}catch(Ge){const je=Ge.message;je.toLowerCase().includes("api key")&&Y(),S(je)}finally{E(!1)}},X=Me=>{m(Me),M(Gr.TASK_DETAIL)},ut=()=>{m(null),M(Gr.PROJECT_FLOW)},Ke=Me=>{O(Me)},pt=()=>{if(!e)return g.jsx(T9,{onSetApiKey:re,error:w});if(w)return g.jsxs("div",{className:"p-4",children:[g.jsx(uc,{message:w}),g.jsx("button",{onClick:()=>{S(null),e?M(Gr.INPUT_FORM):Y()},className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded",children:""})]});switch(C){case Gr.PROJECT_FLOW:return g.jsx(sD,{tasks:c,projectGoal:n,targetDate:a,onSelectTask:X,onUpdateTaskExtendedDetails:()=>{},onUpdateTaskPosition:Te,onStartNewProject:N,onExportProject:Z,onAddTask:()=>b(!0),onRemoveTask:q,onUpdateTaskStatus:j,onImportSingleTask:()=>{},onAutoLayout:()=>Ee(Me=>Ie([...Me])),onUndo:ae,canUndo:U.length>0,onRedo:de,canRedo:J.length>0,generateUniqueId:ne,onUpdateTaskConnections:se,ganttData:x,setGanttData:y,onCustomReportGenerated:Ke,onClearApiKey:Y});case Gr.TASK_DETAIL:return p&&g.jsx(v9,{task:p,onClose:ut,onUpdateTaskCoreInfo:Ae,onUpdateExtendedDetails:Re,generateUniqueId:ne,projectGoal:n,targetDate:a});case Gr.INPUT_FORM:default:return g.jsx(ZM,{onSubmit:Xe,isLoading:_,onImportProject:D,onLoadTemplate:Ce,initialGoal:n,initialDate:a})}};return g.jsxs("div",{className:"h-full w-full",children:[pt(),k&&g.jsx(y9,{onClose:()=>b(!1),onSubmit:H}),W&&g.jsx(Dh,{tasks:c,initialDeck:W,onSave:Me=>O(Me),onClose:()=>O(null),projectGoal:n,targetDate:a,reportScope:"project",generateUniqueId:ne})]})},C_=document.getElementById("root");if(!C_)throw new Error("Could not find root element to mount to");const b9=BS.createRoot(C_);b9.render(g.jsx(Wa.StrictMode,{children:g.jsx(A9,{})}));
